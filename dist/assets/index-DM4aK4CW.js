(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();var Qu={exports:{}},ha={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y0;function fS(){if(y0)return ha;y0=1;var l=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,a){var c=null;if(a!==void 0&&(c=""+a),r.key!==void 0&&(c=""+r.key),"key"in r){a={};for(var u in r)u!=="key"&&(a[u]=r[u])}else a=r;return r=a.ref,{$$typeof:l,type:i,key:c,ref:r!==void 0?r:null,props:a}}return ha.Fragment=e,ha.jsx=t,ha.jsxs=t,ha}var x0;function mS(){return x0||(x0=1,Qu.exports=fS()),Qu.exports}var v=mS(),Wu={exports:{}},Re={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v0;function gS(){if(v0)return Re;v0=1;var l=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),p=Symbol.iterator;function y(w){return w===null||typeof w!="object"?null:(w=p&&w[p]||w["@@iterator"],typeof w=="function"?w:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,T={};function b(w,F,q){this.props=w,this.context=F,this.refs=T,this.updater=q||S}b.prototype.isReactComponent={},b.prototype.setState=function(w,F){if(typeof w!="object"&&typeof w!="function"&&w!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,w,F,"setState")},b.prototype.forceUpdate=function(w){this.updater.enqueueForceUpdate(this,w,"forceUpdate")};function L(){}L.prototype=b.prototype;function _(w,F,q){this.props=w,this.context=F,this.refs=T,this.updater=q||S}var I=_.prototype=new L;I.constructor=_,E(I,b.prototype),I.isPureReactComponent=!0;var C=Array.isArray,N={H:null,A:null,T:null,S:null,V:null},K=Object.prototype.hasOwnProperty;function O(w,F,q,se,oe,he){return q=he.ref,{$$typeof:l,type:w,key:F,ref:q!==void 0?q:null,props:he}}function j(w,F){return O(w.type,F,void 0,void 0,void 0,w.props)}function B(w){return typeof w=="object"&&w!==null&&w.$$typeof===l}function U(w){var F={"=":"=0",":":"=2"};return"$"+w.replace(/[=:]/g,function(q){return F[q]})}var W=/\/+/g;function re(w,F){return typeof w=="object"&&w!==null&&w.key!=null?U(""+w.key):F.toString(36)}function ue(){}function fe(w){switch(w.status){case"fulfilled":return w.value;case"rejected":throw w.reason;default:switch(typeof w.status=="string"?w.then(ue,ue):(w.status="pending",w.then(function(F){w.status==="pending"&&(w.status="fulfilled",w.value=F)},function(F){w.status==="pending"&&(w.status="rejected",w.reason=F)})),w.status){case"fulfilled":return w.value;case"rejected":throw w.reason}}throw w}function le(w,F,q,se,oe){var he=typeof w;(he==="undefined"||he==="boolean")&&(w=null);var ce=!1;if(w===null)ce=!0;else switch(he){case"bigint":case"string":case"number":ce=!0;break;case"object":switch(w.$$typeof){case l:case e:ce=!0;break;case m:return ce=w._init,le(ce(w._payload),F,q,se,oe)}}if(ce)return oe=oe(w),ce=se===""?"."+re(w,0):se,C(oe)?(q="",ce!=null&&(q=ce.replace(W,"$&/")+"/"),le(oe,F,q,"",function(rt){return rt})):oe!=null&&(B(oe)&&(oe=j(oe,q+(oe.key==null||w&&w.key===oe.key?"":(""+oe.key).replace(W,"$&/")+"/")+ce)),F.push(oe)),1;ce=0;var Ue=se===""?".":se+":";if(C(w))for(var Ae=0;Ae<w.length;Ae++)se=w[Ae],he=Ue+re(se,Ae),ce+=le(se,F,q,he,oe);else if(Ae=y(w),typeof Ae=="function")for(w=Ae.call(w),Ae=0;!(se=w.next()).done;)se=se.value,he=Ue+re(se,Ae++),ce+=le(se,F,q,he,oe);else if(he==="object"){if(typeof w.then=="function")return le(fe(w),F,q,se,oe);throw F=String(w),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(w).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.")}return ce}function M(w,F,q){if(w==null)return w;var se=[],oe=0;return le(w,se,"","",function(he){return F.call(q,he,oe++)}),se}function Q(w){if(w._status===-1){var F=w._result;F=F(),F.then(function(q){(w._status===0||w._status===-1)&&(w._status=1,w._result=q)},function(q){(w._status===0||w._status===-1)&&(w._status=2,w._result=q)}),w._status===-1&&(w._status=0,w._result=F)}if(w._status===1)return w._result.default;throw w._result}var Z=typeof reportError=="function"?reportError:function(w){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var F=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof w=="object"&&w!==null&&typeof w.message=="string"?String(w.message):String(w),error:w});if(!window.dispatchEvent(F))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",w);return}console.error(w)};function ae(){}return Re.Children={map:M,forEach:function(w,F,q){M(w,function(){F.apply(this,arguments)},q)},count:function(w){var F=0;return M(w,function(){F++}),F},toArray:function(w){return M(w,function(F){return F})||[]},only:function(w){if(!B(w))throw Error("React.Children.only expected to receive a single React element child.");return w}},Re.Component=b,Re.Fragment=t,Re.Profiler=r,Re.PureComponent=_,Re.StrictMode=i,Re.Suspense=f,Re.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,Re.__COMPILER_RUNTIME={__proto__:null,c:function(w){return N.H.useMemoCache(w)}},Re.cache=function(w){return function(){return w.apply(null,arguments)}},Re.cloneElement=function(w,F,q){if(w==null)throw Error("The argument must be a React element, but you passed "+w+".");var se=E({},w.props),oe=w.key,he=void 0;if(F!=null)for(ce in F.ref!==void 0&&(he=void 0),F.key!==void 0&&(oe=""+F.key),F)!K.call(F,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&F.ref===void 0||(se[ce]=F[ce]);var ce=arguments.length-2;if(ce===1)se.children=q;else if(1<ce){for(var Ue=Array(ce),Ae=0;Ae<ce;Ae++)Ue[Ae]=arguments[Ae+2];se.children=Ue}return O(w.type,oe,void 0,void 0,he,se)},Re.createContext=function(w){return w={$$typeof:c,_currentValue:w,_currentValue2:w,_threadCount:0,Provider:null,Consumer:null},w.Provider=w,w.Consumer={$$typeof:a,_context:w},w},Re.createElement=function(w,F,q){var se,oe={},he=null;if(F!=null)for(se in F.key!==void 0&&(he=""+F.key),F)K.call(F,se)&&se!=="key"&&se!=="__self"&&se!=="__source"&&(oe[se]=F[se]);var ce=arguments.length-2;if(ce===1)oe.children=q;else if(1<ce){for(var Ue=Array(ce),Ae=0;Ae<ce;Ae++)Ue[Ae]=arguments[Ae+2];oe.children=Ue}if(w&&w.defaultProps)for(se in ce=w.defaultProps,ce)oe[se]===void 0&&(oe[se]=ce[se]);return O(w,he,void 0,void 0,null,oe)},Re.createRef=function(){return{current:null}},Re.forwardRef=function(w){return{$$typeof:u,render:w}},Re.isValidElement=B,Re.lazy=function(w){return{$$typeof:m,_payload:{_status:-1,_result:w},_init:Q}},Re.memo=function(w,F){return{$$typeof:h,type:w,compare:F===void 0?null:F}},Re.startTransition=function(w){var F=N.T,q={};N.T=q;try{var se=w(),oe=N.S;oe!==null&&oe(q,se),typeof se=="object"&&se!==null&&typeof se.then=="function"&&se.then(ae,Z)}catch(he){Z(he)}finally{N.T=F}},Re.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},Re.use=function(w){return N.H.use(w)},Re.useActionState=function(w,F,q){return N.H.useActionState(w,F,q)},Re.useCallback=function(w,F){return N.H.useCallback(w,F)},Re.useContext=function(w){return N.H.useContext(w)},Re.useDebugValue=function(){},Re.useDeferredValue=function(w,F){return N.H.useDeferredValue(w,F)},Re.useEffect=function(w,F,q){var se=N.H;if(typeof q=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return se.useEffect(w,F)},Re.useId=function(){return N.H.useId()},Re.useImperativeHandle=function(w,F,q){return N.H.useImperativeHandle(w,F,q)},Re.useInsertionEffect=function(w,F){return N.H.useInsertionEffect(w,F)},Re.useLayoutEffect=function(w,F){return N.H.useLayoutEffect(w,F)},Re.useMemo=function(w,F){return N.H.useMemo(w,F)},Re.useOptimistic=function(w,F){return N.H.useOptimistic(w,F)},Re.useReducer=function(w,F,q){return N.H.useReducer(w,F,q)},Re.useRef=function(w){return N.H.useRef(w)},Re.useState=function(w){return N.H.useState(w)},Re.useSyncExternalStore=function(w,F,q){return N.H.useSyncExternalStore(w,F,q)},Re.useTransition=function(){return N.H.useTransition()},Re.version="19.1.0",Re}var E0;function Xd(){return E0||(E0=1,Wu.exports=gS()),Wu.exports}var te=Xd(),Zu={exports:{}},fa={},Ju={exports:{}},ed={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S0;function pS(){return S0||(S0=1,function(l){function e(M,Q){var Z=M.length;M.push(Q);e:for(;0<Z;){var ae=Z-1>>>1,w=M[ae];if(0<r(w,Q))M[ae]=Q,M[Z]=w,Z=ae;else break e}}function t(M){return M.length===0?null:M[0]}function i(M){if(M.length===0)return null;var Q=M[0],Z=M.pop();if(Z!==Q){M[0]=Z;e:for(var ae=0,w=M.length,F=w>>>1;ae<F;){var q=2*(ae+1)-1,se=M[q],oe=q+1,he=M[oe];if(0>r(se,Z))oe<w&&0>r(he,se)?(M[ae]=he,M[oe]=Z,ae=oe):(M[ae]=se,M[q]=Z,ae=q);else if(oe<w&&0>r(he,Z))M[ae]=he,M[oe]=Z,ae=oe;else break e}}return Q}function r(M,Q){var Z=M.sortIndex-Q.sortIndex;return Z!==0?Z:M.id-Q.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;l.unstable_now=function(){return a.now()}}else{var c=Date,u=c.now();l.unstable_now=function(){return c.now()-u}}var f=[],h=[],m=1,p=null,y=3,S=!1,E=!1,T=!1,b=!1,L=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function C(M){for(var Q=t(h);Q!==null;){if(Q.callback===null)i(h);else if(Q.startTime<=M)i(h),Q.sortIndex=Q.expirationTime,e(f,Q);else break;Q=t(h)}}function N(M){if(T=!1,C(M),!E)if(t(f)!==null)E=!0,K||(K=!0,re());else{var Q=t(h);Q!==null&&le(N,Q.startTime-M)}}var K=!1,O=-1,j=5,B=-1;function U(){return b?!0:!(l.unstable_now()-B<j)}function W(){if(b=!1,K){var M=l.unstable_now();B=M;var Q=!0;try{e:{E=!1,T&&(T=!1,_(O),O=-1),S=!0;var Z=y;try{t:{for(C(M),p=t(f);p!==null&&!(p.expirationTime>M&&U());){var ae=p.callback;if(typeof ae=="function"){p.callback=null,y=p.priorityLevel;var w=ae(p.expirationTime<=M);if(M=l.unstable_now(),typeof w=="function"){p.callback=w,C(M),Q=!0;break t}p===t(f)&&i(f),C(M)}else i(f);p=t(f)}if(p!==null)Q=!0;else{var F=t(h);F!==null&&le(N,F.startTime-M),Q=!1}}break e}finally{p=null,y=Z,S=!1}Q=void 0}}finally{Q?re():K=!1}}}var re;if(typeof I=="function")re=function(){I(W)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,fe=ue.port2;ue.port1.onmessage=W,re=function(){fe.postMessage(null)}}else re=function(){L(W,0)};function le(M,Q){O=L(function(){M(l.unstable_now())},Q)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(M){M.callback=null},l.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<M?Math.floor(1e3/M):5},l.unstable_getCurrentPriorityLevel=function(){return y},l.unstable_next=function(M){switch(y){case 1:case 2:case 3:var Q=3;break;default:Q=y}var Z=y;y=Q;try{return M()}finally{y=Z}},l.unstable_requestPaint=function(){b=!0},l.unstable_runWithPriority=function(M,Q){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var Z=y;y=M;try{return Q()}finally{y=Z}},l.unstable_scheduleCallback=function(M,Q,Z){var ae=l.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?ae+Z:ae):Z=ae,M){case 1:var w=-1;break;case 2:w=250;break;case 5:w=1073741823;break;case 4:w=1e4;break;default:w=5e3}return w=Z+w,M={id:m++,callback:Q,priorityLevel:M,startTime:Z,expirationTime:w,sortIndex:-1},Z>ae?(M.sortIndex=Z,e(h,M),t(f)===null&&M===t(h)&&(T?(_(O),O=-1):T=!0,le(N,Z-ae))):(M.sortIndex=w,e(f,M),E||S||(E=!0,K||(K=!0,re()))),M},l.unstable_shouldYield=U,l.unstable_wrapCallback=function(M){var Q=y;return function(){var Z=y;y=Q;try{return M.apply(this,arguments)}finally{y=Z}}}}(ed)),ed}var T0;function yS(){return T0||(T0=1,Ju.exports=pS()),Ju.exports}var td={exports:{}},It={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b0;function xS(){if(b0)return It;b0=1;var l=Xd();function e(f){var h="https://react.dev/errors/"+f;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(f,h,m){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:p==null?null:""+p,children:f,containerInfo:h,implementation:m}}var c=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,h){if(f==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return It.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,It.createPortal=function(f,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return a(f,h,null,m)},It.flushSync=function(f){var h=c.T,m=i.p;try{if(c.T=null,i.p=2,f)return f()}finally{c.T=h,i.p=m,i.d.f()}},It.preconnect=function(f,h){typeof f=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,i.d.C(f,h))},It.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},It.preinit=function(f,h){if(typeof f=="string"&&h&&typeof h.as=="string"){var m=h.as,p=u(m,h.crossOrigin),y=typeof h.integrity=="string"?h.integrity:void 0,S=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;m==="style"?i.d.S(f,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:p,integrity:y,fetchPriority:S}):m==="script"&&i.d.X(f,{crossOrigin:p,integrity:y,fetchPriority:S,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},It.preinitModule=function(f,h){if(typeof f=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var m=u(h.as,h.crossOrigin);i.d.M(f,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&i.d.M(f)},It.preload=function(f,h){if(typeof f=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var m=h.as,p=u(m,h.crossOrigin);i.d.L(f,m,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},It.preloadModule=function(f,h){if(typeof f=="string")if(h){var m=u(h.as,h.crossOrigin);i.d.m(f,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else i.d.m(f)},It.requestFormReset=function(f){i.d.r(f)},It.unstable_batchedUpdates=function(f,h){return f(h)},It.useFormState=function(f,h,m){return c.H.useFormState(f,h,m)},It.useFormStatus=function(){return c.H.useHostTransitionStatus()},It.version="19.1.0",It}var A0;function vS(){if(A0)return td.exports;A0=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(e){console.error(e)}}return l(),td.exports=xS(),td.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R0;function ES(){if(R0)return fa;R0=1;var l=yS(),e=Xd(),t=vS();function i(s){var n="https://react.dev/errors/"+s;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)n+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var n=s,o=s;if(s.alternate)for(;n.return;)n=n.return;else{s=n;do n=s,(n.flags&4098)!==0&&(o=n.return),s=n.return;while(s)}return n.tag===3?o:null}function c(s){if(s.tag===13){var n=s.memoizedState;if(n===null&&(s=s.alternate,s!==null&&(n=s.memoizedState)),n!==null)return n.dehydrated}return null}function u(s){if(a(s)!==s)throw Error(i(188))}function f(s){var n=s.alternate;if(!n){if(n=a(s),n===null)throw Error(i(188));return n!==s?null:s}for(var o=s,d=n;;){var g=o.return;if(g===null)break;var x=g.alternate;if(x===null){if(d=g.return,d!==null){o=d;continue}break}if(g.child===x.child){for(x=g.child;x;){if(x===o)return u(g),s;if(x===d)return u(g),n;x=x.sibling}throw Error(i(188))}if(o.return!==d.return)o=g,d=x;else{for(var R=!1,D=g.child;D;){if(D===o){R=!0,o=g,d=x;break}if(D===d){R=!0,d=g,o=x;break}D=D.sibling}if(!R){for(D=x.child;D;){if(D===o){R=!0,o=x,d=g;break}if(D===d){R=!0,d=x,o=g;break}D=D.sibling}if(!R)throw Error(i(189))}}if(o.alternate!==d)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:n}function h(s){var n=s.tag;if(n===5||n===26||n===27||n===6)return s;for(s=s.child;s!==null;){if(n=h(s),n!==null)return n;s=s.sibling}return null}var m=Object.assign,p=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),_=Symbol.for("react.consumer"),I=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function re(s){return s===null||typeof s!="object"?null:(s=W&&s[W]||s["@@iterator"],typeof s=="function"?s:null)}var ue=Symbol.for("react.client.reference");function fe(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ue?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case E:return"Fragment";case b:return"Profiler";case T:return"StrictMode";case N:return"Suspense";case K:return"SuspenseList";case B:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case S:return"Portal";case I:return(s.displayName||"Context")+".Provider";case _:return(s._context.displayName||"Context")+".Consumer";case C:var n=s.render;return s=s.displayName,s||(s=n.displayName||n.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case O:return n=s.displayName||null,n!==null?n:fe(s.type)||"Memo";case j:n=s._payload,s=s._init;try{return fe(s(n))}catch{}}return null}var le=Array.isArray,M=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z={pending:!1,data:null,method:null,action:null},ae=[],w=-1;function F(s){return{current:s}}function q(s){0>w||(s.current=ae[w],ae[w]=null,w--)}function se(s,n){w++,ae[w]=s.current,s.current=n}var oe=F(null),he=F(null),ce=F(null),Ue=F(null);function Ae(s,n){switch(se(ce,n),se(he,s),se(oe,null),n.nodeType){case 9:case 11:s=(s=n.documentElement)&&(s=s.namespaceURI)?Kg(s):0;break;default:if(s=n.tagName,n=n.namespaceURI)n=Kg(n),s=zg(n,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}q(oe),se(oe,s)}function rt(){q(oe),q(he),q(ce)}function kt(s){s.memoizedState!==null&&se(Ue,s);var n=oe.current,o=zg(n,s.type);n!==o&&(se(he,s),se(oe,o))}function ii(s){he.current===s&&(q(oe),q(he)),Ue.current===s&&(q(Ue),la._currentValue=Z)}var mr=Object.prototype.hasOwnProperty,Fs=l.unstable_scheduleCallback,js=l.unstable_cancelCallback,Lh=l.unstable_shouldYield,Ne=l.unstable_requestPaint,ze=l.unstable_now,Ot=l.unstable_getCurrentPriorityLevel,Ti=l.unstable_ImmediatePriority,Mt=l.unstable_UserBlockingPriority,gi=l.unstable_NormalPriority,Fi=l.unstable_LowPriority,gr=l.unstable_IdlePriority,fn=l.log,Na=l.unstable_setDisableYieldValue,pi=null,Rt=null;function bi(s){if(typeof fn=="function"&&Na(s),Rt&&typeof Rt.setStrictMode=="function")try{Rt.setStrictMode(pi,s)}catch{}}var Lt=Math.clz32?Math.clz32:Jx,ka=Math.log,$s=Math.LN2;function Jx(s){return s>>>=0,s===0?32:31-(ka(s)/$s|0)|0}var Oa=256,Ma=4194304;function Gs(s){var n=s&42;if(n!==0)return n;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Pa(s,n,o){var d=s.pendingLanes;if(d===0)return 0;var g=0,x=s.suspendedLanes,R=s.pingedLanes;s=s.warmLanes;var D=d&134217727;return D!==0?(d=D&~x,d!==0?g=Gs(d):(R&=D,R!==0?g=Gs(R):o||(o=D&~s,o!==0&&(g=Gs(o))))):(D=d&~x,D!==0?g=Gs(D):R!==0?g=Gs(R):o||(o=d&~s,o!==0&&(g=Gs(o)))),g===0?0:n!==0&&n!==g&&(n&x)===0&&(x=g&-g,o=n&-n,x>=o||x===32&&(o&4194048)!==0)?n:g}function pr(s,n){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&n)===0}function ev(s,n){switch(s){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _h(){var s=Oa;return Oa<<=1,(Oa&4194048)===0&&(Oa=256),s}function Dh(){var s=Ma;return Ma<<=1,(Ma&62914560)===0&&(Ma=4194304),s}function Fo(s){for(var n=[],o=0;31>o;o++)n.push(s);return n}function yr(s,n){s.pendingLanes|=n,n!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function tv(s,n,o,d,g,x){var R=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var D=s.entanglements,k=s.expirationTimes,z=s.hiddenUpdates;for(o=R&~o;0<o;){var J=31-Lt(o),ne=1<<J;D[J]=0,k[J]=-1;var Y=z[J];if(Y!==null)for(z[J]=null,J=0;J<Y.length;J++){var X=Y[J];X!==null&&(X.lane&=-536870913)}o&=~ne}d!==0&&Ih(s,d,0),x!==0&&g===0&&s.tag!==0&&(s.suspendedLanes|=x&~(R&~n))}function Ih(s,n,o){s.pendingLanes|=n,s.suspendedLanes&=~n;var d=31-Lt(n);s.entangledLanes|=n,s.entanglements[d]=s.entanglements[d]|1073741824|o&4194090}function Ch(s,n){var o=s.entangledLanes|=n;for(s=s.entanglements;o;){var d=31-Lt(o),g=1<<d;g&n|s[d]&n&&(s[d]|=n),o&=~g}}function jo(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function $o(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function wh(){var s=Q.p;return s!==0?s:(s=window.event,s===void 0?32:d0(s.type))}function iv(s,n){var o=Q.p;try{return Q.p=s,n()}finally{Q.p=o}}var os=Math.random().toString(36).slice(2),_t="__reactFiber$"+os,Pt="__reactProps$"+os,mn="__reactContainer$"+os,Go="__reactEvents$"+os,sv="__reactListeners$"+os,nv="__reactHandles$"+os,Nh="__reactResources$"+os,xr="__reactMarker$"+os;function Ho(s){delete s[_t],delete s[Pt],delete s[Go],delete s[sv],delete s[nv]}function gn(s){var n=s[_t];if(n)return n;for(var o=s.parentNode;o;){if(n=o[mn]||o[_t]){if(o=n.alternate,n.child!==null||o!==null&&o.child!==null)for(s=Qg(s);s!==null;){if(o=s[_t])return o;s=Qg(s)}return n}s=o,o=s.parentNode}return null}function pn(s){if(s=s[_t]||s[mn]){var n=s.tag;if(n===5||n===6||n===13||n===26||n===27||n===3)return s}return null}function vr(s){var n=s.tag;if(n===5||n===26||n===27||n===6)return s.stateNode;throw Error(i(33))}function yn(s){var n=s[Nh];return n||(n=s[Nh]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function gt(s){s[xr]=!0}var kh=new Set,Oh={};function Hs(s,n){xn(s,n),xn(s+"Capture",n)}function xn(s,n){for(Oh[s]=n,s=0;s<n.length;s++)kh.add(n[s])}var rv=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Mh={},Ph={};function av(s){return mr.call(Ph,s)?!0:mr.call(Mh,s)?!1:rv.test(s)?Ph[s]=!0:(Mh[s]=!0,!1)}function Ua(s,n,o){if(av(n))if(o===null)s.removeAttribute(n);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(n);return;case"boolean":var d=n.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){s.removeAttribute(n);return}}s.setAttribute(n,""+o)}}function Ba(s,n,o){if(o===null)s.removeAttribute(n);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(n);return}s.setAttribute(n,""+o)}}function ji(s,n,o,d){if(d===null)s.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(n,o,""+d)}}var Vo,Uh;function vn(s){if(Vo===void 0)try{throw Error()}catch(o){var n=o.stack.trim().match(/\n( *(at )?)/);Vo=n&&n[1]||"",Uh=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Vo+s+Uh}var Ko=!1;function zo(s,n){if(!s||Ko)return"";Ko=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(n){var ne=function(){throw Error()};if(Object.defineProperty(ne.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ne,[])}catch(X){var Y=X}Reflect.construct(s,[],ne)}else{try{ne.call()}catch(X){Y=X}s.call(ne.prototype)}}else{try{throw Error()}catch(X){Y=X}(ne=s())&&typeof ne.catch=="function"&&ne.catch(function(){})}}catch(X){if(X&&Y&&typeof X.stack=="string")return[X.stack,Y.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=d.DetermineComponentFrameRoot(),R=x[0],D=x[1];if(R&&D){var k=R.split(`
`),z=D.split(`
`);for(g=d=0;d<k.length&&!k[d].includes("DetermineComponentFrameRoot");)d++;for(;g<z.length&&!z[g].includes("DetermineComponentFrameRoot");)g++;if(d===k.length||g===z.length)for(d=k.length-1,g=z.length-1;1<=d&&0<=g&&k[d]!==z[g];)g--;for(;1<=d&&0<=g;d--,g--)if(k[d]!==z[g]){if(d!==1||g!==1)do if(d--,g--,0>g||k[d]!==z[g]){var J=`
`+k[d].replace(" at new "," at ");return s.displayName&&J.includes("<anonymous>")&&(J=J.replace("<anonymous>",s.displayName)),J}while(1<=d&&0<=g);break}}}finally{Ko=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?vn(o):""}function lv(s){switch(s.tag){case 26:case 27:case 5:return vn(s.type);case 16:return vn("Lazy");case 13:return vn("Suspense");case 19:return vn("SuspenseList");case 0:case 15:return zo(s.type,!1);case 11:return zo(s.type.render,!1);case 1:return zo(s.type,!0);case 31:return vn("Activity");default:return""}}function Bh(s){try{var n="";do n+=lv(s),s=s.return;while(s);return n}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}function si(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Fh(s){var n=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function ov(s){var n=Fh(s)?"checked":"value",o=Object.getOwnPropertyDescriptor(s.constructor.prototype,n),d=""+s[n];if(!s.hasOwnProperty(n)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var g=o.get,x=o.set;return Object.defineProperty(s,n,{configurable:!0,get:function(){return g.call(this)},set:function(R){d=""+R,x.call(this,R)}}),Object.defineProperty(s,n,{enumerable:o.enumerable}),{getValue:function(){return d},setValue:function(R){d=""+R},stopTracking:function(){s._valueTracker=null,delete s[n]}}}}function Fa(s){s._valueTracker||(s._valueTracker=ov(s))}function jh(s){if(!s)return!1;var n=s._valueTracker;if(!n)return!0;var o=n.getValue(),d="";return s&&(d=Fh(s)?s.checked?"true":"false":s.value),s=d,s!==o?(n.setValue(s),!0):!1}function ja(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var cv=/[\n"\\]/g;function ni(s){return s.replace(cv,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function Yo(s,n,o,d,g,x,R,D){s.name="",R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?s.type=R:s.removeAttribute("type"),n!=null?R==="number"?(n===0&&s.value===""||s.value!=n)&&(s.value=""+si(n)):s.value!==""+si(n)&&(s.value=""+si(n)):R!=="submit"&&R!=="reset"||s.removeAttribute("value"),n!=null?qo(s,R,si(n)):o!=null?qo(s,R,si(o)):d!=null&&s.removeAttribute("value"),g==null&&x!=null&&(s.defaultChecked=!!x),g!=null&&(s.checked=g&&typeof g!="function"&&typeof g!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?s.name=""+si(D):s.removeAttribute("name")}function $h(s,n,o,d,g,x,R,D){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(s.type=x),n!=null||o!=null){if(!(x!=="submit"&&x!=="reset"||n!=null))return;o=o!=null?""+si(o):"",n=n!=null?""+si(n):o,D||n===s.value||(s.value=n),s.defaultValue=n}d=d??g,d=typeof d!="function"&&typeof d!="symbol"&&!!d,s.checked=D?s.checked:!!d,s.defaultChecked=!!d,R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(s.name=R)}function qo(s,n,o){n==="number"&&ja(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function En(s,n,o,d){if(s=s.options,n){n={};for(var g=0;g<o.length;g++)n["$"+o[g]]=!0;for(o=0;o<s.length;o++)g=n.hasOwnProperty("$"+s[o].value),s[o].selected!==g&&(s[o].selected=g),g&&d&&(s[o].defaultSelected=!0)}else{for(o=""+si(o),n=null,g=0;g<s.length;g++){if(s[g].value===o){s[g].selected=!0,d&&(s[g].defaultSelected=!0);return}n!==null||s[g].disabled||(n=s[g])}n!==null&&(n.selected=!0)}}function Gh(s,n,o){if(n!=null&&(n=""+si(n),n!==s.value&&(s.value=n),o==null)){s.defaultValue!==n&&(s.defaultValue=n);return}s.defaultValue=o!=null?""+si(o):""}function Hh(s,n,o,d){if(n==null){if(d!=null){if(o!=null)throw Error(i(92));if(le(d)){if(1<d.length)throw Error(i(93));d=d[0]}o=d}o==null&&(o=""),n=o}o=si(n),s.defaultValue=o,d=s.textContent,d===o&&d!==""&&d!==null&&(s.value=d)}function Sn(s,n){if(n){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=n;return}}s.textContent=n}var uv=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Vh(s,n,o){var d=n.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?d?s.setProperty(n,""):n==="float"?s.cssFloat="":s[n]="":d?s.setProperty(n,o):typeof o!="number"||o===0||uv.has(n)?n==="float"?s.cssFloat=o:s[n]=(""+o).trim():s[n]=o+"px"}function Kh(s,n,o){if(n!=null&&typeof n!="object")throw Error(i(62));if(s=s.style,o!=null){for(var d in o)!o.hasOwnProperty(d)||n!=null&&n.hasOwnProperty(d)||(d.indexOf("--")===0?s.setProperty(d,""):d==="float"?s.cssFloat="":s[d]="");for(var g in n)d=n[g],n.hasOwnProperty(g)&&o[g]!==d&&Vh(s,g,d)}else for(var x in n)n.hasOwnProperty(x)&&Vh(s,x,n[x])}function Xo(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dv=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hv=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function $a(s){return hv.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var Qo=null;function Wo(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Tn=null,bn=null;function zh(s){var n=pn(s);if(n&&(s=n.stateNode)){var o=s[Pt]||null;e:switch(s=n.stateNode,n.type){case"input":if(Yo(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),n=o.name,o.type==="radio"&&n!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+ni(""+n)+'"][type="radio"]'),n=0;n<o.length;n++){var d=o[n];if(d!==s&&d.form===s.form){var g=d[Pt]||null;if(!g)throw Error(i(90));Yo(d,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(n=0;n<o.length;n++)d=o[n],d.form===s.form&&jh(d)}break e;case"textarea":Gh(s,o.value,o.defaultValue);break e;case"select":n=o.value,n!=null&&En(s,!!o.multiple,n,!1)}}}var Zo=!1;function Yh(s,n,o){if(Zo)return s(n,o);Zo=!0;try{var d=s(n);return d}finally{if(Zo=!1,(Tn!==null||bn!==null)&&(Ll(),Tn&&(n=Tn,s=bn,bn=Tn=null,zh(n),s)))for(n=0;n<s.length;n++)zh(s[n])}}function Er(s,n){var o=s.stateNode;if(o===null)return null;var d=o[Pt]||null;if(d===null)return null;o=d[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(s=s.type,d=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!d;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,n,typeof o));return o}var $i=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jo=!1;if($i)try{var Sr={};Object.defineProperty(Sr,"passive",{get:function(){Jo=!0}}),window.addEventListener("test",Sr,Sr),window.removeEventListener("test",Sr,Sr)}catch{Jo=!1}var cs=null,ec=null,Ga=null;function qh(){if(Ga)return Ga;var s,n=ec,o=n.length,d,g="value"in cs?cs.value:cs.textContent,x=g.length;for(s=0;s<o&&n[s]===g[s];s++);var R=o-s;for(d=1;d<=R&&n[o-d]===g[x-d];d++);return Ga=g.slice(s,1<d?1-d:void 0)}function Ha(s){var n=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&n===13&&(s=13)):s=n,s===10&&(s=13),32<=s||s===13?s:0}function Va(){return!0}function Xh(){return!1}function Ut(s){function n(o,d,g,x,R){this._reactName=o,this._targetInst=g,this.type=d,this.nativeEvent=x,this.target=R,this.currentTarget=null;for(var D in s)s.hasOwnProperty(D)&&(o=s[D],this[D]=o?o(x):x[D]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Va:Xh,this.isPropagationStopped=Xh,this}return m(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Va)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Va)},persist:function(){},isPersistent:Va}),n}var Vs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ka=Ut(Vs),Tr=m({},Vs,{view:0,detail:0}),fv=Ut(Tr),tc,ic,br,za=m({},Tr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nc,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==br&&(br&&s.type==="mousemove"?(tc=s.screenX-br.screenX,ic=s.screenY-br.screenY):ic=tc=0,br=s),tc)},movementY:function(s){return"movementY"in s?s.movementY:ic}}),Qh=Ut(za),mv=m({},za,{dataTransfer:0}),gv=Ut(mv),pv=m({},Tr,{relatedTarget:0}),sc=Ut(pv),yv=m({},Vs,{animationName:0,elapsedTime:0,pseudoElement:0}),xv=Ut(yv),vv=m({},Vs,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Ev=Ut(vv),Sv=m({},Vs,{data:0}),Wh=Ut(Sv),Tv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Av={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rv(s){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(s):(s=Av[s])?!!n[s]:!1}function nc(){return Rv}var Lv=m({},Tr,{key:function(s){if(s.key){var n=Tv[s.key]||s.key;if(n!=="Unidentified")return n}return s.type==="keypress"?(s=Ha(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?bv[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nc,charCode:function(s){return s.type==="keypress"?Ha(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ha(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),_v=Ut(Lv),Dv=m({},za,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zh=Ut(Dv),Iv=m({},Tr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nc}),Cv=Ut(Iv),wv=m({},Vs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nv=Ut(wv),kv=m({},za,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Ov=Ut(kv),Mv=m({},Vs,{newState:0,oldState:0}),Pv=Ut(Mv),Uv=[9,13,27,32],rc=$i&&"CompositionEvent"in window,Ar=null;$i&&"documentMode"in document&&(Ar=document.documentMode);var Bv=$i&&"TextEvent"in window&&!Ar,Jh=$i&&(!rc||Ar&&8<Ar&&11>=Ar),ef=" ",tf=!1;function sf(s,n){switch(s){case"keyup":return Uv.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nf(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var An=!1;function Fv(s,n){switch(s){case"compositionend":return nf(n);case"keypress":return n.which!==32?null:(tf=!0,ef);case"textInput":return s=n.data,s===ef&&tf?null:s;default:return null}}function jv(s,n){if(An)return s==="compositionend"||!rc&&sf(s,n)?(s=qh(),Ga=ec=cs=null,An=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Jh&&n.locale!=="ko"?null:n.data;default:return null}}var $v={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rf(s){var n=s&&s.nodeName&&s.nodeName.toLowerCase();return n==="input"?!!$v[s.type]:n==="textarea"}function af(s,n,o,d){Tn?bn?bn.push(d):bn=[d]:Tn=d,n=Nl(n,"onChange"),0<n.length&&(o=new Ka("onChange","change",null,o,d),s.push({event:o,listeners:n}))}var Rr=null,Lr=null;function Gv(s){jg(s,0)}function Ya(s){var n=vr(s);if(jh(n))return s}function lf(s,n){if(s==="change")return n}var of=!1;if($i){var ac;if($i){var lc="oninput"in document;if(!lc){var cf=document.createElement("div");cf.setAttribute("oninput","return;"),lc=typeof cf.oninput=="function"}ac=lc}else ac=!1;of=ac&&(!document.documentMode||9<document.documentMode)}function uf(){Rr&&(Rr.detachEvent("onpropertychange",df),Lr=Rr=null)}function df(s){if(s.propertyName==="value"&&Ya(Lr)){var n=[];af(n,Lr,s,Wo(s)),Yh(Gv,n)}}function Hv(s,n,o){s==="focusin"?(uf(),Rr=n,Lr=o,Rr.attachEvent("onpropertychange",df)):s==="focusout"&&uf()}function Vv(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ya(Lr)}function Kv(s,n){if(s==="click")return Ya(n)}function zv(s,n){if(s==="input"||s==="change")return Ya(n)}function Yv(s,n){return s===n&&(s!==0||1/s===1/n)||s!==s&&n!==n}var Ht=typeof Object.is=="function"?Object.is:Yv;function _r(s,n){if(Ht(s,n))return!0;if(typeof s!="object"||s===null||typeof n!="object"||n===null)return!1;var o=Object.keys(s),d=Object.keys(n);if(o.length!==d.length)return!1;for(d=0;d<o.length;d++){var g=o[d];if(!mr.call(n,g)||!Ht(s[g],n[g]))return!1}return!0}function hf(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function ff(s,n){var o=hf(s);s=0;for(var d;o;){if(o.nodeType===3){if(d=s+o.textContent.length,s<=n&&d>=n)return{node:o,offset:n-s};s=d}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=hf(o)}}function mf(s,n){return s&&n?s===n?!0:s&&s.nodeType===3?!1:n&&n.nodeType===3?mf(s,n.parentNode):"contains"in s?s.contains(n):s.compareDocumentPosition?!!(s.compareDocumentPosition(n)&16):!1:!1}function gf(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var n=ja(s.document);n instanceof s.HTMLIFrameElement;){try{var o=typeof n.contentWindow.location.href=="string"}catch{o=!1}if(o)s=n.contentWindow;else break;n=ja(s.document)}return n}function oc(s){var n=s&&s.nodeName&&s.nodeName.toLowerCase();return n&&(n==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||n==="textarea"||s.contentEditable==="true")}var qv=$i&&"documentMode"in document&&11>=document.documentMode,Rn=null,cc=null,Dr=null,uc=!1;function pf(s,n,o){var d=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;uc||Rn==null||Rn!==ja(d)||(d=Rn,"selectionStart"in d&&oc(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Dr&&_r(Dr,d)||(Dr=d,d=Nl(cc,"onSelect"),0<d.length&&(n=new Ka("onSelect","select",null,n,o),s.push({event:n,listeners:d}),n.target=Rn)))}function Ks(s,n){var o={};return o[s.toLowerCase()]=n.toLowerCase(),o["Webkit"+s]="webkit"+n,o["Moz"+s]="moz"+n,o}var Ln={animationend:Ks("Animation","AnimationEnd"),animationiteration:Ks("Animation","AnimationIteration"),animationstart:Ks("Animation","AnimationStart"),transitionrun:Ks("Transition","TransitionRun"),transitionstart:Ks("Transition","TransitionStart"),transitioncancel:Ks("Transition","TransitionCancel"),transitionend:Ks("Transition","TransitionEnd")},dc={},yf={};$i&&(yf=document.createElement("div").style,"AnimationEvent"in window||(delete Ln.animationend.animation,delete Ln.animationiteration.animation,delete Ln.animationstart.animation),"TransitionEvent"in window||delete Ln.transitionend.transition);function zs(s){if(dc[s])return dc[s];if(!Ln[s])return s;var n=Ln[s],o;for(o in n)if(n.hasOwnProperty(o)&&o in yf)return dc[s]=n[o];return s}var xf=zs("animationend"),vf=zs("animationiteration"),Ef=zs("animationstart"),Xv=zs("transitionrun"),Qv=zs("transitionstart"),Wv=zs("transitioncancel"),Sf=zs("transitionend"),Tf=new Map,hc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");hc.push("scrollEnd");function yi(s,n){Tf.set(s,n),Hs(n,[s])}var bf=new WeakMap;function ri(s,n){if(typeof s=="object"&&s!==null){var o=bf.get(s);return o!==void 0?o:(n={value:s,source:n,stack:Bh(n)},bf.set(s,n),n)}return{value:s,source:n,stack:Bh(n)}}var ai=[],_n=0,fc=0;function qa(){for(var s=_n,n=fc=_n=0;n<s;){var o=ai[n];ai[n++]=null;var d=ai[n];ai[n++]=null;var g=ai[n];ai[n++]=null;var x=ai[n];if(ai[n++]=null,d!==null&&g!==null){var R=d.pending;R===null?g.next=g:(g.next=R.next,R.next=g),d.pending=g}x!==0&&Af(o,g,x)}}function Xa(s,n,o,d){ai[_n++]=s,ai[_n++]=n,ai[_n++]=o,ai[_n++]=d,fc|=d,s.lanes|=d,s=s.alternate,s!==null&&(s.lanes|=d)}function mc(s,n,o,d){return Xa(s,n,o,d),Qa(s)}function Dn(s,n){return Xa(s,null,null,n),Qa(s)}function Af(s,n,o){s.lanes|=o;var d=s.alternate;d!==null&&(d.lanes|=o);for(var g=!1,x=s.return;x!==null;)x.childLanes|=o,d=x.alternate,d!==null&&(d.childLanes|=o),x.tag===22&&(s=x.stateNode,s===null||s._visibility&1||(g=!0)),s=x,x=x.return;return s.tag===3?(x=s.stateNode,g&&n!==null&&(g=31-Lt(o),s=x.hiddenUpdates,d=s[g],d===null?s[g]=[n]:d.push(n),n.lane=o|536870912),x):null}function Qa(s){if(50<Jr)throw Jr=0,Eu=null,Error(i(185));for(var n=s.return;n!==null;)s=n,n=s.return;return s.tag===3?s.stateNode:null}var In={};function Zv(s,n,o,d){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vt(s,n,o,d){return new Zv(s,n,o,d)}function gc(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Gi(s,n){var o=s.alternate;return o===null?(o=Vt(s.tag,n,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=n,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,n=s.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function Rf(s,n){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),s}function Wa(s,n,o,d,g,x){var R=0;if(d=s,typeof s=="function")gc(s)&&(R=1);else if(typeof s=="string")R=eS(s,o,oe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case B:return s=Vt(31,o,n,g),s.elementType=B,s.lanes=x,s;case E:return Ys(o.children,g,x,n);case T:R=8,g|=24;break;case b:return s=Vt(12,o,n,g|2),s.elementType=b,s.lanes=x,s;case N:return s=Vt(13,o,n,g),s.elementType=N,s.lanes=x,s;case K:return s=Vt(19,o,n,g),s.elementType=K,s.lanes=x,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case L:case I:R=10;break e;case _:R=9;break e;case C:R=11;break e;case O:R=14;break e;case j:R=16,d=null;break e}R=29,o=Error(i(130,s===null?"null":typeof s,"")),d=null}return n=Vt(R,o,n,g),n.elementType=s,n.type=d,n.lanes=x,n}function Ys(s,n,o,d){return s=Vt(7,s,d,n),s.lanes=o,s}function pc(s,n,o){return s=Vt(6,s,null,n),s.lanes=o,s}function yc(s,n,o){return n=Vt(4,s.children!==null?s.children:[],s.key,n),n.lanes=o,n.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},n}var Cn=[],wn=0,Za=null,Ja=0,li=[],oi=0,qs=null,Hi=1,Vi="";function Xs(s,n){Cn[wn++]=Ja,Cn[wn++]=Za,Za=s,Ja=n}function Lf(s,n,o){li[oi++]=Hi,li[oi++]=Vi,li[oi++]=qs,qs=s;var d=Hi;s=Vi;var g=32-Lt(d)-1;d&=~(1<<g),o+=1;var x=32-Lt(n)+g;if(30<x){var R=g-g%5;x=(d&(1<<R)-1).toString(32),d>>=R,g-=R,Hi=1<<32-Lt(n)+g|o<<g|d,Vi=x+s}else Hi=1<<x|o<<g|d,Vi=s}function xc(s){s.return!==null&&(Xs(s,1),Lf(s,1,0))}function vc(s){for(;s===Za;)Za=Cn[--wn],Cn[wn]=null,Ja=Cn[--wn],Cn[wn]=null;for(;s===qs;)qs=li[--oi],li[oi]=null,Vi=li[--oi],li[oi]=null,Hi=li[--oi],li[oi]=null}var Ct=null,it=null,Me=!1,Qs=null,Ai=!1,Ec=Error(i(519));function Ws(s){var n=Error(i(418,""));throw wr(ri(n,s)),Ec}function _f(s){var n=s.stateNode,o=s.type,d=s.memoizedProps;switch(n[_t]=s,n[Pt]=d,o){case"dialog":we("cancel",n),we("close",n);break;case"iframe":case"object":case"embed":we("load",n);break;case"video":case"audio":for(o=0;o<ta.length;o++)we(ta[o],n);break;case"source":we("error",n);break;case"img":case"image":case"link":we("error",n),we("load",n);break;case"details":we("toggle",n);break;case"input":we("invalid",n),$h(n,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0),Fa(n);break;case"select":we("invalid",n);break;case"textarea":we("invalid",n),Hh(n,d.value,d.defaultValue,d.children),Fa(n)}o=d.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||n.textContent===""+o||d.suppressHydrationWarning===!0||Vg(n.textContent,o)?(d.popover!=null&&(we("beforetoggle",n),we("toggle",n)),d.onScroll!=null&&we("scroll",n),d.onScrollEnd!=null&&we("scrollend",n),d.onClick!=null&&(n.onclick=kl),n=!0):n=!1,n||Ws(s)}function Df(s){for(Ct=s.return;Ct;)switch(Ct.tag){case 5:case 13:Ai=!1;return;case 27:case 3:Ai=!0;return;default:Ct=Ct.return}}function Ir(s){if(s!==Ct)return!1;if(!Me)return Df(s),Me=!0,!1;var n=s.tag,o;if((o=n!==3&&n!==27)&&((o=n===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||Pu(s.type,s.memoizedProps)),o=!o),o&&it&&Ws(s),Df(s),n===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));e:{for(s=s.nextSibling,n=0;s;){if(s.nodeType===8)if(o=s.data,o==="/$"){if(n===0){it=vi(s.nextSibling);break e}n--}else o!=="$"&&o!=="$!"&&o!=="$?"||n++;s=s.nextSibling}it=null}}else n===27?(n=it,Rs(s.type)?(s=ju,ju=null,it=s):it=n):it=Ct?vi(s.stateNode.nextSibling):null;return!0}function Cr(){it=Ct=null,Me=!1}function If(){var s=Qs;return s!==null&&(jt===null?jt=s:jt.push.apply(jt,s),Qs=null),s}function wr(s){Qs===null?Qs=[s]:Qs.push(s)}var Sc=F(null),Zs=null,Ki=null;function us(s,n,o){se(Sc,n._currentValue),n._currentValue=o}function zi(s){s._currentValue=Sc.current,q(Sc)}function Tc(s,n,o){for(;s!==null;){var d=s.alternate;if((s.childLanes&n)!==n?(s.childLanes|=n,d!==null&&(d.childLanes|=n)):d!==null&&(d.childLanes&n)!==n&&(d.childLanes|=n),s===o)break;s=s.return}}function bc(s,n,o,d){var g=s.child;for(g!==null&&(g.return=s);g!==null;){var x=g.dependencies;if(x!==null){var R=g.child;x=x.firstContext;e:for(;x!==null;){var D=x;x=g;for(var k=0;k<n.length;k++)if(D.context===n[k]){x.lanes|=o,D=x.alternate,D!==null&&(D.lanes|=o),Tc(x.return,o,s),d||(R=null);break e}x=D.next}}else if(g.tag===18){if(R=g.return,R===null)throw Error(i(341));R.lanes|=o,x=R.alternate,x!==null&&(x.lanes|=o),Tc(R,o,s),R=null}else R=g.child;if(R!==null)R.return=g;else for(R=g;R!==null;){if(R===s){R=null;break}if(g=R.sibling,g!==null){g.return=R.return,R=g;break}R=R.return}g=R}}function Nr(s,n,o,d){s=null;for(var g=n,x=!1;g!==null;){if(!x){if((g.flags&524288)!==0)x=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var R=g.alternate;if(R===null)throw Error(i(387));if(R=R.memoizedProps,R!==null){var D=g.type;Ht(g.pendingProps.value,R.value)||(s!==null?s.push(D):s=[D])}}else if(g===Ue.current){if(R=g.alternate,R===null)throw Error(i(387));R.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(s!==null?s.push(la):s=[la])}g=g.return}s!==null&&bc(n,s,o,d),n.flags|=262144}function el(s){for(s=s.firstContext;s!==null;){if(!Ht(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Js(s){Zs=s,Ki=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Dt(s){return Cf(Zs,s)}function tl(s,n){return Zs===null&&Js(s),Cf(s,n)}function Cf(s,n){var o=n._currentValue;if(n={context:n,memoizedValue:o,next:null},Ki===null){if(s===null)throw Error(i(308));Ki=n,s.dependencies={lanes:0,firstContext:n},s.flags|=524288}else Ki=Ki.next=n;return o}var Jv=typeof AbortController<"u"?AbortController:function(){var s=[],n=this.signal={aborted:!1,addEventListener:function(o,d){s.push(d)}};this.abort=function(){n.aborted=!0,s.forEach(function(o){return o()})}},eE=l.unstable_scheduleCallback,tE=l.unstable_NormalPriority,dt={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ac(){return{controller:new Jv,data:new Map,refCount:0}}function kr(s){s.refCount--,s.refCount===0&&eE(tE,function(){s.controller.abort()})}var Or=null,Rc=0,Nn=0,kn=null;function iE(s,n){if(Or===null){var o=Or=[];Rc=0,Nn=_u(),kn={status:"pending",value:void 0,then:function(d){o.push(d)}}}return Rc++,n.then(wf,wf),n}function wf(){if(--Rc===0&&Or!==null){kn!==null&&(kn.status="fulfilled");var s=Or;Or=null,Nn=0,kn=null;for(var n=0;n<s.length;n++)(0,s[n])()}}function sE(s,n){var o=[],d={status:"pending",value:null,reason:null,then:function(g){o.push(g)}};return s.then(function(){d.status="fulfilled",d.value=n;for(var g=0;g<o.length;g++)(0,o[g])(n)},function(g){for(d.status="rejected",d.reason=g,g=0;g<o.length;g++)(0,o[g])(void 0)}),d}var Nf=M.S;M.S=function(s,n){typeof n=="object"&&n!==null&&typeof n.then=="function"&&iE(s,n),Nf!==null&&Nf(s,n)};var en=F(null);function Lc(){var s=en.current;return s!==null?s:Qe.pooledCache}function il(s,n){n===null?se(en,en.current):se(en,n.pool)}function kf(){var s=Lc();return s===null?null:{parent:dt._currentValue,pool:s}}var Mr=Error(i(460)),Of=Error(i(474)),sl=Error(i(542)),_c={then:function(){}};function Mf(s){return s=s.status,s==="fulfilled"||s==="rejected"}function nl(){}function Pf(s,n,o){switch(o=s[o],o===void 0?s.push(n):o!==n&&(n.then(nl,nl),n=o),n.status){case"fulfilled":return n.value;case"rejected":throw s=n.reason,Bf(s),s;default:if(typeof n.status=="string")n.then(nl,nl);else{if(s=Qe,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=n,s.status="pending",s.then(function(d){if(n.status==="pending"){var g=n;g.status="fulfilled",g.value=d}},function(d){if(n.status==="pending"){var g=n;g.status="rejected",g.reason=d}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw s=n.reason,Bf(s),s}throw Pr=n,Mr}}var Pr=null;function Uf(){if(Pr===null)throw Error(i(459));var s=Pr;return Pr=null,s}function Bf(s){if(s===Mr||s===sl)throw Error(i(483))}var ds=!1;function Dc(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ic(s,n){s=s.updateQueue,n.updateQueue===s&&(n.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function hs(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function fs(s,n,o){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,(Be&2)!==0){var g=d.pending;return g===null?n.next=n:(n.next=g.next,g.next=n),d.pending=n,n=Qa(s),Af(s,null,o),n}return Xa(s,d,n,o),Qa(s)}function Ur(s,n,o){if(n=n.updateQueue,n!==null&&(n=n.shared,(o&4194048)!==0)){var d=n.lanes;d&=s.pendingLanes,o|=d,n.lanes=o,Ch(s,o)}}function Cc(s,n){var o=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,o===d)){var g=null,x=null;if(o=o.firstBaseUpdate,o!==null){do{var R={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};x===null?g=x=R:x=x.next=R,o=o.next}while(o!==null);x===null?g=x=n:x=x.next=n}else g=x=n;o={baseState:d.baseState,firstBaseUpdate:g,lastBaseUpdate:x,shared:d.shared,callbacks:d.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=n:s.next=n,o.lastBaseUpdate=n}var wc=!1;function Br(){if(wc){var s=kn;if(s!==null)throw s}}function Fr(s,n,o,d){wc=!1;var g=s.updateQueue;ds=!1;var x=g.firstBaseUpdate,R=g.lastBaseUpdate,D=g.shared.pending;if(D!==null){g.shared.pending=null;var k=D,z=k.next;k.next=null,R===null?x=z:R.next=z,R=k;var J=s.alternate;J!==null&&(J=J.updateQueue,D=J.lastBaseUpdate,D!==R&&(D===null?J.firstBaseUpdate=z:D.next=z,J.lastBaseUpdate=k))}if(x!==null){var ne=g.baseState;R=0,J=z=k=null,D=x;do{var Y=D.lane&-536870913,X=Y!==D.lane;if(X?(ke&Y)===Y:(d&Y)===Y){Y!==0&&Y===Nn&&(wc=!0),J!==null&&(J=J.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var Ee=s,xe=D;Y=n;var Ve=o;switch(xe.tag){case 1:if(Ee=xe.payload,typeof Ee=="function"){ne=Ee.call(Ve,ne,Y);break e}ne=Ee;break e;case 3:Ee.flags=Ee.flags&-65537|128;case 0:if(Ee=xe.payload,Y=typeof Ee=="function"?Ee.call(Ve,ne,Y):Ee,Y==null)break e;ne=m({},ne,Y);break e;case 2:ds=!0}}Y=D.callback,Y!==null&&(s.flags|=64,X&&(s.flags|=8192),X=g.callbacks,X===null?g.callbacks=[Y]:X.push(Y))}else X={lane:Y,tag:D.tag,payload:D.payload,callback:D.callback,next:null},J===null?(z=J=X,k=ne):J=J.next=X,R|=Y;if(D=D.next,D===null){if(D=g.shared.pending,D===null)break;X=D,D=X.next,X.next=null,g.lastBaseUpdate=X,g.shared.pending=null}}while(!0);J===null&&(k=ne),g.baseState=k,g.firstBaseUpdate=z,g.lastBaseUpdate=J,x===null&&(g.shared.lanes=0),Ss|=R,s.lanes=R,s.memoizedState=ne}}function Ff(s,n){if(typeof s!="function")throw Error(i(191,s));s.call(n)}function jf(s,n){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)Ff(o[s],n)}var On=F(null),rl=F(0);function $f(s,n){s=Ji,se(rl,s),se(On,n),Ji=s|n.baseLanes}function Nc(){se(rl,Ji),se(On,On.current)}function kc(){Ji=rl.current,q(On),q(rl)}var ms=0,Le=null,Ge=null,ot=null,al=!1,Mn=!1,tn=!1,ll=0,jr=0,Pn=null,nE=0;function at(){throw Error(i(321))}function Oc(s,n){if(n===null)return!1;for(var o=0;o<n.length&&o<s.length;o++)if(!Ht(s[o],n[o]))return!1;return!0}function Mc(s,n,o,d,g,x){return ms=x,Le=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,M.H=s===null||s.memoizedState===null?Am:Rm,tn=!1,x=o(d,g),tn=!1,Mn&&(x=Hf(n,o,d,g)),Gf(s),x}function Gf(s){M.H=fl;var n=Ge!==null&&Ge.next!==null;if(ms=0,ot=Ge=Le=null,al=!1,jr=0,Pn=null,n)throw Error(i(300));s===null||pt||(s=s.dependencies,s!==null&&el(s)&&(pt=!0))}function Hf(s,n,o,d){Le=s;var g=0;do{if(Mn&&(Pn=null),jr=0,Mn=!1,25<=g)throw Error(i(301));if(g+=1,ot=Ge=null,s.updateQueue!=null){var x=s.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}M.H=dE,x=n(o,d)}while(Mn);return x}function rE(){var s=M.H,n=s.useState()[0];return n=typeof n.then=="function"?$r(n):n,s=s.useState()[0],(Ge!==null?Ge.memoizedState:null)!==s&&(Le.flags|=1024),n}function Pc(){var s=ll!==0;return ll=0,s}function Uc(s,n,o){n.updateQueue=s.updateQueue,n.flags&=-2053,s.lanes&=~o}function Bc(s){if(al){for(s=s.memoizedState;s!==null;){var n=s.queue;n!==null&&(n.pending=null),s=s.next}al=!1}ms=0,ot=Ge=Le=null,Mn=!1,jr=ll=0,Pn=null}function Bt(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ot===null?Le.memoizedState=ot=s:ot=ot.next=s,ot}function ct(){if(Ge===null){var s=Le.alternate;s=s!==null?s.memoizedState:null}else s=Ge.next;var n=ot===null?Le.memoizedState:ot.next;if(n!==null)ot=n,Ge=s;else{if(s===null)throw Le.alternate===null?Error(i(467)):Error(i(310));Ge=s,s={memoizedState:Ge.memoizedState,baseState:Ge.baseState,baseQueue:Ge.baseQueue,queue:Ge.queue,next:null},ot===null?Le.memoizedState=ot=s:ot=ot.next=s}return ot}function Fc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $r(s){var n=jr;return jr+=1,Pn===null&&(Pn=[]),s=Pf(Pn,s,n),n=Le,(ot===null?n.memoizedState:ot.next)===null&&(n=n.alternate,M.H=n===null||n.memoizedState===null?Am:Rm),s}function ol(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return $r(s);if(s.$$typeof===I)return Dt(s)}throw Error(i(438,String(s)))}function jc(s){var n=null,o=Le.updateQueue;if(o!==null&&(n=o.memoCache),n==null){var d=Le.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(n={data:d.data.map(function(g){return g.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),o===null&&(o=Fc(),Le.updateQueue=o),o.memoCache=n,o=n.data[n.index],o===void 0)for(o=n.data[n.index]=Array(s),d=0;d<s;d++)o[d]=U;return n.index++,o}function Yi(s,n){return typeof n=="function"?n(s):n}function cl(s){var n=ct();return $c(n,Ge,s)}function $c(s,n,o){var d=s.queue;if(d===null)throw Error(i(311));d.lastRenderedReducer=o;var g=s.baseQueue,x=d.pending;if(x!==null){if(g!==null){var R=g.next;g.next=x.next,x.next=R}n.baseQueue=g=x,d.pending=null}if(x=s.baseState,g===null)s.memoizedState=x;else{n=g.next;var D=R=null,k=null,z=n,J=!1;do{var ne=z.lane&-536870913;if(ne!==z.lane?(ke&ne)===ne:(ms&ne)===ne){var Y=z.revertLane;if(Y===0)k!==null&&(k=k.next={lane:0,revertLane:0,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null}),ne===Nn&&(J=!0);else if((ms&Y)===Y){z=z.next,Y===Nn&&(J=!0);continue}else ne={lane:0,revertLane:z.revertLane,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null},k===null?(D=k=ne,R=x):k=k.next=ne,Le.lanes|=Y,Ss|=Y;ne=z.action,tn&&o(x,ne),x=z.hasEagerState?z.eagerState:o(x,ne)}else Y={lane:ne,revertLane:z.revertLane,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null},k===null?(D=k=Y,R=x):k=k.next=Y,Le.lanes|=ne,Ss|=ne;z=z.next}while(z!==null&&z!==n);if(k===null?R=x:k.next=D,!Ht(x,s.memoizedState)&&(pt=!0,J&&(o=kn,o!==null)))throw o;s.memoizedState=x,s.baseState=R,s.baseQueue=k,d.lastRenderedState=x}return g===null&&(d.lanes=0),[s.memoizedState,d.dispatch]}function Gc(s){var n=ct(),o=n.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var d=o.dispatch,g=o.pending,x=n.memoizedState;if(g!==null){o.pending=null;var R=g=g.next;do x=s(x,R.action),R=R.next;while(R!==g);Ht(x,n.memoizedState)||(pt=!0),n.memoizedState=x,n.baseQueue===null&&(n.baseState=x),o.lastRenderedState=x}return[x,d]}function Vf(s,n,o){var d=Le,g=ct(),x=Me;if(x){if(o===void 0)throw Error(i(407));o=o()}else o=n();var R=!Ht((Ge||g).memoizedState,o);R&&(g.memoizedState=o,pt=!0),g=g.queue;var D=Yf.bind(null,d,g,s);if(Gr(2048,8,D,[s]),g.getSnapshot!==n||R||ot!==null&&ot.memoizedState.tag&1){if(d.flags|=2048,Un(9,ul(),zf.bind(null,d,g,o,n),null),Qe===null)throw Error(i(349));x||(ms&124)!==0||Kf(d,n,o)}return o}function Kf(s,n,o){s.flags|=16384,s={getSnapshot:n,value:o},n=Le.updateQueue,n===null?(n=Fc(),Le.updateQueue=n,n.stores=[s]):(o=n.stores,o===null?n.stores=[s]:o.push(s))}function zf(s,n,o,d){n.value=o,n.getSnapshot=d,qf(n)&&Xf(s)}function Yf(s,n,o){return o(function(){qf(n)&&Xf(s)})}function qf(s){var n=s.getSnapshot;s=s.value;try{var o=n();return!Ht(s,o)}catch{return!0}}function Xf(s){var n=Dn(s,2);n!==null&&Xt(n,s,2)}function Hc(s){var n=Bt();if(typeof s=="function"){var o=s;if(s=o(),tn){bi(!0);try{o()}finally{bi(!1)}}}return n.memoizedState=n.baseState=s,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yi,lastRenderedState:s},n}function Qf(s,n,o,d){return s.baseState=o,$c(s,Ge,typeof d=="function"?d:Yi)}function aE(s,n,o,d,g){if(hl(s))throw Error(i(485));if(s=n.action,s!==null){var x={payload:g,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(R){x.listeners.push(R)}};M.T!==null?o(!0):x.isTransition=!1,d(x),o=n.pending,o===null?(x.next=n.pending=x,Wf(n,x)):(x.next=o.next,n.pending=o.next=x)}}function Wf(s,n){var o=n.action,d=n.payload,g=s.state;if(n.isTransition){var x=M.T,R={};M.T=R;try{var D=o(g,d),k=M.S;k!==null&&k(R,D),Zf(s,n,D)}catch(z){Vc(s,n,z)}finally{M.T=x}}else try{x=o(g,d),Zf(s,n,x)}catch(z){Vc(s,n,z)}}function Zf(s,n,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(d){Jf(s,n,d)},function(d){return Vc(s,n,d)}):Jf(s,n,o)}function Jf(s,n,o){n.status="fulfilled",n.value=o,em(n),s.state=o,n=s.pending,n!==null&&(o=n.next,o===n?s.pending=null:(o=o.next,n.next=o,Wf(s,o)))}function Vc(s,n,o){var d=s.pending;if(s.pending=null,d!==null){d=d.next;do n.status="rejected",n.reason=o,em(n),n=n.next;while(n!==d)}s.action=null}function em(s){s=s.listeners;for(var n=0;n<s.length;n++)(0,s[n])()}function tm(s,n){return n}function im(s,n){if(Me){var o=Qe.formState;if(o!==null){e:{var d=Le;if(Me){if(it){t:{for(var g=it,x=Ai;g.nodeType!==8;){if(!x){g=null;break t}if(g=vi(g.nextSibling),g===null){g=null;break t}}x=g.data,g=x==="F!"||x==="F"?g:null}if(g){it=vi(g.nextSibling),d=g.data==="F!";break e}}Ws(d)}d=!1}d&&(n=o[0])}}return o=Bt(),o.memoizedState=o.baseState=n,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:tm,lastRenderedState:n},o.queue=d,o=Sm.bind(null,Le,d),d.dispatch=o,d=Hc(!1),x=Xc.bind(null,Le,!1,d.queue),d=Bt(),g={state:n,dispatch:null,action:s,pending:null},d.queue=g,o=aE.bind(null,Le,g,x,o),g.dispatch=o,d.memoizedState=s,[n,o,!1]}function sm(s){var n=ct();return nm(n,Ge,s)}function nm(s,n,o){if(n=$c(s,n,tm)[0],s=cl(Yi)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var d=$r(n)}catch(R){throw R===Mr?sl:R}else d=n;n=ct();var g=n.queue,x=g.dispatch;return o!==n.memoizedState&&(Le.flags|=2048,Un(9,ul(),lE.bind(null,g,o),null)),[d,x,s]}function lE(s,n){s.action=n}function rm(s){var n=ct(),o=Ge;if(o!==null)return nm(n,o,s);ct(),n=n.memoizedState,o=ct();var d=o.queue.dispatch;return o.memoizedState=s,[n,d,!1]}function Un(s,n,o,d){return s={tag:s,create:o,deps:d,inst:n,next:null},n=Le.updateQueue,n===null&&(n=Fc(),Le.updateQueue=n),o=n.lastEffect,o===null?n.lastEffect=s.next=s:(d=o.next,o.next=s,s.next=d,n.lastEffect=s),s}function ul(){return{destroy:void 0,resource:void 0}}function am(){return ct().memoizedState}function dl(s,n,o,d){var g=Bt();d=d===void 0?null:d,Le.flags|=s,g.memoizedState=Un(1|n,ul(),o,d)}function Gr(s,n,o,d){var g=ct();d=d===void 0?null:d;var x=g.memoizedState.inst;Ge!==null&&d!==null&&Oc(d,Ge.memoizedState.deps)?g.memoizedState=Un(n,x,o,d):(Le.flags|=s,g.memoizedState=Un(1|n,x,o,d))}function lm(s,n){dl(8390656,8,s,n)}function om(s,n){Gr(2048,8,s,n)}function cm(s,n){return Gr(4,2,s,n)}function um(s,n){return Gr(4,4,s,n)}function dm(s,n){if(typeof n=="function"){s=s();var o=n(s);return function(){typeof o=="function"?o():n(null)}}if(n!=null)return s=s(),n.current=s,function(){n.current=null}}function hm(s,n,o){o=o!=null?o.concat([s]):null,Gr(4,4,dm.bind(null,n,s),o)}function Kc(){}function fm(s,n){var o=ct();n=n===void 0?null:n;var d=o.memoizedState;return n!==null&&Oc(n,d[1])?d[0]:(o.memoizedState=[s,n],s)}function mm(s,n){var o=ct();n=n===void 0?null:n;var d=o.memoizedState;if(n!==null&&Oc(n,d[1]))return d[0];if(d=s(),tn){bi(!0);try{s()}finally{bi(!1)}}return o.memoizedState=[d,n],d}function zc(s,n,o){return o===void 0||(ms&1073741824)!==0?s.memoizedState=n:(s.memoizedState=o,s=yg(),Le.lanes|=s,Ss|=s,o)}function gm(s,n,o,d){return Ht(o,n)?o:On.current!==null?(s=zc(s,o,d),Ht(s,n)||(pt=!0),s):(ms&42)===0?(pt=!0,s.memoizedState=o):(s=yg(),Le.lanes|=s,Ss|=s,n)}function pm(s,n,o,d,g){var x=Q.p;Q.p=x!==0&&8>x?x:8;var R=M.T,D={};M.T=D,Xc(s,!1,n,o);try{var k=g(),z=M.S;if(z!==null&&z(D,k),k!==null&&typeof k=="object"&&typeof k.then=="function"){var J=sE(k,d);Hr(s,n,J,qt(s))}else Hr(s,n,d,qt(s))}catch(ne){Hr(s,n,{then:function(){},status:"rejected",reason:ne},qt())}finally{Q.p=x,M.T=R}}function oE(){}function Yc(s,n,o,d){if(s.tag!==5)throw Error(i(476));var g=ym(s).queue;pm(s,g,n,Z,o===null?oE:function(){return xm(s),o(d)})}function ym(s){var n=s.memoizedState;if(n!==null)return n;n={memoizedState:Z,baseState:Z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yi,lastRenderedState:Z},next:null};var o={};return n.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yi,lastRenderedState:o},next:null},s.memoizedState=n,s=s.alternate,s!==null&&(s.memoizedState=n),n}function xm(s){var n=ym(s).next.queue;Hr(s,n,{},qt())}function qc(){return Dt(la)}function vm(){return ct().memoizedState}function Em(){return ct().memoizedState}function cE(s){for(var n=s.return;n!==null;){switch(n.tag){case 24:case 3:var o=qt();s=hs(o);var d=fs(n,s,o);d!==null&&(Xt(d,n,o),Ur(d,n,o)),n={cache:Ac()},s.payload=n;return}n=n.return}}function uE(s,n,o){var d=qt();o={lane:d,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null},hl(s)?Tm(n,o):(o=mc(s,n,o,d),o!==null&&(Xt(o,s,d),bm(o,n,d)))}function Sm(s,n,o){var d=qt();Hr(s,n,o,d)}function Hr(s,n,o,d){var g={lane:d,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null};if(hl(s))Tm(n,g);else{var x=s.alternate;if(s.lanes===0&&(x===null||x.lanes===0)&&(x=n.lastRenderedReducer,x!==null))try{var R=n.lastRenderedState,D=x(R,o);if(g.hasEagerState=!0,g.eagerState=D,Ht(D,R))return Xa(s,n,g,0),Qe===null&&qa(),!1}catch{}finally{}if(o=mc(s,n,g,d),o!==null)return Xt(o,s,d),bm(o,n,d),!0}return!1}function Xc(s,n,o,d){if(d={lane:2,revertLane:_u(),action:d,hasEagerState:!1,eagerState:null,next:null},hl(s)){if(n)throw Error(i(479))}else n=mc(s,o,d,2),n!==null&&Xt(n,s,2)}function hl(s){var n=s.alternate;return s===Le||n!==null&&n===Le}function Tm(s,n){Mn=al=!0;var o=s.pending;o===null?n.next=n:(n.next=o.next,o.next=n),s.pending=n}function bm(s,n,o){if((o&4194048)!==0){var d=n.lanes;d&=s.pendingLanes,o|=d,n.lanes=o,Ch(s,o)}}var fl={readContext:Dt,use:ol,useCallback:at,useContext:at,useEffect:at,useImperativeHandle:at,useLayoutEffect:at,useInsertionEffect:at,useMemo:at,useReducer:at,useRef:at,useState:at,useDebugValue:at,useDeferredValue:at,useTransition:at,useSyncExternalStore:at,useId:at,useHostTransitionStatus:at,useFormState:at,useActionState:at,useOptimistic:at,useMemoCache:at,useCacheRefresh:at},Am={readContext:Dt,use:ol,useCallback:function(s,n){return Bt().memoizedState=[s,n===void 0?null:n],s},useContext:Dt,useEffect:lm,useImperativeHandle:function(s,n,o){o=o!=null?o.concat([s]):null,dl(4194308,4,dm.bind(null,n,s),o)},useLayoutEffect:function(s,n){return dl(4194308,4,s,n)},useInsertionEffect:function(s,n){dl(4,2,s,n)},useMemo:function(s,n){var o=Bt();n=n===void 0?null:n;var d=s();if(tn){bi(!0);try{s()}finally{bi(!1)}}return o.memoizedState=[d,n],d},useReducer:function(s,n,o){var d=Bt();if(o!==void 0){var g=o(n);if(tn){bi(!0);try{o(n)}finally{bi(!1)}}}else g=n;return d.memoizedState=d.baseState=g,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:g},d.queue=s,s=s.dispatch=uE.bind(null,Le,s),[d.memoizedState,s]},useRef:function(s){var n=Bt();return s={current:s},n.memoizedState=s},useState:function(s){s=Hc(s);var n=s.queue,o=Sm.bind(null,Le,n);return n.dispatch=o,[s.memoizedState,o]},useDebugValue:Kc,useDeferredValue:function(s,n){var o=Bt();return zc(o,s,n)},useTransition:function(){var s=Hc(!1);return s=pm.bind(null,Le,s.queue,!0,!1),Bt().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,n,o){var d=Le,g=Bt();if(Me){if(o===void 0)throw Error(i(407));o=o()}else{if(o=n(),Qe===null)throw Error(i(349));(ke&124)!==0||Kf(d,n,o)}g.memoizedState=o;var x={value:o,getSnapshot:n};return g.queue=x,lm(Yf.bind(null,d,x,s),[s]),d.flags|=2048,Un(9,ul(),zf.bind(null,d,x,o,n),null),o},useId:function(){var s=Bt(),n=Qe.identifierPrefix;if(Me){var o=Vi,d=Hi;o=(d&~(1<<32-Lt(d)-1)).toString(32)+o,n=""+n+"R"+o,o=ll++,0<o&&(n+="H"+o.toString(32)),n+=""}else o=nE++,n=""+n+"r"+o.toString(32)+"";return s.memoizedState=n},useHostTransitionStatus:qc,useFormState:im,useActionState:im,useOptimistic:function(s){var n=Bt();n.memoizedState=n.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=o,n=Xc.bind(null,Le,!0,o),o.dispatch=n,[s,n]},useMemoCache:jc,useCacheRefresh:function(){return Bt().memoizedState=cE.bind(null,Le)}},Rm={readContext:Dt,use:ol,useCallback:fm,useContext:Dt,useEffect:om,useImperativeHandle:hm,useInsertionEffect:cm,useLayoutEffect:um,useMemo:mm,useReducer:cl,useRef:am,useState:function(){return cl(Yi)},useDebugValue:Kc,useDeferredValue:function(s,n){var o=ct();return gm(o,Ge.memoizedState,s,n)},useTransition:function(){var s=cl(Yi)[0],n=ct().memoizedState;return[typeof s=="boolean"?s:$r(s),n]},useSyncExternalStore:Vf,useId:vm,useHostTransitionStatus:qc,useFormState:sm,useActionState:sm,useOptimistic:function(s,n){var o=ct();return Qf(o,Ge,s,n)},useMemoCache:jc,useCacheRefresh:Em},dE={readContext:Dt,use:ol,useCallback:fm,useContext:Dt,useEffect:om,useImperativeHandle:hm,useInsertionEffect:cm,useLayoutEffect:um,useMemo:mm,useReducer:Gc,useRef:am,useState:function(){return Gc(Yi)},useDebugValue:Kc,useDeferredValue:function(s,n){var o=ct();return Ge===null?zc(o,s,n):gm(o,Ge.memoizedState,s,n)},useTransition:function(){var s=Gc(Yi)[0],n=ct().memoizedState;return[typeof s=="boolean"?s:$r(s),n]},useSyncExternalStore:Vf,useId:vm,useHostTransitionStatus:qc,useFormState:rm,useActionState:rm,useOptimistic:function(s,n){var o=ct();return Ge!==null?Qf(o,Ge,s,n):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:jc,useCacheRefresh:Em},Bn=null,Vr=0;function ml(s){var n=Vr;return Vr+=1,Bn===null&&(Bn=[]),Pf(Bn,s,n)}function Kr(s,n){n=n.props.ref,s.ref=n!==void 0?n:null}function gl(s,n){throw n.$$typeof===p?Error(i(525)):(s=Object.prototype.toString.call(n),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":s)))}function Lm(s){var n=s._init;return n(s._payload)}function _m(s){function n($,P){if(s){var V=$.deletions;V===null?($.deletions=[P],$.flags|=16):V.push(P)}}function o($,P){if(!s)return null;for(;P!==null;)n($,P),P=P.sibling;return null}function d($){for(var P=new Map;$!==null;)$.key!==null?P.set($.key,$):P.set($.index,$),$=$.sibling;return P}function g($,P){return $=Gi($,P),$.index=0,$.sibling=null,$}function x($,P,V){return $.index=V,s?(V=$.alternate,V!==null?(V=V.index,V<P?($.flags|=67108866,P):V):($.flags|=67108866,P)):($.flags|=1048576,P)}function R($){return s&&$.alternate===null&&($.flags|=67108866),$}function D($,P,V,ie){return P===null||P.tag!==6?(P=pc(V,$.mode,ie),P.return=$,P):(P=g(P,V),P.return=$,P)}function k($,P,V,ie){var ge=V.type;return ge===E?J($,P,V.props.children,ie,V.key):P!==null&&(P.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===j&&Lm(ge)===P.type)?(P=g(P,V.props),Kr(P,V),P.return=$,P):(P=Wa(V.type,V.key,V.props,null,$.mode,ie),Kr(P,V),P.return=$,P)}function z($,P,V,ie){return P===null||P.tag!==4||P.stateNode.containerInfo!==V.containerInfo||P.stateNode.implementation!==V.implementation?(P=yc(V,$.mode,ie),P.return=$,P):(P=g(P,V.children||[]),P.return=$,P)}function J($,P,V,ie,ge){return P===null||P.tag!==7?(P=Ys(V,$.mode,ie,ge),P.return=$,P):(P=g(P,V),P.return=$,P)}function ne($,P,V){if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return P=pc(""+P,$.mode,V),P.return=$,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case y:return V=Wa(P.type,P.key,P.props,null,$.mode,V),Kr(V,P),V.return=$,V;case S:return P=yc(P,$.mode,V),P.return=$,P;case j:var ie=P._init;return P=ie(P._payload),ne($,P,V)}if(le(P)||re(P))return P=Ys(P,$.mode,V,null),P.return=$,P;if(typeof P.then=="function")return ne($,ml(P),V);if(P.$$typeof===I)return ne($,tl($,P),V);gl($,P)}return null}function Y($,P,V,ie){var ge=P!==null?P.key:null;if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return ge!==null?null:D($,P,""+V,ie);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case y:return V.key===ge?k($,P,V,ie):null;case S:return V.key===ge?z($,P,V,ie):null;case j:return ge=V._init,V=ge(V._payload),Y($,P,V,ie)}if(le(V)||re(V))return ge!==null?null:J($,P,V,ie,null);if(typeof V.then=="function")return Y($,P,ml(V),ie);if(V.$$typeof===I)return Y($,P,tl($,V),ie);gl($,V)}return null}function X($,P,V,ie,ge){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return $=$.get(V)||null,D(P,$,""+ie,ge);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case y:return $=$.get(ie.key===null?V:ie.key)||null,k(P,$,ie,ge);case S:return $=$.get(ie.key===null?V:ie.key)||null,z(P,$,ie,ge);case j:var De=ie._init;return ie=De(ie._payload),X($,P,V,ie,ge)}if(le(ie)||re(ie))return $=$.get(V)||null,J(P,$,ie,ge,null);if(typeof ie.then=="function")return X($,P,V,ml(ie),ge);if(ie.$$typeof===I)return X($,P,V,tl(P,ie),ge);gl(P,ie)}return null}function Ee($,P,V,ie){for(var ge=null,De=null,ye=P,ve=P=0,xt=null;ye!==null&&ve<V.length;ve++){ye.index>ve?(xt=ye,ye=null):xt=ye.sibling;var Oe=Y($,ye,V[ve],ie);if(Oe===null){ye===null&&(ye=xt);break}s&&ye&&Oe.alternate===null&&n($,ye),P=x(Oe,P,ve),De===null?ge=Oe:De.sibling=Oe,De=Oe,ye=xt}if(ve===V.length)return o($,ye),Me&&Xs($,ve),ge;if(ye===null){for(;ve<V.length;ve++)ye=ne($,V[ve],ie),ye!==null&&(P=x(ye,P,ve),De===null?ge=ye:De.sibling=ye,De=ye);return Me&&Xs($,ve),ge}for(ye=d(ye);ve<V.length;ve++)xt=X(ye,$,ve,V[ve],ie),xt!==null&&(s&&xt.alternate!==null&&ye.delete(xt.key===null?ve:xt.key),P=x(xt,P,ve),De===null?ge=xt:De.sibling=xt,De=xt);return s&&ye.forEach(function(Cs){return n($,Cs)}),Me&&Xs($,ve),ge}function xe($,P,V,ie){if(V==null)throw Error(i(151));for(var ge=null,De=null,ye=P,ve=P=0,xt=null,Oe=V.next();ye!==null&&!Oe.done;ve++,Oe=V.next()){ye.index>ve?(xt=ye,ye=null):xt=ye.sibling;var Cs=Y($,ye,Oe.value,ie);if(Cs===null){ye===null&&(ye=xt);break}s&&ye&&Cs.alternate===null&&n($,ye),P=x(Cs,P,ve),De===null?ge=Cs:De.sibling=Cs,De=Cs,ye=xt}if(Oe.done)return o($,ye),Me&&Xs($,ve),ge;if(ye===null){for(;!Oe.done;ve++,Oe=V.next())Oe=ne($,Oe.value,ie),Oe!==null&&(P=x(Oe,P,ve),De===null?ge=Oe:De.sibling=Oe,De=Oe);return Me&&Xs($,ve),ge}for(ye=d(ye);!Oe.done;ve++,Oe=V.next())Oe=X(ye,$,ve,Oe.value,ie),Oe!==null&&(s&&Oe.alternate!==null&&ye.delete(Oe.key===null?ve:Oe.key),P=x(Oe,P,ve),De===null?ge=Oe:De.sibling=Oe,De=Oe);return s&&ye.forEach(function(hS){return n($,hS)}),Me&&Xs($,ve),ge}function Ve($,P,V,ie){if(typeof V=="object"&&V!==null&&V.type===E&&V.key===null&&(V=V.props.children),typeof V=="object"&&V!==null){switch(V.$$typeof){case y:e:{for(var ge=V.key;P!==null;){if(P.key===ge){if(ge=V.type,ge===E){if(P.tag===7){o($,P.sibling),ie=g(P,V.props.children),ie.return=$,$=ie;break e}}else if(P.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===j&&Lm(ge)===P.type){o($,P.sibling),ie=g(P,V.props),Kr(ie,V),ie.return=$,$=ie;break e}o($,P);break}else n($,P);P=P.sibling}V.type===E?(ie=Ys(V.props.children,$.mode,ie,V.key),ie.return=$,$=ie):(ie=Wa(V.type,V.key,V.props,null,$.mode,ie),Kr(ie,V),ie.return=$,$=ie)}return R($);case S:e:{for(ge=V.key;P!==null;){if(P.key===ge)if(P.tag===4&&P.stateNode.containerInfo===V.containerInfo&&P.stateNode.implementation===V.implementation){o($,P.sibling),ie=g(P,V.children||[]),ie.return=$,$=ie;break e}else{o($,P);break}else n($,P);P=P.sibling}ie=yc(V,$.mode,ie),ie.return=$,$=ie}return R($);case j:return ge=V._init,V=ge(V._payload),Ve($,P,V,ie)}if(le(V))return Ee($,P,V,ie);if(re(V)){if(ge=re(V),typeof ge!="function")throw Error(i(150));return V=ge.call(V),xe($,P,V,ie)}if(typeof V.then=="function")return Ve($,P,ml(V),ie);if(V.$$typeof===I)return Ve($,P,tl($,V),ie);gl($,V)}return typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint"?(V=""+V,P!==null&&P.tag===6?(o($,P.sibling),ie=g(P,V),ie.return=$,$=ie):(o($,P),ie=pc(V,$.mode,ie),ie.return=$,$=ie),R($)):o($,P)}return function($,P,V,ie){try{Vr=0;var ge=Ve($,P,V,ie);return Bn=null,ge}catch(ye){if(ye===Mr||ye===sl)throw ye;var De=Vt(29,ye,null,$.mode);return De.lanes=ie,De.return=$,De}finally{}}}var Fn=_m(!0),Dm=_m(!1),ci=F(null),Ri=null;function gs(s){var n=s.alternate;se(ht,ht.current&1),se(ci,s),Ri===null&&(n===null||On.current!==null||n.memoizedState!==null)&&(Ri=s)}function Im(s){if(s.tag===22){if(se(ht,ht.current),se(ci,s),Ri===null){var n=s.alternate;n!==null&&n.memoizedState!==null&&(Ri=s)}}else ps()}function ps(){se(ht,ht.current),se(ci,ci.current)}function qi(s){q(ci),Ri===s&&(Ri=null),q(ht)}var ht=F(0);function pl(s){for(var n=s;n!==null;){if(n.tag===13){var o=n.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||Fu(o)))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break;for(;n.sibling===null;){if(n.return===null||n.return===s)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}function Qc(s,n,o,d){n=s.memoizedState,o=o(d,n),o=o==null?n:m({},n,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var Wc={enqueueSetState:function(s,n,o){s=s._reactInternals;var d=qt(),g=hs(d);g.payload=n,o!=null&&(g.callback=o),n=fs(s,g,d),n!==null&&(Xt(n,s,d),Ur(n,s,d))},enqueueReplaceState:function(s,n,o){s=s._reactInternals;var d=qt(),g=hs(d);g.tag=1,g.payload=n,o!=null&&(g.callback=o),n=fs(s,g,d),n!==null&&(Xt(n,s,d),Ur(n,s,d))},enqueueForceUpdate:function(s,n){s=s._reactInternals;var o=qt(),d=hs(o);d.tag=2,n!=null&&(d.callback=n),n=fs(s,d,o),n!==null&&(Xt(n,s,o),Ur(n,s,o))}};function Cm(s,n,o,d,g,x,R){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,x,R):n.prototype&&n.prototype.isPureReactComponent?!_r(o,d)||!_r(g,x):!0}function wm(s,n,o,d){s=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(o,d),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(o,d),n.state!==s&&Wc.enqueueReplaceState(n,n.state,null)}function sn(s,n){var o=n;if("ref"in n){o={};for(var d in n)d!=="ref"&&(o[d]=n[d])}if(s=s.defaultProps){o===n&&(o=m({},o));for(var g in s)o[g]===void 0&&(o[g]=s[g])}return o}var yl=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Nm(s){yl(s)}function km(s){console.error(s)}function Om(s){yl(s)}function xl(s,n){try{var o=s.onUncaughtError;o(n.value,{componentStack:n.stack})}catch(d){setTimeout(function(){throw d})}}function Mm(s,n,o){try{var d=s.onCaughtError;d(o.value,{componentStack:o.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Zc(s,n,o){return o=hs(o),o.tag=3,o.payload={element:null},o.callback=function(){xl(s,n)},o}function Pm(s){return s=hs(s),s.tag=3,s}function Um(s,n,o,d){var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var x=d.value;s.payload=function(){return g(x)},s.callback=function(){Mm(n,o,d)}}var R=o.stateNode;R!==null&&typeof R.componentDidCatch=="function"&&(s.callback=function(){Mm(n,o,d),typeof g!="function"&&(Ts===null?Ts=new Set([this]):Ts.add(this));var D=d.stack;this.componentDidCatch(d.value,{componentStack:D!==null?D:""})})}function hE(s,n,o,d,g){if(o.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(n=o.alternate,n!==null&&Nr(n,o,g,!0),o=ci.current,o!==null){switch(o.tag){case 13:return Ri===null?Tu():o.alternate===null&&st===0&&(st=3),o.flags&=-257,o.flags|=65536,o.lanes=g,d===_c?o.flags|=16384:(n=o.updateQueue,n===null?o.updateQueue=new Set([d]):n.add(d),Au(s,d,g)),!1;case 22:return o.flags|=65536,d===_c?o.flags|=16384:(n=o.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([d])},o.updateQueue=n):(o=n.retryQueue,o===null?n.retryQueue=new Set([d]):o.add(d)),Au(s,d,g)),!1}throw Error(i(435,o.tag))}return Au(s,d,g),Tu(),!1}if(Me)return n=ci.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=g,d!==Ec&&(s=Error(i(422),{cause:d}),wr(ri(s,o)))):(d!==Ec&&(n=Error(i(423),{cause:d}),wr(ri(n,o))),s=s.current.alternate,s.flags|=65536,g&=-g,s.lanes|=g,d=ri(d,o),g=Zc(s.stateNode,d,g),Cc(s,g),st!==4&&(st=2)),!1;var x=Error(i(520),{cause:d});if(x=ri(x,o),Zr===null?Zr=[x]:Zr.push(x),st!==4&&(st=2),n===null)return!0;d=ri(d,o),o=n;do{switch(o.tag){case 3:return o.flags|=65536,s=g&-g,o.lanes|=s,s=Zc(o.stateNode,d,s),Cc(o,s),!1;case 1:if(n=o.type,x=o.stateNode,(o.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ts===null||!Ts.has(x))))return o.flags|=65536,g&=-g,o.lanes|=g,g=Pm(g),Um(g,s,o,d),Cc(o,g),!1}o=o.return}while(o!==null);return!1}var Bm=Error(i(461)),pt=!1;function Et(s,n,o,d){n.child=s===null?Dm(n,null,o,d):Fn(n,s.child,o,d)}function Fm(s,n,o,d,g){o=o.render;var x=n.ref;if("ref"in d){var R={};for(var D in d)D!=="ref"&&(R[D]=d[D])}else R=d;return Js(n),d=Mc(s,n,o,R,x,g),D=Pc(),s!==null&&!pt?(Uc(s,n,g),Xi(s,n,g)):(Me&&D&&xc(n),n.flags|=1,Et(s,n,d,g),n.child)}function jm(s,n,o,d,g){if(s===null){var x=o.type;return typeof x=="function"&&!gc(x)&&x.defaultProps===void 0&&o.compare===null?(n.tag=15,n.type=x,$m(s,n,x,d,g)):(s=Wa(o.type,null,d,n,n.mode,g),s.ref=n.ref,s.return=n,n.child=s)}if(x=s.child,!au(s,g)){var R=x.memoizedProps;if(o=o.compare,o=o!==null?o:_r,o(R,d)&&s.ref===n.ref)return Xi(s,n,g)}return n.flags|=1,s=Gi(x,d),s.ref=n.ref,s.return=n,n.child=s}function $m(s,n,o,d,g){if(s!==null){var x=s.memoizedProps;if(_r(x,d)&&s.ref===n.ref)if(pt=!1,n.pendingProps=d=x,au(s,g))(s.flags&131072)!==0&&(pt=!0);else return n.lanes=s.lanes,Xi(s,n,g)}return Jc(s,n,o,d,g)}function Gm(s,n,o){var d=n.pendingProps,g=d.children,x=s!==null?s.memoizedState:null;if(d.mode==="hidden"){if((n.flags&128)!==0){if(d=x!==null?x.baseLanes|o:o,s!==null){for(g=n.child=s.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;n.childLanes=x&~d}else n.childLanes=0,n.child=null;return Hm(s,n,d,o)}if((o&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},s!==null&&il(n,x!==null?x.cachePool:null),x!==null?$f(n,x):Nc(),Im(n);else return n.lanes=n.childLanes=536870912,Hm(s,n,x!==null?x.baseLanes|o:o,o)}else x!==null?(il(n,x.cachePool),$f(n,x),ps(),n.memoizedState=null):(s!==null&&il(n,null),Nc(),ps());return Et(s,n,g,o),n.child}function Hm(s,n,o,d){var g=Lc();return g=g===null?null:{parent:dt._currentValue,pool:g},n.memoizedState={baseLanes:o,cachePool:g},s!==null&&il(n,null),Nc(),Im(n),s!==null&&Nr(s,n,d,!0),null}function vl(s,n){var o=n.ref;if(o===null)s!==null&&s.ref!==null&&(n.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(n.flags|=4194816)}}function Jc(s,n,o,d,g){return Js(n),o=Mc(s,n,o,d,void 0,g),d=Pc(),s!==null&&!pt?(Uc(s,n,g),Xi(s,n,g)):(Me&&d&&xc(n),n.flags|=1,Et(s,n,o,g),n.child)}function Vm(s,n,o,d,g,x){return Js(n),n.updateQueue=null,o=Hf(n,d,o,g),Gf(s),d=Pc(),s!==null&&!pt?(Uc(s,n,x),Xi(s,n,x)):(Me&&d&&xc(n),n.flags|=1,Et(s,n,o,x),n.child)}function Km(s,n,o,d,g){if(Js(n),n.stateNode===null){var x=In,R=o.contextType;typeof R=="object"&&R!==null&&(x=Dt(R)),x=new o(d,x),n.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Wc,n.stateNode=x,x._reactInternals=n,x=n.stateNode,x.props=d,x.state=n.memoizedState,x.refs={},Dc(n),R=o.contextType,x.context=typeof R=="object"&&R!==null?Dt(R):In,x.state=n.memoizedState,R=o.getDerivedStateFromProps,typeof R=="function"&&(Qc(n,o,R,d),x.state=n.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(R=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),R!==x.state&&Wc.enqueueReplaceState(x,x.state,null),Fr(n,d,x,g),Br(),x.state=n.memoizedState),typeof x.componentDidMount=="function"&&(n.flags|=4194308),d=!0}else if(s===null){x=n.stateNode;var D=n.memoizedProps,k=sn(o,D);x.props=k;var z=x.context,J=o.contextType;R=In,typeof J=="object"&&J!==null&&(R=Dt(J));var ne=o.getDerivedStateFromProps;J=typeof ne=="function"||typeof x.getSnapshotBeforeUpdate=="function",D=n.pendingProps!==D,J||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(D||z!==R)&&wm(n,x,d,R),ds=!1;var Y=n.memoizedState;x.state=Y,Fr(n,d,x,g),Br(),z=n.memoizedState,D||Y!==z||ds?(typeof ne=="function"&&(Qc(n,o,ne,d),z=n.memoizedState),(k=ds||Cm(n,o,k,d,Y,z,R))?(J||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(n.flags|=4194308)):(typeof x.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=d,n.memoizedState=z),x.props=d,x.state=z,x.context=R,d=k):(typeof x.componentDidMount=="function"&&(n.flags|=4194308),d=!1)}else{x=n.stateNode,Ic(s,n),R=n.memoizedProps,J=sn(o,R),x.props=J,ne=n.pendingProps,Y=x.context,z=o.contextType,k=In,typeof z=="object"&&z!==null&&(k=Dt(z)),D=o.getDerivedStateFromProps,(z=typeof D=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(R!==ne||Y!==k)&&wm(n,x,d,k),ds=!1,Y=n.memoizedState,x.state=Y,Fr(n,d,x,g),Br();var X=n.memoizedState;R!==ne||Y!==X||ds||s!==null&&s.dependencies!==null&&el(s.dependencies)?(typeof D=="function"&&(Qc(n,o,D,d),X=n.memoizedState),(J=ds||Cm(n,o,J,d,Y,X,k)||s!==null&&s.dependencies!==null&&el(s.dependencies))?(z||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(d,X,k),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(d,X,k)),typeof x.componentDidUpdate=="function"&&(n.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof x.componentDidUpdate!="function"||R===s.memoizedProps&&Y===s.memoizedState||(n.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||R===s.memoizedProps&&Y===s.memoizedState||(n.flags|=1024),n.memoizedProps=d,n.memoizedState=X),x.props=d,x.state=X,x.context=k,d=J):(typeof x.componentDidUpdate!="function"||R===s.memoizedProps&&Y===s.memoizedState||(n.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||R===s.memoizedProps&&Y===s.memoizedState||(n.flags|=1024),d=!1)}return x=d,vl(s,n),d=(n.flags&128)!==0,x||d?(x=n.stateNode,o=d&&typeof o.getDerivedStateFromError!="function"?null:x.render(),n.flags|=1,s!==null&&d?(n.child=Fn(n,s.child,null,g),n.child=Fn(n,null,o,g)):Et(s,n,o,g),n.memoizedState=x.state,s=n.child):s=Xi(s,n,g),s}function zm(s,n,o,d){return Cr(),n.flags|=256,Et(s,n,o,d),n.child}var eu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function tu(s){return{baseLanes:s,cachePool:kf()}}function iu(s,n,o){return s=s!==null?s.childLanes&~o:0,n&&(s|=ui),s}function Ym(s,n,o){var d=n.pendingProps,g=!1,x=(n.flags&128)!==0,R;if((R=x)||(R=s!==null&&s.memoizedState===null?!1:(ht.current&2)!==0),R&&(g=!0,n.flags&=-129),R=(n.flags&32)!==0,n.flags&=-33,s===null){if(Me){if(g?gs(n):ps(),Me){var D=it,k;if(k=D){e:{for(k=D,D=Ai;k.nodeType!==8;){if(!D){D=null;break e}if(k=vi(k.nextSibling),k===null){D=null;break e}}D=k}D!==null?(n.memoizedState={dehydrated:D,treeContext:qs!==null?{id:Hi,overflow:Vi}:null,retryLane:536870912,hydrationErrors:null},k=Vt(18,null,null,0),k.stateNode=D,k.return=n,n.child=k,Ct=n,it=null,k=!0):k=!1}k||Ws(n)}if(D=n.memoizedState,D!==null&&(D=D.dehydrated,D!==null))return Fu(D)?n.lanes=32:n.lanes=536870912,null;qi(n)}return D=d.children,d=d.fallback,g?(ps(),g=n.mode,D=El({mode:"hidden",children:D},g),d=Ys(d,g,o,null),D.return=n,d.return=n,D.sibling=d,n.child=D,g=n.child,g.memoizedState=tu(o),g.childLanes=iu(s,R,o),n.memoizedState=eu,d):(gs(n),su(n,D))}if(k=s.memoizedState,k!==null&&(D=k.dehydrated,D!==null)){if(x)n.flags&256?(gs(n),n.flags&=-257,n=nu(s,n,o)):n.memoizedState!==null?(ps(),n.child=s.child,n.flags|=128,n=null):(ps(),g=d.fallback,D=n.mode,d=El({mode:"visible",children:d.children},D),g=Ys(g,D,o,null),g.flags|=2,d.return=n,g.return=n,d.sibling=g,n.child=d,Fn(n,s.child,null,o),d=n.child,d.memoizedState=tu(o),d.childLanes=iu(s,R,o),n.memoizedState=eu,n=g);else if(gs(n),Fu(D)){if(R=D.nextSibling&&D.nextSibling.dataset,R)var z=R.dgst;R=z,d=Error(i(419)),d.stack="",d.digest=R,wr({value:d,source:null,stack:null}),n=nu(s,n,o)}else if(pt||Nr(s,n,o,!1),R=(o&s.childLanes)!==0,pt||R){if(R=Qe,R!==null&&(d=o&-o,d=(d&42)!==0?1:jo(d),d=(d&(R.suspendedLanes|o))!==0?0:d,d!==0&&d!==k.retryLane))throw k.retryLane=d,Dn(s,d),Xt(R,s,d),Bm;D.data==="$?"||Tu(),n=nu(s,n,o)}else D.data==="$?"?(n.flags|=192,n.child=s.child,n=null):(s=k.treeContext,it=vi(D.nextSibling),Ct=n,Me=!0,Qs=null,Ai=!1,s!==null&&(li[oi++]=Hi,li[oi++]=Vi,li[oi++]=qs,Hi=s.id,Vi=s.overflow,qs=n),n=su(n,d.children),n.flags|=4096);return n}return g?(ps(),g=d.fallback,D=n.mode,k=s.child,z=k.sibling,d=Gi(k,{mode:"hidden",children:d.children}),d.subtreeFlags=k.subtreeFlags&65011712,z!==null?g=Gi(z,g):(g=Ys(g,D,o,null),g.flags|=2),g.return=n,d.return=n,d.sibling=g,n.child=d,d=g,g=n.child,D=s.child.memoizedState,D===null?D=tu(o):(k=D.cachePool,k!==null?(z=dt._currentValue,k=k.parent!==z?{parent:z,pool:z}:k):k=kf(),D={baseLanes:D.baseLanes|o,cachePool:k}),g.memoizedState=D,g.childLanes=iu(s,R,o),n.memoizedState=eu,d):(gs(n),o=s.child,s=o.sibling,o=Gi(o,{mode:"visible",children:d.children}),o.return=n,o.sibling=null,s!==null&&(R=n.deletions,R===null?(n.deletions=[s],n.flags|=16):R.push(s)),n.child=o,n.memoizedState=null,o)}function su(s,n){return n=El({mode:"visible",children:n},s.mode),n.return=s,s.child=n}function El(s,n){return s=Vt(22,s,null,n),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function nu(s,n,o){return Fn(n,s.child,null,o),s=su(n,n.pendingProps.children),s.flags|=2,n.memoizedState=null,s}function qm(s,n,o){s.lanes|=n;var d=s.alternate;d!==null&&(d.lanes|=n),Tc(s.return,n,o)}function ru(s,n,o,d,g){var x=s.memoizedState;x===null?s.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:d,tail:o,tailMode:g}:(x.isBackwards=n,x.rendering=null,x.renderingStartTime=0,x.last=d,x.tail=o,x.tailMode=g)}function Xm(s,n,o){var d=n.pendingProps,g=d.revealOrder,x=d.tail;if(Et(s,n,d.children,o),d=ht.current,(d&2)!==0)d=d&1|2,n.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=n.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&qm(s,o,n);else if(s.tag===19)qm(s,o,n);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break e;for(;s.sibling===null;){if(s.return===null||s.return===n)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}d&=1}switch(se(ht,d),g){case"forwards":for(o=n.child,g=null;o!==null;)s=o.alternate,s!==null&&pl(s)===null&&(g=o),o=o.sibling;o=g,o===null?(g=n.child,n.child=null):(g=o.sibling,o.sibling=null),ru(n,!1,g,o,x);break;case"backwards":for(o=null,g=n.child,n.child=null;g!==null;){if(s=g.alternate,s!==null&&pl(s)===null){n.child=g;break}s=g.sibling,g.sibling=o,o=g,g=s}ru(n,!0,o,null,x);break;case"together":ru(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Xi(s,n,o){if(s!==null&&(n.dependencies=s.dependencies),Ss|=n.lanes,(o&n.childLanes)===0)if(s!==null){if(Nr(s,n,o,!1),(o&n.childLanes)===0)return null}else return null;if(s!==null&&n.child!==s.child)throw Error(i(153));if(n.child!==null){for(s=n.child,o=Gi(s,s.pendingProps),n.child=o,o.return=n;s.sibling!==null;)s=s.sibling,o=o.sibling=Gi(s,s.pendingProps),o.return=n;o.sibling=null}return n.child}function au(s,n){return(s.lanes&n)!==0?!0:(s=s.dependencies,!!(s!==null&&el(s)))}function fE(s,n,o){switch(n.tag){case 3:Ae(n,n.stateNode.containerInfo),us(n,dt,s.memoizedState.cache),Cr();break;case 27:case 5:kt(n);break;case 4:Ae(n,n.stateNode.containerInfo);break;case 10:us(n,n.type,n.memoizedProps.value);break;case 13:var d=n.memoizedState;if(d!==null)return d.dehydrated!==null?(gs(n),n.flags|=128,null):(o&n.child.childLanes)!==0?Ym(s,n,o):(gs(n),s=Xi(s,n,o),s!==null?s.sibling:null);gs(n);break;case 19:var g=(s.flags&128)!==0;if(d=(o&n.childLanes)!==0,d||(Nr(s,n,o,!1),d=(o&n.childLanes)!==0),g){if(d)return Xm(s,n,o);n.flags|=128}if(g=n.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),se(ht,ht.current),d)break;return null;case 22:case 23:return n.lanes=0,Gm(s,n,o);case 24:us(n,dt,s.memoizedState.cache)}return Xi(s,n,o)}function Qm(s,n,o){if(s!==null)if(s.memoizedProps!==n.pendingProps)pt=!0;else{if(!au(s,o)&&(n.flags&128)===0)return pt=!1,fE(s,n,o);pt=(s.flags&131072)!==0}else pt=!1,Me&&(n.flags&1048576)!==0&&Lf(n,Ja,n.index);switch(n.lanes=0,n.tag){case 16:e:{s=n.pendingProps;var d=n.elementType,g=d._init;if(d=g(d._payload),n.type=d,typeof d=="function")gc(d)?(s=sn(d,s),n.tag=1,n=Km(null,n,d,s,o)):(n.tag=0,n=Jc(null,n,d,s,o));else{if(d!=null){if(g=d.$$typeof,g===C){n.tag=11,n=Fm(null,n,d,s,o);break e}else if(g===O){n.tag=14,n=jm(null,n,d,s,o);break e}}throw n=fe(d)||d,Error(i(306,n,""))}}return n;case 0:return Jc(s,n,n.type,n.pendingProps,o);case 1:return d=n.type,g=sn(d,n.pendingProps),Km(s,n,d,g,o);case 3:e:{if(Ae(n,n.stateNode.containerInfo),s===null)throw Error(i(387));d=n.pendingProps;var x=n.memoizedState;g=x.element,Ic(s,n),Fr(n,d,null,o);var R=n.memoizedState;if(d=R.cache,us(n,dt,d),d!==x.cache&&bc(n,[dt],o,!0),Br(),d=R.element,x.isDehydrated)if(x={element:d,isDehydrated:!1,cache:R.cache},n.updateQueue.baseState=x,n.memoizedState=x,n.flags&256){n=zm(s,n,d,o);break e}else if(d!==g){g=ri(Error(i(424)),n),wr(g),n=zm(s,n,d,o);break e}else{switch(s=n.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(it=vi(s.firstChild),Ct=n,Me=!0,Qs=null,Ai=!0,o=Dm(n,null,d,o),n.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Cr(),d===g){n=Xi(s,n,o);break e}Et(s,n,d,o)}n=n.child}return n;case 26:return vl(s,n),s===null?(o=e0(n.type,null,n.pendingProps,null))?n.memoizedState=o:Me||(o=n.type,s=n.pendingProps,d=Ol(ce.current).createElement(o),d[_t]=n,d[Pt]=s,Tt(d,o,s),gt(d),n.stateNode=d):n.memoizedState=e0(n.type,s.memoizedProps,n.pendingProps,s.memoizedState),null;case 27:return kt(n),s===null&&Me&&(d=n.stateNode=Wg(n.type,n.pendingProps,ce.current),Ct=n,Ai=!0,g=it,Rs(n.type)?(ju=g,it=vi(d.firstChild)):it=g),Et(s,n,n.pendingProps.children,o),vl(s,n),s===null&&(n.flags|=4194304),n.child;case 5:return s===null&&Me&&((g=d=it)&&(d=$E(d,n.type,n.pendingProps,Ai),d!==null?(n.stateNode=d,Ct=n,it=vi(d.firstChild),Ai=!1,g=!0):g=!1),g||Ws(n)),kt(n),g=n.type,x=n.pendingProps,R=s!==null?s.memoizedProps:null,d=x.children,Pu(g,x)?d=null:R!==null&&Pu(g,R)&&(n.flags|=32),n.memoizedState!==null&&(g=Mc(s,n,rE,null,null,o),la._currentValue=g),vl(s,n),Et(s,n,d,o),n.child;case 6:return s===null&&Me&&((s=o=it)&&(o=GE(o,n.pendingProps,Ai),o!==null?(n.stateNode=o,Ct=n,it=null,s=!0):s=!1),s||Ws(n)),null;case 13:return Ym(s,n,o);case 4:return Ae(n,n.stateNode.containerInfo),d=n.pendingProps,s===null?n.child=Fn(n,null,d,o):Et(s,n,d,o),n.child;case 11:return Fm(s,n,n.type,n.pendingProps,o);case 7:return Et(s,n,n.pendingProps,o),n.child;case 8:return Et(s,n,n.pendingProps.children,o),n.child;case 12:return Et(s,n,n.pendingProps.children,o),n.child;case 10:return d=n.pendingProps,us(n,n.type,d.value),Et(s,n,d.children,o),n.child;case 9:return g=n.type._context,d=n.pendingProps.children,Js(n),g=Dt(g),d=d(g),n.flags|=1,Et(s,n,d,o),n.child;case 14:return jm(s,n,n.type,n.pendingProps,o);case 15:return $m(s,n,n.type,n.pendingProps,o);case 19:return Xm(s,n,o);case 31:return d=n.pendingProps,o=n.mode,d={mode:d.mode,children:d.children},s===null?(o=El(d,o),o.ref=n.ref,n.child=o,o.return=n,n=o):(o=Gi(s.child,d),o.ref=n.ref,n.child=o,o.return=n,n=o),n;case 22:return Gm(s,n,o);case 24:return Js(n),d=Dt(dt),s===null?(g=Lc(),g===null&&(g=Qe,x=Ac(),g.pooledCache=x,x.refCount++,x!==null&&(g.pooledCacheLanes|=o),g=x),n.memoizedState={parent:d,cache:g},Dc(n),us(n,dt,g)):((s.lanes&o)!==0&&(Ic(s,n),Fr(n,null,null,o),Br()),g=s.memoizedState,x=n.memoizedState,g.parent!==d?(g={parent:d,cache:d},n.memoizedState=g,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=g),us(n,dt,d)):(d=x.cache,us(n,dt,d),d!==g.cache&&bc(n,[dt],o,!0))),Et(s,n,n.pendingProps.children,o),n.child;case 29:throw n.pendingProps}throw Error(i(156,n.tag))}function Qi(s){s.flags|=4}function Wm(s,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!r0(n)){if(n=ci.current,n!==null&&((ke&4194048)===ke?Ri!==null:(ke&62914560)!==ke&&(ke&536870912)===0||n!==Ri))throw Pr=_c,Of;s.flags|=8192}}function Sl(s,n){n!==null&&(s.flags|=4),s.flags&16384&&(n=s.tag!==22?Dh():536870912,s.lanes|=n,Hn|=n)}function zr(s,n){if(!Me)switch(s.tailMode){case"hidden":n=s.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?n||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function Ze(s){var n=s.alternate!==null&&s.alternate.child===s.child,o=0,d=0;if(n)for(var g=s.child;g!==null;)o|=g.lanes|g.childLanes,d|=g.subtreeFlags&65011712,d|=g.flags&65011712,g.return=s,g=g.sibling;else for(g=s.child;g!==null;)o|=g.lanes|g.childLanes,d|=g.subtreeFlags,d|=g.flags,g.return=s,g=g.sibling;return s.subtreeFlags|=d,s.childLanes=o,n}function mE(s,n,o){var d=n.pendingProps;switch(vc(n),n.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ze(n),null;case 1:return Ze(n),null;case 3:return o=n.stateNode,d=null,s!==null&&(d=s.memoizedState.cache),n.memoizedState.cache!==d&&(n.flags|=2048),zi(dt),rt(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(Ir(n)?Qi(n):s===null||s.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,If())),Ze(n),null;case 26:return o=n.memoizedState,s===null?(Qi(n),o!==null?(Ze(n),Wm(n,o)):(Ze(n),n.flags&=-16777217)):o?o!==s.memoizedState?(Qi(n),Ze(n),Wm(n,o)):(Ze(n),n.flags&=-16777217):(s.memoizedProps!==d&&Qi(n),Ze(n),n.flags&=-16777217),null;case 27:ii(n),o=ce.current;var g=n.type;if(s!==null&&n.stateNode!=null)s.memoizedProps!==d&&Qi(n);else{if(!d){if(n.stateNode===null)throw Error(i(166));return Ze(n),null}s=oe.current,Ir(n)?_f(n):(s=Wg(g,d,o),n.stateNode=s,Qi(n))}return Ze(n),null;case 5:if(ii(n),o=n.type,s!==null&&n.stateNode!=null)s.memoizedProps!==d&&Qi(n);else{if(!d){if(n.stateNode===null)throw Error(i(166));return Ze(n),null}if(s=oe.current,Ir(n))_f(n);else{switch(g=Ol(ce.current),s){case 1:s=g.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:s=g.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":s=g.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":s=g.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":s=g.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof d.is=="string"?g.createElement("select",{is:d.is}):g.createElement("select"),d.multiple?s.multiple=!0:d.size&&(s.size=d.size);break;default:s=typeof d.is=="string"?g.createElement(o,{is:d.is}):g.createElement(o)}}s[_t]=n,s[Pt]=d;e:for(g=n.child;g!==null;){if(g.tag===5||g.tag===6)s.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===n)break e;for(;g.sibling===null;){if(g.return===null||g.return===n)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}n.stateNode=s;e:switch(Tt(s,o,d),o){case"button":case"input":case"select":case"textarea":s=!!d.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Qi(n)}}return Ze(n),n.flags&=-16777217,null;case 6:if(s&&n.stateNode!=null)s.memoizedProps!==d&&Qi(n);else{if(typeof d!="string"&&n.stateNode===null)throw Error(i(166));if(s=ce.current,Ir(n)){if(s=n.stateNode,o=n.memoizedProps,d=null,g=Ct,g!==null)switch(g.tag){case 27:case 5:d=g.memoizedProps}s[_t]=n,s=!!(s.nodeValue===o||d!==null&&d.suppressHydrationWarning===!0||Vg(s.nodeValue,o)),s||Ws(n)}else s=Ol(s).createTextNode(d),s[_t]=n,n.stateNode=s}return Ze(n),null;case 13:if(d=n.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(g=Ir(n),d!==null&&d.dehydrated!==null){if(s===null){if(!g)throw Error(i(318));if(g=n.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[_t]=n}else Cr(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Ze(n),g=!1}else g=If(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=g),g=!0;if(!g)return n.flags&256?(qi(n),n):(qi(n),null)}if(qi(n),(n.flags&128)!==0)return n.lanes=o,n;if(o=d!==null,s=s!==null&&s.memoizedState!==null,o){d=n.child,g=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(g=d.alternate.memoizedState.cachePool.pool);var x=null;d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(x=d.memoizedState.cachePool.pool),x!==g&&(d.flags|=2048)}return o!==s&&o&&(n.child.flags|=8192),Sl(n,n.updateQueue),Ze(n),null;case 4:return rt(),s===null&&wu(n.stateNode.containerInfo),Ze(n),null;case 10:return zi(n.type),Ze(n),null;case 19:if(q(ht),g=n.memoizedState,g===null)return Ze(n),null;if(d=(n.flags&128)!==0,x=g.rendering,x===null)if(d)zr(g,!1);else{if(st!==0||s!==null&&(s.flags&128)!==0)for(s=n.child;s!==null;){if(x=pl(s),x!==null){for(n.flags|=128,zr(g,!1),s=x.updateQueue,n.updateQueue=s,Sl(n,s),n.subtreeFlags=0,s=o,o=n.child;o!==null;)Rf(o,s),o=o.sibling;return se(ht,ht.current&1|2),n.child}s=s.sibling}g.tail!==null&&ze()>Al&&(n.flags|=128,d=!0,zr(g,!1),n.lanes=4194304)}else{if(!d)if(s=pl(x),s!==null){if(n.flags|=128,d=!0,s=s.updateQueue,n.updateQueue=s,Sl(n,s),zr(g,!0),g.tail===null&&g.tailMode==="hidden"&&!x.alternate&&!Me)return Ze(n),null}else 2*ze()-g.renderingStartTime>Al&&o!==536870912&&(n.flags|=128,d=!0,zr(g,!1),n.lanes=4194304);g.isBackwards?(x.sibling=n.child,n.child=x):(s=g.last,s!==null?s.sibling=x:n.child=x,g.last=x)}return g.tail!==null?(n=g.tail,g.rendering=n,g.tail=n.sibling,g.renderingStartTime=ze(),n.sibling=null,s=ht.current,se(ht,d?s&1|2:s&1),n):(Ze(n),null);case 22:case 23:return qi(n),kc(),d=n.memoizedState!==null,s!==null?s.memoizedState!==null!==d&&(n.flags|=8192):d&&(n.flags|=8192),d?(o&536870912)!==0&&(n.flags&128)===0&&(Ze(n),n.subtreeFlags&6&&(n.flags|=8192)):Ze(n),o=n.updateQueue,o!==null&&Sl(n,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),d=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(d=n.memoizedState.cachePool.pool),d!==o&&(n.flags|=2048),s!==null&&q(en),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),n.memoizedState.cache!==o&&(n.flags|=2048),zi(dt),Ze(n),null;case 25:return null;case 30:return null}throw Error(i(156,n.tag))}function gE(s,n){switch(vc(n),n.tag){case 1:return s=n.flags,s&65536?(n.flags=s&-65537|128,n):null;case 3:return zi(dt),rt(),s=n.flags,(s&65536)!==0&&(s&128)===0?(n.flags=s&-65537|128,n):null;case 26:case 27:case 5:return ii(n),null;case 13:if(qi(n),s=n.memoizedState,s!==null&&s.dehydrated!==null){if(n.alternate===null)throw Error(i(340));Cr()}return s=n.flags,s&65536?(n.flags=s&-65537|128,n):null;case 19:return q(ht),null;case 4:return rt(),null;case 10:return zi(n.type),null;case 22:case 23:return qi(n),kc(),s!==null&&q(en),s=n.flags,s&65536?(n.flags=s&-65537|128,n):null;case 24:return zi(dt),null;case 25:return null;default:return null}}function Zm(s,n){switch(vc(n),n.tag){case 3:zi(dt),rt();break;case 26:case 27:case 5:ii(n);break;case 4:rt();break;case 13:qi(n);break;case 19:q(ht);break;case 10:zi(n.type);break;case 22:case 23:qi(n),kc(),s!==null&&q(en);break;case 24:zi(dt)}}function Yr(s,n){try{var o=n.updateQueue,d=o!==null?o.lastEffect:null;if(d!==null){var g=d.next;o=g;do{if((o.tag&s)===s){d=void 0;var x=o.create,R=o.inst;d=x(),R.destroy=d}o=o.next}while(o!==g)}}catch(D){Ye(n,n.return,D)}}function ys(s,n,o){try{var d=n.updateQueue,g=d!==null?d.lastEffect:null;if(g!==null){var x=g.next;d=x;do{if((d.tag&s)===s){var R=d.inst,D=R.destroy;if(D!==void 0){R.destroy=void 0,g=n;var k=o,z=D;try{z()}catch(J){Ye(g,k,J)}}}d=d.next}while(d!==x)}}catch(J){Ye(n,n.return,J)}}function Jm(s){var n=s.updateQueue;if(n!==null){var o=s.stateNode;try{jf(n,o)}catch(d){Ye(s,s.return,d)}}}function eg(s,n,o){o.props=sn(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(d){Ye(s,n,d)}}function qr(s,n){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var d=s.stateNode;break;case 30:d=s.stateNode;break;default:d=s.stateNode}typeof o=="function"?s.refCleanup=o(d):o.current=d}}catch(g){Ye(s,n,g)}}function Li(s,n){var o=s.ref,d=s.refCleanup;if(o!==null)if(typeof d=="function")try{d()}catch(g){Ye(s,n,g)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(g){Ye(s,n,g)}else o.current=null}function tg(s){var n=s.type,o=s.memoizedProps,d=s.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":o.autoFocus&&d.focus();break e;case"img":o.src?d.src=o.src:o.srcSet&&(d.srcset=o.srcSet)}}catch(g){Ye(s,s.return,g)}}function lu(s,n,o){try{var d=s.stateNode;PE(d,s.type,o,n),d[Pt]=n}catch(g){Ye(s,s.return,g)}}function ig(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Rs(s.type)||s.tag===4}function ou(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||ig(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Rs(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function cu(s,n,o){var d=s.tag;if(d===5||d===6)s=s.stateNode,n?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,n):(n=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,n.appendChild(s),o=o._reactRootContainer,o!=null||n.onclick!==null||(n.onclick=kl));else if(d!==4&&(d===27&&Rs(s.type)&&(o=s.stateNode,n=null),s=s.child,s!==null))for(cu(s,n,o),s=s.sibling;s!==null;)cu(s,n,o),s=s.sibling}function Tl(s,n,o){var d=s.tag;if(d===5||d===6)s=s.stateNode,n?o.insertBefore(s,n):o.appendChild(s);else if(d!==4&&(d===27&&Rs(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Tl(s,n,o),s=s.sibling;s!==null;)Tl(s,n,o),s=s.sibling}function sg(s){var n=s.stateNode,o=s.memoizedProps;try{for(var d=s.type,g=n.attributes;g.length;)n.removeAttributeNode(g[0]);Tt(n,d,o),n[_t]=s,n[Pt]=o}catch(x){Ye(s,s.return,x)}}var Wi=!1,lt=!1,uu=!1,ng=typeof WeakSet=="function"?WeakSet:Set,yt=null;function pE(s,n){if(s=s.containerInfo,Ou=jl,s=gf(s),oc(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var d=o.getSelection&&o.getSelection();if(d&&d.rangeCount!==0){o=d.anchorNode;var g=d.anchorOffset,x=d.focusNode;d=d.focusOffset;try{o.nodeType,x.nodeType}catch{o=null;break e}var R=0,D=-1,k=-1,z=0,J=0,ne=s,Y=null;t:for(;;){for(var X;ne!==o||g!==0&&ne.nodeType!==3||(D=R+g),ne!==x||d!==0&&ne.nodeType!==3||(k=R+d),ne.nodeType===3&&(R+=ne.nodeValue.length),(X=ne.firstChild)!==null;)Y=ne,ne=X;for(;;){if(ne===s)break t;if(Y===o&&++z===g&&(D=R),Y===x&&++J===d&&(k=R),(X=ne.nextSibling)!==null)break;ne=Y,Y=ne.parentNode}ne=X}o=D===-1||k===-1?null:{start:D,end:k}}else o=null}o=o||{start:0,end:0}}else o=null;for(Mu={focusedElem:s,selectionRange:o},jl=!1,yt=n;yt!==null;)if(n=yt,s=n.child,(n.subtreeFlags&1024)!==0&&s!==null)s.return=n,yt=s;else for(;yt!==null;){switch(n=yt,x=n.alternate,s=n.flags,n.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&x!==null){s=void 0,o=n,g=x.memoizedProps,x=x.memoizedState,d=o.stateNode;try{var Ee=sn(o.type,g,o.elementType===o.type);s=d.getSnapshotBeforeUpdate(Ee,x),d.__reactInternalSnapshotBeforeUpdate=s}catch(xe){Ye(o,o.return,xe)}}break;case 3:if((s&1024)!==0){if(s=n.stateNode.containerInfo,o=s.nodeType,o===9)Bu(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Bu(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=n.sibling,s!==null){s.return=n.return,yt=s;break}yt=n.return}}function rg(s,n,o){var d=o.flags;switch(o.tag){case 0:case 11:case 15:xs(s,o),d&4&&Yr(5,o);break;case 1:if(xs(s,o),d&4)if(s=o.stateNode,n===null)try{s.componentDidMount()}catch(R){Ye(o,o.return,R)}else{var g=sn(o.type,n.memoizedProps);n=n.memoizedState;try{s.componentDidUpdate(g,n,s.__reactInternalSnapshotBeforeUpdate)}catch(R){Ye(o,o.return,R)}}d&64&&Jm(o),d&512&&qr(o,o.return);break;case 3:if(xs(s,o),d&64&&(s=o.updateQueue,s!==null)){if(n=null,o.child!==null)switch(o.child.tag){case 27:case 5:n=o.child.stateNode;break;case 1:n=o.child.stateNode}try{jf(s,n)}catch(R){Ye(o,o.return,R)}}break;case 27:n===null&&d&4&&sg(o);case 26:case 5:xs(s,o),n===null&&d&4&&tg(o),d&512&&qr(o,o.return);break;case 12:xs(s,o);break;case 13:xs(s,o),d&4&&og(s,o),d&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=RE.bind(null,o),HE(s,o))));break;case 22:if(d=o.memoizedState!==null||Wi,!d){n=n!==null&&n.memoizedState!==null||lt,g=Wi;var x=lt;Wi=d,(lt=n)&&!x?vs(s,o,(o.subtreeFlags&8772)!==0):xs(s,o),Wi=g,lt=x}break;case 30:break;default:xs(s,o)}}function ag(s){var n=s.alternate;n!==null&&(s.alternate=null,ag(n)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(n=s.stateNode,n!==null&&Ho(n)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var We=null,Ft=!1;function Zi(s,n,o){for(o=o.child;o!==null;)lg(s,n,o),o=o.sibling}function lg(s,n,o){if(Rt&&typeof Rt.onCommitFiberUnmount=="function")try{Rt.onCommitFiberUnmount(pi,o)}catch{}switch(o.tag){case 26:lt||Li(o,n),Zi(s,n,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:lt||Li(o,n);var d=We,g=Ft;Rs(o.type)&&(We=o.stateNode,Ft=!1),Zi(s,n,o),sa(o.stateNode),We=d,Ft=g;break;case 5:lt||Li(o,n);case 6:if(d=We,g=Ft,We=null,Zi(s,n,o),We=d,Ft=g,We!==null)if(Ft)try{(We.nodeType===9?We.body:We.nodeName==="HTML"?We.ownerDocument.body:We).removeChild(o.stateNode)}catch(x){Ye(o,n,x)}else try{We.removeChild(o.stateNode)}catch(x){Ye(o,n,x)}break;case 18:We!==null&&(Ft?(s=We,Xg(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),da(s)):Xg(We,o.stateNode));break;case 4:d=We,g=Ft,We=o.stateNode.containerInfo,Ft=!0,Zi(s,n,o),We=d,Ft=g;break;case 0:case 11:case 14:case 15:lt||ys(2,o,n),lt||ys(4,o,n),Zi(s,n,o);break;case 1:lt||(Li(o,n),d=o.stateNode,typeof d.componentWillUnmount=="function"&&eg(o,n,d)),Zi(s,n,o);break;case 21:Zi(s,n,o);break;case 22:lt=(d=lt)||o.memoizedState!==null,Zi(s,n,o),lt=d;break;default:Zi(s,n,o)}}function og(s,n){if(n.memoizedState===null&&(s=n.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{da(s)}catch(o){Ye(n,n.return,o)}}function yE(s){switch(s.tag){case 13:case 19:var n=s.stateNode;return n===null&&(n=s.stateNode=new ng),n;case 22:return s=s.stateNode,n=s._retryCache,n===null&&(n=s._retryCache=new ng),n;default:throw Error(i(435,s.tag))}}function du(s,n){var o=yE(s);n.forEach(function(d){var g=LE.bind(null,s,d);o.has(d)||(o.add(d),d.then(g,g))})}function Kt(s,n){var o=n.deletions;if(o!==null)for(var d=0;d<o.length;d++){var g=o[d],x=s,R=n,D=R;e:for(;D!==null;){switch(D.tag){case 27:if(Rs(D.type)){We=D.stateNode,Ft=!1;break e}break;case 5:We=D.stateNode,Ft=!1;break e;case 3:case 4:We=D.stateNode.containerInfo,Ft=!0;break e}D=D.return}if(We===null)throw Error(i(160));lg(x,R,g),We=null,Ft=!1,x=g.alternate,x!==null&&(x.return=null),g.return=null}if(n.subtreeFlags&13878)for(n=n.child;n!==null;)cg(n,s),n=n.sibling}var xi=null;function cg(s,n){var o=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Kt(n,s),zt(s),d&4&&(ys(3,s,s.return),Yr(3,s),ys(5,s,s.return));break;case 1:Kt(n,s),zt(s),d&512&&(lt||o===null||Li(o,o.return)),d&64&&Wi&&(s=s.updateQueue,s!==null&&(d=s.callbacks,d!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?d:o.concat(d))));break;case 26:var g=xi;if(Kt(n,s),zt(s),d&512&&(lt||o===null||Li(o,o.return)),d&4){var x=o!==null?o.memoizedState:null;if(d=s.memoizedState,o===null)if(d===null)if(s.stateNode===null){e:{d=s.type,o=s.memoizedProps,g=g.ownerDocument||g;t:switch(d){case"title":x=g.getElementsByTagName("title")[0],(!x||x[xr]||x[_t]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=g.createElement(d),g.head.insertBefore(x,g.querySelector("head > title"))),Tt(x,d,o),x[_t]=s,gt(x),d=x;break e;case"link":var R=s0("link","href",g).get(d+(o.href||""));if(R){for(var D=0;D<R.length;D++)if(x=R[D],x.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&x.getAttribute("rel")===(o.rel==null?null:o.rel)&&x.getAttribute("title")===(o.title==null?null:o.title)&&x.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){R.splice(D,1);break t}}x=g.createElement(d),Tt(x,d,o),g.head.appendChild(x);break;case"meta":if(R=s0("meta","content",g).get(d+(o.content||""))){for(D=0;D<R.length;D++)if(x=R[D],x.getAttribute("content")===(o.content==null?null:""+o.content)&&x.getAttribute("name")===(o.name==null?null:o.name)&&x.getAttribute("property")===(o.property==null?null:o.property)&&x.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&x.getAttribute("charset")===(o.charSet==null?null:o.charSet)){R.splice(D,1);break t}}x=g.createElement(d),Tt(x,d,o),g.head.appendChild(x);break;default:throw Error(i(468,d))}x[_t]=s,gt(x),d=x}s.stateNode=d}else n0(g,s.type,s.stateNode);else s.stateNode=i0(g,d,s.memoizedProps);else x!==d?(x===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):x.count--,d===null?n0(g,s.type,s.stateNode):i0(g,d,s.memoizedProps)):d===null&&s.stateNode!==null&&lu(s,s.memoizedProps,o.memoizedProps)}break;case 27:Kt(n,s),zt(s),d&512&&(lt||o===null||Li(o,o.return)),o!==null&&d&4&&lu(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Kt(n,s),zt(s),d&512&&(lt||o===null||Li(o,o.return)),s.flags&32){g=s.stateNode;try{Sn(g,"")}catch(X){Ye(s,s.return,X)}}d&4&&s.stateNode!=null&&(g=s.memoizedProps,lu(s,g,o!==null?o.memoizedProps:g)),d&1024&&(uu=!0);break;case 6:if(Kt(n,s),zt(s),d&4){if(s.stateNode===null)throw Error(i(162));d=s.memoizedProps,o=s.stateNode;try{o.nodeValue=d}catch(X){Ye(s,s.return,X)}}break;case 3:if(Ul=null,g=xi,xi=Ml(n.containerInfo),Kt(n,s),xi=g,zt(s),d&4&&o!==null&&o.memoizedState.isDehydrated)try{da(n.containerInfo)}catch(X){Ye(s,s.return,X)}uu&&(uu=!1,ug(s));break;case 4:d=xi,xi=Ml(s.stateNode.containerInfo),Kt(n,s),zt(s),xi=d;break;case 12:Kt(n,s),zt(s);break;case 13:Kt(n,s),zt(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(yu=ze()),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,du(s,d)));break;case 22:g=s.memoizedState!==null;var k=o!==null&&o.memoizedState!==null,z=Wi,J=lt;if(Wi=z||g,lt=J||k,Kt(n,s),lt=J,Wi=z,zt(s),d&8192)e:for(n=s.stateNode,n._visibility=g?n._visibility&-2:n._visibility|1,g&&(o===null||k||Wi||lt||nn(s)),o=null,n=s;;){if(n.tag===5||n.tag===26){if(o===null){k=o=n;try{if(x=k.stateNode,g)R=x.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none";else{D=k.stateNode;var ne=k.memoizedProps.style,Y=ne!=null&&ne.hasOwnProperty("display")?ne.display:null;D.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(X){Ye(k,k.return,X)}}}else if(n.tag===6){if(o===null){k=n;try{k.stateNode.nodeValue=g?"":k.memoizedProps}catch(X){Ye(k,k.return,X)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===s)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break e;for(;n.sibling===null;){if(n.return===null||n.return===s)break e;o===n&&(o=null),n=n.return}o===n&&(o=null),n.sibling.return=n.return,n=n.sibling}d&4&&(d=s.updateQueue,d!==null&&(o=d.retryQueue,o!==null&&(d.retryQueue=null,du(s,o))));break;case 19:Kt(n,s),zt(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,du(s,d)));break;case 30:break;case 21:break;default:Kt(n,s),zt(s)}}function zt(s){var n=s.flags;if(n&2){try{for(var o,d=s.return;d!==null;){if(ig(d)){o=d;break}d=d.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var g=o.stateNode,x=ou(s);Tl(s,x,g);break;case 5:var R=o.stateNode;o.flags&32&&(Sn(R,""),o.flags&=-33);var D=ou(s);Tl(s,D,R);break;case 3:case 4:var k=o.stateNode.containerInfo,z=ou(s);cu(s,z,k);break;default:throw Error(i(161))}}catch(J){Ye(s,s.return,J)}s.flags&=-3}n&4096&&(s.flags&=-4097)}function ug(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var n=s;ug(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),s=s.sibling}}function xs(s,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)rg(s,n.alternate,n),n=n.sibling}function nn(s){for(s=s.child;s!==null;){var n=s;switch(n.tag){case 0:case 11:case 14:case 15:ys(4,n,n.return),nn(n);break;case 1:Li(n,n.return);var o=n.stateNode;typeof o.componentWillUnmount=="function"&&eg(n,n.return,o),nn(n);break;case 27:sa(n.stateNode);case 26:case 5:Li(n,n.return),nn(n);break;case 22:n.memoizedState===null&&nn(n);break;case 30:nn(n);break;default:nn(n)}s=s.sibling}}function vs(s,n,o){for(o=o&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var d=n.alternate,g=s,x=n,R=x.flags;switch(x.tag){case 0:case 11:case 15:vs(g,x,o),Yr(4,x);break;case 1:if(vs(g,x,o),d=x,g=d.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(z){Ye(d,d.return,z)}if(d=x,g=d.updateQueue,g!==null){var D=d.stateNode;try{var k=g.shared.hiddenCallbacks;if(k!==null)for(g.shared.hiddenCallbacks=null,g=0;g<k.length;g++)Ff(k[g],D)}catch(z){Ye(d,d.return,z)}}o&&R&64&&Jm(x),qr(x,x.return);break;case 27:sg(x);case 26:case 5:vs(g,x,o),o&&d===null&&R&4&&tg(x),qr(x,x.return);break;case 12:vs(g,x,o);break;case 13:vs(g,x,o),o&&R&4&&og(g,x);break;case 22:x.memoizedState===null&&vs(g,x,o),qr(x,x.return);break;case 30:break;default:vs(g,x,o)}n=n.sibling}}function hu(s,n){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(s=n.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&kr(o))}function fu(s,n){s=null,n.alternate!==null&&(s=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==s&&(n.refCount++,s!=null&&kr(s))}function _i(s,n,o,d){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)dg(s,n,o,d),n=n.sibling}function dg(s,n,o,d){var g=n.flags;switch(n.tag){case 0:case 11:case 15:_i(s,n,o,d),g&2048&&Yr(9,n);break;case 1:_i(s,n,o,d);break;case 3:_i(s,n,o,d),g&2048&&(s=null,n.alternate!==null&&(s=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==s&&(n.refCount++,s!=null&&kr(s)));break;case 12:if(g&2048){_i(s,n,o,d),s=n.stateNode;try{var x=n.memoizedProps,R=x.id,D=x.onPostCommit;typeof D=="function"&&D(R,n.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(k){Ye(n,n.return,k)}}else _i(s,n,o,d);break;case 13:_i(s,n,o,d);break;case 23:break;case 22:x=n.stateNode,R=n.alternate,n.memoizedState!==null?x._visibility&2?_i(s,n,o,d):Xr(s,n):x._visibility&2?_i(s,n,o,d):(x._visibility|=2,jn(s,n,o,d,(n.subtreeFlags&10256)!==0)),g&2048&&hu(R,n);break;case 24:_i(s,n,o,d),g&2048&&fu(n.alternate,n);break;default:_i(s,n,o,d)}}function jn(s,n,o,d,g){for(g=g&&(n.subtreeFlags&10256)!==0,n=n.child;n!==null;){var x=s,R=n,D=o,k=d,z=R.flags;switch(R.tag){case 0:case 11:case 15:jn(x,R,D,k,g),Yr(8,R);break;case 23:break;case 22:var J=R.stateNode;R.memoizedState!==null?J._visibility&2?jn(x,R,D,k,g):Xr(x,R):(J._visibility|=2,jn(x,R,D,k,g)),g&&z&2048&&hu(R.alternate,R);break;case 24:jn(x,R,D,k,g),g&&z&2048&&fu(R.alternate,R);break;default:jn(x,R,D,k,g)}n=n.sibling}}function Xr(s,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var o=s,d=n,g=d.flags;switch(d.tag){case 22:Xr(o,d),g&2048&&hu(d.alternate,d);break;case 24:Xr(o,d),g&2048&&fu(d.alternate,d);break;default:Xr(o,d)}n=n.sibling}}var Qr=8192;function $n(s){if(s.subtreeFlags&Qr)for(s=s.child;s!==null;)hg(s),s=s.sibling}function hg(s){switch(s.tag){case 26:$n(s),s.flags&Qr&&s.memoizedState!==null&&iS(xi,s.memoizedState,s.memoizedProps);break;case 5:$n(s);break;case 3:case 4:var n=xi;xi=Ml(s.stateNode.containerInfo),$n(s),xi=n;break;case 22:s.memoizedState===null&&(n=s.alternate,n!==null&&n.memoizedState!==null?(n=Qr,Qr=16777216,$n(s),Qr=n):$n(s));break;default:$n(s)}}function fg(s){var n=s.alternate;if(n!==null&&(s=n.child,s!==null)){n.child=null;do n=s.sibling,s.sibling=null,s=n;while(s!==null)}}function Wr(s){var n=s.deletions;if((s.flags&16)!==0){if(n!==null)for(var o=0;o<n.length;o++){var d=n[o];yt=d,gg(d,s)}fg(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)mg(s),s=s.sibling}function mg(s){switch(s.tag){case 0:case 11:case 15:Wr(s),s.flags&2048&&ys(9,s,s.return);break;case 3:Wr(s);break;case 12:Wr(s);break;case 22:var n=s.stateNode;s.memoizedState!==null&&n._visibility&2&&(s.return===null||s.return.tag!==13)?(n._visibility&=-3,bl(s)):Wr(s);break;default:Wr(s)}}function bl(s){var n=s.deletions;if((s.flags&16)!==0){if(n!==null)for(var o=0;o<n.length;o++){var d=n[o];yt=d,gg(d,s)}fg(s)}for(s=s.child;s!==null;){switch(n=s,n.tag){case 0:case 11:case 15:ys(8,n,n.return),bl(n);break;case 22:o=n.stateNode,o._visibility&2&&(o._visibility&=-3,bl(n));break;default:bl(n)}s=s.sibling}}function gg(s,n){for(;yt!==null;){var o=yt;switch(o.tag){case 0:case 11:case 15:ys(8,o,n);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var d=o.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:kr(o.memoizedState.cache)}if(d=o.child,d!==null)d.return=o,yt=d;else e:for(o=s;yt!==null;){d=yt;var g=d.sibling,x=d.return;if(ag(d),d===o){yt=null;break e}if(g!==null){g.return=x,yt=g;break e}yt=x}}}var xE={getCacheForType:function(s){var n=Dt(dt),o=n.data.get(s);return o===void 0&&(o=s(),n.data.set(s,o)),o}},vE=typeof WeakMap=="function"?WeakMap:Map,Be=0,Qe=null,Ce=null,ke=0,Fe=0,Yt=null,Es=!1,Gn=!1,mu=!1,Ji=0,st=0,Ss=0,rn=0,gu=0,ui=0,Hn=0,Zr=null,jt=null,pu=!1,yu=0,Al=1/0,Rl=null,Ts=null,St=0,bs=null,Vn=null,Kn=0,xu=0,vu=null,pg=null,Jr=0,Eu=null;function qt(){if((Be&2)!==0&&ke!==0)return ke&-ke;if(M.T!==null){var s=Nn;return s!==0?s:_u()}return wh()}function yg(){ui===0&&(ui=(ke&536870912)===0||Me?_h():536870912);var s=ci.current;return s!==null&&(s.flags|=32),ui}function Xt(s,n,o){(s===Qe&&(Fe===2||Fe===9)||s.cancelPendingCommit!==null)&&(zn(s,0),As(s,ke,ui,!1)),yr(s,o),((Be&2)===0||s!==Qe)&&(s===Qe&&((Be&2)===0&&(rn|=o),st===4&&As(s,ke,ui,!1)),Di(s))}function xg(s,n,o){if((Be&6)!==0)throw Error(i(327));var d=!o&&(n&124)===0&&(n&s.expiredLanes)===0||pr(s,n),g=d?TE(s,n):bu(s,n,!0),x=d;do{if(g===0){Gn&&!d&&As(s,n,0,!1);break}else{if(o=s.current.alternate,x&&!EE(o)){g=bu(s,n,!1),x=!1;continue}if(g===2){if(x=n,s.errorRecoveryDisabledLanes&x)var R=0;else R=s.pendingLanes&-536870913,R=R!==0?R:R&536870912?536870912:0;if(R!==0){n=R;e:{var D=s;g=Zr;var k=D.current.memoizedState.isDehydrated;if(k&&(zn(D,R).flags|=256),R=bu(D,R,!1),R!==2){if(mu&&!k){D.errorRecoveryDisabledLanes|=x,rn|=x,g=4;break e}x=jt,jt=g,x!==null&&(jt===null?jt=x:jt.push.apply(jt,x))}g=R}if(x=!1,g!==2)continue}}if(g===1){zn(s,0),As(s,n,0,!0);break}e:{switch(d=s,x=g,x){case 0:case 1:throw Error(i(345));case 4:if((n&4194048)!==n)break;case 6:As(d,n,ui,!Es);break e;case 2:jt=null;break;case 3:case 5:break;default:throw Error(i(329))}if((n&62914560)===n&&(g=yu+300-ze(),10<g)){if(As(d,n,ui,!Es),Pa(d,0,!0)!==0)break e;d.timeoutHandle=Yg(vg.bind(null,d,o,jt,Rl,pu,n,ui,rn,Hn,Es,x,2,-0,0),g);break e}vg(d,o,jt,Rl,pu,n,ui,rn,Hn,Es,x,0,-0,0)}}break}while(!0);Di(s)}function vg(s,n,o,d,g,x,R,D,k,z,J,ne,Y,X){if(s.timeoutHandle=-1,ne=n.subtreeFlags,(ne&8192||(ne&16785408)===16785408)&&(aa={stylesheets:null,count:0,unsuspend:tS},hg(n),ne=sS(),ne!==null)){s.cancelPendingCommit=ne(Lg.bind(null,s,n,x,o,d,g,R,D,k,J,1,Y,X)),As(s,x,R,!z);return}Lg(s,n,x,o,d,g,R,D,k)}function EE(s){for(var n=s;;){var o=n.tag;if((o===0||o===11||o===15)&&n.flags&16384&&(o=n.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var d=0;d<o.length;d++){var g=o[d],x=g.getSnapshot;g=g.value;try{if(!Ht(x(),g))return!1}catch{return!1}}if(o=n.child,n.subtreeFlags&16384&&o!==null)o.return=n,n=o;else{if(n===s)break;for(;n.sibling===null;){if(n.return===null||n.return===s)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function As(s,n,o,d){n&=~gu,n&=~rn,s.suspendedLanes|=n,s.pingedLanes&=~n,d&&(s.warmLanes|=n),d=s.expirationTimes;for(var g=n;0<g;){var x=31-Lt(g),R=1<<x;d[x]=-1,g&=~R}o!==0&&Ih(s,o,n)}function Ll(){return(Be&6)===0?(ea(0),!1):!0}function Su(){if(Ce!==null){if(Fe===0)var s=Ce.return;else s=Ce,Ki=Zs=null,Bc(s),Bn=null,Vr=0,s=Ce;for(;s!==null;)Zm(s.alternate,s),s=s.return;Ce=null}}function zn(s,n){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,BE(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),Su(),Qe=s,Ce=o=Gi(s.current,null),ke=n,Fe=0,Yt=null,Es=!1,Gn=pr(s,n),mu=!1,Hn=ui=gu=rn=Ss=st=0,jt=Zr=null,pu=!1,(n&8)!==0&&(n|=n&32);var d=s.entangledLanes;if(d!==0)for(s=s.entanglements,d&=n;0<d;){var g=31-Lt(d),x=1<<g;n|=s[g],d&=~x}return Ji=n,qa(),o}function Eg(s,n){Le=null,M.H=fl,n===Mr||n===sl?(n=Uf(),Fe=3):n===Of?(n=Uf(),Fe=4):Fe=n===Bm?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,Yt=n,Ce===null&&(st=1,xl(s,ri(n,s.current)))}function Sg(){var s=M.H;return M.H=fl,s===null?fl:s}function Tg(){var s=M.A;return M.A=xE,s}function Tu(){st=4,Es||(ke&4194048)!==ke&&ci.current!==null||(Gn=!0),(Ss&134217727)===0&&(rn&134217727)===0||Qe===null||As(Qe,ke,ui,!1)}function bu(s,n,o){var d=Be;Be|=2;var g=Sg(),x=Tg();(Qe!==s||ke!==n)&&(Rl=null,zn(s,n)),n=!1;var R=st;e:do try{if(Fe!==0&&Ce!==null){var D=Ce,k=Yt;switch(Fe){case 8:Su(),R=6;break e;case 3:case 2:case 9:case 6:ci.current===null&&(n=!0);var z=Fe;if(Fe=0,Yt=null,Yn(s,D,k,z),o&&Gn){R=0;break e}break;default:z=Fe,Fe=0,Yt=null,Yn(s,D,k,z)}}SE(),R=st;break}catch(J){Eg(s,J)}while(!0);return n&&s.shellSuspendCounter++,Ki=Zs=null,Be=d,M.H=g,M.A=x,Ce===null&&(Qe=null,ke=0,qa()),R}function SE(){for(;Ce!==null;)bg(Ce)}function TE(s,n){var o=Be;Be|=2;var d=Sg(),g=Tg();Qe!==s||ke!==n?(Rl=null,Al=ze()+500,zn(s,n)):Gn=pr(s,n);e:do try{if(Fe!==0&&Ce!==null){n=Ce;var x=Yt;t:switch(Fe){case 1:Fe=0,Yt=null,Yn(s,n,x,1);break;case 2:case 9:if(Mf(x)){Fe=0,Yt=null,Ag(n);break}n=function(){Fe!==2&&Fe!==9||Qe!==s||(Fe=7),Di(s)},x.then(n,n);break e;case 3:Fe=7;break e;case 4:Fe=5;break e;case 7:Mf(x)?(Fe=0,Yt=null,Ag(n)):(Fe=0,Yt=null,Yn(s,n,x,7));break;case 5:var R=null;switch(Ce.tag){case 26:R=Ce.memoizedState;case 5:case 27:var D=Ce;if(!R||r0(R)){Fe=0,Yt=null;var k=D.sibling;if(k!==null)Ce=k;else{var z=D.return;z!==null?(Ce=z,_l(z)):Ce=null}break t}}Fe=0,Yt=null,Yn(s,n,x,5);break;case 6:Fe=0,Yt=null,Yn(s,n,x,6);break;case 8:Su(),st=6;break e;default:throw Error(i(462))}}bE();break}catch(J){Eg(s,J)}while(!0);return Ki=Zs=null,M.H=d,M.A=g,Be=o,Ce!==null?0:(Qe=null,ke=0,qa(),st)}function bE(){for(;Ce!==null&&!Lh();)bg(Ce)}function bg(s){var n=Qm(s.alternate,s,Ji);s.memoizedProps=s.pendingProps,n===null?_l(s):Ce=n}function Ag(s){var n=s,o=n.alternate;switch(n.tag){case 15:case 0:n=Vm(o,n,n.pendingProps,n.type,void 0,ke);break;case 11:n=Vm(o,n,n.pendingProps,n.type.render,n.ref,ke);break;case 5:Bc(n);default:Zm(o,n),n=Ce=Rf(n,Ji),n=Qm(o,n,Ji)}s.memoizedProps=s.pendingProps,n===null?_l(s):Ce=n}function Yn(s,n,o,d){Ki=Zs=null,Bc(n),Bn=null,Vr=0;var g=n.return;try{if(hE(s,g,n,o,ke)){st=1,xl(s,ri(o,s.current)),Ce=null;return}}catch(x){if(g!==null)throw Ce=g,x;st=1,xl(s,ri(o,s.current)),Ce=null;return}n.flags&32768?(Me||d===1?s=!0:Gn||(ke&536870912)!==0?s=!1:(Es=s=!0,(d===2||d===9||d===3||d===6)&&(d=ci.current,d!==null&&d.tag===13&&(d.flags|=16384))),Rg(n,s)):_l(n)}function _l(s){var n=s;do{if((n.flags&32768)!==0){Rg(n,Es);return}s=n.return;var o=mE(n.alternate,n,Ji);if(o!==null){Ce=o;return}if(n=n.sibling,n!==null){Ce=n;return}Ce=n=s}while(n!==null);st===0&&(st=5)}function Rg(s,n){do{var o=gE(s.alternate,s);if(o!==null){o.flags&=32767,Ce=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!n&&(s=s.sibling,s!==null)){Ce=s;return}Ce=s=o}while(s!==null);st=6,Ce=null}function Lg(s,n,o,d,g,x,R,D,k){s.cancelPendingCommit=null;do Dl();while(St!==0);if((Be&6)!==0)throw Error(i(327));if(n!==null){if(n===s.current)throw Error(i(177));if(x=n.lanes|n.childLanes,x|=fc,tv(s,o,x,R,D,k),s===Qe&&(Ce=Qe=null,ke=0),Vn=n,bs=s,Kn=o,xu=x,vu=g,pg=d,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,_E(gi,function(){return wg(),null})):(s.callbackNode=null,s.callbackPriority=0),d=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||d){d=M.T,M.T=null,g=Q.p,Q.p=2,R=Be,Be|=4;try{pE(s,n,o)}finally{Be=R,Q.p=g,M.T=d}}St=1,_g(),Dg(),Ig()}}function _g(){if(St===1){St=0;var s=bs,n=Vn,o=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||o){o=M.T,M.T=null;var d=Q.p;Q.p=2;var g=Be;Be|=4;try{cg(n,s);var x=Mu,R=gf(s.containerInfo),D=x.focusedElem,k=x.selectionRange;if(R!==D&&D&&D.ownerDocument&&mf(D.ownerDocument.documentElement,D)){if(k!==null&&oc(D)){var z=k.start,J=k.end;if(J===void 0&&(J=z),"selectionStart"in D)D.selectionStart=z,D.selectionEnd=Math.min(J,D.value.length);else{var ne=D.ownerDocument||document,Y=ne&&ne.defaultView||window;if(Y.getSelection){var X=Y.getSelection(),Ee=D.textContent.length,xe=Math.min(k.start,Ee),Ve=k.end===void 0?xe:Math.min(k.end,Ee);!X.extend&&xe>Ve&&(R=Ve,Ve=xe,xe=R);var $=ff(D,xe),P=ff(D,Ve);if($&&P&&(X.rangeCount!==1||X.anchorNode!==$.node||X.anchorOffset!==$.offset||X.focusNode!==P.node||X.focusOffset!==P.offset)){var V=ne.createRange();V.setStart($.node,$.offset),X.removeAllRanges(),xe>Ve?(X.addRange(V),X.extend(P.node,P.offset)):(V.setEnd(P.node,P.offset),X.addRange(V))}}}}for(ne=[],X=D;X=X.parentNode;)X.nodeType===1&&ne.push({element:X,left:X.scrollLeft,top:X.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<ne.length;D++){var ie=ne[D];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}jl=!!Ou,Mu=Ou=null}finally{Be=g,Q.p=d,M.T=o}}s.current=n,St=2}}function Dg(){if(St===2){St=0;var s=bs,n=Vn,o=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||o){o=M.T,M.T=null;var d=Q.p;Q.p=2;var g=Be;Be|=4;try{rg(s,n.alternate,n)}finally{Be=g,Q.p=d,M.T=o}}St=3}}function Ig(){if(St===4||St===3){St=0,Ne();var s=bs,n=Vn,o=Kn,d=pg;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?St=5:(St=0,Vn=bs=null,Cg(s,s.pendingLanes));var g=s.pendingLanes;if(g===0&&(Ts=null),$o(o),n=n.stateNode,Rt&&typeof Rt.onCommitFiberRoot=="function")try{Rt.onCommitFiberRoot(pi,n,void 0,(n.current.flags&128)===128)}catch{}if(d!==null){n=M.T,g=Q.p,Q.p=2,M.T=null;try{for(var x=s.onRecoverableError,R=0;R<d.length;R++){var D=d[R];x(D.value,{componentStack:D.stack})}}finally{M.T=n,Q.p=g}}(Kn&3)!==0&&Dl(),Di(s),g=s.pendingLanes,(o&4194090)!==0&&(g&42)!==0?s===Eu?Jr++:(Jr=0,Eu=s):Jr=0,ea(0)}}function Cg(s,n){(s.pooledCacheLanes&=n)===0&&(n=s.pooledCache,n!=null&&(s.pooledCache=null,kr(n)))}function Dl(s){return _g(),Dg(),Ig(),wg()}function wg(){if(St!==5)return!1;var s=bs,n=xu;xu=0;var o=$o(Kn),d=M.T,g=Q.p;try{Q.p=32>o?32:o,M.T=null,o=vu,vu=null;var x=bs,R=Kn;if(St=0,Vn=bs=null,Kn=0,(Be&6)!==0)throw Error(i(331));var D=Be;if(Be|=4,mg(x.current),dg(x,x.current,R,o),Be=D,ea(0,!1),Rt&&typeof Rt.onPostCommitFiberRoot=="function")try{Rt.onPostCommitFiberRoot(pi,x)}catch{}return!0}finally{Q.p=g,M.T=d,Cg(s,n)}}function Ng(s,n,o){n=ri(o,n),n=Zc(s.stateNode,n,2),s=fs(s,n,2),s!==null&&(yr(s,2),Di(s))}function Ye(s,n,o){if(s.tag===3)Ng(s,s,o);else for(;n!==null;){if(n.tag===3){Ng(n,s,o);break}else if(n.tag===1){var d=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Ts===null||!Ts.has(d))){s=ri(o,s),o=Pm(2),d=fs(n,o,2),d!==null&&(Um(o,d,n,s),yr(d,2),Di(d));break}}n=n.return}}function Au(s,n,o){var d=s.pingCache;if(d===null){d=s.pingCache=new vE;var g=new Set;d.set(n,g)}else g=d.get(n),g===void 0&&(g=new Set,d.set(n,g));g.has(o)||(mu=!0,g.add(o),s=AE.bind(null,s,n,o),n.then(s,s))}function AE(s,n,o){var d=s.pingCache;d!==null&&d.delete(n),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,Qe===s&&(ke&o)===o&&(st===4||st===3&&(ke&62914560)===ke&&300>ze()-yu?(Be&2)===0&&zn(s,0):gu|=o,Hn===ke&&(Hn=0)),Di(s)}function kg(s,n){n===0&&(n=Dh()),s=Dn(s,n),s!==null&&(yr(s,n),Di(s))}function RE(s){var n=s.memoizedState,o=0;n!==null&&(o=n.retryLane),kg(s,o)}function LE(s,n){var o=0;switch(s.tag){case 13:var d=s.stateNode,g=s.memoizedState;g!==null&&(o=g.retryLane);break;case 19:d=s.stateNode;break;case 22:d=s.stateNode._retryCache;break;default:throw Error(i(314))}d!==null&&d.delete(n),kg(s,o)}function _E(s,n){return Fs(s,n)}var Il=null,qn=null,Ru=!1,Cl=!1,Lu=!1,an=0;function Di(s){s!==qn&&s.next===null&&(qn===null?Il=qn=s:qn=qn.next=s),Cl=!0,Ru||(Ru=!0,IE())}function ea(s,n){if(!Lu&&Cl){Lu=!0;do for(var o=!1,d=Il;d!==null;){if(s!==0){var g=d.pendingLanes;if(g===0)var x=0;else{var R=d.suspendedLanes,D=d.pingedLanes;x=(1<<31-Lt(42|s)+1)-1,x&=g&~(R&~D),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(o=!0,Ug(d,x))}else x=ke,x=Pa(d,d===Qe?x:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(x&3)===0||pr(d,x)||(o=!0,Ug(d,x));d=d.next}while(o);Lu=!1}}function DE(){Og()}function Og(){Cl=Ru=!1;var s=0;an!==0&&(UE()&&(s=an),an=0);for(var n=ze(),o=null,d=Il;d!==null;){var g=d.next,x=Mg(d,n);x===0?(d.next=null,o===null?Il=g:o.next=g,g===null&&(qn=o)):(o=d,(s!==0||(x&3)!==0)&&(Cl=!0)),d=g}ea(s)}function Mg(s,n){for(var o=s.suspendedLanes,d=s.pingedLanes,g=s.expirationTimes,x=s.pendingLanes&-62914561;0<x;){var R=31-Lt(x),D=1<<R,k=g[R];k===-1?((D&o)===0||(D&d)!==0)&&(g[R]=ev(D,n)):k<=n&&(s.expiredLanes|=D),x&=~D}if(n=Qe,o=ke,o=Pa(s,s===n?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d=s.callbackNode,o===0||s===n&&(Fe===2||Fe===9)||s.cancelPendingCommit!==null)return d!==null&&d!==null&&js(d),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||pr(s,o)){if(n=o&-o,n===s.callbackPriority)return n;switch(d!==null&&js(d),$o(o)){case 2:case 8:o=Mt;break;case 32:o=gi;break;case 268435456:o=gr;break;default:o=gi}return d=Pg.bind(null,s),o=Fs(o,d),s.callbackPriority=n,s.callbackNode=o,n}return d!==null&&d!==null&&js(d),s.callbackPriority=2,s.callbackNode=null,2}function Pg(s,n){if(St!==0&&St!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Dl()&&s.callbackNode!==o)return null;var d=ke;return d=Pa(s,s===Qe?d:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d===0?null:(xg(s,d,n),Mg(s,ze()),s.callbackNode!=null&&s.callbackNode===o?Pg.bind(null,s):null)}function Ug(s,n){if(Dl())return null;xg(s,n,!0)}function IE(){FE(function(){(Be&6)!==0?Fs(Ti,DE):Og()})}function _u(){return an===0&&(an=_h()),an}function Bg(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:$a(""+s)}function Fg(s,n){var o=n.ownerDocument.createElement("input");return o.name=n.name,o.value=n.value,s.id&&o.setAttribute("form",s.id),n.parentNode.insertBefore(o,n),s=new FormData(s),o.parentNode.removeChild(o),s}function CE(s,n,o,d,g){if(n==="submit"&&o&&o.stateNode===g){var x=Bg((g[Pt]||null).action),R=d.submitter;R&&(n=(n=R[Pt]||null)?Bg(n.formAction):R.getAttribute("formAction"),n!==null&&(x=n,R=null));var D=new Ka("action","action",null,d,g);s.push({event:D,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(an!==0){var k=R?Fg(g,R):new FormData(g);Yc(o,{pending:!0,data:k,method:g.method,action:x},null,k)}}else typeof x=="function"&&(D.preventDefault(),k=R?Fg(g,R):new FormData(g),Yc(o,{pending:!0,data:k,method:g.method,action:x},x,k))},currentTarget:g}]})}}for(var Du=0;Du<hc.length;Du++){var Iu=hc[Du],wE=Iu.toLowerCase(),NE=Iu[0].toUpperCase()+Iu.slice(1);yi(wE,"on"+NE)}yi(xf,"onAnimationEnd"),yi(vf,"onAnimationIteration"),yi(Ef,"onAnimationStart"),yi("dblclick","onDoubleClick"),yi("focusin","onFocus"),yi("focusout","onBlur"),yi(Xv,"onTransitionRun"),yi(Qv,"onTransitionStart"),yi(Wv,"onTransitionCancel"),yi(Sf,"onTransitionEnd"),xn("onMouseEnter",["mouseout","mouseover"]),xn("onMouseLeave",["mouseout","mouseover"]),xn("onPointerEnter",["pointerout","pointerover"]),xn("onPointerLeave",["pointerout","pointerover"]),Hs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Hs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Hs("onBeforeInput",["compositionend","keypress","textInput","paste"]),Hs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Hs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Hs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ta="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ta));function jg(s,n){n=(n&4)!==0;for(var o=0;o<s.length;o++){var d=s[o],g=d.event;d=d.listeners;e:{var x=void 0;if(n)for(var R=d.length-1;0<=R;R--){var D=d[R],k=D.instance,z=D.currentTarget;if(D=D.listener,k!==x&&g.isPropagationStopped())break e;x=D,g.currentTarget=z;try{x(g)}catch(J){yl(J)}g.currentTarget=null,x=k}else for(R=0;R<d.length;R++){if(D=d[R],k=D.instance,z=D.currentTarget,D=D.listener,k!==x&&g.isPropagationStopped())break e;x=D,g.currentTarget=z;try{x(g)}catch(J){yl(J)}g.currentTarget=null,x=k}}}}function we(s,n){var o=n[Go];o===void 0&&(o=n[Go]=new Set);var d=s+"__bubble";o.has(d)||($g(n,s,2,!1),o.add(d))}function Cu(s,n,o){var d=0;n&&(d|=4),$g(o,s,d,n)}var wl="_reactListening"+Math.random().toString(36).slice(2);function wu(s){if(!s[wl]){s[wl]=!0,kh.forEach(function(o){o!=="selectionchange"&&(kE.has(o)||Cu(o,!1,s),Cu(o,!0,s))});var n=s.nodeType===9?s:s.ownerDocument;n===null||n[wl]||(n[wl]=!0,Cu("selectionchange",!1,n))}}function $g(s,n,o,d){switch(d0(n)){case 2:var g=aS;break;case 8:g=lS;break;default:g=Ku}o=g.bind(null,n,o,s),g=void 0,!Jo||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(g=!0),d?g!==void 0?s.addEventListener(n,o,{capture:!0,passive:g}):s.addEventListener(n,o,!0):g!==void 0?s.addEventListener(n,o,{passive:g}):s.addEventListener(n,o,!1)}function Nu(s,n,o,d,g){var x=d;if((n&1)===0&&(n&2)===0&&d!==null)e:for(;;){if(d===null)return;var R=d.tag;if(R===3||R===4){var D=d.stateNode.containerInfo;if(D===g)break;if(R===4)for(R=d.return;R!==null;){var k=R.tag;if((k===3||k===4)&&R.stateNode.containerInfo===g)return;R=R.return}for(;D!==null;){if(R=gn(D),R===null)return;if(k=R.tag,k===5||k===6||k===26||k===27){d=x=R;continue e}D=D.parentNode}}d=d.return}Yh(function(){var z=x,J=Wo(o),ne=[];e:{var Y=Tf.get(s);if(Y!==void 0){var X=Ka,Ee=s;switch(s){case"keypress":if(Ha(o)===0)break e;case"keydown":case"keyup":X=_v;break;case"focusin":Ee="focus",X=sc;break;case"focusout":Ee="blur",X=sc;break;case"beforeblur":case"afterblur":X=sc;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":X=Qh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":X=gv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":X=Cv;break;case xf:case vf:case Ef:X=xv;break;case Sf:X=Nv;break;case"scroll":case"scrollend":X=fv;break;case"wheel":X=Ov;break;case"copy":case"cut":case"paste":X=Ev;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":X=Zh;break;case"toggle":case"beforetoggle":X=Pv}var xe=(n&4)!==0,Ve=!xe&&(s==="scroll"||s==="scrollend"),$=xe?Y!==null?Y+"Capture":null:Y;xe=[];for(var P=z,V;P!==null;){var ie=P;if(V=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||V===null||$===null||(ie=Er(P,$),ie!=null&&xe.push(ia(P,ie,V))),Ve)break;P=P.return}0<xe.length&&(Y=new X(Y,Ee,null,o,J),ne.push({event:Y,listeners:xe}))}}if((n&7)===0){e:{if(Y=s==="mouseover"||s==="pointerover",X=s==="mouseout"||s==="pointerout",Y&&o!==Qo&&(Ee=o.relatedTarget||o.fromElement)&&(gn(Ee)||Ee[mn]))break e;if((X||Y)&&(Y=J.window===J?J:(Y=J.ownerDocument)?Y.defaultView||Y.parentWindow:window,X?(Ee=o.relatedTarget||o.toElement,X=z,Ee=Ee?gn(Ee):null,Ee!==null&&(Ve=a(Ee),xe=Ee.tag,Ee!==Ve||xe!==5&&xe!==27&&xe!==6)&&(Ee=null)):(X=null,Ee=z),X!==Ee)){if(xe=Qh,ie="onMouseLeave",$="onMouseEnter",P="mouse",(s==="pointerout"||s==="pointerover")&&(xe=Zh,ie="onPointerLeave",$="onPointerEnter",P="pointer"),Ve=X==null?Y:vr(X),V=Ee==null?Y:vr(Ee),Y=new xe(ie,P+"leave",X,o,J),Y.target=Ve,Y.relatedTarget=V,ie=null,gn(J)===z&&(xe=new xe($,P+"enter",Ee,o,J),xe.target=V,xe.relatedTarget=Ve,ie=xe),Ve=ie,X&&Ee)t:{for(xe=X,$=Ee,P=0,V=xe;V;V=Xn(V))P++;for(V=0,ie=$;ie;ie=Xn(ie))V++;for(;0<P-V;)xe=Xn(xe),P--;for(;0<V-P;)$=Xn($),V--;for(;P--;){if(xe===$||$!==null&&xe===$.alternate)break t;xe=Xn(xe),$=Xn($)}xe=null}else xe=null;X!==null&&Gg(ne,Y,X,xe,!1),Ee!==null&&Ve!==null&&Gg(ne,Ve,Ee,xe,!0)}}e:{if(Y=z?vr(z):window,X=Y.nodeName&&Y.nodeName.toLowerCase(),X==="select"||X==="input"&&Y.type==="file")var ge=lf;else if(rf(Y))if(of)ge=zv;else{ge=Vv;var De=Hv}else X=Y.nodeName,!X||X.toLowerCase()!=="input"||Y.type!=="checkbox"&&Y.type!=="radio"?z&&Xo(z.elementType)&&(ge=lf):ge=Kv;if(ge&&(ge=ge(s,z))){af(ne,ge,o,J);break e}De&&De(s,Y,z),s==="focusout"&&z&&Y.type==="number"&&z.memoizedProps.value!=null&&qo(Y,"number",Y.value)}switch(De=z?vr(z):window,s){case"focusin":(rf(De)||De.contentEditable==="true")&&(Rn=De,cc=z,Dr=null);break;case"focusout":Dr=cc=Rn=null;break;case"mousedown":uc=!0;break;case"contextmenu":case"mouseup":case"dragend":uc=!1,pf(ne,o,J);break;case"selectionchange":if(qv)break;case"keydown":case"keyup":pf(ne,o,J)}var ye;if(rc)e:{switch(s){case"compositionstart":var ve="onCompositionStart";break e;case"compositionend":ve="onCompositionEnd";break e;case"compositionupdate":ve="onCompositionUpdate";break e}ve=void 0}else An?sf(s,o)&&(ve="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(ve="onCompositionStart");ve&&(Jh&&o.locale!=="ko"&&(An||ve!=="onCompositionStart"?ve==="onCompositionEnd"&&An&&(ye=qh()):(cs=J,ec="value"in cs?cs.value:cs.textContent,An=!0)),De=Nl(z,ve),0<De.length&&(ve=new Wh(ve,s,null,o,J),ne.push({event:ve,listeners:De}),ye?ve.data=ye:(ye=nf(o),ye!==null&&(ve.data=ye)))),(ye=Bv?Fv(s,o):jv(s,o))&&(ve=Nl(z,"onBeforeInput"),0<ve.length&&(De=new Wh("onBeforeInput","beforeinput",null,o,J),ne.push({event:De,listeners:ve}),De.data=ye)),CE(ne,s,z,o,J)}jg(ne,n)})}function ia(s,n,o){return{instance:s,listener:n,currentTarget:o}}function Nl(s,n){for(var o=n+"Capture",d=[];s!==null;){var g=s,x=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||x===null||(g=Er(s,o),g!=null&&d.unshift(ia(s,g,x)),g=Er(s,n),g!=null&&d.push(ia(s,g,x))),s.tag===3)return d;s=s.return}return[]}function Xn(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Gg(s,n,o,d,g){for(var x=n._reactName,R=[];o!==null&&o!==d;){var D=o,k=D.alternate,z=D.stateNode;if(D=D.tag,k!==null&&k===d)break;D!==5&&D!==26&&D!==27||z===null||(k=z,g?(z=Er(o,x),z!=null&&R.unshift(ia(o,z,k))):g||(z=Er(o,x),z!=null&&R.push(ia(o,z,k)))),o=o.return}R.length!==0&&s.push({event:n,listeners:R})}var OE=/\r\n?/g,ME=/\u0000|\uFFFD/g;function Hg(s){return(typeof s=="string"?s:""+s).replace(OE,`
`).replace(ME,"")}function Vg(s,n){return n=Hg(n),Hg(s)===n}function kl(){}function He(s,n,o,d,g,x){switch(o){case"children":typeof d=="string"?n==="body"||n==="textarea"&&d===""||Sn(s,d):(typeof d=="number"||typeof d=="bigint")&&n!=="body"&&Sn(s,""+d);break;case"className":Ba(s,"class",d);break;case"tabIndex":Ba(s,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":Ba(s,o,d);break;case"style":Kh(s,d,x);break;case"data":if(n!=="object"){Ba(s,"data",d);break}case"src":case"href":if(d===""&&(n!=="a"||o!=="href")){s.removeAttribute(o);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(o);break}d=$a(""+d),s.setAttribute(o,d);break;case"action":case"formAction":if(typeof d=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(o==="formAction"?(n!=="input"&&He(s,n,"name",g.name,g,null),He(s,n,"formEncType",g.formEncType,g,null),He(s,n,"formMethod",g.formMethod,g,null),He(s,n,"formTarget",g.formTarget,g,null)):(He(s,n,"encType",g.encType,g,null),He(s,n,"method",g.method,g,null),He(s,n,"target",g.target,g,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(o);break}d=$a(""+d),s.setAttribute(o,d);break;case"onClick":d!=null&&(s.onclick=kl);break;case"onScroll":d!=null&&we("scroll",s);break;case"onScrollEnd":d!=null&&we("scrollend",s);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(o=d.__html,o!=null){if(g.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":s.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){s.removeAttribute("xlink:href");break}o=$a(""+d),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(o,""+d):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":d===!0?s.setAttribute(o,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(o,d):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?s.setAttribute(o,d):s.removeAttribute(o);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?s.removeAttribute(o):s.setAttribute(o,d);break;case"popover":we("beforetoggle",s),we("toggle",s),Ua(s,"popover",d);break;case"xlinkActuate":ji(s,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":ji(s,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":ji(s,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":ji(s,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":ji(s,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":ji(s,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":ji(s,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":ji(s,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":ji(s,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":Ua(s,"is",d);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=dv.get(o)||o,Ua(s,o,d))}}function ku(s,n,o,d,g,x){switch(o){case"style":Kh(s,d,x);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(o=d.__html,o!=null){if(g.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof d=="string"?Sn(s,d):(typeof d=="number"||typeof d=="bigint")&&Sn(s,""+d);break;case"onScroll":d!=null&&we("scroll",s);break;case"onScrollEnd":d!=null&&we("scrollend",s);break;case"onClick":d!=null&&(s.onclick=kl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Oh.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(g=o.endsWith("Capture"),n=o.slice(2,g?o.length-7:void 0),x=s[Pt]||null,x=x!=null?x[o]:null,typeof x=="function"&&s.removeEventListener(n,x,g),typeof d=="function")){typeof x!="function"&&x!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(n,d,g);break e}o in s?s[o]=d:d===!0?s.setAttribute(o,""):Ua(s,o,d)}}}function Tt(s,n,o){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":we("error",s),we("load",s);var d=!1,g=!1,x;for(x in o)if(o.hasOwnProperty(x)){var R=o[x];if(R!=null)switch(x){case"src":d=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,n));default:He(s,n,x,R,o,null)}}g&&He(s,n,"srcSet",o.srcSet,o,null),d&&He(s,n,"src",o.src,o,null);return;case"input":we("invalid",s);var D=x=R=g=null,k=null,z=null;for(d in o)if(o.hasOwnProperty(d)){var J=o[d];if(J!=null)switch(d){case"name":g=J;break;case"type":R=J;break;case"checked":k=J;break;case"defaultChecked":z=J;break;case"value":x=J;break;case"defaultValue":D=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(i(137,n));break;default:He(s,n,d,J,o,null)}}$h(s,x,D,k,z,R,g,!1),Fa(s);return;case"select":we("invalid",s),d=R=x=null;for(g in o)if(o.hasOwnProperty(g)&&(D=o[g],D!=null))switch(g){case"value":x=D;break;case"defaultValue":R=D;break;case"multiple":d=D;default:He(s,n,g,D,o,null)}n=x,o=R,s.multiple=!!d,n!=null?En(s,!!d,n,!1):o!=null&&En(s,!!d,o,!0);return;case"textarea":we("invalid",s),x=g=d=null;for(R in o)if(o.hasOwnProperty(R)&&(D=o[R],D!=null))switch(R){case"value":d=D;break;case"defaultValue":g=D;break;case"children":x=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(i(91));break;default:He(s,n,R,D,o,null)}Hh(s,d,g,x),Fa(s);return;case"option":for(k in o)if(o.hasOwnProperty(k)&&(d=o[k],d!=null))switch(k){case"selected":s.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:He(s,n,k,d,o,null)}return;case"dialog":we("beforetoggle",s),we("toggle",s),we("cancel",s),we("close",s);break;case"iframe":case"object":we("load",s);break;case"video":case"audio":for(d=0;d<ta.length;d++)we(ta[d],s);break;case"image":we("error",s),we("load",s);break;case"details":we("toggle",s);break;case"embed":case"source":case"link":we("error",s),we("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(z in o)if(o.hasOwnProperty(z)&&(d=o[z],d!=null))switch(z){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,n));default:He(s,n,z,d,o,null)}return;default:if(Xo(n)){for(J in o)o.hasOwnProperty(J)&&(d=o[J],d!==void 0&&ku(s,n,J,d,o,void 0));return}}for(D in o)o.hasOwnProperty(D)&&(d=o[D],d!=null&&He(s,n,D,d,o,null))}function PE(s,n,o,d){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,x=null,R=null,D=null,k=null,z=null,J=null;for(X in o){var ne=o[X];if(o.hasOwnProperty(X)&&ne!=null)switch(X){case"checked":break;case"value":break;case"defaultValue":k=ne;default:d.hasOwnProperty(X)||He(s,n,X,null,d,ne)}}for(var Y in d){var X=d[Y];if(ne=o[Y],d.hasOwnProperty(Y)&&(X!=null||ne!=null))switch(Y){case"type":x=X;break;case"name":g=X;break;case"checked":z=X;break;case"defaultChecked":J=X;break;case"value":R=X;break;case"defaultValue":D=X;break;case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(i(137,n));break;default:X!==ne&&He(s,n,Y,X,d,ne)}}Yo(s,R,D,k,z,J,x,g);return;case"select":X=R=D=Y=null;for(x in o)if(k=o[x],o.hasOwnProperty(x)&&k!=null)switch(x){case"value":break;case"multiple":X=k;default:d.hasOwnProperty(x)||He(s,n,x,null,d,k)}for(g in d)if(x=d[g],k=o[g],d.hasOwnProperty(g)&&(x!=null||k!=null))switch(g){case"value":Y=x;break;case"defaultValue":D=x;break;case"multiple":R=x;default:x!==k&&He(s,n,g,x,d,k)}n=D,o=R,d=X,Y!=null?En(s,!!o,Y,!1):!!d!=!!o&&(n!=null?En(s,!!o,n,!0):En(s,!!o,o?[]:"",!1));return;case"textarea":X=Y=null;for(D in o)if(g=o[D],o.hasOwnProperty(D)&&g!=null&&!d.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:He(s,n,D,null,d,g)}for(R in d)if(g=d[R],x=o[R],d.hasOwnProperty(R)&&(g!=null||x!=null))switch(R){case"value":Y=g;break;case"defaultValue":X=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==x&&He(s,n,R,g,d,x)}Gh(s,Y,X);return;case"option":for(var Ee in o)if(Y=o[Ee],o.hasOwnProperty(Ee)&&Y!=null&&!d.hasOwnProperty(Ee))switch(Ee){case"selected":s.selected=!1;break;default:He(s,n,Ee,null,d,Y)}for(k in d)if(Y=d[k],X=o[k],d.hasOwnProperty(k)&&Y!==X&&(Y!=null||X!=null))switch(k){case"selected":s.selected=Y&&typeof Y!="function"&&typeof Y!="symbol";break;default:He(s,n,k,Y,d,X)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var xe in o)Y=o[xe],o.hasOwnProperty(xe)&&Y!=null&&!d.hasOwnProperty(xe)&&He(s,n,xe,null,d,Y);for(z in d)if(Y=d[z],X=o[z],d.hasOwnProperty(z)&&Y!==X&&(Y!=null||X!=null))switch(z){case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(i(137,n));break;default:He(s,n,z,Y,d,X)}return;default:if(Xo(n)){for(var Ve in o)Y=o[Ve],o.hasOwnProperty(Ve)&&Y!==void 0&&!d.hasOwnProperty(Ve)&&ku(s,n,Ve,void 0,d,Y);for(J in d)Y=d[J],X=o[J],!d.hasOwnProperty(J)||Y===X||Y===void 0&&X===void 0||ku(s,n,J,Y,d,X);return}}for(var $ in o)Y=o[$],o.hasOwnProperty($)&&Y!=null&&!d.hasOwnProperty($)&&He(s,n,$,null,d,Y);for(ne in d)Y=d[ne],X=o[ne],!d.hasOwnProperty(ne)||Y===X||Y==null&&X==null||He(s,n,ne,Y,d,X)}var Ou=null,Mu=null;function Ol(s){return s.nodeType===9?s:s.ownerDocument}function Kg(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function zg(s,n){if(s===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&n==="foreignObject"?0:s}function Pu(s,n){return s==="textarea"||s==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Uu=null;function UE(){var s=window.event;return s&&s.type==="popstate"?s===Uu?!1:(Uu=s,!0):(Uu=null,!1)}var Yg=typeof setTimeout=="function"?setTimeout:void 0,BE=typeof clearTimeout=="function"?clearTimeout:void 0,qg=typeof Promise=="function"?Promise:void 0,FE=typeof queueMicrotask=="function"?queueMicrotask:typeof qg<"u"?function(s){return qg.resolve(null).then(s).catch(jE)}:Yg;function jE(s){setTimeout(function(){throw s})}function Rs(s){return s==="head"}function Xg(s,n){var o=n,d=0,g=0;do{var x=o.nextSibling;if(s.removeChild(o),x&&x.nodeType===8)if(o=x.data,o==="/$"){if(0<d&&8>d){o=d;var R=s.ownerDocument;if(o&1&&sa(R.documentElement),o&2&&sa(R.body),o&4)for(o=R.head,sa(o),R=o.firstChild;R;){var D=R.nextSibling,k=R.nodeName;R[xr]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&R.rel.toLowerCase()==="stylesheet"||o.removeChild(R),R=D}}if(g===0){s.removeChild(x),da(n);return}g--}else o==="$"||o==="$?"||o==="$!"?g++:d=o.charCodeAt(0)-48;else d=0;o=x}while(o);da(n)}function Bu(s){var n=s.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var o=n;switch(n=n.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Bu(o),Ho(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function $E(s,n,o,d){for(;s.nodeType===1;){var g=o;if(s.nodeName.toLowerCase()!==n.toLowerCase()){if(!d&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(d){if(!s[xr])switch(n){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(x=s.getAttribute("rel"),x==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(x!==g.rel||s.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||s.getAttribute("title")!==(g.title==null?null:g.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(x=s.getAttribute("src"),(x!==(g.src==null?null:g.src)||s.getAttribute("type")!==(g.type==null?null:g.type)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&x&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(n==="input"&&s.type==="hidden"){var x=g.name==null?null:""+g.name;if(g.type==="hidden"&&s.getAttribute("name")===x)return s}else return s;if(s=vi(s.nextSibling),s===null)break}return null}function GE(s,n,o){if(n==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=vi(s.nextSibling),s===null))return null;return s}function Fu(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function HE(s,n){var o=s.ownerDocument;if(s.data!=="$?"||o.readyState==="complete")n();else{var d=function(){n(),o.removeEventListener("DOMContentLoaded",d)};o.addEventListener("DOMContentLoaded",d),s._reactRetry=d}}function vi(s){for(;s!=null;s=s.nextSibling){var n=s.nodeType;if(n===1||n===3)break;if(n===8){if(n=s.data,n==="$"||n==="$!"||n==="$?"||n==="F!"||n==="F")break;if(n==="/$")return null}}return s}var ju=null;function Qg(s){s=s.previousSibling;for(var n=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"){if(n===0)return s;n--}else o==="/$"&&n++}s=s.previousSibling}return null}function Wg(s,n,o){switch(n=Ol(o),s){case"html":if(s=n.documentElement,!s)throw Error(i(452));return s;case"head":if(s=n.head,!s)throw Error(i(453));return s;case"body":if(s=n.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function sa(s){for(var n=s.attributes;n.length;)s.removeAttributeNode(n[0]);Ho(s)}var di=new Map,Zg=new Set;function Ml(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var es=Q.d;Q.d={f:VE,r:KE,D:zE,C:YE,L:qE,m:XE,X:WE,S:QE,M:ZE};function VE(){var s=es.f(),n=Ll();return s||n}function KE(s){var n=pn(s);n!==null&&n.tag===5&&n.type==="form"?xm(n):es.r(s)}var Qn=typeof document>"u"?null:document;function Jg(s,n,o){var d=Qn;if(d&&typeof n=="string"&&n){var g=ni(n);g='link[rel="'+s+'"][href="'+g+'"]',typeof o=="string"&&(g+='[crossorigin="'+o+'"]'),Zg.has(g)||(Zg.add(g),s={rel:s,crossOrigin:o,href:n},d.querySelector(g)===null&&(n=d.createElement("link"),Tt(n,"link",s),gt(n),d.head.appendChild(n)))}}function zE(s){es.D(s),Jg("dns-prefetch",s,null)}function YE(s,n){es.C(s,n),Jg("preconnect",s,n)}function qE(s,n,o){es.L(s,n,o);var d=Qn;if(d&&s&&n){var g='link[rel="preload"][as="'+ni(n)+'"]';n==="image"&&o&&o.imageSrcSet?(g+='[imagesrcset="'+ni(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(g+='[imagesizes="'+ni(o.imageSizes)+'"]')):g+='[href="'+ni(s)+'"]';var x=g;switch(n){case"style":x=Wn(s);break;case"script":x=Zn(s)}di.has(x)||(s=m({rel:"preload",href:n==="image"&&o&&o.imageSrcSet?void 0:s,as:n},o),di.set(x,s),d.querySelector(g)!==null||n==="style"&&d.querySelector(na(x))||n==="script"&&d.querySelector(ra(x))||(n=d.createElement("link"),Tt(n,"link",s),gt(n),d.head.appendChild(n)))}}function XE(s,n){es.m(s,n);var o=Qn;if(o&&s){var d=n&&typeof n.as=="string"?n.as:"script",g='link[rel="modulepreload"][as="'+ni(d)+'"][href="'+ni(s)+'"]',x=g;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Zn(s)}if(!di.has(x)&&(s=m({rel:"modulepreload",href:s},n),di.set(x,s),o.querySelector(g)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(ra(x)))return}d=o.createElement("link"),Tt(d,"link",s),gt(d),o.head.appendChild(d)}}}function QE(s,n,o){es.S(s,n,o);var d=Qn;if(d&&s){var g=yn(d).hoistableStyles,x=Wn(s);n=n||"default";var R=g.get(x);if(!R){var D={loading:0,preload:null};if(R=d.querySelector(na(x)))D.loading=5;else{s=m({rel:"stylesheet",href:s,"data-precedence":n},o),(o=di.get(x))&&$u(s,o);var k=R=d.createElement("link");gt(k),Tt(k,"link",s),k._p=new Promise(function(z,J){k.onload=z,k.onerror=J}),k.addEventListener("load",function(){D.loading|=1}),k.addEventListener("error",function(){D.loading|=2}),D.loading|=4,Pl(R,n,d)}R={type:"stylesheet",instance:R,count:1,state:D},g.set(x,R)}}}function WE(s,n){es.X(s,n);var o=Qn;if(o&&s){var d=yn(o).hoistableScripts,g=Zn(s),x=d.get(g);x||(x=o.querySelector(ra(g)),x||(s=m({src:s,async:!0},n),(n=di.get(g))&&Gu(s,n),x=o.createElement("script"),gt(x),Tt(x,"link",s),o.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},d.set(g,x))}}function ZE(s,n){es.M(s,n);var o=Qn;if(o&&s){var d=yn(o).hoistableScripts,g=Zn(s),x=d.get(g);x||(x=o.querySelector(ra(g)),x||(s=m({src:s,async:!0,type:"module"},n),(n=di.get(g))&&Gu(s,n),x=o.createElement("script"),gt(x),Tt(x,"link",s),o.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},d.set(g,x))}}function e0(s,n,o,d){var g=(g=ce.current)?Ml(g):null;if(!g)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(n=Wn(o.href),o=yn(g).hoistableStyles,d=o.get(n),d||(d={type:"style",instance:null,count:0,state:null},o.set(n,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Wn(o.href);var x=yn(g).hoistableStyles,R=x.get(s);if(R||(g=g.ownerDocument||g,R={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(s,R),(x=g.querySelector(na(s)))&&!x._p&&(R.instance=x,R.state.loading=5),di.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},di.set(s,o),x||JE(g,s,o,R.state))),n&&d===null)throw Error(i(528,""));return R}if(n&&d!==null)throw Error(i(529,""));return null;case"script":return n=o.async,o=o.src,typeof o=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=Zn(o),o=yn(g).hoistableScripts,d=o.get(n),d||(d={type:"script",instance:null,count:0,state:null},o.set(n,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Wn(s){return'href="'+ni(s)+'"'}function na(s){return'link[rel="stylesheet"]['+s+"]"}function t0(s){return m({},s,{"data-precedence":s.precedence,precedence:null})}function JE(s,n,o,d){s.querySelector('link[rel="preload"][as="style"]['+n+"]")?d.loading=1:(n=s.createElement("link"),d.preload=n,n.addEventListener("load",function(){return d.loading|=1}),n.addEventListener("error",function(){return d.loading|=2}),Tt(n,"link",o),gt(n),s.head.appendChild(n))}function Zn(s){return'[src="'+ni(s)+'"]'}function ra(s){return"script[async]"+s}function i0(s,n,o){if(n.count++,n.instance===null)switch(n.type){case"style":var d=s.querySelector('style[data-href~="'+ni(o.href)+'"]');if(d)return n.instance=d,gt(d),d;var g=m({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return d=(s.ownerDocument||s).createElement("style"),gt(d),Tt(d,"style",g),Pl(d,o.precedence,s),n.instance=d;case"stylesheet":g=Wn(o.href);var x=s.querySelector(na(g));if(x)return n.state.loading|=4,n.instance=x,gt(x),x;d=t0(o),(g=di.get(g))&&$u(d,g),x=(s.ownerDocument||s).createElement("link"),gt(x);var R=x;return R._p=new Promise(function(D,k){R.onload=D,R.onerror=k}),Tt(x,"link",d),n.state.loading|=4,Pl(x,o.precedence,s),n.instance=x;case"script":return x=Zn(o.src),(g=s.querySelector(ra(x)))?(n.instance=g,gt(g),g):(d=o,(g=di.get(x))&&(d=m({},o),Gu(d,g)),s=s.ownerDocument||s,g=s.createElement("script"),gt(g),Tt(g,"link",d),s.head.appendChild(g),n.instance=g);case"void":return null;default:throw Error(i(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(d=n.instance,n.state.loading|=4,Pl(d,o.precedence,s));return n.instance}function Pl(s,n,o){for(var d=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=d.length?d[d.length-1]:null,x=g,R=0;R<d.length;R++){var D=d[R];if(D.dataset.precedence===n)x=D;else if(x!==g)break}x?x.parentNode.insertBefore(s,x.nextSibling):(n=o.nodeType===9?o.head:o,n.insertBefore(s,n.firstChild))}function $u(s,n){s.crossOrigin==null&&(s.crossOrigin=n.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=n.referrerPolicy),s.title==null&&(s.title=n.title)}function Gu(s,n){s.crossOrigin==null&&(s.crossOrigin=n.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=n.referrerPolicy),s.integrity==null&&(s.integrity=n.integrity)}var Ul=null;function s0(s,n,o){if(Ul===null){var d=new Map,g=Ul=new Map;g.set(o,d)}else g=Ul,d=g.get(o),d||(d=new Map,g.set(o,d));if(d.has(s))return d;for(d.set(s,null),o=o.getElementsByTagName(s),g=0;g<o.length;g++){var x=o[g];if(!(x[xr]||x[_t]||s==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var R=x.getAttribute(n)||"";R=s+R;var D=d.get(R);D?D.push(x):d.set(R,[x])}}return d}function n0(s,n,o){s=s.ownerDocument||s,s.head.insertBefore(o,n==="title"?s.querySelector("head > title"):null)}function eS(s,n,o){if(o===1||n.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return s=n.disabled,typeof n.precedence=="string"&&s==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function r0(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var aa=null;function tS(){}function iS(s,n,o){if(aa===null)throw Error(i(475));var d=aa;if(n.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var g=Wn(o.href),x=s.querySelector(na(g));if(x){s=x._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(d.count++,d=Bl.bind(d),s.then(d,d)),n.state.loading|=4,n.instance=x,gt(x);return}x=s.ownerDocument||s,o=t0(o),(g=di.get(g))&&$u(o,g),x=x.createElement("link"),gt(x);var R=x;R._p=new Promise(function(D,k){R.onload=D,R.onerror=k}),Tt(x,"link",o),n.instance=x}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(n,s),(s=n.state.preload)&&(n.state.loading&3)===0&&(d.count++,n=Bl.bind(d),s.addEventListener("load",n),s.addEventListener("error",n))}}function sS(){if(aa===null)throw Error(i(475));var s=aa;return s.stylesheets&&s.count===0&&Hu(s,s.stylesheets),0<s.count?function(n){var o=setTimeout(function(){if(s.stylesheets&&Hu(s,s.stylesheets),s.unsuspend){var d=s.unsuspend;s.unsuspend=null,d()}},6e4);return s.unsuspend=n,function(){s.unsuspend=null,clearTimeout(o)}}:null}function Bl(){if(this.count--,this.count===0){if(this.stylesheets)Hu(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Fl=null;function Hu(s,n){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Fl=new Map,n.forEach(nS,s),Fl=null,Bl.call(s))}function nS(s,n){if(!(n.state.loading&4)){var o=Fl.get(s);if(o)var d=o.get(null);else{o=new Map,Fl.set(s,o);for(var g=s.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<g.length;x++){var R=g[x];(R.nodeName==="LINK"||R.getAttribute("media")!=="not all")&&(o.set(R.dataset.precedence,R),d=R)}d&&o.set(null,d)}g=n.instance,R=g.getAttribute("data-precedence"),x=o.get(R)||d,x===d&&o.set(null,g),o.set(R,g),this.count++,d=Bl.bind(this),g.addEventListener("load",d),g.addEventListener("error",d),x?x.parentNode.insertBefore(g,x.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(g,s.firstChild)),n.state.loading|=4}}var la={$$typeof:I,Provider:null,Consumer:null,_currentValue:Z,_currentValue2:Z,_threadCount:0};function rS(s,n,o,d,g,x,R,D){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Fo(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fo(0),this.hiddenUpdates=Fo(null),this.identifierPrefix=d,this.onUncaughtError=g,this.onCaughtError=x,this.onRecoverableError=R,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function a0(s,n,o,d,g,x,R,D,k,z,J,ne){return s=new rS(s,n,o,R,D,k,z,ne),n=1,x===!0&&(n|=24),x=Vt(3,null,null,n),s.current=x,x.stateNode=s,n=Ac(),n.refCount++,s.pooledCache=n,n.refCount++,x.memoizedState={element:d,isDehydrated:o,cache:n},Dc(x),s}function l0(s){return s?(s=In,s):In}function o0(s,n,o,d,g,x){g=l0(g),d.context===null?d.context=g:d.pendingContext=g,d=hs(n),d.payload={element:o},x=x===void 0?null:x,x!==null&&(d.callback=x),o=fs(s,d,n),o!==null&&(Xt(o,s,n),Ur(o,s,n))}function c0(s,n){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<n?o:n}}function Vu(s,n){c0(s,n),(s=s.alternate)&&c0(s,n)}function u0(s){if(s.tag===13){var n=Dn(s,67108864);n!==null&&Xt(n,s,67108864),Vu(s,67108864)}}var jl=!0;function aS(s,n,o,d){var g=M.T;M.T=null;var x=Q.p;try{Q.p=2,Ku(s,n,o,d)}finally{Q.p=x,M.T=g}}function lS(s,n,o,d){var g=M.T;M.T=null;var x=Q.p;try{Q.p=8,Ku(s,n,o,d)}finally{Q.p=x,M.T=g}}function Ku(s,n,o,d){if(jl){var g=zu(d);if(g===null)Nu(s,n,d,$l,o),h0(s,d);else if(cS(g,s,n,o,d))d.stopPropagation();else if(h0(s,d),n&4&&-1<oS.indexOf(s)){for(;g!==null;){var x=pn(g);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var R=Gs(x.pendingLanes);if(R!==0){var D=x;for(D.pendingLanes|=2,D.entangledLanes|=2;R;){var k=1<<31-Lt(R);D.entanglements[1]|=k,R&=~k}Di(x),(Be&6)===0&&(Al=ze()+500,ea(0))}}break;case 13:D=Dn(x,2),D!==null&&Xt(D,x,2),Ll(),Vu(x,2)}if(x=zu(d),x===null&&Nu(s,n,d,$l,o),x===g)break;g=x}g!==null&&d.stopPropagation()}else Nu(s,n,d,null,o)}}function zu(s){return s=Wo(s),Yu(s)}var $l=null;function Yu(s){if($l=null,s=gn(s),s!==null){var n=a(s);if(n===null)s=null;else{var o=n.tag;if(o===13){if(s=c(n),s!==null)return s;s=null}else if(o===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;s=null}else n!==s&&(s=null)}}return $l=s,null}function d0(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ot()){case Ti:return 2;case Mt:return 8;case gi:case Fi:return 32;case gr:return 268435456;default:return 32}default:return 32}}var qu=!1,Ls=null,_s=null,Ds=null,oa=new Map,ca=new Map,Is=[],oS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function h0(s,n){switch(s){case"focusin":case"focusout":Ls=null;break;case"dragenter":case"dragleave":_s=null;break;case"mouseover":case"mouseout":Ds=null;break;case"pointerover":case"pointerout":oa.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":ca.delete(n.pointerId)}}function ua(s,n,o,d,g,x){return s===null||s.nativeEvent!==x?(s={blockedOn:n,domEventName:o,eventSystemFlags:d,nativeEvent:x,targetContainers:[g]},n!==null&&(n=pn(n),n!==null&&u0(n)),s):(s.eventSystemFlags|=d,n=s.targetContainers,g!==null&&n.indexOf(g)===-1&&n.push(g),s)}function cS(s,n,o,d,g){switch(n){case"focusin":return Ls=ua(Ls,s,n,o,d,g),!0;case"dragenter":return _s=ua(_s,s,n,o,d,g),!0;case"mouseover":return Ds=ua(Ds,s,n,o,d,g),!0;case"pointerover":var x=g.pointerId;return oa.set(x,ua(oa.get(x)||null,s,n,o,d,g)),!0;case"gotpointercapture":return x=g.pointerId,ca.set(x,ua(ca.get(x)||null,s,n,o,d,g)),!0}return!1}function f0(s){var n=gn(s.target);if(n!==null){var o=a(n);if(o!==null){if(n=o.tag,n===13){if(n=c(o),n!==null){s.blockedOn=n,iv(s.priority,function(){if(o.tag===13){var d=qt();d=jo(d);var g=Dn(o,d);g!==null&&Xt(g,o,d),Vu(o,d)}});return}}else if(n===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Gl(s){if(s.blockedOn!==null)return!1;for(var n=s.targetContainers;0<n.length;){var o=zu(s.nativeEvent);if(o===null){o=s.nativeEvent;var d=new o.constructor(o.type,o);Qo=d,o.target.dispatchEvent(d),Qo=null}else return n=pn(o),n!==null&&u0(n),s.blockedOn=o,!1;n.shift()}return!0}function m0(s,n,o){Gl(s)&&o.delete(n)}function uS(){qu=!1,Ls!==null&&Gl(Ls)&&(Ls=null),_s!==null&&Gl(_s)&&(_s=null),Ds!==null&&Gl(Ds)&&(Ds=null),oa.forEach(m0),ca.forEach(m0)}function Hl(s,n){s.blockedOn===n&&(s.blockedOn=null,qu||(qu=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,uS)))}var Vl=null;function g0(s){Vl!==s&&(Vl=s,l.unstable_scheduleCallback(l.unstable_NormalPriority,function(){Vl===s&&(Vl=null);for(var n=0;n<s.length;n+=3){var o=s[n],d=s[n+1],g=s[n+2];if(typeof d!="function"){if(Yu(d||o)===null)continue;break}var x=pn(o);x!==null&&(s.splice(n,3),n-=3,Yc(x,{pending:!0,data:g,method:o.method,action:d},d,g))}}))}function da(s){function n(k){return Hl(k,s)}Ls!==null&&Hl(Ls,s),_s!==null&&Hl(_s,s),Ds!==null&&Hl(Ds,s),oa.forEach(n),ca.forEach(n);for(var o=0;o<Is.length;o++){var d=Is[o];d.blockedOn===s&&(d.blockedOn=null)}for(;0<Is.length&&(o=Is[0],o.blockedOn===null);)f0(o),o.blockedOn===null&&Is.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(d=0;d<o.length;d+=3){var g=o[d],x=o[d+1],R=g[Pt]||null;if(typeof x=="function")R||g0(o);else if(R){var D=null;if(x&&x.hasAttribute("formAction")){if(g=x,R=x[Pt]||null)D=R.formAction;else if(Yu(g)!==null)continue}else D=R.action;typeof D=="function"?o[d+1]=D:(o.splice(d,3),d-=3),g0(o)}}}function Xu(s){this._internalRoot=s}Kl.prototype.render=Xu.prototype.render=function(s){var n=this._internalRoot;if(n===null)throw Error(i(409));var o=n.current,d=qt();o0(o,d,s,n,null,null)},Kl.prototype.unmount=Xu.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var n=s.containerInfo;o0(s.current,2,null,s,null,null),Ll(),n[mn]=null}};function Kl(s){this._internalRoot=s}Kl.prototype.unstable_scheduleHydration=function(s){if(s){var n=wh();s={blockedOn:null,target:s,priority:n};for(var o=0;o<Is.length&&n!==0&&n<Is[o].priority;o++);Is.splice(o,0,s),o===0&&f0(s)}};var p0=e.version;if(p0!=="19.1.0")throw Error(i(527,p0,"19.1.0"));Q.findDOMNode=function(s){var n=s._reactInternals;if(n===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=f(n),s=s!==null?h(s):null,s=s===null?null:s.stateNode,s};var dS={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:M,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zl.isDisabled&&zl.supportsFiber)try{pi=zl.inject(dS),Rt=zl}catch{}}return fa.createRoot=function(s,n){if(!r(s))throw Error(i(299));var o=!1,d="",g=Nm,x=km,R=Om,D=null;return n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(d=n.identifierPrefix),n.onUncaughtError!==void 0&&(g=n.onUncaughtError),n.onCaughtError!==void 0&&(x=n.onCaughtError),n.onRecoverableError!==void 0&&(R=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(D=n.unstable_transitionCallbacks)),n=a0(s,1,!1,null,null,o,d,g,x,R,D,null),s[mn]=n.current,wu(s),new Xu(n)},fa.hydrateRoot=function(s,n,o){if(!r(s))throw Error(i(299));var d=!1,g="",x=Nm,R=km,D=Om,k=null,z=null;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(x=o.onUncaughtError),o.onCaughtError!==void 0&&(R=o.onCaughtError),o.onRecoverableError!==void 0&&(D=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(k=o.unstable_transitionCallbacks),o.formState!==void 0&&(z=o.formState)),n=a0(s,1,!0,n,o??null,d,g,x,R,D,k,z),n.context=l0(null),o=n.current,d=qt(),d=jo(d),g=hs(d),g.callback=null,fs(o,g,d),o=d,n.current.lanes=o,yr(n,o),Di(n),s[mn]=n.current,wu(s),new Kl(n)},fa.version="19.1.0",fa}var L0;function SS(){if(L0)return Zu.exports;L0=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(e){console.error(e)}}return l(),Zu.exports=ES(),Zu.exports}var TS=SS(),ma={},_0;function bS(){if(_0)return ma;_0=1,Object.defineProperty(ma,"__esModule",{value:!0}),ma.parse=c,ma.serialize=h;const l=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,i=/^[\u0020-\u003A\u003D-\u007E]*$/,r=Object.prototype.toString,a=(()=>{const y=function(){};return y.prototype=Object.create(null),y})();function c(y,S){const E=new a,T=y.length;if(T<2)return E;const b=(S==null?void 0:S.decode)||m;let L=0;do{const _=y.indexOf("=",L);if(_===-1)break;const I=y.indexOf(";",L),C=I===-1?T:I;if(_>C){L=y.lastIndexOf(";",_-1)+1;continue}const N=u(y,L,_),K=f(y,_,N),O=y.slice(N,K);if(E[O]===void 0){let j=u(y,_+1,C),B=f(y,C,j);const U=b(y.slice(j,B));E[O]=U}L=C+1}while(L<T);return E}function u(y,S,E){do{const T=y.charCodeAt(S);if(T!==32&&T!==9)return S}while(++S<E);return E}function f(y,S,E){for(;S>E;){const T=y.charCodeAt(--S);if(T!==32&&T!==9)return S+1}return E}function h(y,S,E){const T=(E==null?void 0:E.encode)||encodeURIComponent;if(!l.test(y))throw new TypeError(`argument name is invalid: ${y}`);const b=T(S);if(!e.test(b))throw new TypeError(`argument val is invalid: ${S}`);let L=y+"="+b;if(!E)return L;if(E.maxAge!==void 0){if(!Number.isInteger(E.maxAge))throw new TypeError(`option maxAge is invalid: ${E.maxAge}`);L+="; Max-Age="+E.maxAge}if(E.domain){if(!t.test(E.domain))throw new TypeError(`option domain is invalid: ${E.domain}`);L+="; Domain="+E.domain}if(E.path){if(!i.test(E.path))throw new TypeError(`option path is invalid: ${E.path}`);L+="; Path="+E.path}if(E.expires){if(!p(E.expires)||!Number.isFinite(E.expires.valueOf()))throw new TypeError(`option expires is invalid: ${E.expires}`);L+="; Expires="+E.expires.toUTCString()}if(E.httpOnly&&(L+="; HttpOnly"),E.secure&&(L+="; Secure"),E.partitioned&&(L+="; Partitioned"),E.priority)switch(typeof E.priority=="string"?E.priority.toLowerCase():void 0){case"low":L+="; Priority=Low";break;case"medium":L+="; Priority=Medium";break;case"high":L+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${E.priority}`)}if(E.sameSite)switch(typeof E.sameSite=="string"?E.sameSite.toLowerCase():E.sameSite){case!0:case"strict":L+="; SameSite=Strict";break;case"lax":L+="; SameSite=Lax";break;case"none":L+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${E.sameSite}`)}return L}function m(y){if(y.indexOf("%")===-1)return y;try{return decodeURIComponent(y)}catch{return y}}function p(y){return r.call(y)==="[object Date]"}return ma}bS();var D0="popstate";function AS(l={}){function e(i,r){let{pathname:a,search:c,hash:u}=i.location;return Dd("",{pathname:a,search:c,hash:u},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(i,r){return typeof r=="string"?r:Sa(r)}return LS(e,t,null,l)}function tt(l,e){if(l===!1||l===null||typeof l>"u")throw new Error(e)}function Mi(l,e){if(!l){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function RS(){return Math.random().toString(36).substring(2,10)}function I0(l,e){return{usr:l.state,key:l.key,idx:e}}function Dd(l,e,t=null,i){return{pathname:typeof l=="string"?l:l.pathname,search:"",hash:"",...typeof e=="string"?dr(e):e,state:t,key:e&&e.key||i||RS()}}function Sa({pathname:l="/",search:e="",hash:t=""}){return e&&e!=="?"&&(l+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(l+=t.charAt(0)==="#"?t:"#"+t),l}function dr(l){let e={};if(l){let t=l.indexOf("#");t>=0&&(e.hash=l.substring(t),l=l.substring(0,t));let i=l.indexOf("?");i>=0&&(e.search=l.substring(i),l=l.substring(0,i)),l&&(e.pathname=l)}return e}function LS(l,e,t,i={}){let{window:r=document.defaultView,v5Compat:a=!1}=i,c=r.history,u="POP",f=null,h=m();h==null&&(h=0,c.replaceState({...c.state,idx:h},""));function m(){return(c.state||{idx:null}).idx}function p(){u="POP";let b=m(),L=b==null?null:b-h;h=b,f&&f({action:u,location:T.location,delta:L})}function y(b,L){u="PUSH";let _=Dd(T.location,b,L);h=m()+1;let I=I0(_,h),C=T.createHref(_);try{c.pushState(I,"",C)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;r.location.assign(C)}a&&f&&f({action:u,location:T.location,delta:1})}function S(b,L){u="REPLACE";let _=Dd(T.location,b,L);h=m();let I=I0(_,h),C=T.createHref(_);c.replaceState(I,"",C),a&&f&&f({action:u,location:T.location,delta:0})}function E(b){return _S(b)}let T={get action(){return u},get location(){return l(r,c)},listen(b){if(f)throw new Error("A history only accepts one active listener");return r.addEventListener(D0,p),f=b,()=>{r.removeEventListener(D0,p),f=null}},createHref(b){return e(r,b)},createURL:E,encodeLocation(b){let L=E(b);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:y,replace:S,go(b){return c.go(b)}};return T}function _S(l,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),tt(t,"No window.location.(origin|href) available to create URL");let i=typeof l=="string"?l:Sa(l);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function Wp(l,e,t="/"){return DS(l,e,t,!1)}function DS(l,e,t,i){let r=typeof e=="string"?dr(e):e,a=as(r.pathname||"/",t);if(a==null)return null;let c=Zp(l);IS(c);let u=null;for(let f=0;u==null&&f<c.length;++f){let h=jS(a);u=BS(c[f],h,i)}return u}function Zp(l,e=[],t=[],i=""){let r=(a,c,u)=>{let f={relativePath:u===void 0?a.path||"":u,caseSensitive:a.caseSensitive===!0,childrenIndex:c,route:a};f.relativePath.startsWith("/")&&(tt(f.relativePath.startsWith(i),`Absolute route path "${f.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(i.length));let h=rs([i,f.relativePath]),m=t.concat(f);a.children&&a.children.length>0&&(tt(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),Zp(a.children,e,m,h)),!(a.path==null&&!a.index)&&e.push({path:h,score:PS(h,a.index),routesMeta:m})};return l.forEach((a,c)=>{var u;if(a.path===""||!((u=a.path)!=null&&u.includes("?")))r(a,c);else for(let f of Jp(a.path))r(a,c,f)}),e}function Jp(l){let e=l.split("/");if(e.length===0)return[];let[t,...i]=e,r=t.endsWith("?"),a=t.replace(/\?$/,"");if(i.length===0)return r?[a,""]:[a];let c=Jp(i.join("/")),u=[];return u.push(...c.map(f=>f===""?a:[a,f].join("/"))),r&&u.push(...c),u.map(f=>l.startsWith("/")&&f===""?"/":f)}function IS(l){l.sort((e,t)=>e.score!==t.score?t.score-e.score:US(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var CS=/^:[\w-]+$/,wS=3,NS=2,kS=1,OS=10,MS=-2,C0=l=>l==="*";function PS(l,e){let t=l.split("/"),i=t.length;return t.some(C0)&&(i+=MS),e&&(i+=NS),t.filter(r=>!C0(r)).reduce((r,a)=>r+(CS.test(a)?wS:a===""?kS:OS),i)}function US(l,e){return l.length===e.length&&l.slice(0,-1).every((i,r)=>i===e[r])?l[l.length-1]-e[e.length-1]:0}function BS(l,e,t=!1){let{routesMeta:i}=l,r={},a="/",c=[];for(let u=0;u<i.length;++u){let f=i[u],h=u===i.length-1,m=a==="/"?e:e.slice(a.length)||"/",p=So({path:f.relativePath,caseSensitive:f.caseSensitive,end:h},m),y=f.route;if(!p&&h&&t&&!i[i.length-1].route.index&&(p=So({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},m)),!p)return null;Object.assign(r,p.params),c.push({params:r,pathname:rs([a,p.pathname]),pathnameBase:VS(rs([a,p.pathnameBase])),route:y}),p.pathnameBase!=="/"&&(a=rs([a,p.pathnameBase]))}return c}function So(l,e){typeof l=="string"&&(l={path:l,caseSensitive:!1,end:!0});let[t,i]=FS(l.path,l.caseSensitive,l.end),r=e.match(t);if(!r)return null;let a=r[0],c=a.replace(/(.)\/+$/,"$1"),u=r.slice(1);return{params:i.reduce((h,{paramName:m,isOptional:p},y)=>{if(m==="*"){let E=u[y]||"";c=a.slice(0,a.length-E.length).replace(/(.)\/+$/,"$1")}const S=u[y];return p&&!S?h[m]=void 0:h[m]=(S||"").replace(/%2F/g,"/"),h},{}),pathname:a,pathnameBase:c,pattern:l}}function FS(l,e=!1,t=!0){Mi(l==="*"||!l.endsWith("*")||l.endsWith("/*"),`Route path "${l}" will be treated as if it were "${l.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${l.replace(/\*$/,"/*")}".`);let i=[],r="^"+l.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,f)=>(i.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return l.endsWith("*")?(i.push({paramName:"*"}),r+=l==="*"||l==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":l!==""&&l!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function jS(l){try{return l.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Mi(!1,`The URL path "${l}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),l}}function as(l,e){if(e==="/")return l;if(!l.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=l.charAt(t);return i&&i!=="/"?null:l.slice(t)||"/"}function $S(l,e="/"){let{pathname:t,search:i="",hash:r=""}=typeof l=="string"?dr(l):l;return{pathname:t?t.startsWith("/")?t:GS(t,e):e,search:KS(i),hash:zS(r)}}function GS(l,e){let t=e.replace(/\/+$/,"").split("/");return l.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function id(l,e,t,i){return`Cannot include a '${l}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function HS(l){return l.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function ey(l){let e=HS(l);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function ty(l,e,t,i=!1){let r;typeof l=="string"?r=dr(l):(r={...l},tt(!r.pathname||!r.pathname.includes("?"),id("?","pathname","search",r)),tt(!r.pathname||!r.pathname.includes("#"),id("#","pathname","hash",r)),tt(!r.search||!r.search.includes("#"),id("#","search","hash",r)));let a=l===""||r.pathname==="",c=a?"/":r.pathname,u;if(c==null)u=t;else{let p=e.length-1;if(!i&&c.startsWith("..")){let y=c.split("/");for(;y[0]==="..";)y.shift(),p-=1;r.pathname=y.join("/")}u=p>=0?e[p]:"/"}let f=$S(r,u),h=c&&c!=="/"&&c.endsWith("/"),m=(a||c===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(h||m)&&(f.pathname+="/"),f}var rs=l=>l.join("/").replace(/\/\/+/g,"/"),VS=l=>l.replace(/\/+$/,"").replace(/^\/*/,"/"),KS=l=>!l||l==="?"?"":l.startsWith("?")?l:"?"+l,zS=l=>!l||l==="#"?"":l.startsWith("#")?l:"#"+l;function YS(l){return l!=null&&typeof l.status=="number"&&typeof l.statusText=="string"&&typeof l.internal=="boolean"&&"data"in l}var iy=["POST","PUT","PATCH","DELETE"];new Set(iy);var qS=["GET",...iy];new Set(qS);var hr=te.createContext(null);hr.displayName="DataRouter";var ko=te.createContext(null);ko.displayName="DataRouterState";var sy=te.createContext({isTransitioning:!1});sy.displayName="ViewTransition";var XS=te.createContext(new Map);XS.displayName="Fetchers";var QS=te.createContext(null);QS.displayName="Await";var Bi=te.createContext(null);Bi.displayName="Navigation";var Ia=te.createContext(null);Ia.displayName="Location";var ls=te.createContext({outlet:null,matches:[],isDataRoute:!1});ls.displayName="Route";var Qd=te.createContext(null);Qd.displayName="RouteError";function WS(l,{relative:e}={}){tt(Ca(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=te.useContext(Bi),{hash:r,pathname:a,search:c}=wa(l,{relative:e}),u=a;return t!=="/"&&(u=a==="/"?t:rs([t,a])),i.createHref({pathname:u,search:c,hash:r})}function Ca(){return te.useContext(Ia)!=null}function Bs(){return tt(Ca(),"useLocation() may be used only in the context of a <Router> component."),te.useContext(Ia).location}var ny="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ry(l){te.useContext(Bi).static||te.useLayoutEffect(l)}function ZS(){let{isDataRoute:l}=te.useContext(ls);return l?dT():JS()}function JS(){tt(Ca(),"useNavigate() may be used only in the context of a <Router> component.");let l=te.useContext(hr),{basename:e,navigator:t}=te.useContext(Bi),{matches:i}=te.useContext(ls),{pathname:r}=Bs(),a=JSON.stringify(ey(i)),c=te.useRef(!1);return ry(()=>{c.current=!0}),te.useCallback((f,h={})=>{if(Mi(c.current,ny),!c.current)return;if(typeof f=="number"){t.go(f);return}let m=ty(f,JSON.parse(a),r,h.relative==="path");l==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:rs([e,m.pathname])),(h.replace?t.replace:t.push)(m,h.state,h)},[e,t,a,r,l])}te.createContext(null);function wa(l,{relative:e}={}){let{matches:t}=te.useContext(ls),{pathname:i}=Bs(),r=JSON.stringify(ey(t));return te.useMemo(()=>ty(l,JSON.parse(r),i,e==="path"),[l,r,i,e])}function eT(l,e){return ay(l,e)}function ay(l,e,t,i){var L;tt(Ca(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=te.useContext(Bi),{matches:a}=te.useContext(ls),c=a[a.length-1],u=c?c.params:{},f=c?c.pathname:"/",h=c?c.pathnameBase:"/",m=c&&c.route;{let _=m&&m.path||"";ly(f,!m||_.endsWith("*")||_.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${_}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${_}"> to <Route path="${_==="/"?"*":`${_}/*`}">.`)}let p=Bs(),y;if(e){let _=typeof e=="string"?dr(e):e;tt(h==="/"||((L=_.pathname)==null?void 0:L.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${_.pathname}" was given in the \`location\` prop.`),y=_}else y=p;let S=y.pathname||"/",E=S;if(h!=="/"){let _=h.replace(/^\//,"").split("/");E="/"+S.replace(/^\//,"").split("/").slice(_.length).join("/")}let T=Wp(l,{pathname:E});Mi(m||T!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),Mi(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=rT(T&&T.map(_=>Object.assign({},_,{params:Object.assign({},u,_.params),pathname:rs([h,r.encodeLocation?r.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?h:rs([h,r.encodeLocation?r.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),a,t,i);return e&&b?te.createElement(Ia.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},b):b}function tT(){let l=uT(),e=YS(l)?`${l.status} ${l.statusText}`:l instanceof Error?l.message:JSON.stringify(l),t=l instanceof Error?l.stack:null,i="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:i},a={padding:"2px 4px",backgroundColor:i},c=null;return console.error("Error handled by React Router default ErrorBoundary:",l),c=te.createElement(te.Fragment,null,te.createElement("p",null," Hey developer "),te.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",te.createElement("code",{style:a},"ErrorBoundary")," or"," ",te.createElement("code",{style:a},"errorElement")," prop on your route.")),te.createElement(te.Fragment,null,te.createElement("h2",null,"Unexpected Application Error!"),te.createElement("h3",{style:{fontStyle:"italic"}},e),t?te.createElement("pre",{style:r},t):null,c)}var iT=te.createElement(tT,null),sT=class extends te.Component{constructor(l){super(l),this.state={location:l.location,revalidation:l.revalidation,error:l.error}}static getDerivedStateFromError(l){return{error:l}}static getDerivedStateFromProps(l,e){return e.location!==l.location||e.revalidation!=="idle"&&l.revalidation==="idle"?{error:l.error,location:l.location,revalidation:l.revalidation}:{error:l.error!==void 0?l.error:e.error,location:e.location,revalidation:l.revalidation||e.revalidation}}componentDidCatch(l,e){console.error("React Router caught the following error during render",l,e)}render(){return this.state.error!==void 0?te.createElement(ls.Provider,{value:this.props.routeContext},te.createElement(Qd.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function nT({routeContext:l,match:e,children:t}){let i=te.useContext(hr);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),te.createElement(ls.Provider,{value:l},t)}function rT(l,e=[],t=null,i=null){if(l==null){if(!t)return null;if(t.errors)l=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)l=t.matches;else return null}let r=l,a=t==null?void 0:t.errors;if(a!=null){let f=r.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);tt(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),r=r.slice(0,Math.min(r.length,f+1))}let c=!1,u=-1;if(t)for(let f=0;f<r.length;f++){let h=r[f];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=f),h.route.id){let{loaderData:m,errors:p}=t,y=h.route.loader&&!m.hasOwnProperty(h.route.id)&&(!p||p[h.route.id]===void 0);if(h.route.lazy||y){c=!0,u>=0?r=r.slice(0,u+1):r=[r[0]];break}}}return r.reduceRight((f,h,m)=>{let p,y=!1,S=null,E=null;t&&(p=a&&h.route.id?a[h.route.id]:void 0,S=h.route.errorElement||iT,c&&(u<0&&m===0?(ly("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,E=null):u===m&&(y=!0,E=h.route.hydrateFallbackElement||null)));let T=e.concat(r.slice(0,m+1)),b=()=>{let L;return p?L=S:y?L=E:h.route.Component?L=te.createElement(h.route.Component,null):h.route.element?L=h.route.element:L=f,te.createElement(nT,{match:h,routeContext:{outlet:f,matches:T,isDataRoute:t!=null},children:L})};return t&&(h.route.ErrorBoundary||h.route.errorElement||m===0)?te.createElement(sT,{location:t.location,revalidation:t.revalidation,component:S,error:p,children:b(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):b()},null)}function Wd(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function aT(l){let e=te.useContext(hr);return tt(e,Wd(l)),e}function lT(l){let e=te.useContext(ko);return tt(e,Wd(l)),e}function oT(l){let e=te.useContext(ls);return tt(e,Wd(l)),e}function Zd(l){let e=oT(l),t=e.matches[e.matches.length-1];return tt(t.route.id,`${l} can only be used on routes that contain a unique "id"`),t.route.id}function cT(){return Zd("useRouteId")}function uT(){var i;let l=te.useContext(Qd),e=lT("useRouteError"),t=Zd("useRouteError");return l!==void 0?l:(i=e.errors)==null?void 0:i[t]}function dT(){let{router:l}=aT("useNavigate"),e=Zd("useNavigate"),t=te.useRef(!1);return ry(()=>{t.current=!0}),te.useCallback(async(r,a={})=>{Mi(t.current,ny),t.current&&(typeof r=="number"?l.navigate(r):await l.navigate(r,{fromRouteId:e,...a}))},[l,e])}var w0={};function ly(l,e,t){!e&&!w0[l]&&(w0[l]=!0,Mi(!1,t))}te.memo(hT);function hT({routes:l,future:e,state:t}){return ay(l,void 0,t,e)}function hi(l){tt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function fT({basename:l="/",children:e=null,location:t,navigationType:i="POP",navigator:r,static:a=!1}){tt(!Ca(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=l.replace(/^\/*/,"/"),u=te.useMemo(()=>({basename:c,navigator:r,static:a,future:{}}),[c,r,a]);typeof t=="string"&&(t=dr(t));let{pathname:f="/",search:h="",hash:m="",state:p=null,key:y="default"}=t,S=te.useMemo(()=>{let E=as(f,c);return E==null?null:{location:{pathname:E,search:h,hash:m,state:p,key:y},navigationType:i}},[c,f,h,m,p,y,i]);return Mi(S!=null,`<Router basename="${c}"> is not able to match the URL "${f}${h}${m}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:te.createElement(Bi.Provider,{value:u},te.createElement(Ia.Provider,{children:e,value:S}))}function mT({children:l,location:e}){return eT(Id(l),e)}function Id(l,e=[]){let t=[];return te.Children.forEach(l,(i,r)=>{if(!te.isValidElement(i))return;let a=[...e,r];if(i.type===te.Fragment){t.push.apply(t,Id(i.props.children,a));return}tt(i.type===hi,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),tt(!i.props.index||!i.props.children,"An index route cannot have child routes.");let c={id:i.props.id||a.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=Id(i.props.children,a)),t.push(c)}),t}var uo="get",ho="application/x-www-form-urlencoded";function Oo(l){return l!=null&&typeof l.tagName=="string"}function gT(l){return Oo(l)&&l.tagName.toLowerCase()==="button"}function pT(l){return Oo(l)&&l.tagName.toLowerCase()==="form"}function yT(l){return Oo(l)&&l.tagName.toLowerCase()==="input"}function xT(l){return!!(l.metaKey||l.altKey||l.ctrlKey||l.shiftKey)}function vT(l,e){return l.button===0&&(!e||e==="_self")&&!xT(l)}var Yl=null;function ET(){if(Yl===null)try{new FormData(document.createElement("form"),0),Yl=!1}catch{Yl=!0}return Yl}var ST=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function sd(l){return l!=null&&!ST.has(l)?(Mi(!1,`"${l}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ho}"`),null):l}function TT(l,e){let t,i,r,a,c;if(pT(l)){let u=l.getAttribute("action");i=u?as(u,e):null,t=l.getAttribute("method")||uo,r=sd(l.getAttribute("enctype"))||ho,a=new FormData(l)}else if(gT(l)||yT(l)&&(l.type==="submit"||l.type==="image")){let u=l.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=l.getAttribute("formaction")||u.getAttribute("action");if(i=f?as(f,e):null,t=l.getAttribute("formmethod")||u.getAttribute("method")||uo,r=sd(l.getAttribute("formenctype"))||sd(u.getAttribute("enctype"))||ho,a=new FormData(u,l),!ET()){let{name:h,type:m,value:p}=l;if(m==="image"){let y=h?`${h}.`:"";a.append(`${y}x`,"0"),a.append(`${y}y`,"0")}else h&&a.append(h,p)}}else{if(Oo(l))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=uo,i=null,r=ho,c=l}return a&&r==="text/plain"&&(c=a,a=void 0),{action:i,method:t.toLowerCase(),encType:r,formData:a,body:c}}function Jd(l,e){if(l===!1||l===null||typeof l>"u")throw new Error(e)}async function bT(l,e){if(l.id in e)return e[l.id];try{let t=await import(l.module);return e[l.id]=t,t}catch(t){return console.error(`Error loading route module \`${l.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function AT(l){return l==null?!1:l.href==null?l.rel==="preload"&&typeof l.imageSrcSet=="string"&&typeof l.imageSizes=="string":typeof l.rel=="string"&&typeof l.href=="string"}async function RT(l,e,t){let i=await Promise.all(l.map(async r=>{let a=e.routes[r.route.id];if(a){let c=await bT(a,t);return c.links?c.links():[]}return[]}));return IT(i.flat(1).filter(AT).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function N0(l,e,t,i,r,a){let c=(f,h)=>t[h]?f.route.id!==t[h].route.id:!0,u=(f,h)=>{var m;return t[h].pathname!==f.pathname||((m=t[h].route.path)==null?void 0:m.endsWith("*"))&&t[h].params["*"]!==f.params["*"]};return a==="assets"?e.filter((f,h)=>c(f,h)||u(f,h)):a==="data"?e.filter((f,h)=>{var p;let m=i.routes[f.route.id];if(!m||!m.hasLoader)return!1;if(c(f,h)||u(f,h))return!0;if(f.route.shouldRevalidate){let y=f.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((p=t[0])==null?void 0:p.params)||{},nextUrl:new URL(l,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function LT(l,e,{includeHydrateFallback:t}={}){return _T(l.map(i=>{let r=e.routes[i.route.id];if(!r)return[];let a=[r.module];return r.clientActionModule&&(a=a.concat(r.clientActionModule)),r.clientLoaderModule&&(a=a.concat(r.clientLoaderModule)),t&&r.hydrateFallbackModule&&(a=a.concat(r.hydrateFallbackModule)),r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function _T(l){return[...new Set(l)]}function DT(l){let e={},t=Object.keys(l).sort();for(let i of t)e[i]=l[i];return e}function IT(l,e){let t=new Set;return new Set(e),l.reduce((i,r)=>{let a=JSON.stringify(DT(r));return t.has(a)||(t.add(a),i.push({key:a,link:r})),i},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var CT=new Set([100,101,204,205]);function wT(l,e){let t=typeof l=="string"?new URL(l,typeof window>"u"?"server://singlefetch/":window.location.origin):l;return t.pathname==="/"?t.pathname="_root.data":e&&as(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function oy(){let l=te.useContext(hr);return Jd(l,"You must render this element inside a <DataRouterContext.Provider> element"),l}function NT(){let l=te.useContext(ko);return Jd(l,"You must render this element inside a <DataRouterStateContext.Provider> element"),l}var eh=te.createContext(void 0);eh.displayName="FrameworkContext";function cy(){let l=te.useContext(eh);return Jd(l,"You must render this element inside a <HydratedRouter> element"),l}function kT(l,e){let t=te.useContext(eh),[i,r]=te.useState(!1),[a,c]=te.useState(!1),{onFocus:u,onBlur:f,onMouseEnter:h,onMouseLeave:m,onTouchStart:p}=e,y=te.useRef(null);te.useEffect(()=>{if(l==="render"&&c(!0),l==="viewport"){let T=L=>{L.forEach(_=>{c(_.isIntersecting)})},b=new IntersectionObserver(T,{threshold:.5});return y.current&&b.observe(y.current),()=>{b.disconnect()}}},[l]),te.useEffect(()=>{if(i){let T=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(T)}}},[i]);let S=()=>{r(!0)},E=()=>{r(!1),c(!1)};return t?l!=="intent"?[a,y,{}]:[a,y,{onFocus:ga(u,S),onBlur:ga(f,E),onMouseEnter:ga(h,S),onMouseLeave:ga(m,E),onTouchStart:ga(p,S)}]:[!1,y,{}]}function ga(l,e){return t=>{l&&l(t),t.defaultPrevented||e(t)}}function OT({page:l,...e}){let{router:t}=oy(),i=te.useMemo(()=>Wp(t.routes,l,t.basename),[t.routes,l,t.basename]);return i?te.createElement(PT,{page:l,matches:i,...e}):null}function MT(l){let{manifest:e,routeModules:t}=cy(),[i,r]=te.useState([]);return te.useEffect(()=>{let a=!1;return RT(l,e,t).then(c=>{a||r(c)}),()=>{a=!0}},[l,e,t]),i}function PT({page:l,matches:e,...t}){let i=Bs(),{manifest:r,routeModules:a}=cy(),{basename:c}=oy(),{loaderData:u,matches:f}=NT(),h=te.useMemo(()=>N0(l,e,f,r,i,"data"),[l,e,f,r,i]),m=te.useMemo(()=>N0(l,e,f,r,i,"assets"),[l,e,f,r,i]),p=te.useMemo(()=>{if(l===i.pathname+i.search+i.hash)return[];let E=new Set,T=!1;if(e.forEach(L=>{var I;let _=r.routes[L.route.id];!_||!_.hasLoader||(!h.some(C=>C.route.id===L.route.id)&&L.route.id in u&&((I=a[L.route.id])!=null&&I.shouldRevalidate)||_.hasClientLoader?T=!0:E.add(L.route.id))}),E.size===0)return[];let b=wT(l,c);return T&&E.size>0&&b.searchParams.set("_routes",e.filter(L=>E.has(L.route.id)).map(L=>L.route.id).join(",")),[b.pathname+b.search]},[c,u,i,r,h,e,l,a]),y=te.useMemo(()=>LT(m,r),[m,r]),S=MT(m);return te.createElement(te.Fragment,null,p.map(E=>te.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...t})),y.map(E=>te.createElement("link",{key:E,rel:"modulepreload",href:E,...t})),S.map(({key:E,link:T})=>te.createElement("link",{key:E,...T})))}function UT(...l){return e=>{l.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var uy=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{uy&&(window.__reactRouterVersion="7.6.1")}catch{}function BT({basename:l,children:e,window:t}){let i=te.useRef();i.current==null&&(i.current=AS({window:t,v5Compat:!0}));let r=i.current,[a,c]=te.useState({action:r.action,location:r.location}),u=te.useCallback(f=>{te.startTransition(()=>c(f))},[c]);return te.useLayoutEffect(()=>r.listen(u),[r,u]),te.createElement(fT,{basename:l,children:e,location:a.location,navigationType:a.action,navigator:r})}var dy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Te=te.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:r,reloadDocument:a,replace:c,state:u,target:f,to:h,preventScrollReset:m,viewTransition:p,...y},S){let{basename:E}=te.useContext(Bi),T=typeof h=="string"&&dy.test(h),b,L=!1;if(typeof h=="string"&&T&&(b=h,uy))try{let B=new URL(window.location.href),U=h.startsWith("//")?new URL(B.protocol+h):new URL(h),W=as(U.pathname,E);U.origin===B.origin&&W!=null?h=W+U.search+U.hash:L=!0}catch{Mi(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=WS(h,{relative:r}),[I,C,N]=kT(i,y),K=GT(h,{replace:c,state:u,target:f,preventScrollReset:m,relative:r,viewTransition:p});function O(B){e&&e(B),B.defaultPrevented||K(B)}let j=te.createElement("a",{...y,...N,href:b||_,onClick:L||a?e:O,ref:UT(S,C),target:f,"data-discover":!T&&t==="render"?"true":void 0});return I&&!T?te.createElement(te.Fragment,null,j,te.createElement(OT,{page:_})):j});Te.displayName="Link";var FT=te.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:r=!1,style:a,to:c,viewTransition:u,children:f,...h},m){let p=wa(c,{relative:h.relative}),y=Bs(),S=te.useContext(ko),{navigator:E,basename:T}=te.useContext(Bi),b=S!=null&&YT(p)&&u===!0,L=E.encodeLocation?E.encodeLocation(p).pathname:p.pathname,_=y.pathname,I=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;t||(_=_.toLowerCase(),I=I?I.toLowerCase():null,L=L.toLowerCase()),I&&T&&(I=as(I,T)||I);const C=L!=="/"&&L.endsWith("/")?L.length-1:L.length;let N=_===L||!r&&_.startsWith(L)&&_.charAt(C)==="/",K=I!=null&&(I===L||!r&&I.startsWith(L)&&I.charAt(L.length)==="/"),O={isActive:N,isPending:K,isTransitioning:b},j=N?e:void 0,B;typeof i=="function"?B=i(O):B=[i,N?"active":null,K?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let U=typeof a=="function"?a(O):a;return te.createElement(Te,{...h,"aria-current":j,className:B,ref:m,style:U,to:c,viewTransition:u},typeof f=="function"?f(O):f)});FT.displayName="NavLink";var jT=te.forwardRef(({discover:l="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:r,state:a,method:c=uo,action:u,onSubmit:f,relative:h,preventScrollReset:m,viewTransition:p,...y},S)=>{let E=KT(),T=zT(u,{relative:h}),b=c.toLowerCase()==="get"?"get":"post",L=typeof u=="string"&&dy.test(u),_=I=>{if(f&&f(I),I.defaultPrevented)return;I.preventDefault();let C=I.nativeEvent.submitter,N=(C==null?void 0:C.getAttribute("formmethod"))||c;E(C||I.currentTarget,{fetcherKey:e,method:N,navigate:t,replace:r,state:a,relative:h,preventScrollReset:m,viewTransition:p})};return te.createElement("form",{ref:S,method:b,action:T,onSubmit:i?f:_,...y,"data-discover":!L&&l==="render"?"true":void 0})});jT.displayName="Form";function $T(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hy(l){let e=te.useContext(hr);return tt(e,$T(l)),e}function GT(l,{target:e,replace:t,state:i,preventScrollReset:r,relative:a,viewTransition:c}={}){let u=ZS(),f=Bs(),h=wa(l,{relative:a});return te.useCallback(m=>{if(vT(m,e)){m.preventDefault();let p=t!==void 0?t:Sa(f)===Sa(h);u(l,{replace:p,state:i,preventScrollReset:r,relative:a,viewTransition:c})}},[f,u,h,t,i,e,l,r,a,c])}var HT=0,VT=()=>`__${String(++HT)}__`;function KT(){let{router:l}=hy("useSubmit"),{basename:e}=te.useContext(Bi),t=cT();return te.useCallback(async(i,r={})=>{let{action:a,method:c,encType:u,formData:f,body:h}=TT(i,e);if(r.navigate===!1){let m=r.fetcherKey||VT();await l.fetch(m,t,r.action||a,{preventScrollReset:r.preventScrollReset,formData:f,body:h,formMethod:r.method||c,formEncType:r.encType||u,flushSync:r.flushSync})}else await l.navigate(r.action||a,{preventScrollReset:r.preventScrollReset,formData:f,body:h,formMethod:r.method||c,formEncType:r.encType||u,replace:r.replace,state:r.state,fromRouteId:t,flushSync:r.flushSync,viewTransition:r.viewTransition})},[l,e,t])}function zT(l,{relative:e}={}){let{basename:t}=te.useContext(Bi),i=te.useContext(ls);tt(i,"useFormAction must be used inside a RouteContext");let[r]=i.matches.slice(-1),a={...wa(l||".",{relative:e})},c=Bs();if(l==null){a.search=c.search;let u=new URLSearchParams(a.search),f=u.getAll("index");if(f.some(m=>m==="")){u.delete("index"),f.filter(p=>p).forEach(p=>u.append("index",p));let m=u.toString();a.search=m?`?${m}`:""}}return(!l||l===".")&&r.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:rs([t,a.pathname])),Sa(a)}function YT(l,e={}){let t=te.useContext(sy);tt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=hy("useViewTransitionState"),r=wa(l,{relative:e.relative});if(!t.isTransitioning)return!1;let a=as(t.currentLocation.pathname,i)||t.currentLocation.pathname,c=as(t.nextLocation.pathname,i)||t.nextLocation.pathname;return So(r.pathname,c)!=null||So(r.pathname,a)!=null}[...CT];/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qT=l=>l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),XT=l=>l.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),k0=l=>{const e=XT(l);return e.charAt(0).toUpperCase()+e.slice(1)},fy=(...l)=>l.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),QT=l=>{for(const e in l)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var WT={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZT=te.forwardRef(({color:l="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:a,iconNode:c,...u},f)=>te.createElement("svg",{ref:f,...WT,width:e,height:e,stroke:l,strokeWidth:i?Number(t)*24/Number(e):t,className:fy("lucide",r),...!a&&!QT(u)&&{"aria-hidden":"true"},...u},[...c.map(([h,m])=>te.createElement(h,m)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=(l,e)=>{const t=te.forwardRef(({className:i,...r},a)=>te.createElement(ZT,{ref:a,iconNode:e,className:fy(`lucide-${qT(k0(l))}`,`lucide-${l}`,i),...r}));return t.displayName=k0(l),t};/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JT=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Ms=Pe("arrow-right",JT);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eb=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],tb=Pe("book-open",eb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ib=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],sb=Pe("car",ib);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nb=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],rb=Pe("cloud",nb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ab=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],my=Pe("cpu",ab);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],ob=Pe("crosshair",lb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cb=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ub=Pe("eye",cb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]],hb=Pe("factory",db);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fb=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],mb=Pe("flask-conical",fb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gb=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],pb=Pe("globe",gb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yb=[["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["rect",{x:"2",y:"15",width:"20",height:"4",rx:"1",key:"g3x8cw"}]],xb=Pe("hard-hat",yb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vb=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]],Eb=Pe("heart",vb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sb=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],gy=Pe("lightbulb",Sb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tb=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],py=Pe("lock",Tb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bb=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],Ab=Pe("menu",bb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rb=[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]],Lb=Pe("network",Rb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _b=[["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-4 0v-9a2 2 0 0 1 2-2h2",key:"39pd36"}],["rect",{width:"8",height:"4",x:"10",y:"6",rx:"1",key:"aywv1n"}]],Db=Pe("newspaper",_b);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ib=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Cb=Pe("package",Ib);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wb=[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]],yy=Pe("plane",wb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nb=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],kb=Pe("scan",Nb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ob=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],Mb=Pe("server",Ob);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pb=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],fr=Pe("shield",Pb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ub=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],xy=Pe("stethoscope",Ub);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bb=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Fb=Pe("target",Bb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jb=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],th=Pe("trending-up",jb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $b=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],Gb=Pe("truck",$b);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hb=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],vy=Pe("users",Hb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vb=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Kb=Pe("video",Vb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],Ey=Pe("waves",zb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yb=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],Sy=Pe("wrench",Yb);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qb=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Xb=Pe("x",qb),Qb=()=>{const[l,e]=te.useState(!1),[t,i]=te.useState(!1),r=Bs();return te.useEffect(()=>{const a=()=>{i(window.scrollY>20)};return window.addEventListener("scroll",a),()=>window.removeEventListener("scroll",a)},[]),te.useEffect(()=>{e(!1)},[r]),v.jsx("nav",{className:`fixed w-full z-50 transition-all duration-300 ${t?"bg-black/90 backdrop-blur-md border-b border-white/5":"bg-transparent"}`,children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[v.jsxs("div",{className:"flex justify-between items-center h-20",children:[v.jsxs(Te,{to:"/",className:"flex items-center space-x-3 group",children:[v.jsx("div",{className:"w-8 h-8 bg-white rounded-sm flex items-center justify-center",children:v.jsx("span",{className:"text-black font-bold text-lg",children:"A"})}),v.jsx("span",{className:"text-xl font-medium tracking-tight text-white group-hover:opacity-80 transition-opacity",children:"ARGUS"})]}),v.jsxs("div",{className:"hidden md:flex items-center space-x-10",children:[v.jsx(Te,{to:"/products",className:"text-sm font-medium text-gray-300 hover:text-white transition-colors",children:"Capabilities"}),v.jsx(Te,{to:"/drones",className:"text-sm font-medium text-gray-300 hover:text-white transition-colors",children:"Autonomous Assets"}),v.jsx(Te,{to:"/company",className:"text-sm font-medium text-gray-300 hover:text-white transition-colors",children:"Mission"}),v.jsx(Te,{to:"/company",className:"btn-primary py-2 px-4 text-xs",children:"Contact"})]}),v.jsx("button",{onClick:()=>e(!l),className:"md:hidden p-2 text-white hover:bg-white/10 transition-colors",children:l?v.jsx(Xb,{className:"h-6 w-6"}):v.jsx(Ab,{className:"h-6 w-6"})})]}),l&&v.jsxs("div",{className:"md:hidden absolute top-20 left-0 w-full bg-black border-b border-white/10 py-8 px-4 flex flex-col space-y-6",children:[v.jsx(Te,{to:"/products",className:"text-lg font-medium text-white hover:text-gray-300",children:"Capabilities"}),v.jsx(Te,{to:"/drones",className:"text-lg font-medium text-white hover:text-gray-300",children:"Autonomous Assets"}),v.jsx(Te,{to:"/company",className:"text-lg font-medium text-white hover:text-gray-300",children:"Mission"}),v.jsx(Te,{to:"/company",className:"btn-primary text-center justify-center",children:"Contact"})]})]})})},Wb=()=>v.jsx("footer",{className:"bg-black text-white py-20 border-t border-white/10",children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-12",children:[v.jsxs("div",{className:"col-span-1 md:col-span-2",children:[v.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[v.jsx("div",{className:"w-6 h-6 bg-white rounded-sm flex items-center justify-center",children:v.jsx("span",{className:"text-black font-bold text-xs",children:"A"})}),v.jsx("span",{className:"text-xl font-medium tracking-tight",children:"ARGUS"})]}),v.jsx("p",{className:"text-sm text-gray-500 max-w-md mb-8 leading-relaxed",children:"Artificial intelligence to protect our democracies. We build software-defined defense systems that ensure information superiority in the modern battlespace."}),v.jsx("p",{className:"text-xs text-gray-600 font-mono",children:" 2025 Argus Systems. All rights reserved."})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium text-sm text-white mb-6 uppercase tracking-widest",children:"Capabilities"}),v.jsxs("ul",{className:"space-y-4 text-sm text-gray-400",children:[v.jsx("li",{children:v.jsx(Te,{to:"/products",className:"hover:text-white transition-colors",children:"Software-Defined Defense"})}),v.jsx("li",{children:v.jsx(Te,{to:"/drones",className:"hover:text-white transition-colors",children:"Autonomous Assets"})}),v.jsx("li",{children:v.jsx(Te,{to:"/products",className:"hover:text-white transition-colors",children:"Edge Intelligence"})})]})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium text-sm text-white mb-6 uppercase tracking-widest",children:"Company"}),v.jsxs("ul",{className:"space-y-4 text-sm text-gray-400",children:[v.jsx("li",{children:v.jsx(Te,{to:"/company",className:"hover:text-white transition-colors",children:"Mission"})}),v.jsx("li",{children:v.jsx(Te,{to:"/company",className:"hover:text-white transition-colors",children:"Careers"})}),v.jsx("li",{children:v.jsx(Te,{to:"/company",className:"hover:text-white transition-colors",children:"Contact"})})]})]})]})})}),de=Number.isFinite||function(l){return typeof l=="number"&&isFinite(l)},Zb=Number.isSafeInteger||function(l){return typeof l=="number"&&Math.abs(l)<=Jb},Jb=Number.MAX_SAFE_INTEGER||9007199254740991;let pe=function(l){return l.NETWORK_ERROR="networkError",l.MEDIA_ERROR="mediaError",l.KEY_SYSTEM_ERROR="keySystemError",l.MUX_ERROR="muxError",l.OTHER_ERROR="otherError",l}({}),H=function(l){return l.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",l.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",l.KEY_SYSTEM_NO_SESSION="keySystemNoSession",l.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",l.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",l.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",l.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",l.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",l.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",l.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",l.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",l.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",l.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",l.MANIFEST_LOAD_ERROR="manifestLoadError",l.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",l.MANIFEST_PARSING_ERROR="manifestParsingError",l.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",l.LEVEL_EMPTY_ERROR="levelEmptyError",l.LEVEL_LOAD_ERROR="levelLoadError",l.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",l.LEVEL_PARSING_ERROR="levelParsingError",l.LEVEL_SWITCH_ERROR="levelSwitchError",l.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",l.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",l.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",l.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",l.FRAG_LOAD_ERROR="fragLoadError",l.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",l.FRAG_DECRYPT_ERROR="fragDecryptError",l.FRAG_PARSING_ERROR="fragParsingError",l.FRAG_GAP="fragGap",l.REMUX_ALLOC_ERROR="remuxAllocError",l.KEY_LOAD_ERROR="keyLoadError",l.KEY_LOAD_TIMEOUT="keyLoadTimeOut",l.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",l.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",l.BUFFER_APPEND_ERROR="bufferAppendError",l.BUFFER_APPENDING_ERROR="bufferAppendingError",l.BUFFER_STALLED_ERROR="bufferStalledError",l.BUFFER_FULL_ERROR="bufferFullError",l.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",l.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",l.ASSET_LIST_LOAD_ERROR="assetListLoadError",l.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",l.ASSET_LIST_PARSING_ERROR="assetListParsingError",l.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",l.INTERNAL_EXCEPTION="internalException",l.INTERNAL_ABORTED="aborted",l.ATTACH_MEDIA_ERROR="attachMediaError",l.UNKNOWN="unknown",l}({}),A=function(l){return l.MEDIA_ATTACHING="hlsMediaAttaching",l.MEDIA_ATTACHED="hlsMediaAttached",l.MEDIA_DETACHING="hlsMediaDetaching",l.MEDIA_DETACHED="hlsMediaDetached",l.MEDIA_ENDED="hlsMediaEnded",l.STALL_RESOLVED="hlsStallResolved",l.BUFFER_RESET="hlsBufferReset",l.BUFFER_CODECS="hlsBufferCodecs",l.BUFFER_CREATED="hlsBufferCreated",l.BUFFER_APPENDING="hlsBufferAppending",l.BUFFER_APPENDED="hlsBufferAppended",l.BUFFER_EOS="hlsBufferEos",l.BUFFERED_TO_END="hlsBufferedToEnd",l.BUFFER_FLUSHING="hlsBufferFlushing",l.BUFFER_FLUSHED="hlsBufferFlushed",l.MANIFEST_LOADING="hlsManifestLoading",l.MANIFEST_LOADED="hlsManifestLoaded",l.MANIFEST_PARSED="hlsManifestParsed",l.LEVEL_SWITCHING="hlsLevelSwitching",l.LEVEL_SWITCHED="hlsLevelSwitched",l.LEVEL_LOADING="hlsLevelLoading",l.LEVEL_LOADED="hlsLevelLoaded",l.LEVEL_UPDATED="hlsLevelUpdated",l.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",l.LEVELS_UPDATED="hlsLevelsUpdated",l.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",l.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",l.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",l.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",l.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",l.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",l.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",l.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",l.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",l.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",l.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",l.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",l.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",l.CUES_PARSED="hlsCuesParsed",l.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",l.INIT_PTS_FOUND="hlsInitPtsFound",l.FRAG_LOADING="hlsFragLoading",l.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",l.FRAG_LOADED="hlsFragLoaded",l.FRAG_DECRYPTED="hlsFragDecrypted",l.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",l.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",l.FRAG_PARSING_METADATA="hlsFragParsingMetadata",l.FRAG_PARSED="hlsFragParsed",l.FRAG_BUFFERED="hlsFragBuffered",l.FRAG_CHANGED="hlsFragChanged",l.FPS_DROP="hlsFpsDrop",l.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",l.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",l.ERROR="hlsError",l.DESTROYING="hlsDestroying",l.KEY_LOADING="hlsKeyLoading",l.KEY_LOADED="hlsKeyLoaded",l.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",l.BACK_BUFFER_REACHED="hlsBackBufferReached",l.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",l.ASSET_LIST_LOADING="hlsAssetListLoading",l.ASSET_LIST_LOADED="hlsAssetListLoaded",l.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",l.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",l.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",l.INTERSTITIAL_STARTED="hlsInterstitialStarted",l.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",l.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",l.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",l.INTERSTITIAL_ENDED="hlsInterstitialEnded",l.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",l.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",l.EVENT_CUE_ENTER="hlsEventCueEnter",l}({});var Ie={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},me={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class Jn{constructor(e,t=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=i}sample(e,t){const i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class eA{constructor(e,t,i,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Jn(e),this.fast_=new Jn(t),this.defaultTTFB_=r,this.ttfb_=new Jn(e)}update(e,t){const{slow_:i,fast_:r,ttfb_:a}=this;i.halfLife!==e&&(this.slow_=new Jn(e,i.getEstimate(),i.getTotalWeight())),r.halfLife!==t&&(this.fast_=new Jn(t,r.getEstimate(),r.getTotalWeight())),a.halfLife!==e&&(this.ttfb_=new Jn(e,a.getEstimate(),a.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const i=8*t,r=e/1e3,a=i/r;this.fast_.sample(r,a),this.slow_.sample(r,a)}sampleTTFB(e){const t=e/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(i,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function tA(l,e,t){return(e=sA(e))in l?Object.defineProperty(l,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):l[e]=t,l}function Ke(){return Ke=Object.assign?Object.assign.bind():function(l){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(l[i]=t[i])}return l},Ke.apply(null,arguments)}function O0(l,e){var t=Object.keys(l);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(l);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(l,r).enumerable})),t.push.apply(t,i)}return t}function je(l){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?O0(Object(t),!0).forEach(function(i){tA(l,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(t)):O0(Object(t)).forEach(function(i){Object.defineProperty(l,i,Object.getOwnPropertyDescriptor(t,i))})}return l}function iA(l,e){if(typeof l!="object"||!l)return l;var t=l[Symbol.toPrimitive];if(t!==void 0){var i=t.call(l,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(l)}function sA(l){var e=iA(l,"string");return typeof e=="symbol"?e:e+""}class mi{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const i=`[${e}]:`;this.trace=ks,this.debug=t.debug.bind(null,i),this.log=t.log.bind(null,i),this.warn=t.warn.bind(null,i),this.info=t.info.bind(null,i),this.error=t.error.bind(null,i)}}const ks=function(){},nA={trace:ks,debug:ks,log:ks,warn:ks,info:ks,error:ks};function Cd(){return Ke({},nA)}function rA(l,e){const t=self.console[l];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${l}] >`):ks}function M0(l,e,t){return e[l]?e[l].bind(e):rA(l,t)}const wd=Cd();function aA(l,e,t){const i=Cd();if(typeof console=="object"&&l===!0||typeof l=="object"){const r=["debug","log","info","warn","error"];r.forEach(a=>{i[a]=M0(a,l,t)});try{i.log(`Debug logs enabled for "${e}" in hls.js version 1.6.13`)}catch{return Cd()}r.forEach(a=>{wd[a]=M0(a,l)})}else Ke(wd,i);return i}const $e=wd;function Ps(l=!0){return typeof self>"u"?void 0:(l||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function lA(l){return typeof self<"u"&&l===self.ManagedMediaSource}function Ty(l,e){const t=Object.keys(l),i=Object.keys(e),r=t.length,a=i.length;return!r||!a||r===a&&!t.some(c=>i.indexOf(c)===-1)}function ti(l,e=!1){if(typeof TextDecoder<"u"){const h=new TextDecoder("utf-8").decode(l);if(e){const m=h.indexOf("\0");return m!==-1?h.substring(0,m):h}return h.replace(/\0/g,"")}const t=l.length;let i,r,a,c="",u=0;for(;u<t;){if(i=l[u++],i===0&&e)return c;if(i===0||i===3)continue;switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c+=String.fromCharCode(i);break;case 12:case 13:r=l[u++],c+=String.fromCharCode((i&31)<<6|r&63);break;case 14:r=l[u++],a=l[u++],c+=String.fromCharCode((i&15)<<12|(r&63)<<6|(a&63)<<0);break}}return c}function wt(l){let e="";for(let t=0;t<l.length;t++){let i=l[t].toString(16);i.length<2&&(i="0"+i),e+=i}return e}function by(l){return Uint8Array.from(l.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function oA(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var nd={exports:{}},P0;function cA(){return P0||(P0=1,function(l,e){(function(t){var i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,c=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,u={buildAbsoluteURL:function(f,h,m){if(m=m||{},f=f.trim(),h=h.trim(),!h){if(!m.alwaysNormalize)return f;var p=u.parseURL(f);if(!p)throw new Error("Error trying to parse base URL.");return p.path=u.normalizePath(p.path),u.buildURLFromParts(p)}var y=u.parseURL(h);if(!y)throw new Error("Error trying to parse relative URL.");if(y.scheme)return m.alwaysNormalize?(y.path=u.normalizePath(y.path),u.buildURLFromParts(y)):h;var S=u.parseURL(f);if(!S)throw new Error("Error trying to parse base URL.");if(!S.netLoc&&S.path&&S.path[0]!=="/"){var E=r.exec(S.path);S.netLoc=E[1],S.path=E[2]}S.netLoc&&!S.path&&(S.path="/");var T={scheme:S.scheme,netLoc:y.netLoc,path:null,params:y.params,query:y.query,fragment:y.fragment};if(!y.netLoc&&(T.netLoc=S.netLoc,y.path[0]!=="/"))if(!y.path)T.path=S.path,y.params||(T.params=S.params,y.query||(T.query=S.query));else{var b=S.path,L=b.substring(0,b.lastIndexOf("/")+1)+y.path;T.path=u.normalizePath(L)}return T.path===null&&(T.path=m.alwaysNormalize?u.normalizePath(y.path):y.path),u.buildURLFromParts(T)},parseURL:function(f){var h=i.exec(f);return h?{scheme:h[1]||"",netLoc:h[2]||"",path:h[3]||"",params:h[4]||"",query:h[5]||"",fragment:h[6]||""}:null},normalizePath:function(f){for(f=f.split("").reverse().join("").replace(a,"");f.length!==(f=f.replace(c,"")).length;);return f.split("").reverse().join("")},buildURLFromParts:function(f){return f.scheme+f.netLoc+f.path+f.params+f.query+f.fragment}};l.exports=u})()}(nd)),nd.exports}var ih=cA();class sh{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var qe={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class Ay{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,dA(this,"stats")}setByteRange(e,t){const i=e.split("@",2);let r;i.length===1?r=(t==null?void 0:t.byteRangeEndOffset)||0:r=parseInt(i[1]),this._byteRange=[r,parseInt(i[0])+r]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[qe.AUDIO]:null,[qe.VIDEO]:null,[qe.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new sh),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=ih.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[qe.AUDIO]=null,e[qe.VIDEO]=null,e[qe.AUDIOVIDEO]=null}}function ut(l){return l.sn!=="initSegment"}class rd extends Ay{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],t=this.byteRange[1];if(de(e)&&de(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){var e;const{levelkeys:t}=this;if(!t||t.NONE)return null;if(t.identity)this._decryptdata||(this._decryptdata=t.identity.getDecryptData(this.sn));else if(!((e=this._decryptdata)!=null&&e.keyId)){const i=Object.keys(t);if(i.length===1){const r=this._decryptdata=t[i[0]]||null;r&&(this._decryptdata=r.getDecryptData(this.sn,t))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=de(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var t;const i=Object.keys(this.levelkeys),r=i.length;if(r>1||r===1&&(t=this.levelkeys[i[0]])!=null&&t.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!de(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return ut(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){const t=this.levelkeys;if(t){var i;const r=t[e];r&&!((i=this._decryptdata)!=null&&i.keyId)&&(this._decryptdata=r.getDecryptData(this.sn,t))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,i,r,a,c=!1){const{elementaryStreams:u}=this,f=u[e];if(!f){u[e]={startPTS:t,endPTS:i,startDTS:r,endDTS:a,partial:c};return}f.startPTS=Math.min(f.startPTS,t),f.endPTS=Math.max(f.endPTS,i),f.startDTS=Math.min(f.startDTS,r),f.endDTS=Math.max(f.endDTS,a)}}class uA extends Ay{constructor(e,t,i,r,a){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;const c=e.enumeratedString("BYTERANGE");c&&this.setByteRange(c,a),a&&(this.fragOffset=a.fragOffset+a.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function Ry(l,e){const t=Object.getPrototypeOf(l);if(t){const i=Object.getOwnPropertyDescriptor(t,e);return i||Ry(t,e)}}function dA(l,e){const t=Ry(l,e);t&&(t.enumerable=!0,Object.defineProperty(l,e,t))}const U0=Math.pow(2,32)-1,hA=[].push,Ly={video:1,audio:2,id3:3,text:4};function ft(l){return String.fromCharCode.apply(null,l)}function _y(l,e){const t=l[e]<<8|l[e+1];return t<0?65536+t:t}function Se(l,e){const t=Dy(l,e);return t<0?4294967296+t:t}function B0(l,e){let t=Se(l,e);return t*=Math.pow(2,32),t+=Se(l,e+4),t}function Dy(l,e){return l[e]<<24|l[e+1]<<16|l[e+2]<<8|l[e+3]}function fA(l){const e=l.byteLength;for(let t=0;t<e;){const i=Se(l,t);if(i>8&&l[t+4]===109&&l[t+5]===111&&l[t+6]===111&&l[t+7]===102)return!0;t=i>1?t+i:e}return!1}function _e(l,e){const t=[];if(!e.length)return t;const i=l.byteLength;for(let r=0;r<i;){const a=Se(l,r),c=ft(l.subarray(r+4,r+8)),u=a>1?r+a:i;if(c===e[0])if(e.length===1)t.push(l.subarray(r+8,u));else{const f=_e(l.subarray(r+8,u),e.slice(1));f.length&&hA.apply(t,f)}r=u}return t}function mA(l){const e=[],t=l[0];let i=8;const r=Se(l,i);i+=4;let a=0,c=0;t===0?(a=Se(l,i),c=Se(l,i+4),i+=8):(a=B0(l,i),c=B0(l,i+8),i+=16),i+=2;let u=l.length+c;const f=_y(l,i);i+=2;for(let h=0;h<f;h++){let m=i;const p=Se(l,m);m+=4;const y=p&2147483647;if((p&2147483648)>>>31===1)return $e.warn("SIDX has hierarchical references (not supported)"),null;const E=Se(l,m);m+=4,e.push({referenceSize:y,subsegmentDuration:E,info:{duration:E/r,start:u,end:u+y-1}}),u+=y,m+=4,i=m}return{earliestPresentationTime:a,timescale:r,version:t,referencesCount:f,references:e}}function Iy(l){const e=[],t=_e(l,["moov","trak"]);for(let r=0;r<t.length;r++){const a=t[r],c=_e(a,["tkhd"])[0];if(c){let u=c[0];const f=Se(c,u===0?12:20),h=_e(a,["mdia","mdhd"])[0];if(h){u=h[0];const m=Se(h,u===0?12:20),p=_e(a,["mdia","hdlr"])[0];if(p){const y=ft(p.subarray(8,12)),S={soun:qe.AUDIO,vide:qe.VIDEO}[y],E=_e(a,["mdia","minf","stbl","stsd"])[0],T=gA(E);S?(e[f]={timescale:m,type:S,stsd:T},e[S]=je({timescale:m,id:f},T)):e[f]={timescale:m,type:y,stsd:T}}}}}return _e(l,["moov","mvex","trex"]).forEach(r=>{const a=Se(r,4),c=e[a];c&&(c.default={duration:Se(r,12),flags:Se(r,20)})}),e}function gA(l){const e=l.subarray(8),t=e.subarray(86),i=ft(e.subarray(4,8));let r=i,a;const c=i==="enca"||i==="encv";if(c){const h=_e(e,[i])[0].subarray(i==="enca"?28:78);_e(h,["sinf"]).forEach(p=>{const y=_e(p,["schm"])[0];if(y){const S=ft(y.subarray(4,8));if(S==="cbcs"||S==="cenc"){const E=_e(p,["frma"])[0];E&&(r=ft(E))}}})}const u=r;switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const f=_e(t,["avcC"])[0];f&&f.length>3&&(r+="."+Xl(f[1])+Xl(f[2])+Xl(f[3]),a=ql(u==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const f=_e(e,[i])[0],h=_e(f.subarray(28),["esds"])[0];if(h&&h.length>7){let m=4;if(h[m++]!==3)break;m=ad(h,m),m+=2;const p=h[m++];if(p&128&&(m+=2),p&64&&(m+=h[m++]),h[m++]!==4)break;m=ad(h,m);const y=h[m++];if(y===64)r+="."+Xl(y);else break;if(m+=12,h[m++]!==5)break;m=ad(h,m);const S=h[m++];let E=(S&248)>>3;E===31&&(E+=1+((S&7)<<3)+((h[m]&224)>>5)),r+="."+E}break}case"hvc1":case"hev1":{const f=_e(t,["hvcC"])[0];if(f&&f.length>12){const h=f[1],m=["","A","B","C"][h>>6],p=h&31,y=Se(f,2),S=(h&32)>>5?"H":"L",E=f[12],T=f.subarray(6,12);r+="."+m+p,r+="."+pA(y).toString(16).toUpperCase(),r+="."+S+E;let b="";for(let L=T.length;L--;){const _=T[L];(_||b)&&(b="."+_.toString(16).toUpperCase()+b)}r+=b}a=ql(u=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{r=ql(r,t)||r;break}case"vp09":{const f=_e(t,["vpcC"])[0];if(f&&f.length>6){const h=f[4],m=f[5],p=f[6]>>4&15;r+="."+wi(h)+"."+wi(m)+"."+wi(p)}break}case"av01":{const f=_e(t,["av1C"])[0];if(f&&f.length>2){const h=f[1]>>>5,m=f[1]&31,p=f[2]>>>7?"H":"M",y=(f[2]&64)>>6,S=(f[2]&32)>>5,E=h===2&&y?S?12:10:y?10:8,T=(f[2]&16)>>4,b=(f[2]&8)>>3,L=(f[2]&4)>>2,_=f[2]&3;r+="."+h+"."+wi(m)+p+"."+wi(E)+"."+T+"."+b+L+_+"."+wi(1)+"."+wi(1)+"."+wi(1)+"."+0,a=ql("dav1",t)}break}}return{codec:r,encrypted:c,supplemental:a}}function ql(l,e){const t=_e(e,["dvvC"]),i=t.length?t[0]:_e(e,["dvcC"])[0];if(i){const r=i[2]>>1&127,a=i[2]<<5&32|i[3]>>3&31;return l+"."+wi(r)+"."+wi(a)}}function pA(l){let e=0;for(let t=0;t<32;t++)e|=(l>>t&1)<<31-t;return e>>>0}function ad(l,e){const t=e+5;for(;l[e++]&128&&e<t;);return e}function Xl(l){return("0"+l.toString(16).toUpperCase()).slice(-2)}function wi(l){return(l<10?"0":"")+l}function yA(l,e){if(!l||!e)return;const t=e.keyId;t&&e.isCommonEncryption&&Cy(l,(i,r)=>{const a=i.subarray(8,24);a.some(c=>c!==0)||($e.log(`[eme] Patching keyId in 'enc${r?"a":"v"}>sinf>>tenc' box: ${wt(a)} -> ${wt(t)}`),i.set(t,8))})}function xA(l){const e=[];return Cy(l,t=>e.push(t.subarray(8,24))),e}function Cy(l,e){_e(l,["moov","trak"]).forEach(i=>{const r=_e(i,["mdia","minf","stbl","stsd"])[0];if(!r)return;const a=r.subarray(8);let c=_e(a,["enca"]);const u=c.length>0;u||(c=_e(a,["encv"])),c.forEach(f=>{const h=u?f.subarray(28):f.subarray(78);_e(h,["sinf"]).forEach(p=>{const y=wy(p);y&&e(y,u)})})})}function wy(l){const e=_e(l,["schm"])[0];if(e){const t=ft(e.subarray(4,8));if(t==="cbcs"||t==="cenc"){const i=_e(l,["schi","tenc"])[0];if(i)return i}}}function vA(l,e,t){const i={},r=_e(l,["moof","traf"]);for(let a=0;a<r.length;a++){const c=r[a],u=_e(c,["tfhd"])[0],f=Se(u,4),h=e[f];if(!h)continue;i[f]||(i[f]={start:NaN,duration:0,sampleCount:0,timescale:h.timescale,type:h.type});const m=i[f],p=_e(c,["tfdt"])[0];if(p){const I=p[0];let C=Se(p,4);I===1&&(C===U0?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(C*=U0+1,C+=Se(p,8))),de(C)&&(!de(m.start)||C<m.start)&&(m.start=C)}const y=h.default,S=Se(u,0)|(y==null?void 0:y.flags);let E=(y==null?void 0:y.duration)||0;S&8&&(S&2?E=Se(u,12):E=Se(u,8));const T=_e(c,["trun"]);let b=m.start||0,L=0,_=E;for(let I=0;I<T.length;I++){const C=T[I],N=Se(C,4),K=m.sampleCount;m.sampleCount+=N;const O=C[3]&1,j=C[3]&4,B=C[2]&1,U=C[2]&2,W=C[2]&4,re=C[2]&8;let ue=8,fe=N;for(O&&(ue+=4),j&&N&&(!(C[ue+1]&1)&&m.keyFrameIndex===void 0&&(m.keyFrameIndex=K),ue+=4,B?(_=Se(C,ue),ue+=4):_=E,U&&(ue+=4),re&&(ue+=4),b+=_,L+=_,fe--);fe--;)B?(_=Se(C,ue),ue+=4):_=E,U&&(ue+=4),W&&(C[ue+1]&1||m.keyFrameIndex===void 0&&(m.keyFrameIndex=m.sampleCount-(fe+1),m.keyFrameStart=b),ue+=4),re&&(ue+=4),b+=_,L+=_;!L&&E&&(L+=E*N)}m.duration+=L}if(!Object.keys(i).some(a=>i[a].duration)){let a=1/0,c=0;const u=_e(l,["sidx"]);for(let f=0;f<u.length;f++){const h=mA(u[f]);if(h!=null&&h.references){a=Math.min(a,h.earliestPresentationTime/h.timescale);const m=h.references.reduce((p,y)=>p+y.info.duration||0,0);c=Math.max(c,m+h.earliestPresentationTime/h.timescale)}}c&&de(c)&&Object.keys(i).forEach(f=>{i[f].duration||(i[f].duration=c*i[f].timescale-i[f].start)})}return i}function EA(l){const e={valid:null,remainder:null},t=_e(l,["moof"]);if(t.length<2)return e.remainder=l,e;const i=t[t.length-1];return e.valid=l.slice(0,i.byteOffset-8),e.remainder=l.slice(i.byteOffset-8),e}function fi(l,e){const t=new Uint8Array(l.length+e.length);return t.set(l),t.set(e,l.length),t}function F0(l,e){const t=[],i=e.samples,r=e.timescale,a=e.id;let c=!1;return _e(i,["moof"]).map(f=>{const h=f.byteOffset-8;_e(f,["traf"]).map(p=>{const y=_e(p,["tfdt"]).map(S=>{const E=S[0];let T=Se(S,4);return E===1&&(T*=Math.pow(2,32),T+=Se(S,8)),T/r})[0];return y!==void 0&&(l=y),_e(p,["tfhd"]).map(S=>{const E=Se(S,4),T=Se(S,0)&16777215,b=(T&1)!==0,L=(T&2)!==0,_=(T&8)!==0;let I=0;const C=(T&16)!==0;let N=0;const K=(T&32)!==0;let O=8;E===a&&(b&&(O+=8),L&&(O+=4),_&&(I=Se(S,O),O+=4),C&&(N=Se(S,O),O+=4),K&&(O+=4),e.type==="video"&&(c=Mo(e.codec)),_e(p,["trun"]).map(j=>{const B=j[0],U=Se(j,0)&16777215,W=(U&1)!==0;let re=0;const ue=(U&4)!==0,fe=(U&256)!==0;let le=0;const M=(U&512)!==0;let Q=0;const Z=(U&1024)!==0,ae=(U&2048)!==0;let w=0;const F=Se(j,4);let q=8;W&&(re=Se(j,q),q+=4),ue&&(q+=4);let se=re+h;for(let oe=0;oe<F;oe++){if(fe?(le=Se(j,q),q+=4):le=I,M?(Q=Se(j,q),q+=4):Q=N,Z&&(q+=4),ae&&(B===0?w=Se(j,q):w=Dy(j,q),q+=4),e.type===qe.VIDEO){let he=0;for(;he<Q;){const ce=Se(i,se);if(se+=4,SA(c,i[se])){const Ue=i.subarray(se,se+ce);nh(Ue,c?2:1,l+w/r,t)}se+=ce,he+=ce+4}}l+=le/r}}))})})}),t}function Mo(l){if(!l)return!1;const e=l.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function SA(l,e){if(l){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function nh(l,e,t,i){const r=Ny(l);let a=0;a+=e;let c=0,u=0,f=0;for(;a<r.length;){c=0;do{if(a>=r.length)break;f=r[a++],c+=f}while(f===255);u=0;do{if(a>=r.length)break;f=r[a++],u+=f}while(f===255);const h=r.length-a;let m=a;if(u<h)a+=u;else if(u>h){$e.error(`Malformed SEI payload. ${u} is too small, only ${h} bytes left to parse.`);break}if(c===4){if(r[m++]===181){const y=_y(r,m);if(m+=2,y===49){const S=Se(r,m);if(m+=4,S===1195456820){const E=r[m++];if(E===3){const T=r[m++],b=31&T,L=64&T,_=L?2+b*3:0,I=new Uint8Array(_);if(L){I[0]=T;for(let C=1;C<_;C++)I[C]=r[m++]}i.push({type:E,payloadType:c,pts:t,bytes:I})}}}}}else if(c===5&&u>16){const p=[];for(let E=0;E<16;E++){const T=r[m++].toString(16);p.push(T.length==1?"0"+T:T),(E===3||E===5||E===7||E===9)&&p.push("-")}const y=u-16,S=new Uint8Array(y);for(let E=0;E<y;E++)S[E]=r[m++];i.push({payloadType:c,pts:t,uuid:p.join(""),userData:ti(S),userDataBytes:S})}}}function Ny(l){const e=l.byteLength,t=[];let i=1;for(;i<e-2;)l[i]===0&&l[i+1]===0&&l[i+2]===3?(t.push(i+2),i+=2):i++;if(t.length===0)return l;const r=e-t.length,a=new Uint8Array(r);let c=0;for(i=0;i<r;c++,i++)c===t[0]&&(c++,t.shift()),a[i]=l[c];return a}function TA(l){const e=l[0];let t="",i="",r=0,a=0,c=0,u=0,f=0,h=0;if(e===0){for(;ft(l.subarray(h,h+1))!=="\0";)t+=ft(l.subarray(h,h+1)),h+=1;for(t+=ft(l.subarray(h,h+1)),h+=1;ft(l.subarray(h,h+1))!=="\0";)i+=ft(l.subarray(h,h+1)),h+=1;i+=ft(l.subarray(h,h+1)),h+=1,r=Se(l,12),a=Se(l,16),u=Se(l,20),f=Se(l,24),h=28}else if(e===1){h+=4,r=Se(l,h),h+=4;const p=Se(l,h);h+=4;const y=Se(l,h);for(h+=4,c=2**32*p+y,Zb(c)||(c=Number.MAX_SAFE_INTEGER,$e.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),u=Se(l,h),h+=4,f=Se(l,h),h+=4;ft(l.subarray(h,h+1))!=="\0";)t+=ft(l.subarray(h,h+1)),h+=1;for(t+=ft(l.subarray(h,h+1)),h+=1;ft(l.subarray(h,h+1))!=="\0";)i+=ft(l.subarray(h,h+1)),h+=1;i+=ft(l.subarray(h,h+1)),h+=1}const m=l.subarray(h,l.byteLength);return{schemeIdUri:t,value:i,timeScale:r,presentationTime:c,presentationTimeDelta:a,eventDuration:u,id:f,payload:m}}function bA(l,...e){const t=e.length;let i=8,r=t;for(;r--;)i+=e[r].byteLength;const a=new Uint8Array(i);for(a[0]=i>>24&255,a[1]=i>>16&255,a[2]=i>>8&255,a[3]=i&255,a.set(l,4),r=0,i=8;r<t;r++)a.set(e[r],i),i+=e[r].byteLength;return a}function AA(l,e,t){if(l.byteLength!==16)throw new RangeError("Invalid system id");let i,r;i=0,r=new Uint8Array;let a;i>0?(a=new Uint8Array(4),e.length>0&&new DataView(a.buffer).setUint32(0,e.length,!1)):a=new Uint8Array;const c=new Uint8Array(4);return t.byteLength>0&&new DataView(c.buffer).setUint32(0,t.byteLength,!1),bA([112,115,115,104],new Uint8Array([i,0,0,0]),l,a,r,c,t)}function RA(l){const e=[];if(l instanceof ArrayBuffer){const t=l.byteLength;let i=0;for(;i+32<t;){const r=new DataView(l,i),a=LA(r);e.push(a),i+=a.size}}return e}function LA(l){const e=l.getUint32(0),t=l.byteOffset,i=l.byteLength;if(i<e)return{offset:t,size:i};if(l.getUint32(4)!==1886614376)return{offset:t,size:e};const a=l.getUint32(8)>>>24;if(a!==0&&a!==1)return{offset:t,size:e};const c=l.buffer,u=wt(new Uint8Array(c,t+12,16));let f=null,h=null,m=0;if(a===0)m=28;else{const y=l.getUint32(28);if(!y||i<32+y*16)return{offset:t,size:e};f=[];for(let S=0;S<y;S++)f.push(new Uint8Array(c,t+32+S*16,16));m=32+y*16}if(!m)return{offset:t,size:e};const p=l.getUint32(m);return e-32<p?{offset:t,size:e}:(h=new Uint8Array(c,t+m+4,p),{version:a,systemId:u,kids:f,data:h,offset:t,size:e})}const ky=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),cr={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function rh(l,e){const t=cr[e];return!!t&&!!t[l.slice(0,4)]}function Ta(l,e,t=!0){return!l.split(",").some(i=>!ah(i,e,t))}function ah(l,e,t=!0){var i;const r=Ps(t);return(i=r==null?void 0:r.isTypeSupported(ba(l,e)))!=null?i:!1}function ba(l,e){return`${e}/mp4;codecs=${l}`}function j0(l){if(l){const e=l.substring(0,4);return cr.video[e]}return 2}function To(l){const e=ky();return l.split(",").reduce((t,i)=>{const a=e&&Mo(i)?9:cr.video[i];return a?(a*2+t)/(t?3:2):(cr.audio[i]+t)/(t?2:1)},0)}const ld={};function _A(l,e=!0){if(ld[l])return ld[l];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[l];for(let r=0;r<t.length;r++){var i;if(ah(t[r],"audio",e))return ld[l]=t[r],t[r];if(t[r]==="mp3"&&(i=Ps(e))!=null&&i.isTypeSupported("audio/mpeg"))return""}return l}const DA=/flac|opus|mp4a\.40\.34/i;function bo(l,e=!0){return l.replace(DA,t=>_A(t.toLowerCase(),e))}function IA(l,e){const t=[];if(l){const i=l.split(",");for(let r=0;r<i.length;r++)rh(i[r],"video")||t.push(i[r])}return e&&t.push(e),t.join(",")}function fo(l,e){if(l&&(l.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(l)!==-1)&&($0(l,"audio")||$0(l,"video")))return l;if(e){const t=e.split(",");if(t.length>1){if(l){for(let i=t.length;i--;)if(t[i].substring(0,4)===l.substring(0,4))return t[i]}return t[0]}}return e||l}function $0(l,e){return rh(l,e)&&ah(l,e)}function CA(l){const e=l.split(",");for(let t=0;t<e.length;t++){const i=e[t].split(".");i.length>2&&i[0]==="avc1"&&(e[t]=`avc1.${parseInt(i[1]).toString(16)}${("000"+parseInt(i[2]).toString(16)).slice(-4)}`)}return e.join(",")}function wA(l){if(l.startsWith("av01.")){const e=l.split("."),t=["0","111","01","01","01","0"];for(let i=e.length;i>4&&i<10;i++)e[i]=t[i-4];return e.join(".")}return l}function G0(l){const e=Ps(l)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function Nd(l){return l.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const NA={supported:!0,powerEfficient:!0,smooth:!0},kA={supported:!1,smooth:!1,powerEfficient:!1},Oy={supported:!0,configurations:[],decodingInfoResults:[NA]};function My(l,e){return{supported:!1,configurations:e,decodingInfoResults:[kA],error:l}}function OA(l,e,t,i,r,a){const c=l.videoCodec,u=l.audioCodec?l.audioGroups:null,f=a==null?void 0:a.audioCodec,h=a==null?void 0:a.channels,m=h?parseInt(h):f?1/0:2;let p=null;if(u!=null&&u.length)try{u.length===1&&u[0]?p=e.groups[u[0]].channels:p=u.reduce((y,S)=>{if(S){const E=e.groups[S];if(!E)throw new Error(`Audio track group ${S} not found`);Object.keys(E.channels).forEach(T=>{y[T]=(y[T]||0)+E.channels[T]})}return y},{2:0})}catch{return!0}return c!==void 0&&(c.split(",").some(y=>Mo(y))||l.width>1920&&l.height>1088||l.height>1920&&l.width>1088||l.frameRate>Math.max(i,30)||l.videoRange!=="SDR"&&l.videoRange!==t||l.bitrate>Math.max(r,8e6))||!!p&&de(m)&&Object.keys(p).some(y=>parseInt(y)>m)}function Py(l,e,t,i={}){const r=l.videoCodec;if(!r&&!l.audioCodec||!t)return Promise.resolve(Oy);const a=[],c=MA(l),u=c.length,f=PA(l,e,u>0),h=f.length;for(let m=u||1*h||1;m--;){const p={type:"media-source"};if(u&&(p.video=c[m%u]),h){p.audio=f[m%h];const y=p.audio.bitrate;p.video&&y&&(p.video.bitrate-=y)}a.push(p)}if(r){const m=navigator.userAgent;if(r.split(",").some(p=>Mo(p))&&ky())return Promise.resolve(My(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${m})`),a))}return Promise.all(a.map(m=>{const p=BA(m);return i[p]||(i[p]=t.decodingInfo(m))})).then(m=>({supported:!m.some(p=>!p.supported),configurations:a,decodingInfoResults:m})).catch(m=>({supported:!1,configurations:a,decodingInfoResults:[],error:m}))}function MA(l){var e;const t=(e=l.videoCodec)==null?void 0:e.split(","),i=Uy(l),r=l.width||640,a=l.height||480,c=l.frameRate||30,u=l.videoRange.toLowerCase();return t?t.map(f=>{const h={contentType:ba(wA(f),"video"),width:r,height:a,bitrate:i,framerate:c};return u!=="sdr"&&(h.transferFunction=u),h}):[]}function PA(l,e,t){var i;const r=(i=l.audioCodec)==null?void 0:i.split(","),a=Uy(l);return r&&l.audioGroups?l.audioGroups.reduce((c,u)=>{var f;const h=u?(f=e.groups[u])==null?void 0:f.tracks:null;return h?h.reduce((m,p)=>{if(p.groupId===u){const y=parseFloat(p.channels||"");r.forEach(S=>{const E={contentType:ba(S,"audio"),bitrate:t?UA(S,a):a};y&&(E.channels=""+y),m.push(E)})}return m},c):c},[]):[]}function UA(l,e){if(e<=1)return 1;let t=128e3;return l==="ec-3"?t=768e3:l==="ac-3"&&(t=64e4),Math.min(e/2,t)}function Uy(l){return Math.ceil(Math.max(l.bitrate*.9,l.averageBitrate)/1e3)*1e3||1}function BA(l){let e="";const{audio:t,video:i}=l;if(i){const r=Nd(i.contentType);e+=`${r}_r${i.height}x${i.width}f${Math.ceil(i.framerate)}${i.transferFunction||"sd"}_${Math.ceil(i.bitrate/1e5)}`}if(t){const r=Nd(t.contentType);e+=`${i?"_":""}${r}_c${t.channels}`}return e}const kd=["NONE","TYPE-0","TYPE-1",null];function FA(l){return kd.indexOf(l)>-1}const Ao=["SDR","PQ","HLG"];function jA(l){return!!l&&Ao.indexOf(l)>-1}var mo={No:"",Yes:"YES",v2:"v2"};function H0(l){const{canSkipUntil:e,canSkipDateRanges:t,age:i}=l,r=i<e/2;return e&&r?t?mo.v2:mo.Yes:mo.No}class V0{constructor(e,t,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=i}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Aa{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(i=>!!i).map(i=>i.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const i=(t=e.supplemental)==null?void 0:t.videoCodec;i&&i!==e.videoCodec&&(this.codecSet+=`,${i.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return K0(this._audioGroups,e)}hasSubtitleGroup(e){return K0(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let i=this._audioGroups;i||(i=this._audioGroups=[]),i.indexOf(t)===-1&&i.push(t)}else if(e==="text"){let i=this._subtitleGroups;i||(i=this._subtitleGroups=[]),i.indexOf(t)===-1&&i.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function K0(l,e){return!e||!l?!1:l.indexOf(e)!==-1}function $A(){if(typeof matchMedia=="function"){const l=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(l.media!==e.media)return l.matches===!0}return!1}function GA(l,e){let t=!1,i=[];if(l&&(t=l!=="SDR",i=[l]),e){i=e.allowedVideoRanges||Ao.slice(0);const r=i.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:r&&$A(),t||(i=["SDR"])}return{preferHDR:t,allowedVideoRanges:i}}const HA=l=>{const e=new WeakSet;return(t,i)=>{if(l&&(i=l(t,i)),typeof i=="object"&&i!==null){if(e.has(i))return;e.add(i)}return i}},Xe=(l,e)=>JSON.stringify(l,HA(e));function VA(l,e,t,i,r){const a=Object.keys(l),c=i==null?void 0:i.channels,u=i==null?void 0:i.audioCodec,f=r==null?void 0:r.videoCodec,h=c&&parseInt(c)===2;let m=!1,p=!1,y=1/0,S=1/0,E=1/0,T=1/0,b=0,L=[];const{preferHDR:_,allowedVideoRanges:I}=GA(e,r);for(let j=a.length;j--;){const B=l[a[j]];m||(m=B.channels[2]>0),y=Math.min(y,B.minHeight),S=Math.min(S,B.minFramerate),E=Math.min(E,B.minBitrate),I.filter(W=>B.videoRanges[W]>0).length>0&&(p=!0)}y=de(y)?y:0,S=de(S)?S:0;const C=Math.max(1080,y),N=Math.max(30,S);E=de(E)?E:t,t=Math.max(E,t),p||(e=void 0);const K=a.length>1;return{codecSet:a.reduce((j,B)=>{const U=l[B];if(B===j)return j;if(L=p?I.filter(W=>U.videoRanges[W]>0):[],K){if(U.minBitrate>t)return Ii(B,`min bitrate of ${U.minBitrate} > current estimate of ${t}`),j;if(!U.hasDefaultAudio)return Ii(B,"no renditions with default or auto-select sound found"),j;if(u&&B.indexOf(u.substring(0,4))%5!==0)return Ii(B,`audio codec preference "${u}" not found`),j;if(c&&!h){if(!U.channels[c])return Ii(B,`no renditions with ${c} channel sound found (channels options: ${Object.keys(U.channels)})`),j}else if((!u||h)&&m&&U.channels[2]===0)return Ii(B,"no renditions with stereo sound found"),j;if(U.minHeight>C)return Ii(B,`min resolution of ${U.minHeight} > maximum of ${C}`),j;if(U.minFramerate>N)return Ii(B,`min framerate of ${U.minFramerate} > maximum of ${N}`),j;if(!L.some(W=>U.videoRanges[W]>0))return Ii(B,`no variants with VIDEO-RANGE of ${Xe(L)} found`),j;if(f&&B.indexOf(f.substring(0,4))%5!==0)return Ii(B,`video codec preference "${f}" not found`),j;if(U.maxScore<b)return Ii(B,`max score of ${U.maxScore} < selected max of ${b}`),j}return j&&(To(B)>=To(j)||U.fragmentError>l[j].fragmentError)?j:(T=U.minIndex,b=U.maxScore,B)},void 0),videoRanges:L,preferHDR:_,minFramerate:S,minBitrate:E,minIndex:T}}function Ii(l,e){$e.log(`[abr] start candidates with "${l}" ignored because ${e}`)}function By(l){return l.reduce((e,t)=>{let i=e.groups[t.groupId];i||(i=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),i.tracks.push(t);const r=t.channels||"2";return i.channels[r]=(i.channels[r]||0)+1,i.hasDefault=i.hasDefault||t.default,i.hasAutoSelect=i.hasAutoSelect||t.autoselect,i.hasDefault&&(e.hasDefaultAudio=!0),i.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function KA(l,e,t,i){return l.slice(t,i+1).reduce((r,a,c)=>{if(!a.codecSet)return r;const u=a.audioGroups;let f=r[a.codecSet];f||(r[a.codecSet]=f={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:c,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!u,fragmentError:0}),f.minBitrate=Math.min(f.minBitrate,a.bitrate);const h=Math.min(a.height,a.width);return f.minHeight=Math.min(f.minHeight,h),f.minFramerate=Math.min(f.minFramerate,a.frameRate),f.minIndex=Math.min(f.minIndex,c),f.maxScore=Math.max(f.maxScore,a.score),f.fragmentError+=a.fragmentError,f.videoRanges[a.videoRange]=(f.videoRanges[a.videoRange]||0)+1,u&&u.forEach(m=>{if(!m)return;const p=e.groups[m];p&&(f.hasDefaultAudio=f.hasDefaultAudio||e.hasDefaultAudio?p.hasDefault:p.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(p.channels).forEach(y=>{f.channels[y]=(f.channels[y]||0)+p.channels[y]}))}),r},{})}function z0(l){if(!l)return l;const{lang:e,assocLang:t,characteristics:i,channels:r,audioCodec:a}=l;return{lang:e,assocLang:t,characteristics:i,channels:r,audioCodec:a}}function ki(l,e,t){if("attrs"in l){const i=e.indexOf(l);if(i!==-1)return i}for(let i=0;i<e.length;i++){const r=e[i];if(un(l,r,t))return i}return-1}function un(l,e,t){const{groupId:i,name:r,lang:a,assocLang:c,default:u}=l,f=l.forced;return(i===void 0||e.groupId===i)&&(r===void 0||e.name===r)&&(a===void 0||zA(a,e.lang))&&(a===void 0||e.assocLang===c)&&(u===void 0||e.default===u)&&(f===void 0||e.forced===f)&&(!("characteristics"in l)||YA(l.characteristics||"",e.characteristics))&&(t===void 0||t(l,e))}function zA(l,e="--"){return l.length===e.length?l===e:l.startsWith(e)||e.startsWith(l)}function YA(l,e=""){const t=l.split(","),i=e.split(",");return t.length===i.length&&!t.some(r=>i.indexOf(r)===-1)}function cn(l,e){const{audioCodec:t,channels:i}=l;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(i===void 0||i===(e.channels||"2"))}function qA(l,e,t,i,r){const a=e[i],u=e.reduce((y,S,E)=>{const T=S.uri;return(y[T]||(y[T]=[])).push(E),y},{})[a.uri];u.length>1&&(i=Math.max.apply(Math,u));const f=a.videoRange,h=a.frameRate,m=a.codecSet.substring(0,4),p=Y0(e,i,y=>{if(y.videoRange!==f||y.frameRate!==h||y.codecSet.substring(0,4)!==m)return!1;const S=y.audioGroups,E=t.filter(T=>!S||S.indexOf(T.groupId)!==-1);return ki(l,E,r)>-1});return p>-1?p:Y0(e,i,y=>{const S=y.audioGroups,E=t.filter(T=>!S||S.indexOf(T.groupId)!==-1);return ki(l,E,r)>-1})}function Y0(l,e,t){for(let i=e;i>-1;i--)if(t(l[i]))return i;for(let i=e+1;i<l.length;i++)if(t(l[i]))return i;return-1}function Ro(l,e){var t;return!!l&&l!==((t=e.loadLevelObj)==null?void 0:t.uri)}class XA extends mi{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var i;const{fragCurrent:r,partCurrent:a,hls:c}=this,{autoLevelEnabled:u,media:f}=c;if(!r||!f)return;const h=performance.now(),m=a?a.stats:r.stats,p=a?a.duration:r.duration,y=h-m.loading.start,S=c.minAutoLevel,E=r.level,T=this._nextAutoLevel;if(m.aborted||m.loaded&&m.loaded===m.total||E<=S){this.clearTimer(),this._nextAutoLevel=-1;return}if(!u)return;const b=T>-1&&T!==E,L=!!t||b;if(!L&&(f.paused||!f.playbackRate||!f.readyState))return;const _=c.mainForwardBufferInfo;if(!L&&_===null)return;const I=this.bwEstimator.getEstimateTTFB(),C=Math.abs(f.playbackRate);if(y<=Math.max(I,1e3*(p/(C*2))))return;const N=_?_.len/C:0,K=m.loading.first?m.loading.first-m.loading.start:-1,O=m.loaded&&K>-1,j=this.getBwEstimate(),B=c.levels,U=B[E],W=Math.max(m.loaded,Math.round(p*(r.bitrate||U.averageBitrate)/8));let re=O?y-K:y;re<1&&O&&(re=Math.min(y,m.loaded*8/j));const ue=O?m.loaded*1e3/re:0,fe=I/1e3,le=ue?(W-m.loaded)/ue:W*8/j+fe;if(le<=N)return;const M=ue?ue*8:j,Q=((i=(t==null?void 0:t.details)||this.hls.latestLevelDetails)==null?void 0:i.live)===!0,Z=this.hls.config.abrBandWidthUpFactor;let ae=Number.POSITIVE_INFINITY,w;for(w=E-1;w>S;w--){const oe=B[w].maxBitrate,he=!B[w].details||Q;if(ae=this.getTimeToLoadFrag(fe,M,p*oe,he),ae<Math.min(N,p+fe))break}if(ae>=le||ae>p*10)return;O?this.bwEstimator.sample(y-Math.min(I,K),m.loaded):this.bwEstimator.sampleTTFB(y);const F=B[w].maxBitrate;this.getBwEstimate()*Z>F&&this.resetEstimator(F);const q=this.findBestLevel(F,S,w,0,N,1,1);q>-1&&(w=q),this.warn(`Fragment ${r.sn}${a?" part "+a.index:""} of level ${E} is loading too slowly;
      Fragment duration: ${r.duration.toFixed(3)}
      Time to underbuffer: ${N.toFixed(3)} s
      Estimated load time for current fragment: ${le.toFixed(3)} s
      Estimated load time for down switch fragment: ${ae.toFixed(3)} s
      TTFB estimate: ${K|0} ms
      Current BW estimate: ${de(j)?j|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${w} @ ${F|0} bps`),c.nextLoadLevel=c.nextAutoLevel=w,this.clearTimer();const se=()=>{if(this.clearTimer(),this.fragCurrent===r&&this.hls.loadLevel===w&&w>0){const oe=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${w>0?"and switching down":""}
      Fragment duration: ${r.duration.toFixed(3)} s
      Time to underbuffer: ${oe.toFixed(3)} s`),r.abortRequests(),this.fragCurrent=this.partCurrent=null,w>S){let he=this.findBestLevel(this.hls.levels[S].bitrate,S,w,0,oe,1,1);he===-1&&(he=S),this.hls.nextLoadLevel=this.hls.nextAutoLevel=he,this.resetEstimator(this.hls.levels[he].bitrate)}}};b||le>ae*2?se():this.timer=self.setInterval(se,ae*1e3),c.trigger(A.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,part:a,stats:m})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new eA(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.FRAG_LOADING,this.onFragLoading,this),e.on(A.FRAG_LOADED,this.onFragLoaded,this),e.on(A.FRAG_BUFFERED,this.onFragBuffered,this),e.on(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(A.LEVEL_LOADED,this.onLevelLoaded,this),e.on(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(A.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(A.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.FRAG_LOADING,this.onFragLoading,this),e.off(A.FRAG_LOADED,this.onFragLoaded,this),e.off(A.FRAG_BUFFERED,this.onFragBuffered,this),e.off(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(A.LEVEL_LOADED,this.onLevelLoaded,this),e.off(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(A.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(A.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const i=t.frag;if(!this.ignoreFragment(i)){if(!i.bitrateTest){var r;this.fragCurrent=i,this.partCurrent=(r=t.part)!=null?r:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case H.BUFFER_ADD_CODEC_ERROR:case H.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case H.FRAG_LOAD_TIMEOUT:{const i=t.frag,{fragCurrent:r,partCurrent:a}=this;if(i&&r&&i.sn===r.sn&&i.level===r.level){const c=performance.now(),u=a?a.stats:i.stats,f=c-u.loading.start,h=u.loading.first?u.loading.first-u.loading.start:-1;if(u.loaded&&h>-1){const p=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(f-Math.min(p,h),u.loaded)}else this.bwEstimator.sampleTTFB(f)}break}}}getTimeToLoadFrag(e,t,i,r){const a=e+i/t,c=r?e+this.lastLevelLoadSec:0;return a+c}onLevelLoaded(e,t){const i=this.hls.config,{loading:r}=t.stats,a=r.end-r.first;de(a)&&(this.lastLevelLoadSec=a/1e3),t.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:i}){const r=i?i.stats:t.stats;if(t.type===me.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const a=i?i.duration:t.duration,c=this.hls.levels[t.level],u=(c.loaded?c.loaded.bytes:0)+r.loaded,f=(c.loaded?c.loaded.duration:0)+a;c.loaded={bytes:u,duration:f},c.realBitrate=Math.round(8*u/f)}if(t.bitrateTest){const a={stats:r,frag:t,part:i,id:t.type};this.onFragBuffered(A.FRAG_BUFFERED,a),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:i,part:r}=t,a=r!=null&&r.stats.loaded?r.stats:i.stats;if(a.aborted||this.ignoreFragment(i))return;const c=a.parsing.end-a.loading.start-Math.min(a.loading.first-a.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(c,a.loaded),a.bwEstimate=this.getBwEstimate(),i.bitrateTest?this.bitrateTestDelay=c/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==me.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,i=this.getBwEstimate(),r=this.hls.config.maxStarvationDelay,a=this.findBestLevel(i,t,e,0,r,1,1);if(a>-1)return a;const c=this.hls.firstLevel,u=Math.min(Math.max(c,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${c} clamped to ${u}`),u}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,i=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(e!==-1&&(!i||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const a=i&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const c=this.hls.levels;if(c.length>Math.max(e,a)&&c[e].loadError<=c[a].loadError)return e}return this._nextAutoLevel=a,this.nextAutoLevelKey=this.getAutoLevelKey(),a}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:i}=this;if(i.levels.length<=1)return i.loadLevel;const{maxAutoLevel:r,config:a,minAutoLevel:c}=i,u=t?t.duration:e?e.duration:0,f=this.getBwEstimate(),h=this.getStarvationDelay();let m=a.abrBandWidthFactor,p=a.abrBandWidthUpFactor;if(h){const b=this.findBestLevel(f,c,r,h,0,m,p);if(b>=0)return this.rebufferNotice=-1,b}let y=u?Math.min(u,a.maxStarvationDelay):a.maxStarvationDelay;if(!h){const b=this.bitrateTestDelay;b&&(y=(u?Math.min(u,a.maxLoadingDelay):a.maxLoadingDelay)-b,this.info(`bitrate test took ${Math.round(1e3*b)}ms, set first fragment max fetchDuration to ${Math.round(1e3*y)} ms`),m=p=1)}const S=this.findBestLevel(f,c,r,h,y,m,p);if(this.rebufferNotice!==S&&(this.rebufferNotice=S,this.info(`${h?"rebuffering expected":"buffer is empty"}, optimal quality level ${S}`)),S>-1)return S;const E=i.levels[c],T=i.loadLevelObj;return T&&(E==null?void 0:E.bitrate)<T.bitrate?c:i.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const i=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,r=e.mainForwardBufferInfo;return(r?r.len:0)/i}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,i,r,a,c,u){var f;const h=r+a,m=this.lastLoadedFragLevel,p=m===-1?this.hls.firstLevel:m,{fragCurrent:y,partCurrent:S}=this,{levels:E,allAudioTracks:T,loadLevel:b,config:L}=this.hls;if(E.length===1)return 0;const _=E[p],I=!!((f=this.hls.latestLevelDetails)!=null&&f.live),C=b===-1||m===-1;let N,K="SDR",O=(_==null?void 0:_.frameRate)||0;const{audioPreference:j,videoPreference:B}=L,U=this.audioTracksByGroup||(this.audioTracksByGroup=By(T));let W=-1;if(C){if(this.firstSelection!==-1)return this.firstSelection;const M=this.codecTiers||(this.codecTiers=KA(E,U,t,i)),Q=VA(M,K,e,j,B),{codecSet:Z,videoRanges:ae,minFramerate:w,minBitrate:F,minIndex:q,preferHDR:se}=Q;W=q,N=Z,K=se?ae[ae.length-1]:ae[0],O=w,e=Math.max(e,F),this.log(`picked start tier ${Xe(Q)}`)}else N=_==null?void 0:_.codecSet,K=_==null?void 0:_.videoRange;const re=S?S.duration:y?y.duration:0,ue=this.bwEstimator.getEstimateTTFB()/1e3,fe=[];for(let M=i;M>=t;M--){var le;const Q=E[M],Z=M>p;if(!Q)continue;if(L.useMediaCapabilities&&!Q.supportedResult&&!Q.supportedPromise){const he=navigator.mediaCapabilities;typeof(he==null?void 0:he.decodingInfo)=="function"&&OA(Q,U,K,O,e,j)?(Q.supportedPromise=Py(Q,U,he,this.supportedCache),Q.supportedPromise.then(ce=>{if(!this.hls)return;Q.supportedResult=ce;const Ue=this.hls.levels,Ae=Ue.indexOf(Q);ce.error?this.warn(`MediaCapabilities decodingInfo error: "${ce.error}" for level ${Ae} ${Xe(ce)}`):ce.supported?ce.decodingInfoResults.some(rt=>rt.smooth===!1||rt.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${Ae} not smooth or powerEfficient: ${Xe(ce)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${Ae} ${Xe(ce)}`),Ae>-1&&Ue.length>1&&(this.log(`Removing unsupported level ${Ae}`),this.hls.removeLevel(Ae),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(ce=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${ce}`)})):Q.supportedResult=Oy}if((N&&Q.codecSet!==N||K&&Q.videoRange!==K||Z&&O>Q.frameRate||!Z&&O>0&&O<Q.frameRate||(le=Q.supportedResult)!=null&&(le=le.decodingInfoResults)!=null&&le.some(he=>he.smooth===!1))&&(!C||M!==W)){fe.push(M);continue}const ae=Q.details,w=(S?ae==null?void 0:ae.partTarget:ae==null?void 0:ae.averagetargetduration)||re;let F;Z?F=u*e:F=c*e;const q=re&&r>=re*2&&a===0?Q.averageBitrate:Q.maxBitrate,se=this.getTimeToLoadFrag(ue,F,q*w,ae===void 0);if(F>=q&&(M===m||Q.loadError===0&&Q.fragmentError===0)&&(se<=ue||!de(se)||I&&!this.bitrateTestDelay||se<h)){const he=this.forcedAutoLevel;return M!==b&&(he===-1||he!==b)&&(fe.length&&this.trace(`Skipped level(s) ${fe.join(",")} of ${i} max with CODECS and VIDEO-RANGE:"${E[fe[0]].codecs}" ${E[fe[0]].videoRange}; not compatible with "${N}" ${K}`),this.info(`switch candidate:${p}->${M} adjustedbw(${Math.round(F)})-bitrate=${Math.round(F-q)} ttfb:${ue.toFixed(1)} avgDuration:${w.toFixed(1)} maxFetchDuration:${h.toFixed(1)} fetchDuration:${se.toFixed(1)} firstSelection:${C} codecSet:${Q.codecSet} videoRange:${Q.videoRange} hls.loadLevel:${b}`)),C&&(this.firstSelection=M),M}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:i}=this.hls;return Math.min(Math.max(e,i),t)}}const Fy={search:function(l,e){let t=0,i=l.length-1,r=null,a=null;for(;t<=i;){r=(t+i)/2|0,a=l[r];const c=e(a);if(c>0)t=r+1;else if(c<0)i=r-1;else return a}return null}};function QA(l,e,t){if(e===null||!Array.isArray(l)||!l.length||!de(e))return null;const i=l[0].programDateTime;if(e<(i||0))return null;const r=l[l.length-1].endProgramDateTime;if(e>=(r||0))return null;for(let a=0;a<l.length;++a){const c=l[a];if(ZA(e,t,c))return c}return null}function hn(l,e,t=0,i=0,r=.005){let a=null;if(l){a=e[1+l.sn-e[0].sn]||null;const u=l.endDTS-t;u>0&&u<15e-7&&(t+=15e-7),a&&l.level!==a.level&&a.end<=l.end&&(a=e[2+l.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(a=e[0]);if(a&&((!l||l.level===a.level)&&q0(t,i,a)===0||WA(a,l,Math.min(r,i))))return a;const c=Fy.search(e,q0.bind(null,t,i));return c&&(c!==l||!a)?c:a}function WA(l,e,t){if(e&&e.start===0&&e.level<l.level&&(e.endPTS||0)>0){const i=e.tagList.reduce((r,a)=>(a[0]==="INF"&&(r+=parseFloat(a[1])),r),t);return l.start<=i}return!1}function q0(l=0,e=0,t){if(t.start<=l&&t.start+t.duration>l)return 0;const i=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-i<=l?1:t.start-i>l&&t.start?-1:0}function ZA(l,e,t){const i=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-i>l}function jy(l,e,t){if(l&&l.startCC<=e&&l.endCC>=e){let i=l.fragments;const{fragmentHint:r}=l;r&&(i=i.concat(r));let a;return Fy.search(i,c=>c.cc<e?1:c.cc>e?-1:(a=c,c.end<=t?1:c.start>t?-1:0)),a||null}return null}function Lo(l){switch(l.details){case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_TIMEOUT:case H.LEVEL_LOAD_TIMEOUT:case H.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function $y(l){return l.details.startsWith("key")}function Gy(l){return $y(l)&&!!l.frag&&!l.frag.decryptdata}function X0(l,e){const t=Lo(e);return l.default[`${t?"timeout":"error"}Retry`]}function lh(l,e){const t=l.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*l.retryDelayMs,l.maxRetryDelayMs)}function Q0(l){return je(je({},l),{errorRetry:null,timeoutRetry:null})}function _o(l,e,t,i){if(!l)return!1;const r=i==null?void 0:i.code,a=e<l.maxNumRetry&&(JA(r)||!!t);return l.shouldRetry?l.shouldRetry(l,e,t,i,a):a}function JA(l){return Od(l)||!!l&&(l<400||l>499)}function Od(l){return l===0&&navigator.onLine===!1}var bt={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},Wt={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class e1 extends mi{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(A.ERROR,this.onError,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(A.ERROR,this.onError,this),e.off(A.ERROR,this.onErrorOut,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===me.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;const t=this.hls,i=t.currentLevel;return(e=t.loadLevelObj)!=null&&e.details||i===-1?t.loadLevel:i}variantHasKey(e,t){if(e){var i;if((i=e.details)!=null&&i.hasKey(t))return!0;const r=e.audioGroups;if(r)return this.hls.allAudioTracks.filter(c=>r.indexOf(c.groupId)>=0).some(c=>{var u;return(u=c.details)==null?void 0:u.hasKey(t)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,t){var i;if(t.fatal)return;const r=this.hls,a=t.context;switch(t.details){case H.FRAG_LOAD_ERROR:case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_ERROR:case H.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case H.FRAG_PARSING_ERROR:if((i=t.frag)!=null&&i.gap){t.errorAction=rr();return}case H.FRAG_GAP:case H.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=bt.SendAlternateToPenaltyBox;return}case H.LEVEL_EMPTY_ERROR:case H.LEVEL_PARSING_ERROR:{var c;const f=t.parent===me.MAIN?t.level:r.loadLevel;t.details===H.LEVEL_EMPTY_ERROR&&((c=t.context)!=null&&(c=c.levelDetails)!=null&&c.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,f):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,f))}return;case H.LEVEL_LOAD_ERROR:case H.LEVEL_LOAD_TIMEOUT:typeof(a==null?void 0:a.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,a.level));return;case H.AUDIO_TRACK_LOAD_ERROR:case H.AUDIO_TRACK_LOAD_TIMEOUT:case H.SUBTITLE_LOAD_ERROR:case H.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){const f=r.loadLevelObj;if(f&&(a.type===Ie.AUDIO_TRACK&&f.hasAudioGroup(a.groupId)||a.type===Ie.SUBTITLE_TRACK&&f.hasSubtitleGroup(a.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.loadLevel),t.errorAction.action=bt.SendAlternateToPenaltyBox,t.errorAction.flags=Wt.MoveAllAlternatesMatchingHost;return}}return;case H.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:t.errorAction={action:bt.SendAlternateToPenaltyBox,flags:Wt.MoveAllAlternatesMatchingHDCP};return;case H.KEY_SYSTEM_SESSION_UPDATE_FAILED:case H.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case H.KEY_SYSTEM_NO_SESSION:t.errorAction={action:bt.SendAlternateToPenaltyBox,flags:Wt.MoveAllAlternatesMatchingKey};return;case H.BUFFER_ADD_CODEC_ERROR:case H.REMUX_ALLOC_ERROR:case H.BUFFER_APPEND_ERROR:if(!t.errorAction){var u;t.errorAction=this.getLevelSwitchAction(t,(u=t.level)!=null?u:r.loadLevel)}return;case H.INTERNAL_EXCEPTION:case H.BUFFER_APPENDING_ERROR:case H.BUFFER_FULL_ERROR:case H.LEVEL_SWITCH_ERROR:case H.BUFFER_STALLED_ERROR:case H.BUFFER_SEEK_OVER_HOLE:case H.BUFFER_NUDGE_ON_STALL:t.errorAction=rr();return}t.type===pe.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=rr())}getPlaylistRetryOrSwitchAction(e,t){const i=this.hls,r=X0(i.config.playlistLoadPolicy,e),a=this.playlistError++;if(_o(r,a,Lo(e),e.response))return{action:bt.RetryRequest,flags:Wt.None,retryConfig:r,retryCount:a};const u=this.getLevelSwitchAction(e,t);return r&&(u.retryConfig=r,u.retryCount=a),u}getFragRetryOrSwitchAction(e){const t=this.hls,i=this.getVariantLevelIndex(e.frag),r=t.levels[i],{fragLoadPolicy:a,keyLoadPolicy:c}=t.config,u=X0($y(e)?c:a,e),f=t.levels.reduce((m,p)=>m+p.fragmentError,0);if(r&&(e.details!==H.FRAG_GAP&&r.fragmentError++,!Gy(e)&&_o(u,f,Lo(e),e.response)))return{action:bt.RetryRequest,flags:Wt.None,retryConfig:u,retryCount:f};const h=this.getLevelSwitchAction(e,i);return u&&(h.retryConfig=u,h.retryCount=f),h}getLevelSwitchAction(e,t){const i=this.hls;t==null&&(t=i.loadLevel);const r=this.hls.levels[t];if(r){var a,c;const h=e.details;r.loadError++,h===H.BUFFER_APPEND_ERROR&&r.fragmentError++;let m=-1;const{levels:p,loadLevel:y,minAutoLevel:S,maxAutoLevel:E}=i;!i.autoLevelEnabled&&!i.config.preserveManualLevelOnError&&(i.loadLevel=-1);const T=(a=e.frag)==null?void 0:a.type,L=(T===me.AUDIO&&h===H.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(h===H.BUFFER_ADD_CODEC_ERROR||h===H.BUFFER_APPEND_ERROR))&&p.some(({audioCodec:K})=>r.audioCodec!==K),I=e.sourceBufferName==="video"&&(h===H.BUFFER_ADD_CODEC_ERROR||h===H.BUFFER_APPEND_ERROR)&&p.some(({codecSet:K,audioCodec:O})=>r.codecSet!==K&&r.audioCodec===O),{type:C,groupId:N}=(c=e.context)!=null?c:{};for(let K=p.length;K--;){const O=(K+y)%p.length;if(O!==y&&O>=S&&O<=E&&p[O].loadError===0){var u,f;const j=p[O];if(h===H.FRAG_GAP&&T===me.MAIN&&e.frag){const B=p[O].details;if(B){const U=hn(e.frag,B.fragments,e.frag.start);if(U!=null&&U.gap)continue}}else{if(C===Ie.AUDIO_TRACK&&j.hasAudioGroup(N)||C===Ie.SUBTITLE_TRACK&&j.hasSubtitleGroup(N))continue;if(T===me.AUDIO&&(u=r.audioGroups)!=null&&u.some(B=>j.hasAudioGroup(B))||T===me.SUBTITLE&&(f=r.subtitleGroups)!=null&&f.some(B=>j.hasSubtitleGroup(B))||L&&r.audioCodec===j.audioCodec||I&&r.codecSet===j.codecSet||!L&&r.codecSet!==j.codecSet)continue}m=O;break}}if(m>-1&&i.loadLevel!==m)return e.levelRetry=!0,this.playlistError=0,{action:bt.SendAlternateToPenaltyBox,flags:Wt.None,nextAutoLevel:m}}return{action:bt.SendAlternateToPenaltyBox,flags:Wt.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var i;switch((i=t.errorAction)==null?void 0:i.action){case bt.DoNothing:break;case bt.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==H.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,i=e.errorAction;if(!i)return;const{flags:r}=i,a=i.nextAutoLevel;switch(r){case Wt.None:this.switchLevel(e,a);break;case Wt.MoveAllAlternatesMatchingHDCP:{const f=this.getVariantLevelIndex(e.frag),h=t.levels[f],m=h==null?void 0:h.attrs["HDCP-LEVEL"];if(i.hdcpLevel=m,m==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(m){t.maxHdcpLevel=kd[kd.indexOf(m)-1],i.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}}case Wt.MoveAllAlternatesMatchingKey:{const f=e.decryptdata;if(f){const h=this.hls.levels,m=h.length;for(let y=m;y--;)if(this.variantHasKey(h[y],f)){var c,u;this.log(`Banned key found in level ${y} (${h[y].bitrate}bps) or audio group "${(c=h[y].audioGroups)==null?void 0:c.join(",")}" (${(u=e.frag)==null?void 0:u.type} fragment) ${wt(f.keyId||[])}`),h[y].fragmentError++,h[y].loadError++,this.log(`Removing level ${y} with key error (${e.error})`),this.hls.removeLevel(y)}const p=e.frag;if(this.hls.levels.length<m)i.resolved=!0;else if(p&&p.type!==me.MAIN){const y=p.decryptdata;y&&!f.matches(y)&&(i.resolved=!0)}}break}}i.resolved||this.switchLevel(e,a)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===H.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const i=Nd(e.mimeType),r=this.hls.levels;for(let a=r.length;a--;)r[a][`${e.sourceBufferName}Codec`]===i&&(this.log(`Removing level ${a} for ${e.details} ("${i}" not supported)`),this.hls.removeLevel(a))}}}function rr(l){const e={action:bt.DoNothing,flags:Wt.None};return l&&(e.resolved=!0),e}var mt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class t1{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.BUFFER_APPENDED,this.onBufferAppended,this),e.on(A.FRAG_BUFFERED,this.onFragBuffered,this),e.on(A.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.BUFFER_APPENDED,this.onBufferAppended,this),e.off(A.FRAG_BUFFERED,this.onFragBuffered,this),e.off(A.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const i=this.activePartLists[t];if(i)for(let r=i.length;r--;){const a=i[r];if(!a)break;if(a.start<=e&&e<=a.end&&a.loaded)return a}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,i){const{fragments:r}=this,a=Object.keys(r);for(let c=a.length;c--;){const u=r[a[c]];if((u==null?void 0:u.body.type)===t&&(!i||u.buffered)){const f=u.body;if(f.start<=e&&e<=f.end)return f}}return null}detectEvictedFragments(e,t,i,r,a){this.timeRanges&&(this.timeRanges[e]=t);const c=(r==null?void 0:r.fragment.sn)||-1;Object.keys(this.fragments).forEach(u=>{const f=this.fragments[u];if(!f||c>=f.body.sn)return;if(!f.buffered&&(!f.loaded||a)){f.body.type===i&&this.removeFragment(f.body);return}const h=f.range[e];if(h){if(h.time.length===0){this.removeFragment(f.body);return}h.time.some(m=>{const p=!this.isTimeBuffered(m.startPTS,m.endPTS,t);return p&&this.removeFragment(f.body),p})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const i=e.frag,r=er(i),a=this.fragments[r];if(!a||a.buffered&&i.gap)return;const c=!i.relurl;Object.keys(t).forEach(u=>{const f=i.elementaryStreams[u];if(!f)return;const h=t[u],m=c||f.partial===!0;a.range[u]=this.getBufferedTimes(i,e.part,m,h)}),a.loaded=null,Object.keys(a.range).length?(a.buffered=!0,(a.body.endList=i.endList||a.body.endList)&&(this.endListFragments[a.body.type]=a),Ql(a)||this.removeParts(i.sn-1,i.type)):this.removeFragment(a.body)}removeParts(e,t){const i=this.activePartLists[t];i&&(this.activePartLists[t]=W0(i,r=>r.fragment.sn>=e))}fragBuffered(e,t){const i=er(e);let r=this.fragments[i];!r&&t&&(r=this.fragments[i]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(e,t,i,r){const a={time:[],partial:i},c=e.start,u=e.end,f=e.minEndPTS||u,h=e.maxStartPTS||c;for(let m=0;m<r.length;m++){const p=r.start(m)-this.bufferPadding,y=r.end(m)+this.bufferPadding;if(h>=p&&f<=y){a.time.push({startPTS:Math.max(c,r.start(m)),endPTS:Math.min(u,r.end(m))});break}else if(c<y&&u>p){const S=Math.max(c,r.start(m)),E=Math.min(u,r.end(m));E>S&&(a.partial=!0,a.time.push({startPTS:S,endPTS:E}))}else if(u<=p)break}return a}getPartialFragment(e){let t=null,i,r,a,c=0;const{bufferPadding:u,fragments:f}=this;return Object.keys(f).forEach(h=>{const m=f[h];m&&Ql(m)&&(r=m.body.start-u,a=m.body.end+u,e>=r&&e<=a&&(i=Math.min(e-r,a-e),c<=i&&(t=m.body,c=i)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Ql(t))}getState(e){const t=er(e),i=this.fragments[t];return i?i.buffered?Ql(i)?mt.PARTIAL:mt.OK:mt.APPENDING:mt.NOT_LOADED}isTimeBuffered(e,t,i){let r,a;for(let c=0;c<i.length;c++){if(r=i.start(c)-this.bufferPadding,a=i.end(c)+this.bufferPadding,e>=r&&t<=a)return!0;if(t<=r)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const i=t.frag,r=t.part?null:t,a=er(i);this.fragments[a]={body:i,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:i,part:r,timeRanges:a,type:c}=t;if(i.sn==="initSegment")return;const u=i.type;if(r){let h=this.activePartLists[u];h||(this.activePartLists[u]=h=[]),h.push(r)}this.timeRanges=a;const f=a[c];this.detectEvictedFragments(c,f,u,r)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=er(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,i=Object.keys(t);if(!e)return i.length>0;for(let r=i.length;r--;){const a=t[i[r]];if((a==null?void 0:a.body.type)===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,i,r,a){r&&!this.hasGaps||Object.keys(this.fragments).forEach(c=>{const u=this.fragments[c];if(!u)return;const f=u.body;f.type!==i||r&&!f.gap||f.start<t&&f.end>e&&(u.buffered||a)&&this.removeFragment(f)})}removeFragment(e){const t=er(e);e.clearElementaryStreamInfo();const i=this.activePartLists[e.type];if(i){const r=e.sn;this.activePartLists[e.type]=W0(i,a=>a.fragment.sn!==r)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const t=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;t&&t.forEach(i=>i.clearElementaryStreamInfo())}}function Ql(l){var e,t,i;return l.buffered&&!!(l.body.gap||(e=l.range.video)!=null&&e.partial||(t=l.range.audio)!=null&&t.partial||(i=l.range.audiovideo)!=null&&i.partial)}function er(l){return`${l.type}_${l.level}_${l.sn}`}function W0(l,e){return l.filter(t=>{const i=e(t);return i||t.clearElementaryStreamInfo(),i})}var Us={cbc:0,ctr:1};class i1{constructor(e,t,i){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=i}decrypt(e,t){switch(this.aesMode){case Us.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case Us.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function s1(l){const e=l.byteLength,t=e&&new DataView(l.buffer).getUint8(e-1);return t?l.slice(0,e-t):l}class n1{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),i=new Uint32Array(4);for(let r=0;r<4;r++)i[r]=t.getUint32(r*4);return i}initTable(){const e=this.sBox,t=this.invSBox,i=this.subMix,r=i[0],a=i[1],c=i[2],u=i[3],f=this.invSubMix,h=f[0],m=f[1],p=f[2],y=f[3],S=new Uint32Array(256);let E=0,T=0,b=0;for(b=0;b<256;b++)b<128?S[b]=b<<1:S[b]=b<<1^283;for(b=0;b<256;b++){let L=T^T<<1^T<<2^T<<3^T<<4;L=L>>>8^L&255^99,e[E]=L,t[L]=E;const _=S[E],I=S[_],C=S[I];let N=S[L]*257^L*16843008;r[E]=N<<24|N>>>8,a[E]=N<<16|N>>>16,c[E]=N<<8|N>>>24,u[E]=N,N=C*16843009^I*65537^_*257^E*16843008,h[L]=N<<24|N>>>8,m[L]=N<<16|N>>>16,p[L]=N<<8|N>>>24,y[L]=N,E?(E=_^S[S[S[C^_]]],T^=S[S[T]]):E=T=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let i=!0,r=0;for(;r<t.length&&i;)i=t[r]===this.key[r],r++;if(i)return;this.key=t;const a=this.keySize=t.length;if(a!==4&&a!==6&&a!==8)throw new Error("Invalid aes key size="+a);const c=this.ksRows=(a+6+1)*4;let u,f;const h=this.keySchedule=new Uint32Array(c),m=this.invKeySchedule=new Uint32Array(c),p=this.sBox,y=this.rcon,S=this.invSubMix,E=S[0],T=S[1],b=S[2],L=S[3];let _,I;for(u=0;u<c;u++){if(u<a){_=h[u]=t[u];continue}I=_,u%a===0?(I=I<<8|I>>>24,I=p[I>>>24]<<24|p[I>>>16&255]<<16|p[I>>>8&255]<<8|p[I&255],I^=y[u/a|0]<<24):a>6&&u%a===4&&(I=p[I>>>24]<<24|p[I>>>16&255]<<16|p[I>>>8&255]<<8|p[I&255]),h[u]=_=(h[u-a]^I)>>>0}for(f=0;f<c;f++)u=c-f,f&3?I=h[u]:I=h[u-4],f<4||u<=4?m[f]=I:m[f]=E[p[I>>>24]]^T[p[I>>>16&255]]^b[p[I>>>8&255]]^L[p[I&255]],m[f]=m[f]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,i){const r=this.keySize+6,a=this.invKeySchedule,c=this.invSBox,u=this.invSubMix,f=u[0],h=u[1],m=u[2],p=u[3],y=this.uint8ArrayToUint32Array_(i);let S=y[0],E=y[1],T=y[2],b=y[3];const L=new Int32Array(e),_=new Int32Array(L.length);let I,C,N,K,O,j,B,U,W,re,ue,fe,le,M;const Q=this.networkToHostOrderSwap;for(;t<L.length;){for(W=Q(L[t]),re=Q(L[t+1]),ue=Q(L[t+2]),fe=Q(L[t+3]),O=W^a[0],j=fe^a[1],B=ue^a[2],U=re^a[3],le=4,M=1;M<r;M++)I=f[O>>>24]^h[j>>16&255]^m[B>>8&255]^p[U&255]^a[le],C=f[j>>>24]^h[B>>16&255]^m[U>>8&255]^p[O&255]^a[le+1],N=f[B>>>24]^h[U>>16&255]^m[O>>8&255]^p[j&255]^a[le+2],K=f[U>>>24]^h[O>>16&255]^m[j>>8&255]^p[B&255]^a[le+3],O=I,j=C,B=N,U=K,le=le+4;I=c[O>>>24]<<24^c[j>>16&255]<<16^c[B>>8&255]<<8^c[U&255]^a[le],C=c[j>>>24]<<24^c[B>>16&255]<<16^c[U>>8&255]<<8^c[O&255]^a[le+1],N=c[B>>>24]<<24^c[U>>16&255]<<16^c[O>>8&255]<<8^c[j&255]^a[le+2],K=c[U>>>24]<<24^c[O>>16&255]<<16^c[j>>8&255]<<8^c[B&255]^a[le+3],_[t]=Q(I^S),_[t+1]=Q(K^E),_[t+2]=Q(N^T),_[t+3]=Q(C^b),S=W,E=re,T=ue,b=fe,t=t+4}return _.buffer}}class r1{constructor(e,t,i){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=i}expandKey(){const e=a1(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function a1(l){switch(l){case Us.cbc:return"AES-CBC";case Us.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${l}`)}}const l1=16;class oh{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const i=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?s1(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,i,r){return this.useSoftware?new Promise((a,c)=>{const u=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(u,t,i,r);const f=this.flush();f?a(f.buffer):c(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,i,r)}softwareDecrypt(e,t,i,r){const{currentIV:a,currentResult:c,remainderData:u}=this;if(r!==Us.cbc||t.byteLength!==16)return $e.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),u&&(e=fi(u,e),this.remainderData=null);const f=this.getValidChunk(e);if(!f.length)return null;a&&(i=a);let h=this.softwareDecrypter;h||(h=this.softwareDecrypter=new n1),h.expandKey(t);const m=c;return this.currentResult=h.decrypt(f.buffer,0,i),this.currentIV=f.slice(-16).buffer,m||null}webCryptoDecrypt(e,t,i,r){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,i,r));this.key=t,this.fastAesKey=new r1(this.subtle,t,r)}return this.fastAesKey.expandKey().then(a=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new i1(this.subtle,new Uint8Array(i),r).decrypt(e.buffer,a)):Promise.reject(new Error("web crypto not initialized"))).catch(a=>($e.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${a.name}: ${a.message}`),this.onWebCryptoError(e,t,i,r)))}onWebCryptoError(e,t,i,r){const a=this.enableSoftwareAES;if(a){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,i,r);const c=this.flush();if(c)return c.buffer}throw new Error("WebCrypto"+(a?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const i=e.length-e.length%l1;return i!==e.length&&(t=e.slice(0,i),this.remainderData=e.slice(i)),t}logOnce(e){this.logEnabled&&($e.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const Z0=Math.pow(2,17);class o1{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const i=e.url;if(!i)return Promise.reject(new ss({type:pe.NETWORK_ERROR,details:H.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${i?"part list":"url"}`),networkDetails:null}));this.abort();const r=this.config,a=r.fLoader,c=r.loader;return new Promise((u,f)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(E=>E[0]==="GAP")){f(ep(e));return}else e.gap=!1;const h=this.loader=a?new a(r):new c(r),m=J0(e);e.loader=h;const p=Q0(r.fragLoadPolicy.default),y={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:Z0};e.stats=h.stats;const S={onSuccess:(E,T,b,L)=>{this.resetLoader(e,h);let _=E.data;b.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(_.slice(0,16)),_=_.slice(16)),u({frag:e,part:null,payload:_,networkDetails:L})},onError:(E,T,b,L)=>{this.resetLoader(e,h),f(new ss({type:pe.NETWORK_ERROR,details:H.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:je({url:i,data:void 0},E),error:new Error(`HTTP Error ${E.code} ${E.text}`),networkDetails:b,stats:L}))},onAbort:(E,T,b)=>{this.resetLoader(e,h),f(new ss({type:pe.NETWORK_ERROR,details:H.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:b,stats:E}))},onTimeout:(E,T,b)=>{this.resetLoader(e,h),f(new ss({type:pe.NETWORK_ERROR,details:H.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${y.timeout}ms`),networkDetails:b,stats:E}))}};t&&(S.onProgress=(E,T,b,L)=>t({frag:e,part:null,payload:b,networkDetails:L})),h.load(m,y,S)})}loadPart(e,t,i){this.abort();const r=this.config,a=r.fLoader,c=r.loader;return new Promise((u,f)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){f(ep(e,t));return}const h=this.loader=a?new a(r):new c(r),m=J0(e,t);e.loader=h;const p=Q0(r.fragLoadPolicy.default),y={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Z0};t.stats=h.stats,h.load(m,y,{onSuccess:(S,E,T,b)=>{this.resetLoader(e,h),this.updateStatsFromPart(e,t);const L={frag:e,part:t,payload:S.data,networkDetails:b};i(L),u(L)},onError:(S,E,T,b)=>{this.resetLoader(e,h),f(new ss({type:pe.NETWORK_ERROR,details:H.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:je({url:m.url,data:void 0},S),error:new Error(`HTTP Error ${S.code} ${S.text}`),networkDetails:T,stats:b}))},onAbort:(S,E,T)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,h),f(new ss({type:pe.NETWORK_ERROR,details:H.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:T,stats:S}))},onTimeout:(S,E,T)=>{this.resetLoader(e,h),f(new ss({type:pe.NETWORK_ERROR,details:H.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${y.timeout}ms`),networkDetails:T,stats:S}))}})})}updateStatsFromPart(e,t){const i=e.stats,r=t.stats,a=r.total;if(i.loaded+=r.loaded,a){const f=Math.round(e.duration/t.duration),h=Math.min(Math.round(i.loaded/a),f),p=(f-h)*Math.round(i.loaded/h);i.total=i.loaded+p}else i.total=Math.max(i.loaded,i.total);const c=i.loading,u=r.loading;c.start?c.first+=u.first-u.start:(c.start=u.start,c.first=u.first),c.end=u.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function J0(l,e=null){const t=e||l,i={frag:l,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},r=t.byteRangeStartOffset,a=t.byteRangeEndOffset;if(de(r)&&de(a)){var c;let u=r,f=a;if(l.sn==="initSegment"&&c1((c=l.decryptdata)==null?void 0:c.method)){const h=a-r;h%16&&(f=a+(16-h%16)),r!==0&&(i.resetIV=!0,u=r-16)}i.rangeStart=u,i.rangeEnd=f}return i}function ep(l,e){const t=new Error(`GAP ${l.gap?"tag":"attribute"} found`),i={type:pe.MEDIA_ERROR,details:H.FRAG_GAP,fatal:!1,frag:l,error:t,networkDetails:null};return e&&(i.part=e),(e||l).stats.aborted=!0,new ss(i)}function c1(l){return l==="AES-128"||l==="AES-256"}class ss extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class Hy extends mi{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class ch{constructor(e,t,i,r=0,a=-1,c=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Wl(),this.buffering={audio:Wl(),video:Wl(),audiovideo:Wl()},this.level=e,this.sn=t,this.id=i,this.size=r,this.part=a,this.partial=c}}function Wl(){return{start:0,executeStart:0,executeEnd:0,end:0}}const tp={length:0,start:()=>0,end:()=>0};class be{static isBuffered(e,t){if(e){const i=be.getBuffered(e);for(let r=i.length;r--;)if(t>=i.start(r)&&t<=i.end(r))return!0}return!1}static bufferedRanges(e){if(e){const t=be.getBuffered(e);return be.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let i=0;i<e.length;i++)t.push({start:e.start(i),end:e.end(i)});return t}static bufferInfo(e,t,i){if(e){const r=be.bufferedRanges(e);if(r.length)return be.bufferedInfo(r,t,i)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,i){t=Math.max(0,t),e.length>1&&e.sort((m,p)=>m.start-p.start||p.end-m.end);let r=-1,a=[];if(i)for(let m=0;m<e.length;m++){t>=e[m].start&&t<=e[m].end&&(r=m);const p=a.length;if(p){const y=a[p-1].end;e[m].start-y<i?e[m].end>y&&(a[p-1].end=e[m].end):a.push(e[m])}else a.push(e[m])}else a=e;let c=0,u,f=t,h=t;for(let m=0;m<a.length;m++){const p=a[m].start,y=a[m].end;if(r===-1&&t>=p&&t<=y&&(r=m),t+i>=p&&t<y)f=p,h=y,c=h-t;else if(t+i<p){u=p;break}}return{len:c,start:f||0,end:h||0,nextStart:u,buffered:e,bufferedIndex:r}}static getBuffered(e){try{return e.buffered||tp}catch(t){return $e.log("failed to get media.buffered",t),tp}}}const Vy=/\{\$([a-zA-Z0-9-_]+)\}/g;function ip(l){return Vy.test(l)}function Md(l,e){if(l.variableList!==null||l.hasVariableRefs){const t=l.variableList;return e.replace(Vy,i=>{const r=i.substring(2,i.length-1),a=t==null?void 0:t[r];return a===void 0?(l.playlistParsingError||(l.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),i):a})}return e}function sp(l,e,t){let i=l.variableList;i||(l.variableList=i={});let r,a;if("QUERYPARAM"in e){r=e.QUERYPARAM;try{const c=new self.URL(t).searchParams;if(c.has(r))a=c.get(r);else throw new Error(`"${r}" does not match any query parameter in URI: "${t}"`)}catch(c){l.playlistParsingError||(l.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${c.message}`))}}else r=e.NAME,a=e.VALUE;r in i?l.playlistParsingError||(l.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):i[r]=a||""}function u1(l,e,t){const i=e.IMPORT;if(t&&i in t){let r=l.variableList;r||(l.variableList=r={}),r[i]=t[i]}else l.playlistParsingError||(l.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}const d1=/^(\d+)x(\d+)$/,np=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Je{constructor(e,t){typeof e=="string"&&(e=Je.parseAttrList(e,t)),Ke(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const i=new Uint8Array(t.length/2);for(let r=0;r<t.length/2;r++)i[r]=parseInt(t.slice(r*2,r*2+2),16);return i}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const i=this[e];return i?parseFloat(i):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const i=this[e];return(i?i.split(/[ ,]+/):[]).reduce((r,a)=>(r[a.toLowerCase()]=!0,r),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=d1.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let i;const r={},a='"';for(np.lastIndex=0;(i=np.exec(e))!==null;){const c=i[1].trim();let u=i[2];const f=u.indexOf(a)===0&&u.lastIndexOf(a)===u.length-1;let h=!1;if(f)u=u.slice(1,-1);else switch(c){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":h=!0}if(t&&(f||h))u=Md(t,u);else if(!h&&!f)switch(c){case"CLOSED-CAPTIONS":if(u==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":$e.warn(`${e}: attribute ${c} is missing quotes`)}r[c]=u}return r}}const h1="com.apple.hls.interstitial";function f1(l){return l!=="ID"&&l!=="CLASS"&&l!=="CUE"&&l!=="START-DATE"&&l!=="DURATION"&&l!=="END-DATE"&&l!=="END-ON-NEXT"}function m1(l){return l==="SCTE35-OUT"||l==="SCTE35-IN"||l==="SCTE35-CMD"}class Ky{constructor(e,t,i=0){var r;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(t==null?void 0:t.tagAnchor)||null,this.tagOrder=(r=t==null?void 0:t.tagOrder)!=null?r:i,t){const a=t.attr;for(const c in a)if(Object.prototype.hasOwnProperty.call(e,c)&&e[c]!==a[c]){$e.warn(`DATERANGE tag attribute: "${c}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=c;break}e=Ke(new Je({}),a,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const a=(t==null?void 0:t.endDate)||new Date(this.attr["END-DATE"]);de(a.getTime())&&(this._endDate=a)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?($e.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(de(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===h1}get isValid(){return!!this.id&&!this._badValueForSameId&&de(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const g1=10;class p1{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,i=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!i||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&i>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(t=>{let i=t.decryptdata;return i||(t.setKeyFormat(e.keyFormat),i=t.decryptdata),!!i&&e.matches(i)})}get hasProgramDateTime(){return this.fragments.length?de(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||g1}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let i=e.length;i--;)if(e[i].index>t)return e[i].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Do(l,e){return l.length===e.length?!l.some((t,i)=>t!==e[i]):!1}function rp(l,e){return!l&&!e?!0:!l||!e?!1:Do(l,e)}function ar(l){return l==="AES-128"||l==="AES-256"||l==="AES-256-CTR"}function uh(l){switch(l){case"AES-128":case"AES-256":return Us.cbc;case"AES-256-CTR":return Us.ctr;default:throw new Error(`invalid full segment method ${l}`)}}function dh(l){return Uint8Array.from(atob(l),e=>e.charCodeAt(0))}function Pd(l){return Uint8Array.from(unescape(encodeURIComponent(l)),e=>e.charCodeAt(0))}function y1(l){const e=Pd(l).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function zy(l){const e=function(i,r,a){const c=i[r];i[r]=i[a],i[a]=c};e(l,0,3),e(l,1,2),e(l,4,5),e(l,6,7)}function Yy(l){const e=l.split(":");let t=null;if(e[0]==="data"&&e.length===2){const i=e[1].split(";"),r=i[i.length-1].split(",");if(r.length===2){const a=r[0]==="base64",c=r[1];a?(i.splice(-1,1),t=dh(c)):t=y1(c)}}return t}const Io=typeof self<"u"?self:void 0;var et={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},At={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function go(l){switch(l){case At.FAIRPLAY:return et.FAIRPLAY;case At.PLAYREADY:return et.PLAYREADY;case At.WIDEVINE:return et.WIDEVINE;case At.CLEARKEY:return et.CLEARKEY}}function od(l){switch(l){case et.FAIRPLAY:return At.FAIRPLAY;case et.PLAYREADY:return At.PLAYREADY;case et.WIDEVINE:return At.WIDEVINE;case et.CLEARKEY:return At.CLEARKEY}}function ya(l){const{drmSystems:e,widevineLicenseUrl:t}=l,i=e?[et.FAIRPLAY,et.WIDEVINE,et.PLAYREADY,et.CLEARKEY].filter(r=>!!e[r]):[];return!i[et.WIDEVINE]&&t&&i.push(et.WIDEVINE),i}const qy=function(l){return Io!=null&&(l=Io.navigator)!=null&&l.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function x1(l,e,t,i){let r;switch(l){case et.FAIRPLAY:r=["cenc","sinf"];break;case et.WIDEVINE:case et.PLAYREADY:r=["cenc"];break;case et.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${l}`)}return v1(r,e,t,i)}function v1(l,e,t,i){return[{initDataTypes:l,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:e.map(a=>({contentType:`audio/mp4; codecs=${a}`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:t.map(a=>({contentType:`video/mp4; codecs=${a}`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}function E1(l){var e;return!!l&&(l.sessionType==="persistent-license"||!!((e=l.sessionTypes)!=null&&e.some(t=>t==="persistent-license")))}function Xy(l){const e=new Uint16Array(l.buffer,l.byteOffset,l.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),i=t.substring(t.indexOf("<"),t.length),c=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(c){const u=c.childNodes[0]?c.childNodes[0].nodeValue:c.getAttribute("VALUE");if(u){const f=dh(u).subarray(0,16);return zy(f),f}}return null}let Zl={};class dn{static clearKeyUriToKeyIdMap(){Zl={}}static setKeyIdForUri(e,t){Zl[e]=t}constructor(e,t,i,r=[1],a=null,c){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=i,this.keyFormatVersions=r,this.iv=a,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!ar(e),c!=null&&c.startsWith("0x")&&(this.keyId=new Uint8Array(by(c)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&Do(e.keyFormatVersions,this.keyFormatVersions)&&rp(e.iv,this.iv)&&rp(e.keyId,this.keyId)}isSupported(){if(this.method){if(ar(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case At.FAIRPLAY:case At.WIDEVINE:case At.PLAYREADY:case At.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e,t){if(!this.encrypted||!this.uri)return null;if(ar(this.method)){let a=this.iv;return a||(typeof e!="number"&&($e.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),a=T1(e)),new dn(this.method,this.uri,"identity",this.keyFormatVersions,a)}if(this.keyId){const a=Zl[this.uri];if(a&&!Do(this.keyId,a)&&dn.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const i=Yy(this.uri);if(i)switch(this.keyFormat){case At.WIDEVINE:if(this.pssh=i,!this.keyId){const a=RA(i.buffer);if(a.length){var r;const c=a[0];this.keyId=(r=c.kids)!=null&&r.length?c.kids[0]:null}}this.keyId||(this.keyId=ap(t));break;case At.PLAYREADY:{const a=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=AA(a,null,i),this.keyId=Xy(i);break}default:{let a=i.subarray(0,16);if(a.length!==16){const c=new Uint8Array(16);c.set(a,16-a.length),a=c}this.keyId=a;break}}if(!this.keyId||this.keyId.byteLength!==16){let a;a=S1(t),a||(a=ap(t),a||(a=Zl[this.uri])),a&&(this.keyId=a,dn.setKeyIdForUri(this.uri,a))}return this}}function S1(l){const e=l==null?void 0:l[At.WIDEVINE];return e?e.keyId:null}function ap(l){const e=l==null?void 0:l[At.PLAYREADY];if(e){const t=Yy(e.uri);if(t)return Xy(t)}return null}function T1(l){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=l>>8*(15-t)&255;return e}const lp=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,op=/#EXT-X-MEDIA:(.*)/g,b1=/^#EXT(?:INF|-X-TARGETDURATION):/m,cd=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),A1=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Oi{static findGroup(e,t){for(let i=0;i<e.length;i++){const r=e[i];if(r.id===t)return r}}static resolve(e,t){return ih.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return b1.test(e)}static parseMasterPlaylist(e,t){const i=ip(e),r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:i},a=[];if(lp.lastIndex=0,!e.startsWith("#EXTM3U"))return r.playlistParsingError=new Error("no EXTM3U delimiter"),r;let c;for(;(c=lp.exec(e))!=null;)if(c[1]){var u;const h=new Je(c[1],r),m=Md(r,c[2]),p={attrs:h,bitrate:h.decimalInteger("BANDWIDTH")||h.decimalInteger("AVERAGE-BANDWIDTH"),name:h.NAME,url:Oi.resolve(m,t)},y=h.decimalResolution("RESOLUTION");y&&(p.width=y.width,p.height=y.height),dp(h.CODECS,p);const S=h["SUPPLEMENTAL-CODECS"];S&&(p.supplemental={},dp(S,p.supplemental)),(u=p.unknownCodecs)!=null&&u.length||a.push(p),r.levels.push(p)}else if(c[3]){const h=c[3],m=c[4];switch(h){case"SESSION-DATA":{const p=new Je(m,r),y=p["DATA-ID"];y&&(r.sessionData===null&&(r.sessionData={}),r.sessionData[y]=p);break}case"SESSION-KEY":{const p=cp(m,t,r);p.encrypted&&p.isSupported()?(r.sessionKeys===null&&(r.sessionKeys=[]),r.sessionKeys.push(p)):$e.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${m}"`);break}case"DEFINE":{{const p=new Je(m,r);sp(r,p,t)}break}case"CONTENT-STEERING":{const p=new Je(m,r);r.contentSteering={uri:Oi.resolve(p["SERVER-URI"],t),pathwayId:p["PATHWAY-ID"]||"."};break}case"START":{r.startTimeOffset=up(m);break}}}const f=a.length>0&&a.length<r.levels.length;return r.levels=f?a:r.levels,r.levels.length===0&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,t,i){let r;const a={},c=i.levels,u={AUDIO:c.map(h=>({id:h.attrs.AUDIO,audioCodec:h.audioCodec})),SUBTITLES:c.map(h=>({id:h.attrs.SUBTITLES,textCodec:h.textCodec})),"CLOSED-CAPTIONS":[]};let f=0;for(op.lastIndex=0;(r=op.exec(e))!==null;){const h=new Je(r[1],i),m=h.TYPE;if(m){const p=u[m],y=a[m]||[];a[m]=y;const S=h.LANGUAGE,E=h["ASSOC-LANGUAGE"],T=h.CHANNELS,b=h.CHARACTERISTICS,L=h["INSTREAM-ID"],_={attrs:h,bitrate:0,id:f++,groupId:h["GROUP-ID"]||"",name:h.NAME||S||"",type:m,default:h.bool("DEFAULT"),autoselect:h.bool("AUTOSELECT"),forced:h.bool("FORCED"),lang:S,url:h.URI?Oi.resolve(h.URI,t):""};if(E&&(_.assocLang=E),T&&(_.channels=T),b&&(_.characteristics=b),L&&(_.instreamId=L),p!=null&&p.length){const I=Oi.findGroup(p,_.groupId)||p[0];hp(_,I,"audioCodec"),hp(_,I,"textCodec")}y.push(_)}}return a}static parseLevelPlaylist(e,t,i,r,a,c){var u;const f={url:t},h=new p1(t),m=h.fragments,p=[];let y=null,S=0,E=0,T=0,b=0,L=0,_=null,I=new rd(r,f),C,N,K,O=-1,j=!1,B=null,U;if(cd.lastIndex=0,h.m3u8=e,h.hasVariableRefs=ip(e),((u=cd.exec(e))==null?void 0:u[0])!=="#EXTM3U")return h.playlistParsingError=new Error("Missing format identifier #EXTM3U"),h;for(;(C=cd.exec(e))!==null;){j&&(j=!1,I=new rd(r,f),I.playlistOffset=T,I.setStart(T),I.sn=S,I.cc=b,L&&(I.bitrate=L),I.level=i,y&&(I.initSegment=y,y.rawProgramDateTime&&(I.rawProgramDateTime=y.rawProgramDateTime,y.rawProgramDateTime=null),B&&(I.setByteRange(B),B=null)));const fe=C[1];if(fe){I.duration=parseFloat(fe);const le=(" "+C[2]).slice(1);I.title=le||null,I.tagList.push(le?["INF",fe,le]:["INF",fe])}else if(C[3]){if(de(I.duration)){I.playlistOffset=T,I.setStart(T),K&&mp(I,K,h),I.sn=S,I.level=i,I.cc=b,m.push(I);const le=(" "+C[3]).slice(1);I.relurl=Md(h,le),Ud(I,_,p),_=I,T+=I.duration,S++,E=0,j=!0}}else{if(C=C[0].match(A1),!C){$e.warn("No matches on slow regex match for level playlist!");continue}for(N=1;N<C.length&&C[N]===void 0;N++);const le=(" "+C[N]).slice(1),M=(" "+C[N+1]).slice(1),Q=C[N+2]?(" "+C[N+2]).slice(1):null;switch(le){case"BYTERANGE":_?I.setByteRange(M,_):I.setByteRange(M);break;case"PROGRAM-DATE-TIME":I.rawProgramDateTime=M,I.tagList.push(["PROGRAM-DATE-TIME",M]),O===-1&&(O=m.length);break;case"PLAYLIST-TYPE":h.type&&ts(h,le,C),h.type=M.toUpperCase();break;case"MEDIA-SEQUENCE":h.startSN!==0?ts(h,le,C):m.length>0&&gp(h,le,C),S=h.startSN=parseInt(M);break;case"SKIP":{h.skippedSegments&&ts(h,le,C);const Z=new Je(M,h),ae=Z.decimalInteger("SKIPPED-SEGMENTS");if(de(ae)){h.skippedSegments+=ae;for(let F=ae;F--;)m.push(null);S+=ae}const w=Z.enumeratedString("RECENTLY-REMOVED-DATERANGES");w&&(h.recentlyRemovedDateranges=(h.recentlyRemovedDateranges||[]).concat(w.split("	")));break}case"TARGETDURATION":h.targetduration!==0&&ts(h,le,C),h.targetduration=Math.max(parseInt(M),1);break;case"VERSION":h.version!==null&&ts(h,le,C),h.version=parseInt(M);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":h.live||ts(h,le,C),h.live=!1;break;case"#":(M||Q)&&I.tagList.push(Q?[M,Q]:[M]);break;case"DISCONTINUITY":b++,I.tagList.push(["DIS"]);break;case"GAP":I.gap=!0,I.tagList.push([le]);break;case"BITRATE":I.tagList.push([le,M]),L=parseInt(M)*1e3,de(L)?I.bitrate=L:L=0;break;case"DATERANGE":{const Z=new Je(M,h),ae=new Ky(Z,h.dateRanges[Z.ID],h.dateRangeTagCount);h.dateRangeTagCount++,ae.isValid||h.skippedSegments?h.dateRanges[ae.id]=ae:$e.warn(`Ignoring invalid DATERANGE tag: "${M}"`),I.tagList.push(["EXT-X-DATERANGE",M]);break}case"DEFINE":{{const Z=new Je(M,h);"IMPORT"in Z?u1(h,Z,c):sp(h,Z,t)}break}case"DISCONTINUITY-SEQUENCE":h.startCC!==0?ts(h,le,C):m.length>0&&gp(h,le,C),h.startCC=b=parseInt(M);break;case"KEY":{const Z=cp(M,t,h);if(Z.isSupported()){if(Z.method==="NONE"){K=void 0;break}K||(K={});const ae=K[Z.keyFormat];ae!=null&&ae.matches(Z)||(ae&&(K=Ke({},K)),K[Z.keyFormat]=Z)}else $e.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${M}"`);break}case"START":h.startTimeOffset=up(M);break;case"MAP":{const Z=new Je(M,h);if(I.duration){const ae=new rd(r,f);fp(ae,Z,i,K),y=ae,I.initSegment=y,y.rawProgramDateTime&&!I.rawProgramDateTime&&(I.rawProgramDateTime=y.rawProgramDateTime)}else{const ae=I.byteRangeEndOffset;if(ae){const w=I.byteRangeStartOffset;B=`${ae-w}@${w}`}else B=null;fp(I,Z,i,K),y=I,j=!0}y.cc=b;break}case"SERVER-CONTROL":{U&&ts(h,le,C),U=new Je(M),h.canBlockReload=U.bool("CAN-BLOCK-RELOAD"),h.canSkipUntil=U.optionalFloat("CAN-SKIP-UNTIL",0),h.canSkipDateRanges=h.canSkipUntil>0&&U.bool("CAN-SKIP-DATERANGES"),h.partHoldBack=U.optionalFloat("PART-HOLD-BACK",0),h.holdBack=U.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{h.partTarget&&ts(h,le,C);const Z=new Je(M);h.partTarget=Z.decimalFloatingPoint("PART-TARGET");break}case"PART":{let Z=h.partList;Z||(Z=h.partList=[]);const ae=E>0?Z[Z.length-1]:void 0,w=E++,F=new Je(M,h),q=new uA(F,I,f,w,ae);Z.push(q),I.duration+=q.duration;break}case"PRELOAD-HINT":{const Z=new Je(M,h);h.preloadHint=Z;break}case"RENDITION-REPORT":{const Z=new Je(M,h);h.renditionReports=h.renditionReports||[],h.renditionReports.push(Z);break}default:$e.warn(`line parsed but not handled: ${C}`);break}}}_&&!_.relurl?(m.pop(),T-=_.duration,h.partList&&(h.fragmentHint=_)):h.partList&&(Ud(I,_,p),I.cc=b,h.fragmentHint=I,K&&mp(I,K,h)),h.targetduration||(h.playlistParsingError=new Error("Missing Target Duration"));const W=m.length,re=m[0],ue=m[W-1];if(T+=h.skippedSegments*h.targetduration,T>0&&W&&ue){h.averagetargetduration=T/W;const fe=ue.sn;h.endSN=fe!=="initSegment"?fe:0,h.live||(ue.endList=!0),O>0&&(L1(m,O),re&&p.unshift(re))}return h.fragmentHint&&(T+=h.fragmentHint.duration),h.totalduration=T,p.length&&h.dateRangeTagCount&&re&&Qy(p,h),h.endCC=b,h}}function Qy(l,e){let t=l.length;if(!t)if(e.hasProgramDateTime){const u=e.fragments[e.fragments.length-1];l.push(u),t++}else return;const i=l[t-1],r=e.live?1/0:e.totalduration,a=Object.keys(e.dateRanges);for(let u=a.length;u--;){const f=e.dateRanges[a[u]],h=f.startDate.getTime();f.tagAnchor=i.ref;for(let m=t;m--;){var c;if(((c=l[m])==null?void 0:c.sn)<e.startSN)break;const p=R1(e,h,l,m,r);if(p!==-1){f.tagAnchor=e.fragments[p].ref;break}}}}function R1(l,e,t,i,r){const a=t[i];if(a){const u=a.programDateTime;if(e>=u||i===0){var c;const f=(((c=t[i+1])==null?void 0:c.start)||r)-a.start;if(e<=u+f*1e3){const h=t[i].sn-l.startSN;if(h<0)return-1;const m=l.fragments;if(m.length>t.length){const y=(t[i+1]||m[m.length-1]).sn-l.startSN;for(let S=y;S>h;S--){const E=m[S].programDateTime;if(e>=E&&e<E+m[S].duration*1e3)return S}}return h}}}return-1}function cp(l,e,t){var i,r;const a=new Je(l,t),c=(i=a.METHOD)!=null?i:"",u=a.URI,f=a.hexadecimalInteger("IV"),h=a.KEYFORMATVERSIONS,m=(r=a.KEYFORMAT)!=null?r:"identity";u&&a.IV&&!f&&$e.error(`Invalid IV: ${a.IV}`);const p=u?Oi.resolve(u,e):"",y=(h||"1").split("/").map(Number).filter(Number.isFinite);return new dn(c,p,m,y,f,a.KEYID)}function up(l){const t=new Je(l).decimalFloatingPoint("TIME-OFFSET");return de(t)?t:null}function dp(l,e){let t=(l||"").split(/[ ,]+/).filter(i=>i);["video","audio","text"].forEach(i=>{const r=t.filter(a=>rh(a,i));r.length&&(e[`${i}Codec`]=r.map(a=>a.split("/")[0]).join(","),t=t.filter(a=>r.indexOf(a)===-1))}),e.unknownCodecs=t}function hp(l,e,t){const i=e[t];i&&(l[t]=i)}function L1(l,e){let t=l[e];for(let i=e;i--;){const r=l[i];if(!r)return;r.programDateTime=t.programDateTime-r.duration*1e3,t=r}}function Ud(l,e,t){l.rawProgramDateTime?t.push(l):e!=null&&e.programDateTime&&(l.programDateTime=e.endProgramDateTime)}function fp(l,e,t,i){l.relurl=e.URI,e.BYTERANGE&&l.setByteRange(e.BYTERANGE),l.level=t,l.sn="initSegment",i&&(l.levelkeys=i),l.initSegment=null}function mp(l,e,t){l.levelkeys=e;const{encryptedFragments:i}=t;(!i.length||i[i.length-1].levelkeys!==e)&&Object.keys(e).some(r=>e[r].isCommonEncryption)&&i.push(l)}function ts(l,e,t){l.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function gp(l,e,t){l.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function ud(l,e){const t=e.startPTS;if(de(t)){let i=0,r;e.sn>l.sn?(i=t-l.start,r=l):(i=l.start-t,r=e),r.duration!==i&&r.setDuration(i)}else e.sn>l.sn?l.cc===e.cc&&l.minEndPTS?e.setStart(l.start+(l.minEndPTS-l.start)):e.setStart(l.start+l.duration):e.setStart(Math.max(l.start-e.duration,0))}function Wy(l,e,t,i,r,a,c){i-t<=0&&(c.warn("Fragment should have a positive duration",e),i=t+e.duration,a=r+e.duration);let f=t,h=i;const m=e.startPTS,p=e.endPTS;if(de(m)){const L=Math.abs(m-t);l&&L>l.totalduration?c.warn(`media timestamps and playlist times differ by ${L}s for level ${e.level} ${l.url}`):de(e.deltaPTS)?e.deltaPTS=Math.max(L,e.deltaPTS):e.deltaPTS=L,f=Math.max(t,m),t=Math.min(t,m),r=e.startDTS!==void 0?Math.min(r,e.startDTS):r,h=Math.min(i,p),i=Math.max(i,p),a=e.endDTS!==void 0?Math.max(a,e.endDTS):a}const y=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(i-e.start),e.startPTS=t,e.maxStartPTS=f,e.startDTS=r,e.endPTS=i,e.minEndPTS=h,e.endDTS=a;const S=e.sn;if(!l||S<l.startSN||S>l.endSN)return 0;let E;const T=S-l.startSN,b=l.fragments;for(b[T]=e,E=T;E>0;E--)ud(b[E],b[E-1]);for(E=T;E<b.length-1;E++)ud(b[E],b[E+1]);return l.fragmentHint&&ud(b[b.length-1],l.fragmentHint),l.PTSKnown=l.alignedSliding=!0,y}function _1(l,e,t){if(l===e)return;let i=null;const r=l.fragments;for(let m=r.length-1;m>=0;m--){const p=r[m].initSegment;if(p){i=p;break}}l.fragmentHint&&delete l.fragmentHint.endPTS;let a;C1(l,e,(m,p,y,S)=>{if((!e.startCC||e.skippedSegments)&&p.cc!==m.cc){const E=m.cc-p.cc;for(let T=y;T<S.length;T++)S[T].cc+=E;e.endCC=S[S.length-1].cc}de(m.startPTS)&&de(m.endPTS)&&(p.setStart(p.startPTS=m.startPTS),p.startDTS=m.startDTS,p.maxStartPTS=m.maxStartPTS,p.endPTS=m.endPTS,p.endDTS=m.endDTS,p.minEndPTS=m.minEndPTS,p.setDuration(m.endPTS-m.startPTS),p.duration&&(a=p),e.PTSKnown=e.alignedSliding=!0),m.hasStreams&&(p.elementaryStreams=m.elementaryStreams),p.loader=m.loader,m.hasStats&&(p.stats=m.stats),m.initSegment&&(p.initSegment=m.initSegment,i=m.initSegment)});const c=e.fragments,u=e.fragmentHint?c.concat(e.fragmentHint):c;if(i&&u.forEach(m=>{var p;m&&(!m.initSegment||m.initSegment.relurl===((p=i)==null?void 0:p.relurl))&&(m.initSegment=i)}),e.skippedSegments){if(e.deltaUpdateFailed=c.some(m=>!m),e.deltaUpdateFailed){t.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let m=e.skippedSegments;m--;)c.shift();e.startSN=c[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=D1(l.dateRanges,e,t));const m=l.fragments.filter(p=>p.rawProgramDateTime);if(l.hasProgramDateTime&&!e.hasProgramDateTime)for(let p=1;p<u.length;p++)u[p].programDateTime===null&&Ud(u[p],u[p-1],m);Qy(m,e)}e.endCC=c[c.length-1].cc}if(!e.startCC){var f;const m=ex(l,e.startSN-1);e.startCC=(f=m==null?void 0:m.cc)!=null?f:c[0].cc}I1(l.partList,e.partList,(m,p)=>{p.elementaryStreams=m.elementaryStreams,p.stats=m.stats}),a?Wy(e,a,a.startPTS,a.endPTS,a.startDTS,a.endDTS,t):Zy(l,e),c.length&&(e.totalduration=e.edge-c[0].start),e.driftStartTime=l.driftStartTime,e.driftStart=l.driftStart;const h=e.advancedDateTime;if(e.advanced&&h){const m=e.edge;e.driftStart||(e.driftStartTime=h,e.driftStart=m),e.driftEndTime=h,e.driftEnd=m}else e.driftEndTime=l.driftEndTime,e.driftEnd=l.driftEnd,e.advancedDateTime=l.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=l.requestScheduled)}function D1(l,e,t){const{dateRanges:i,recentlyRemovedDateranges:r}=e,a=Ke({},l);r&&r.forEach(f=>{delete a[f]});const u=Object.keys(a).length;return u?(Object.keys(i).forEach(f=>{const h=a[f],m=new Ky(i[f].attr,h);m.isValid?(a[f]=m,h||(m.tagOrder+=u)):t.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${Xe(i[f].attr)}"`)}),a):i}function I1(l,e,t){if(l&&e){let i=0;for(let r=0,a=l.length;r<=a;r++){const c=l[r],u=e[r+i];c&&u&&c.index===u.index&&c.fragment.sn===u.fragment.sn?t(c,u):i--}}}function C1(l,e,t){const i=e.skippedSegments,r=Math.max(l.startSN,e.startSN)-e.startSN,a=(l.fragmentHint?1:0)+(i?e.endSN:Math.min(l.endSN,e.endSN))-e.startSN,c=e.startSN-l.startSN,u=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,f=l.fragmentHint?l.fragments.concat(l.fragmentHint):l.fragments;for(let h=r;h<=a;h++){const m=f[c+h];let p=u[h];if(i&&!p&&m&&(p=e.fragments[h]=m),m&&p){t(m,p,h,u);const y=m.relurl,S=p.relurl;if(y&&w1(y,S)){e.playlistParsingError=pp(`media sequence mismatch ${p.sn}:`,l,e,m,p);return}else if(m.cc!==p.cc){e.playlistParsingError=pp(`discontinuity sequence mismatch (${m.cc}!=${p.cc})`,l,e,m,p);return}}}}function pp(l,e,t,i,r){return new Error(`${l} ${r.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function Zy(l,e,t=!0){const i=e.startSN+e.skippedSegments-l.startSN,r=l.fragments,a=i>=0;let c=0;if(a&&i<r.length)c=r[i].start;else if(a&&e.startSN===l.endSN+1)c=l.fragmentEnd;else if(a&&t)c=l.fragmentStart+i*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)c=l.fragmentStart;else return;Bd(e,c)}function Bd(l,e){if(e){const t=l.fragments;for(let i=l.skippedSegments;i<t.length;i++)t[i].addStart(e);l.fragmentHint&&l.fragmentHint.addStart(e)}}function Jy(l,e=1/0){let t=1e3*l.targetduration;if(l.updated){const i=l.fragments;if(i.length&&t*4>e){const a=i[i.length-1].duration*1e3;a<t&&(t=a)}}else t/=2;return Math.round(t)}function ex(l,e,t){if(!l)return null;let i=l.fragments[e-l.startSN];return i||(i=l.fragmentHint,i&&i.sn===e)?i:e<l.startSN&&t&&t.sn===e?t:null}function yp(l,e,t){return l?tx(l.partList,e,t):null}function tx(l,e,t){if(l)for(let i=l.length;i--;){const r=l[i];if(r.index===t&&r.fragment.sn===e)return r}return null}function ix(l){l.forEach((e,t)=>{var i;(i=e.details)==null||i.fragments.forEach(r=>{r.level=t,r.initSegment&&(r.initSegment.level=t)})})}function w1(l,e){return l!==e&&e?xp(l)!==xp(e):!1}function xp(l){return l.replace(/\?[^?]*$/,"")}function xa(l,e){for(let i=0,r=l.length;i<r;i++){var t;if(((t=l[i])==null?void 0:t.cc)===e)return l[i]}return null}function N1(l,e){return!!(l&&e.startCC<l.endCC&&e.endCC>l.startCC)}function vp(l,e){const t=l.start+e;l.startPTS=t,l.setStart(t),l.endPTS=t+l.duration}function sx(l,e){const t=e.fragments;for(let i=0,r=t.length;i<r;i++)vp(t[i],l);e.fragmentHint&&vp(e.fragmentHint,l),e.alignedSliding=!0}function k1(l,e){l&&(nx(e,l),e.alignedSliding||Co(e,l),!e.alignedSliding&&!e.skippedSegments&&Zy(l,e,!1))}function nx(l,e){if(!N1(e,l))return;const t=Math.min(e.endCC,l.endCC),i=xa(e.fragments,t),r=xa(l.fragments,t);if(!i||!r)return;$e.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const a=i.start-r.start;sx(a,l)}function Co(l,e){if(!l.hasProgramDateTime||!e.hasProgramDateTime)return;const t=l.fragments,i=e.fragments;if(!t.length||!i.length)return;let r,a;const c=Math.min(e.endCC,l.endCC);e.startCC<c&&l.startCC<c&&(r=xa(i,c),a=xa(t,c)),(!r||!a)&&(r=i[Math.floor(i.length/2)],a=xa(t,r.cc)||t[Math.floor(t.length/2)]);const u=r.programDateTime,f=a.programDateTime;if(!u||!f)return;const h=(f-u)/1e3-(a.start-r.start);sx(h,l)}function Nt(l,e,t){Gt(l,e,t),l.addEventListener(e,t)}function Gt(l,e,t){l.removeEventListener(e,t)}const O1={toString:function(l){let e="";const t=l.length;for(let i=0;i<t;i++)e+=`[${l.start(i).toFixed(3)}-${l.end(i).toFixed(3)}]`;return e}},ee={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class hh extends Hy{constructor(e,t,i,r,a){super(r,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=ee.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:c,fragCurrent:u,media:f,mediaBuffer:h,state:m}=this,p=f?f.currentTime:0,y=be.bufferInfo(h||f,p,c.maxBufferHole),S=!y.len;if(this.log(`Media seeking to ${de(p)?p.toFixed(3):p}, state: ${m}, ${S?"out of":"in"} buffer`),this.state===ee.ENDED)this.resetLoadingState();else if(u){const E=c.maxFragLookUpTolerance,T=u.start-E,b=u.start+u.duration+E;if(S||b<y.start||T>y.end){const L=p>b;(p<T||L)&&(L&&u.loader&&(this.log(`Cancelling fragment load for seek (sn: ${u.sn})`),u.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(f){this.fragmentTracker.removeFragmentsInRange(p,1/0,this.playlistType,!0);const E=this.lastCurrentTime;if(p>E&&(this.lastCurrentTime=p),!this.loadingParts){const T=Math.max(y.end,p),b=this.shouldLoadParts(this.getLevelDetails(),T);b&&(this.log(`LL-Part loading ON after seeking to ${p.toFixed(2)} with buffer @${T.toFixed(2)}`),this.loadingParts=b)}}this.hls.hasEnoughToStart||(this.log(`Setting ${S?"startPosition":"nextLoadPosition"} to ${p} for seek without enough to start`),this.nextLoadPosition=p,S&&(this.startPosition=p)),S&&this.state===ee.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=a,this.hls=e,this.fragmentLoader=new o1(e.config),this.keyLoader=i,this.fragmentTracker=t,this.config=e.config,this.decrypter=new oh(e.config)}registerListeners(){const{hls:e}=this;e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(A.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(A.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===ee.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=ee.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const i=e.end||0,r=this.config.timelineOffset||0;if(i<=r)return!1;const a=e.buffered;this.config.maxBufferHole&&a&&a.length>1&&(e=be.bufferedInfo(a,e.start,0));const c=e.nextStart;if(c&&c>r&&c<t.edge||this.media.currentTime<e.start)return!1;const f=t.partList;if(f!=null&&f.length){const m=f[f.length-1];return be.isBuffered(this.media,m.start+m.duration/2)}const h=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(h)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const i=this.media=this.mediaBuffer=t.media;Nt(i,"seeking",this.onMediaSeeking),Nt(i,"ended",this.onMediaEnded);const r=this.config;this.levels&&r.autoStartLoad&&this.state===ee.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(e,t){const i=!!t.transferMedia,r=this.media;if(r!==null){if(r.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),Gt(r,"seeking",this.onMediaSeeking),Gt(r,"ended",this.onMediaEnded),this.keyLoader&&!i&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,i){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=ee.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,i){this.startFragRequested=!0,this._loadFragForPlayback(e,t,i)}_loadFragForPlayback(e,t,i){const r=a=>{const c=a.frag;if(this.fragContextChanged(c)){this.warn(`${c.type} sn: ${c.sn}${a.part?" part: "+a.part.index:""} of ${this.fragInfo(c,!1,a.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(c);return}c.stats.chunkCount++,this._handleFragmentLoadProgress(a)};this._doFragLoad(e,t,i,r).then(a=>{if(!a)return;const c=this.state,u=a.frag;if(this.fragContextChanged(u)){(c===ee.FRAG_LOADING||!this.fragCurrent&&c===ee.PARSING)&&(this.fragmentTracker.removeFragment(u),this.state=ee.IDLE);return}"payload"in a&&(this.log(`Loaded ${u.type} sn: ${u.sn} of ${this.playlistLabel()} ${u.level}`),this.hls.trigger(A.FRAG_LOADED,a)),this._handleFragmentLoadComplete(a)}).catch(a=>{this.state===ee.STOPPED||this.state===ee.ERROR||(this.warn(`Frag error: ${(a==null?void 0:a.message)||a}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:i}=this;if(i.getState(e)===mt.APPENDING){const a=e.type,c=this.getFwdBufferInfo(this.mediaBuffer,a),u=Math.max(e.duration,c?c.len:this.config.maxBufferLength),f=this.backtrackFragment;((f?e.sn-f.sn:0)===1||this.reduceMaxBufferLength(u,e.duration))&&i.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?i.removeAllFragments():i.hasParts(e.type)&&(i.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),i.getState(e)===mt.PARTIAL&&i.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(t==null?void 0:t.live)&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,i=null){if(!(e-t))return;const r={startOffset:e,endOffset:t,type:i};this.hls.trigger(A.BUFFER_FLUSHING,r)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(i=>{const r=i==null?void 0:i.frag;if(!r||this.fragContextChanged(r)||!this.levels)throw new Error("init load aborted");return i}).then(i=>{const{hls:r}=this,{frag:a,payload:c}=i,u=a.decryptdata;if(c&&c.byteLength>0&&u!=null&&u.key&&u.iv&&ar(u.method)){const f=self.performance.now();return this.decrypter.decrypt(new Uint8Array(c),u.key.buffer,u.iv.buffer,uh(u.method)).catch(h=>{throw r.trigger(A.ERROR,{type:pe.MEDIA_ERROR,details:H.FRAG_DECRYPT_ERROR,fatal:!1,error:h,reason:h.message,frag:a}),h}).then(h=>{const m=self.performance.now();return r.trigger(A.FRAG_DECRYPTED,{frag:a,payload:h,stats:{tstart:f,tdecrypt:m}}),i.payload=h,this.completeInitSegmentLoad(i)})}return this.completeInitSegmentLoad(i)}).catch(i=>{this.state===ee.STOPPED||this.state===ee.ERROR||(this.warn(i),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const i=e.frag.stats;this.state!==ee.STOPPED&&(this.state=ee.IDLE),e.frag.data=new Uint8Array(e.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,t){var i,r;const a=e.tracks;if(a&&!t.encrypted&&((i=a.audio)!=null&&i.encrypted||(r=a.video)!=null&&r.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const c=this.media,u=new Error(`Encrypted track with no key in ${this.fragInfo(t)} (media ${c?"attached mediaKeys: "+c.mediaKeys:"detached"})`);return this.warn(u.message),!c||c.mediaKeys?!1:(this.hls.trigger(A.ERROR,{type:pe.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_KEYS,fatal:!1,error:u,frag:t}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const i=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${i?O1.toString(be.getBuffered(i)):"(detached)"})`),ut(e)){var r;if(e.type!==me.SUBTITLE){const c=e.elementaryStreams;if(!Object.keys(c).some(u=>!!c[u])){this.state=ee.IDLE;return}}const a=(r=this.levels)==null?void 0:r[e.level];a!=null&&a.fragmentError&&(this.log(`Resetting level fragment error count of ${a.fragmentError} on frag buffered`),a.fragmentError=0)}this.state=ee.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:i,part:r,partsLoaded:a}=e,c=!a||a.length===0||a.some(f=>!f),u=new ch(i.level,i.sn,i.stats.chunkCount+1,0,r?r.index:-1,!c);t.flush(u)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,i=null,r){var a;this.fragCurrent=e;const c=t.details;if(!this.levels||!c)throw new Error(`frag load aborted, missing level${c?"":" detail"}s`);let u=null;if(e.encrypted&&!((a=e.decryptdata)!=null&&a.key)){if(this.log(`Loading key for ${e.sn} of [${c.startSN}-${c.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=ee.KEY_LOADING,this.fragCurrent=e,u=this.keyLoader.load(e).then(y=>{if(!this.fragContextChanged(y.frag))return this.hls.trigger(A.KEY_LOADED,y),this.state===ee.KEY_LOADING&&(this.state=ee.IDLE),y}),this.hls.trigger(A.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else e.encrypted||(u=this.keyLoader.loadClear(e,c.encryptedFragments,this.startFragRequested),u&&this.log("[eme] blocking frag load until media-keys acquired"));const f=this.fragPrevious;if(ut(e)&&(!f||e.sn!==f.sn)){const y=this.shouldLoadParts(t.details,e.end);y!==this.loadingParts&&(this.log(`LL-Part loading ${y?"ON":"OFF"} loading sn ${f==null?void 0:f.sn}->${e.sn}`),this.loadingParts=y)}if(i=Math.max(e.start,i||0),this.loadingParts&&ut(e)){const y=c.partList;if(y&&r){i>c.fragmentEnd&&c.fragmentHint&&(e=c.fragmentHint);const S=this.getNextPart(y,e,i);if(S>-1){const E=y[S];e=this.fragCurrent=E.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${E.index} (${S}/${y.length-1}) of ${this.fragInfo(e,!1,E)}) cc: ${e.cc} [${c.startSN}-${c.endSN}], target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=E.start+E.duration,this.state=ee.FRAG_LOADING;let T;return u?T=u.then(b=>!b||this.fragContextChanged(b.frag)?null:this.doFragPartsLoad(e,E,t,r)).catch(b=>this.handleFragLoadError(b)):T=this.doFragPartsLoad(e,E,t,r).catch(b=>this.handleFragLoadError(b)),this.hls.trigger(A.FRAG_LOADING,{frag:e,part:E,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):T}else if(!e.url||this.loadedEndOfParts(y,i))return Promise.resolve(null)}}if(ut(e)&&this.loadingParts){var h;this.log(`LL-Part loading OFF after next part miss @${i.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(h=c.partList)==null?void 0:h.filter(y=>y.loaded).map(y=>`[${y.start}-${y.end}]`)}`),this.loadingParts=!1}else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+c.startSN+"-"+c.endSN+"]"}, target: ${parseFloat(i.toFixed(3))}`),de(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=ee.FRAG_LOADING;const m=this.config.progressive;let p;return m&&u?p=u.then(y=>!y||this.fragContextChanged(y.frag)?null:this.fragmentLoader.load(e,r)).catch(y=>this.handleFragLoadError(y)):p=Promise.all([this.fragmentLoader.load(e,m?r:void 0),u]).then(([y])=>(!m&&r&&r(y),y)).catch(y=>this.handleFragLoadError(y)),this.hls.trigger(A.FRAG_LOADING,{frag:e,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):p}doFragPartsLoad(e,t,i,r){return new Promise((a,c)=>{var u;const f=[],h=(u=i.details)==null?void 0:u.partList,m=p=>{this.fragmentLoader.loadPart(e,p,r).then(y=>{f[p.index]=y;const S=y.part;this.hls.trigger(A.FRAG_LOADED,y);const E=yp(i.details,e.sn,p.index+1)||tx(h,e.sn,p.index+1);if(E)m(E);else return a({frag:e,part:S,partsLoaded:f})}).catch(c)};m(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;t.frag&&t.details===H.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===pe.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(t.frag)):this.hls.trigger(A.ERROR,t)}else this.hls.trigger(A.ERROR,{type:pe.OTHER_ERROR,details:H.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==ee.PARSING){!this.fragCurrent&&this.state!==ee.STOPPED&&this.state!==ee.ERROR&&(this.state=ee.IDLE);return}const{frag:i,part:r,level:a}=t,c=self.performance.now();i.stats.parsing.end=c,r&&(r.stats.parsing.end=c);const u=this.getLevelDetails(),h=u&&i.sn>u.endSN||this.shouldLoadParts(u,i.end);h!==this.loadingParts&&(this.log(`LL-Part loading ${h?"ON":"OFF"} after parsing segment ending @${i.end.toFixed(2)}`),this.loadingParts=h),this.updateLevelTiming(i,r,a,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var i;const a=e.partList[0];if(a.fragment.type===me.SUBTITLE)return!1;const c=a.end+(((i=e.fragmentHint)==null?void 0:i.duration)||0);if(t>=c){var r;if((this.hls.hasEnoughToStart?((r=this.media)==null?void 0:r.currentTime)||this.lastCurrentTime:this.getLoadPosition())>a.start-a.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:i}=this,{level:r,sn:a,part:c}=e;if(!(t!=null&&t[r]))return this.warn(`Levels object was unset while buffering fragment ${a} of ${this.playlistLabel()} ${r}. The current chunk will not be buffered.`),null;const u=t[r],f=u.details,h=c>-1?yp(f,a,c):null,m=h?h.fragment:ex(f,a,i);return m?(i&&i!==m&&(m.stats=i.stats),{frag:m,part:h,level:u}):null}bufferFragmentData(e,t,i,r,a){if(this.state!==ee.PARSING)return;const{data1:c,data2:u}=e;let f=c;if(u&&(f=fi(c,u)),!f.length)return;const h=this.initPTS[t.cc],m=h?-h.baseTime/h.timescale:void 0,p={type:e.type,frag:t,part:i,chunkMeta:r,offset:m,parent:t.type,data:f};if(this.hls.trigger(A.BUFFER_APPENDING,p),e.dropped&&e.independent&&!i){if(a)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!be.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const i=t.currentTime,r=be.bufferInfo(t,i,0),a=e.duration,c=Math.min(this.config.maxFragLookUpTolerance*2,a*.25),u=Math.max(Math.min(e.start-c,r.end-c),i+c);e.start-u>c&&this.flushMainBuffer(u,e.start)}getFwdBufferInfo(e,t){var i;const r=this.getLoadPosition();if(!de(r))return null;const c=this.lastCurrentTime>r||(i=this.media)!=null&&i.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,r,t,c)}getFwdBufferInfoAtPos(e,t,i,r){const a=be.bufferInfo(e,t,r);if(a.len===0&&a.nextStart!==void 0){const c=this.fragmentTracker.getBufferedFrag(t,i);if(c&&(a.nextStart<=c.end||c.gap)){const u=Math.max(Math.min(a.nextStart,c.end)-t,r);return be.bufferInfo(e,t,u)}}return a}getMaxBufferLength(e){const{config:t}=this;let i;return e?i=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):i=t.maxBufferLength,Math.min(i,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const i=this.config,r=Math.max(Math.min(e-t,i.maxBufferLength),t),a=Math.max(e-t*3,i.maxMaxBufferLength/2,r);return a>=r?(i.maxMaxBufferLength=a,this.warn(`Reduce max buffer length to ${a}s`),!0):!1}getAppendedFrag(e,t=me.MAIN){const i=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return i&&"fragment"in i?i.fragment:i}getNextFragment(e,t){const i=t.fragments,r=i.length;if(!r)return null;const{config:a}=this,c=i[0].start,u=a.lowLatencyMode&&!!t.partList;let f=null;if(t.live){const p=a.initialLiveManifestSize;if(r<p)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${p})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<c){var h;u&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),f=this.getInitialLiveFragment(t);const y=this.hls.startPosition,S=this.hls.liveSyncPosition,E=f?(y!==-1&&y>=c?y:S)||f.start:e;this.log(`Setting startPosition to ${E} to match start frag at live edge. mainStart: ${y} liveSyncPosition: ${S} frag.start: ${(h=f)==null?void 0:h.start}`),this.startPosition=this.nextLoadPosition=E}}else e<=c&&(f=i[0]);if(!f){const p=this.loadingParts?t.partEnd:t.fragmentEnd;f=this.getFragmentAtPosition(e,p,t)}let m=this.filterReplacedPrimary(f,t);if(!m&&f){const p=f.sn-t.startSN;m=this.filterReplacedPrimary(i[p+1]||null,t)}return this.mapToInitFragWhenRequired(m)}isLoopLoading(e,t){const i=this.fragmentTracker.getState(e);return(i===mt.OK||i===mt.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,i,r,a){let c=null;if(e.gap&&(c=this.getNextFragment(this.nextLoadPosition,t),c&&!c.gap&&i.nextStart)){const u=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,r,0);if(u!==null&&i.len+u.len>=a){const f=c.sn;return this.loopSn!==f&&(this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${f}`),this.loopSn=f),null}}return this.loopSn=void 0,c}get primaryPrefetch(){if(Ep(this.config)){var e;if((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(Ep(this.config)&&e.type!==me.SUBTITLE){const i=this.hls.interstitialsManager,r=i==null?void 0:i.bufferingItem;if(r){const c=r.event;if(c){if(c.appendInPlace||Math.abs(e.start-r.start)>1||r.start===0)return null}else if(e.end<=r.start&&(t==null?void 0:t.live)===!1||e.start>r.end&&r.nextEvent&&(r.nextEvent.appendInPlace||e.start-r.end>1))return null}const a=i==null?void 0:i.playerQueue;if(a)for(let c=a.length;c--;){const u=a[c].interstitial;if(u.appendInPlace&&e.start>=u.startTime&&e.end<=u.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!e.initSegment.data&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,i){let r=-1,a=!1,c=!0;for(let u=0,f=e.length;u<f;u++){const h=e[u];if(c=c&&!h.independent,r>-1&&i<h.start)break;const m=h.loaded;m?r=-1:(a||(h.independent||c)&&h.fragment===t)&&(h.fragment!==t&&this.warn(`Need buffer at ${i} but next unloaded part starts at ${h.start}`),r=u),a=m}return r}loadedEndOfParts(e,t){let i;for(let r=e.length;r--;){if(i=e[r],!i.loaded)return!1;if(t>i.start)return!0}return!1}getInitialLiveFragment(e){const t=e.fragments,i=this.fragPrevious;let r=null;if(i){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),r=QA(t,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const a=i.sn+1;if(a>=e.startSN&&a<=e.endSN){const c=t[a-e.startSN];i.cc===c.cc&&(r=c,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=jy(e,i.cc,i.end),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const a=this.hls.liveSyncPosition;a!==null&&(r=this.getFragmentAtPosition(a,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,i){const{config:r}=this;let{fragPrevious:a}=this,{fragments:c,endSN:u}=i;const{fragmentHint:f}=i,{maxFragLookUpTolerance:h}=r,m=i.partList,p=!!(this.loadingParts&&m!=null&&m.length&&f);p&&!this.bitrateTest&&m[m.length-1].fragment.sn===f.sn&&(c=c.concat(f),u=f.sn);let y;if(e<t){var S;const T=e<this.lastCurrentTime||e>t-h||(S=this.media)!=null&&S.paused||!this.startFragRequested?0:h;y=hn(a,c,e,T)}else y=c[c.length-1];if(y){const E=y.sn-i.startSN,T=this.fragmentTracker.getState(y);if((T===mt.OK||T===mt.PARTIAL&&y.gap)&&(a=y),a&&y.sn===a.sn&&(!p||m[0].fragment.sn>y.sn||!i.live)&&y.level===a.level){const L=c[E+1];y.sn<u&&this.fragmentTracker.getState(L)!==mt.OK?y=L:y=null}}return y}alignPlaylists(e,t,i){const r=e.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;const a=e.fragmentStart,c=!t,u=e.alignedSliding&&de(a);if(c||!u&&!a){k1(i,e);const f=e.fragmentStart;return this.log(`Live playlist sliding: ${f.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${r}`),f}return a}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let i=this.startPosition;i<t&&(i=-1);const r=this.timelineOffset;if(i===-1){const a=this.startTimeOffset!==null,c=a?this.startTimeOffset:e.startTimeOffset;c!==null&&de(c)?(i=t+c,c<0&&(i+=e.edge),i=Math.min(Math.max(t,i),t+e.totalduration),this.log(`Setting startPosition to ${i} for start time offset ${c} found in ${a?"multivariant":"media"} playlist`),this.startPosition=i):e.live?(i=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${i}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=i=0),this.lastCurrentTime=i+r}this.nextLoadPosition=i+r}getLoadPosition(){var e;const{media:t}=this;let i=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?i=t.currentTime:this.nextLoadPosition>=0&&(i=this.nextLoadPosition),i}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&ut(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==ee.FRAG_LOADING_WAITING_RETRY)&&(this.state=ee.IDLE)}onFragmentOrKeyLoadError(e,t){var i;if(t.chunkMeta&&!t.frag){const L=this.getCurrentContext(t.chunkMeta);L&&(t.frag=L.frag)}const r=t.frag;if(!r||r.type!==e||!this.levels)return;if(this.fragContextChanged(r)){var a;this.warn(`Frag load error must match current frag to retry ${r.url} > ${(a=this.fragCurrent)==null?void 0:a.url}`);return}const c=t.details===H.FRAG_GAP;c&&this.fragmentTracker.fragBuffered(r,!0);const u=t.errorAction;if(!u){this.state=ee.ERROR;return}const{action:f,flags:h,retryCount:m=0,retryConfig:p}=u,y=!!p,S=y&&f===bt.RetryRequest,E=y&&!u.resolved&&h===Wt.MoveAllAlternatesMatchingHost,T=(i=this.hls.latestLevelDetails)==null?void 0:i.live;if(!S&&E&&ut(r)&&!r.endList&&T&&!Gy(t))this.resetFragmentErrors(e),this.treatAsGap(r),u.resolved=!0;else if((S||E)&&m<p.maxNumRetry){var b;const L=Od((b=t.response)==null?void 0:b.code),_=lh(p,m);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+_,this.state=ee.FRAG_LOADING_WAITING_RETRY,u.resolved=!0,L){this.log("Waiting for connection (offline)"),this.retryDate=1/0,t.reason="offline";return}this.warn(`Fragment ${r.sn} of ${e} ${r.level} errored with ${t.details}, retrying loading ${m+1}/${p.maxNumRetry} in ${_}ms`)}else if(p)if(this.resetFragmentErrors(e),m<p.maxNumRetry)!c&&f!==bt.RemoveAlternatePermanently&&(u.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${m})`);return}else f===bt.SendAlternateToPenaltyBox?this.state=ee.WAITING_LEVEL:this.state=ee.ERROR;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),t=this.retryDate,i=t===1/0;(!t||e>=t||i&&!Od(0))&&(i&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=ee.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===ee.PARSING||this.state===ee.PARSED){const t=e.frag,i=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,i),a=r&&r.len>.5;a&&this.reduceMaxBufferLength(r.len,(t==null?void 0:t.duration)||10);const c=!a;return c&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${i} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),c}return!1}resetFragmentErrors(e){e===me.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==ee.STOPPED&&(this.state=ee.IDLE)}afterBufferFlushed(e,t,i){if(!e)return;const r=be.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,i),this.state===ee.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==ee.STOPPED&&(this.state=ee.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,i,r){const a=i.details;if(!a){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((f,h)=>{const m=e.elementaryStreams[h];if(m){const p=m.endPTS-m.startPTS;if(p<=0)return this.warn(`Could not parse fragment ${e.sn} ${h} duration reliably (${p})`),f||!1;const y=r?0:Wy(a,e,m.startPTS,m.endPTS,m.startDTS,m.endDTS,this);return this.hls.trigger(A.LEVEL_PTS_UPDATED,{details:a,level:i,drift:y,type:h,frag:e,start:m.startPTS,end:m.endPTS}),!0}return f},!1)){var u;if(i.fragmentError===0&&this.treatAsGap(e,i),((u=this.transmuxer)==null?void 0:u.error)===null){const f=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(f.message),this.hls.trigger(A.ERROR,{type:pe.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,error:f,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=ee.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(A.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===me.MAIN?"level":"track"}fragInfo(e,t=!0,i){var r,a;return`${this.playlistLabel()} ${e.level} (${i?"part":"frag"}:[${((r=t&&!i?e.startPTS:(i||e).start)!=null?r:NaN).toFixed(3)}-${((a=t&&!i?e.endPTS:(i||e).end)!=null?a:NaN).toFixed(3)}]${i&&e.type==="main"?"INDEPENDENT="+(i.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function Ep(l){return!!l.interstitialsController&&l.enableInterstitialPlayback!==!1}class rx{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let i;if(e.length)e.length===1?i=e[0]:i=M1(e,t);else return new Uint8Array(0);return this.reset(),i}reset(){this.chunks.length=0,this.dataLength=0}}function M1(l,e){const t=new Uint8Array(e);let i=0;for(let r=0;r<l.length;r++){const a=l[r];t.set(a,i),i+=a.length}return t}var dd={exports:{}},Sp;function P1(){return Sp||(Sp=1,function(l){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function r(f,h,m){this.fn=f,this.context=h,this.once=m||!1}function a(f,h,m,p,y){if(typeof m!="function")throw new TypeError("The listener must be a function");var S=new r(m,p||f,y),E=t?t+h:h;return f._events[E]?f._events[E].fn?f._events[E]=[f._events[E],S]:f._events[E].push(S):(f._events[E]=S,f._eventsCount++),f}function c(f,h){--f._eventsCount===0?f._events=new i:delete f._events[h]}function u(){this._events=new i,this._eventsCount=0}u.prototype.eventNames=function(){var h=[],m,p;if(this._eventsCount===0)return h;for(p in m=this._events)e.call(m,p)&&h.push(t?p.slice(1):p);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(m)):h},u.prototype.listeners=function(h){var m=t?t+h:h,p=this._events[m];if(!p)return[];if(p.fn)return[p.fn];for(var y=0,S=p.length,E=new Array(S);y<S;y++)E[y]=p[y].fn;return E},u.prototype.listenerCount=function(h){var m=t?t+h:h,p=this._events[m];return p?p.fn?1:p.length:0},u.prototype.emit=function(h,m,p,y,S,E){var T=t?t+h:h;if(!this._events[T])return!1;var b=this._events[T],L=arguments.length,_,I;if(b.fn){switch(b.once&&this.removeListener(h,b.fn,void 0,!0),L){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,m),!0;case 3:return b.fn.call(b.context,m,p),!0;case 4:return b.fn.call(b.context,m,p,y),!0;case 5:return b.fn.call(b.context,m,p,y,S),!0;case 6:return b.fn.call(b.context,m,p,y,S,E),!0}for(I=1,_=new Array(L-1);I<L;I++)_[I-1]=arguments[I];b.fn.apply(b.context,_)}else{var C=b.length,N;for(I=0;I<C;I++)switch(b[I].once&&this.removeListener(h,b[I].fn,void 0,!0),L){case 1:b[I].fn.call(b[I].context);break;case 2:b[I].fn.call(b[I].context,m);break;case 3:b[I].fn.call(b[I].context,m,p);break;case 4:b[I].fn.call(b[I].context,m,p,y);break;default:if(!_)for(N=1,_=new Array(L-1);N<L;N++)_[N-1]=arguments[N];b[I].fn.apply(b[I].context,_)}}return!0},u.prototype.on=function(h,m,p){return a(this,h,m,p,!1)},u.prototype.once=function(h,m,p){return a(this,h,m,p,!0)},u.prototype.removeListener=function(h,m,p,y){var S=t?t+h:h;if(!this._events[S])return this;if(!m)return c(this,S),this;var E=this._events[S];if(E.fn)E.fn===m&&(!y||E.once)&&(!p||E.context===p)&&c(this,S);else{for(var T=0,b=[],L=E.length;T<L;T++)(E[T].fn!==m||y&&!E[T].once||p&&E[T].context!==p)&&b.push(E[T]);b.length?this._events[S]=b.length===1?b[0]:b:c(this,S)}return this},u.prototype.removeAllListeners=function(h){var m;return h?(m=t?t+h:h,this._events[m]&&c(this,m)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=t,u.EventEmitter=u,l.exports=u}(dd)),dd.exports}var U1=P1(),fh=oA(U1);const Ra="1.6.13",ur={};function B1(){return typeof __HLS_WORKER_BUNDLE__=="function"}function F1(){const l=ur[Ra];if(l)return l.clientCount++,l;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),r={worker:new self.Worker(t),objectURL:t,clientCount:1};return ur[Ra]=r,r}function j1(l){const e=ur[l];if(e)return e.clientCount++,e;const t=new self.URL(l,self.location.href).href,r={worker:new self.Worker(t),scriptURL:t,clientCount:1};return ur[l]=r,r}function $1(l){const e=ur[l||Ra];if(e&&e.clientCount--===1){const{worker:i,objectURL:r}=e;delete ur[l||Ra],r&&self.URL.revokeObjectURL(r),i.terminate()}}function ax(l,e){return e+10<=l.length&&l[e]===51&&l[e+1]===68&&l[e+2]===73&&l[e+3]<255&&l[e+4]<255&&l[e+6]<128&&l[e+7]<128&&l[e+8]<128&&l[e+9]<128}function mh(l,e){return e+10<=l.length&&l[e]===73&&l[e+1]===68&&l[e+2]===51&&l[e+3]<255&&l[e+4]<255&&l[e+6]<128&&l[e+7]<128&&l[e+8]<128&&l[e+9]<128}function Po(l,e){let t=0;return t=(l[e]&127)<<21,t|=(l[e+1]&127)<<14,t|=(l[e+2]&127)<<7,t|=l[e+3]&127,t}function La(l,e){const t=e;let i=0;for(;mh(l,e);){i+=10;const r=Po(l,e+6);i+=r,ax(l,e+10)&&(i+=10),e+=i}if(i>0)return l.subarray(t,t+i)}function G1(l,e,t,i){const r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],a=e[t+2],c=a>>2&15;if(c>12){const S=new Error(`invalid ADTS sampling index:${c}`);l.emit(A.ERROR,A.ERROR,{type:pe.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!0,error:S,reason:S.message});return}const u=(a>>6&3)+1,f=e[t+3]>>6&3|(a&1)<<2,h="mp4a.40."+u,m=r[c];let p=c;(u===5||u===29)&&(p-=3);const y=[u<<3|(p&14)>>1,(p&1)<<7|f<<3];return $e.log(`manifest codec:${i}, parsed codec:${h}, channels:${f}, rate:${m} (ADTS object type:${u} sampling index:${c})`),{config:y,samplerate:m,channelCount:f,codec:h,parsedCodec:h,manifestCodec:i}}function lx(l,e){return l[e]===255&&(l[e+1]&246)===240}function ox(l,e){return l[e+1]&1?7:9}function gh(l,e){return(l[e+3]&3)<<11|l[e+4]<<3|(l[e+5]&224)>>>5}function H1(l,e){return e+5<l.length}function wo(l,e){return e+1<l.length&&lx(l,e)}function V1(l,e){return H1(l,e)&&lx(l,e)&&gh(l,e)<=l.length-e}function K1(l,e){if(wo(l,e)){const t=ox(l,e);if(e+t>=l.length)return!1;const i=gh(l,e);if(i<=t)return!1;const r=e+i;return r===l.length||wo(l,r)}return!1}function cx(l,e,t,i,r){if(!l.samplerate){const a=G1(e,t,i,r);if(!a)return;Ke(l,a)}}function ux(l){return 1024*9e4/l}function z1(l,e){const t=ox(l,e);if(e+t<=l.length){const i=gh(l,e)-t;if(i>0)return{headerLength:t,frameLength:i}}}function dx(l,e,t,i,r){const a=ux(l.samplerate),c=i+r*a,u=z1(e,t);let f;if(u){const{frameLength:p,headerLength:y}=u,S=y+p,E=Math.max(0,t+S-e.length);E?(f=new Uint8Array(S-y),f.set(e.subarray(t+y,e.length),0)):f=e.subarray(t+y,t+S);const T={unit:f,pts:c};return E||l.samples.push(T),{sample:T,length:S,missing:E}}const h=e.length-t;return f=new Uint8Array(h),f.set(e.subarray(t,e.length),0),{sample:{unit:f,pts:c},length:h,missing:-1}}function Y1(l,e){return mh(l,e)&&Po(l,e+6)+10<=l.length-e}function q1(l){return l instanceof ArrayBuffer?l:l.byteOffset==0&&l.byteLength==l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer}function hd(l,e=0,t=1/0){return X1(l,e,t,Uint8Array)}function X1(l,e,t,i){const r=Q1(l);let a=1;"BYTES_PER_ELEMENT"in i&&(a=i.BYTES_PER_ELEMENT);const c=W1(l)?l.byteOffset:0,u=(c+l.byteLength)/a,f=(c+e)/a,h=Math.floor(Math.max(0,Math.min(f,u))),m=Math.floor(Math.min(h+Math.max(t,0),u));return new i(r,h,m-h)}function Q1(l){return l instanceof ArrayBuffer?l:l.buffer}function W1(l){return l&&l.buffer instanceof ArrayBuffer&&l.byteLength!==void 0&&l.byteOffset!==void 0}function Z1(l){const e={key:l.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(l.size<2)return;if(l.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const i=l.data.subarray(1).indexOf(0);if(i===-1)return;const r=ti(hd(l.data,1,i)),a=l.data[2+i],c=l.data.subarray(3+i).indexOf(0);if(c===-1)return;const u=ti(hd(l.data,3+i,c));let f;return r==="-->"?f=ti(hd(l.data,4+i+c)):f=q1(l.data.subarray(4+i+c)),e.mimeType=r,e.pictureType=a,e.description=u,e.data=f,e}function J1(l){if(l.size<2)return;const e=ti(l.data,!0),t=new Uint8Array(l.data.subarray(e.length+1));return{key:l.type,info:e,data:t.buffer}}function eR(l){if(l.size<2)return;if(l.type==="TXXX"){let t=1;const i=ti(l.data.subarray(t),!0);t+=i.length+1;const r=ti(l.data.subarray(t));return{key:l.type,info:i,data:r}}const e=ti(l.data.subarray(1));return{key:l.type,info:"",data:e}}function tR(l){if(l.type==="WXXX"){if(l.size<2)return;let t=1;const i=ti(l.data.subarray(t),!0);t+=i.length+1;const r=ti(l.data.subarray(t));return{key:l.type,info:i,data:r}}const e=ti(l.data);return{key:l.type,info:"",data:e}}function iR(l){return l.type==="PRIV"?J1(l):l.type[0]==="W"?tR(l):l.type==="APIC"?Z1(l):eR(l)}function sR(l){const e=String.fromCharCode(l[0],l[1],l[2],l[3]),t=Po(l,4),i=10;return{type:e,size:t,data:l.subarray(i,i+t)}}const Jl=10,nR=10;function hx(l){let e=0;const t=[];for(;mh(l,e);){const i=Po(l,e+6);l[e+5]>>6&1&&(e+=Jl),e+=Jl;const r=e+i;for(;e+nR<r;){const a=sR(l.subarray(e)),c=iR(a);c&&t.push(c),e+=a.size+Jl}ax(l,e)&&(e+=Jl)}return t}function fx(l){return l&&l.key==="PRIV"&&l.info==="com.apple.streaming.transportStreamTimestamp"}function rR(l){if(l.data.byteLength===8){const e=new Uint8Array(l.data),t=e[3]&1;let i=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return i/=45,t&&(i+=4772185884e-2),Math.round(i)}}function ph(l){const e=hx(l);for(let t=0;t<e.length;t++){const i=e[t];if(fx(i))return rR(i)}}let Jt=function(l){return l.audioId3="org.id3",l.dateRange="com.apple.quicktime.HLS",l.emsg="https://aomedia.org/emsg/ID3",l.misbklv="urn:misb:KLV:bin:1910.1",l}({});function Ni(l="",e=9e4){return{type:l,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class yh{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,i,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,i){}demux(e,t){this.cachedData&&(e=fi(this.cachedData,e),this.cachedData=null);let i=La(e,0),r=i?i.length:0,a;const c=this._audioTrack,u=this._id3Track,f=i?ph(i):void 0,h=e.length;for((this.basePTS===null||this.frameIndex===0&&de(f))&&(this.basePTS=aR(f,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),i&&i.length>0&&u.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Jt.audioId3,duration:Number.POSITIVE_INFINITY});r<h;){if(this.canParse(e,r)){const m=this.appendFrame(c,e,r);m?(this.frameIndex++,this.lastPTS=m.sample.pts,r+=m.length,a=r):r=h}else Y1(e,r)?(i=La(e,r),u.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Jt.audioId3,duration:Number.POSITIVE_INFINITY}),r+=i.length,a=r):r++;if(r===h&&a!==h){const m=e.slice(a);this.cachedData?this.cachedData=fi(this.cachedData,m):this.cachedData=m}}return{audioTrack:c,videoTrack:Ni(),id3Track:u,textTrack:Ni()}}demuxSampleAes(e,t,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Ni(),id3Track:this._id3Track,textTrack:Ni()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const aR=(l,e,t)=>{if(de(l))return l*90;const i=t?t.baseTime*9e4/t.timescale:0;return e*9e4+i};let eo=null;const lR=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],oR=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],cR=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],uR=[0,1,1,4];function mx(l,e,t,i,r){if(t+24>e.length)return;const a=gx(e,t);if(a&&t+a.frameLength<=e.length){const c=a.samplesPerFrame*9e4/a.sampleRate,u=i+r*c,f={unit:e.subarray(t,t+a.frameLength),pts:u,dts:u};return l.config=[],l.channelCount=a.channelCount,l.samplerate=a.sampleRate,l.samples.push(f),{sample:f,length:a.frameLength,missing:0}}}function gx(l,e){const t=l[e+1]>>3&3,i=l[e+1]>>1&3,r=l[e+2]>>4&15,a=l[e+2]>>2&3;if(t!==1&&r!==0&&r!==15&&a!==3){const c=l[e+2]>>1&1,u=l[e+3]>>6,f=t===3?3-i:i===3?3:4,h=lR[f*14+r-1]*1e3,p=oR[(t===3?0:t===2?1:2)*3+a],y=u===3?1:2,S=cR[t][i],E=uR[i],T=S*8*E,b=Math.floor(S*h/p+c)*E;if(eo===null){const I=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);eo=I?parseInt(I[1]):0}return!!eo&&eo<=87&&i===2&&h>=224e3&&u===0&&(l[e+3]=l[e+3]|128),{sampleRate:p,channelCount:y,frameLength:b,samplesPerFrame:T}}}function xh(l,e){return l[e]===255&&(l[e+1]&224)===224&&(l[e+1]&6)!==0}function px(l,e){return e+1<l.length&&xh(l,e)}function dR(l,e){return xh(l,e)&&4<=l.length-e}function yx(l,e){if(e+1<l.length&&xh(l,e)){const i=gx(l,e);let r=4;i!=null&&i.frameLength&&(r=i.frameLength);const a=e+r;return a===l.length||px(l,a)}return!1}class hR extends yh{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,i,r){super.resetInitSegment(e,t,i,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const i=La(e,0);let r=(i==null?void 0:i.length)||0;if(yx(e,r))return!1;for(let a=e.length;r<a;r++)if(K1(e,r))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return V1(e,t)}appendFrame(e,t,i){cx(e,this.observer,t,i,e.manifestCodec);const r=dx(e,t,i,this.basePTS,this.frameIndex);if(r&&r.missing===0)return r}}const xx=(l,e)=>{let t=0,i=5;e+=i;const r=new Uint32Array(1),a=new Uint32Array(1),c=new Uint8Array(1);for(;i>0;){c[0]=l[e];const u=Math.min(i,8),f=8-u;a[0]=4278190080>>>24+f<<f,r[0]=(c[0]&a[0])>>f,t=t?t<<u|r[0]:r[0],e+=1,i-=u}return t};class fR extends yh{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,i,r){super.resetInitSegment(e,t,i,r),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,i){const r=vx(e,t,i,this.basePTS,this.frameIndex);if(r!==-1)return{sample:e.samples[e.samples.length-1],length:r,missing:0}}static probe(e){if(!e)return!1;const t=La(e,0);if(!t)return!1;const i=t.length;return e[i]===11&&e[i+1]===119&&ph(t)!==void 0&&xx(e,i)<16}}function vx(l,e,t,i,r){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const a=e[t+4]>>6;if(a>=3)return-1;const u=[48e3,44100,32e3][a],f=e[t+4]&63,m=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][f*3+a]*2;if(t+m>e.length)return-1;const p=e[t+6]>>5;let y=0;p===2?y+=2:(p&1&&p!==1&&(y+=2),p&4&&(y+=2));const S=(e[t+6]<<8|e[t+7])>>12-y&1,T=[2,1,2,3,3,4,4,5][p]+S,b=e[t+5]>>3,L=e[t+5]&7,_=new Uint8Array([a<<6|b<<1|L>>2,(L&3)<<6|p<<3|S<<2|f>>4,f<<4&224]),I=1536/u*9e4,C=i+r*I,N=e.subarray(t,t+m);return l.config=_,l.channelCount=T,l.samplerate=u,l.samples.push({unit:N,pts:C}),m}class mR extends yh{resetInitSegment(e,t,i,r){super.resetInitSegment(e,t,i,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=La(e,0);let i=(t==null?void 0:t.length)||0;if(t&&e[i]===11&&e[i+1]===119&&ph(t)!==void 0&&xx(e,i)<=16)return!1;for(let r=e.length;i<r;i++)if(yx(e,i))return $e.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return dR(e,t)}appendFrame(e,t,i){if(this.basePTS!==null)return mx(e,t,i,this.basePTS,this.frameIndex)}}const gR=/\/emsg[-/]ID3/i;class pR{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,i,r){const a=this.videoTrack=Ni("video",1),c=this.audioTrack=Ni("audio",1),u=this.txtTrack=Ni("text",1);if(this.id3Track=Ni("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const f=Iy(e);if(f.video){const{id:h,timescale:m,codec:p,supplemental:y}=f.video;a.id=h,a.timescale=u.timescale=m,a.codec=p,a.supplemental=y}if(f.audio){const{id:h,timescale:m,codec:p}=f.audio;c.id=h,c.timescale=m,c.codec=p}u.id=Ly.text,a.sampleDuration=0,a.duration=c.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return fA(e)}demux(e,t){this.timeOffset=t;let i=e;const r=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=fi(this.remainderData,e));const u=EA(i);this.remainderData=u.remainder,r.samples=u.valid||new Uint8Array}else r.samples=i;const c=this.extractID3Track(r,t);return a.samples=F0(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:c,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,i=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(t,this.timeOffset);return i.samples=F0(e,t),{videoTrack:t,audioTrack:Ni(),id3Track:r,textTrack:Ni()}}extractID3Track(e,t){const i=this.id3Track;if(e.samples.length){const r=_e(e.samples,["emsg"]);r&&r.forEach(a=>{const c=TA(a);if(gR.test(c.schemeIdUri)){const u=Tp(c,t);let f=c.eventDuration===4294967295?Number.POSITIVE_INFINITY:c.eventDuration/c.timeScale;f<=.001&&(f=Number.POSITIVE_INFINITY);const h=c.payload;i.samples.push({data:h,len:h.byteLength,dts:u,pts:u,type:Jt.emsg,duration:f})}else if(this.config.enableEmsgKLVMetadata&&c.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const u=Tp(c,t);i.samples.push({data:c.payload,len:c.payload.byteLength,dts:u,pts:u,type:Jt.misbklv,duration:Number.POSITIVE_INFINITY})}})}return i}demuxSampleAes(e,t,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function Tp(l,e){return de(l.presentationTime)?l.presentationTime/l.timeScale:e+l.presentationTimeDelta/l.timeScale}class yR{constructor(e,t,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new oh(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,Us.cbc)}decryptAacSample(e,t,i){const r=e[t].unit;if(r.length<=16)return;const a=r.subarray(16,r.length-r.length%16),c=a.buffer.slice(a.byteOffset,a.byteOffset+a.length);this.decryptBuffer(c).then(u=>{const f=new Uint8Array(u);r.set(f,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,i)}).catch(i)}decryptAacSamples(e,t,i){for(;;t++){if(t>=e.length){i();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,i=new Int8Array(t);let r=0;for(let a=32;a<e.length-16;a+=160,r+=16)i.set(e.subarray(a,a+16),r);return i}getAvcDecryptedUnit(e,t){const i=new Uint8Array(t);let r=0;for(let a=32;a<e.length-16;a+=160,r+=16)e.set(i.subarray(r,r+16),a);return e}decryptAvcSample(e,t,i,r,a){const c=Ny(a.data),u=this.getAvcEncryptedData(c);this.decryptBuffer(u.buffer).then(f=>{a.data=this.getAvcDecryptedUnit(c,f),this.decrypter.isSync()||this.decryptAvcSamples(e,t,i+1,r)}).catch(r)}decryptAvcSamples(e,t,i,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,i=0){if(t>=e.length){r();return}const a=e[t].units;for(;!(i>=a.length);i++){const c=a[i];if(!(c.data.length<=48||c.type!==1&&c.type!==5)&&(this.decryptAvcSample(e,t,i,r,c),!this.decrypter.isSync()))return}}}}class Ex{constructor(){this.VideoSample=null}createVideoSample(e,t,i){return{key:e,frame:!1,pts:t,dts:i,units:[],length:0}}getLastNalUnit(e){var t;let i=this.VideoSample,r;if((!i||i.units.length===0)&&(i=e[e.length-1]),(t=i)!=null&&t.units){const a=i.units;r=a[a.length-1]}return r}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const i=t.samples,r=i.length;if(r){const a=i[r-1];e.pts=a.pts,e.dts=a.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,i){const r=t.byteLength;let a=e.naluState||0;const c=a,u=[];let f=0,h,m,p,y=-1,S=0;for(a===-1&&(y=0,S=this.getNALuType(t,0),a=0,f=1);f<r;){if(h=t[f++],!a){a=h?0:1;continue}if(a===1){a=h?0:2;continue}if(!h)a=3;else if(h===1){if(m=f-a-1,y>=0){const E={data:t.subarray(y,m),type:S};u.push(E)}else{const E=this.getLastNalUnit(e.samples);E&&(c&&f<=4-c&&E.state&&(E.data=E.data.subarray(0,E.data.byteLength-c)),m>0&&(E.data=fi(E.data,t.subarray(0,m)),E.state=0))}f<r?(p=this.getNALuType(t,f),y=f,S=p,a=0):a=-1}else a=0}if(y>=0&&a>=0){const E={data:t.subarray(y,r),type:S,state:a};u.push(E)}if(u.length===0){const E=this.getLastNalUnit(e.samples);E&&(E.data=fi(E.data,t))}return e.naluState=a,u}}class va{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,i=e.byteLength-t,r=new Uint8Array(4),a=Math.min(4,t);if(a===0)throw new Error("no bytes available");r.set(e.subarray(i,i+a)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=a*8,this.bytesAvailable-=a}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const i=this.word>>>32-t;if(e>32&&$e.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?i<<t|this.readBits(t):i}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class xR extends Ex{parsePES(e,t,i,r){const a=this.parseNALu(e,i.data,r);let c=this.VideoSample,u,f=!1;i.data=null,c&&a.length&&!e.audFound&&(this.pushAccessUnit(c,e),c=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),a.forEach(h=>{var m,p;switch(h.type){case 1:{let T=!1;u=!0;const b=h.data;if(f&&b.length>4){const L=this.readSliceType(b);(L===2||L===4||L===7||L===9)&&(T=!0)}if(T){var y;(y=c)!=null&&y.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null)}c||(c=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),c.frame=!0,c.key=T;break}case 5:u=!0,(m=c)!=null&&m.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null),c||(c=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),c.key=!0,c.frame=!0;break;case 6:{u=!0,nh(h.data,1,i.pts,t.samples);break}case 7:{var S,E;u=!0,f=!0;const T=h.data,b=this.readSPS(T);if(!e.sps||e.width!==b.width||e.height!==b.height||((S=e.pixelRatio)==null?void 0:S[0])!==b.pixelRatio[0]||((E=e.pixelRatio)==null?void 0:E[1])!==b.pixelRatio[1]){e.width=b.width,e.height=b.height,e.pixelRatio=b.pixelRatio,e.sps=[T];const L=T.subarray(1,4);let _="avc1.";for(let I=0;I<3;I++){let C=L[I].toString(16);C.length<2&&(C="0"+C),_+=C}e.codec=_}break}case 8:u=!0,e.pps=[h.data];break;case 9:u=!0,e.audFound=!0,(p=c)!=null&&p.frame&&(this.pushAccessUnit(c,e),c=null),c||(c=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;case 12:u=!0;break;default:u=!1;break}c&&u&&c.units.push(h)}),r&&c&&(this.pushAccessUnit(c,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new va(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let i=8,r=8,a;for(let c=0;c<e;c++)r!==0&&(a=t.readEG(),r=(i+a+256)%256),i=r===0?i:r}readSPS(e){const t=new va(e);let i=0,r=0,a=0,c=0,u,f,h;const m=t.readUByte.bind(t),p=t.readBits.bind(t),y=t.readUEG.bind(t),S=t.readBoolean.bind(t),E=t.skipBits.bind(t),T=t.skipEG.bind(t),b=t.skipUEG.bind(t),L=this.skipScalingList.bind(this);m();const _=m();if(p(5),E(3),m(),b(),_===100||_===110||_===122||_===244||_===44||_===83||_===86||_===118||_===128){const j=y();if(j===3&&E(1),b(),b(),E(1),S())for(f=j!==3?8:12,h=0;h<f;h++)S()&&(h<6?L(16,t):L(64,t))}b();const I=y();if(I===0)y();else if(I===1)for(E(1),T(),T(),u=y(),h=0;h<u;h++)T();b(),E(1);const C=y(),N=y(),K=p(1);K===0&&E(1),E(1),S()&&(i=y(),r=y(),a=y(),c=y());let O=[1,1];if(S()&&S())switch(m()){case 1:O=[1,1];break;case 2:O=[12,11];break;case 3:O=[10,11];break;case 4:O=[16,11];break;case 5:O=[40,33];break;case 6:O=[24,11];break;case 7:O=[20,11];break;case 8:O=[32,11];break;case 9:O=[80,33];break;case 10:O=[18,11];break;case 11:O=[15,11];break;case 12:O=[64,33];break;case 13:O=[160,99];break;case 14:O=[4,3];break;case 15:O=[3,2];break;case 16:O=[2,1];break;case 255:{O=[m()<<8|m(),m()<<8|m()];break}}return{width:Math.ceil((C+1)*16-i*2-r*2),height:(2-K)*(N+1)*16-(K?2:4)*(a+c),pixelRatio:O}}}class vR extends Ex{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,i,r){const a=this.parseNALu(e,i.data,r);let c=this.VideoSample,u,f=!1;i.data=null,c&&a.length&&!e.audFound&&(this.pushAccessUnit(c,e),c=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),a.forEach(h=>{var m,p;switch(h.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:c||(c=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),c.frame=!0,u=!0;break;case 16:case 17:case 18:case 21:if(u=!0,f){var y;(y=c)!=null&&y.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null)}c||(c=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),c.key=!0,c.frame=!0;break;case 19:case 20:u=!0,(m=c)!=null&&m.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null),c||(c=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),c.key=!0,c.frame=!0;break;case 39:u=!0,nh(h.data,2,i.pts,t.samples);break;case 32:u=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=Ke(e.params,this.readVPS(h.data)),this.initVPS=h.data),e.vps=[h.data];break;case 33:if(u=!0,f=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],h.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const S=this.readSPS(h.data);e.width=S.width,e.height=S.height,e.pixelRatio=S.pixelRatio,e.codec=S.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const E in S.params)e.params[E]=S.params[E]}this.pushParameterSet(e.sps,h.data,e.vps),c||(c=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),c.key=!0;break;case 34:if(u=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const S=this.readPPS(h.data);for(const E in S)e.params[E]=S[E]}this.pushParameterSet(e.pps,h.data,e.vps)}break;case 35:u=!0,e.audFound=!0,(p=c)!=null&&p.frame&&(this.pushAccessUnit(c,e),c=null),c||(c=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;default:u=!1;break}c&&u&&c.units.push(h)}),r&&c&&(this.pushAccessUnit(c,e),this.VideoSample=null)}pushParameterSet(e,t,i){(i&&i[0]===this.initVPS||!i&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let i=0;for(let r=0;r<e.byteLength;r++)r>=2&&e[r]===3&&e[r-1]===0&&e[r-2]===0||(t[i]=e[r],i++);return new Uint8Array(t.buffer,0,i)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new va(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const i=t.readBits(3),r=t.readBoolean();return{numTemporalLayers:i+1,temporalIdNested:r}}readSPS(e){const t=new va(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const i=t.readBits(3);t.readBoolean();const r=t.readBits(2),a=t.readBoolean(),c=t.readBits(5),u=t.readUByte(),f=t.readUByte(),h=t.readUByte(),m=t.readUByte(),p=t.readUByte(),y=t.readUByte(),S=t.readUByte(),E=t.readUByte(),T=t.readUByte(),b=t.readUByte(),L=t.readUByte(),_=[],I=[];for(let Ne=0;Ne<i;Ne++)_.push(t.readBoolean()),I.push(t.readBoolean());if(i>0)for(let Ne=i;Ne<8;Ne++)t.readBits(2);for(let Ne=0;Ne<i;Ne++)_[Ne]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),I[Ne]&&t.readUByte();t.readUEG();const C=t.readUEG();C==3&&t.skipBits(1);const N=t.readUEG(),K=t.readUEG(),O=t.readBoolean();let j=0,B=0,U=0,W=0;O&&(j+=t.readUEG(),B+=t.readUEG(),U+=t.readUEG(),W+=t.readUEG());const re=t.readUEG(),ue=t.readUEG(),fe=t.readUEG(),le=t.readBoolean();for(let Ne=le?0:i;Ne<=i;Ne++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let ze=0;ze<4;ze++)for(let Ot=0;Ot<(ze===3?2:6);Ot++)if(!t.readBoolean())t.readUEG();else{const Mt=Math.min(64,1<<4+(ze<<1));ze>1&&t.readEG();for(let gi=0;gi<Mt;gi++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const Z=t.readUEG();let ae=0;for(let Ne=0;Ne<Z;Ne++){let ze=!1;if(Ne!==0&&(ze=t.readBoolean()),ze){Ne===Z&&t.readUEG(),t.readBoolean(),t.readUEG();let Ot=0;for(let Ti=0;Ti<=ae;Ti++){const Mt=t.readBoolean();let gi=!1;Mt||(gi=t.readBoolean()),(Mt||gi)&&Ot++}ae=Ot}else{const Ot=t.readUEG(),Ti=t.readUEG();ae=Ot+Ti;for(let Mt=0;Mt<Ot;Mt++)t.readUEG(),t.readBoolean();for(let Mt=0;Mt<Ti;Mt++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const Ne=t.readUEG();for(let ze=0;ze<Ne;ze++){for(let Ot=0;Ot<fe+4;Ot++)t.readBits(1);t.readBits(1)}}let F=0,q=1,se=1,oe=!0,he=1,ce=0;t.readBoolean(),t.readBoolean();let Ue=!1;if(t.readBoolean()){if(t.readBoolean()){const Fi=t.readUByte(),gr=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],fn=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];Fi>0&&Fi<16?(q=gr[Fi-1],se=fn[Fi-1]):Fi===255&&(q=t.readBits(16),se=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),Ue=t.readBoolean(),Ue&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(he=t.readBits(32),ce=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const fn=t.readBoolean(),Na=t.readBoolean();let pi=!1;(fn||Na)&&(pi=t.readBoolean(),pi&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),pi&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let Rt=0;Rt<=i;Rt++){oe=t.readBoolean();const bi=oe||t.readBoolean();let Lt=!1;bi?t.readEG():Lt=t.readBoolean();const ka=Lt?1:t.readUEG()+1;if(fn)for(let $s=0;$s<ka;$s++)t.readUEG(),t.readUEG(),pi&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(Na)for(let $s=0;$s<ka;$s++)t.readUEG(),t.readUEG(),pi&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),F=t.readUEG())}let rt=N,kt=K;if(O){let Ne=1,ze=1;C===1?Ne=ze=2:C==2&&(Ne=2),rt=N-Ne*B-Ne*j,kt=K-ze*W-ze*U}const ii=r?["A","B","C"][r]:"",mr=u<<24|f<<16|h<<8|m;let Fs=0;for(let Ne=0;Ne<32;Ne++)Fs=(Fs|(mr>>Ne&1)<<31-Ne)>>>0;let js=Fs.toString(16);return c===1&&js==="2"&&(js="6"),{codecString:`hvc1.${ii}${c}.${js}.${a?"H":"L"}${L}.B0`,params:{general_tier_flag:a,general_profile_idc:c,general_profile_space:r,general_profile_compatibility_flags:[u,f,h,m],general_constraint_indicator_flags:[p,y,S,E,T,b],general_level_idc:L,bit_depth:re+8,bit_depth_luma_minus8:re,bit_depth_chroma_minus8:ue,min_spatial_segmentation_idc:F,chroma_format_idc:C,frame_rate:{fixed:oe,fps:ce/he}},width:rt,height:kt,pixelRatio:[q,se]}}readPPS(e){const t=new va(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const r=t.readBoolean(),a=t.readBoolean();let c=1;return a&&r?c=0:a?c=3:r&&(c=2),{parallelismType:c}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const vt=188;class Os{constructor(e,t,i,r){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=i,this.logger=r,this.videoParser=null}static probe(e,t){const i=Os.syncOffset(e);return i>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${i}`),i!==-1}static syncOffset(e){const t=e.length;let i=Math.min(vt*5,t-vt)+1,r=0;for(;r<i;){let a=!1,c=-1,u=0;for(let f=r;f<t;f+=vt)if(e[f]===71&&(t-f===vt||e[f+vt]===71)){if(u++,c===-1&&(c=f,c!==0&&(i=Math.min(c+vt*99,e.length-vt)+1)),a||(a=Fd(e,f)===0),a&&u>1&&(c===0&&u>2||f+vt>i))return c}else{if(u)return-1;break}r++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:Ly[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,i,r){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Os.createTrack("video"),this._videoTrack.duration=r,this._audioTrack=Os.createTrack("audio",r),this._id3Track=Os.createTrack("id3"),this._txtTrack=Os.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:i}=this;e&&(e.pesData=null),t&&(t.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,i=!1,r=!1){i||(this.sampleAes=null);let a;const c=this._videoTrack,u=this._audioTrack,f=this._id3Track,h=this._txtTrack;let m=c.pid,p=c.pesData,y=u.pid,S=f.pid,E=u.pesData,T=f.pesData,b=null,L=this.pmtParsed,_=this._pmtId,I=e.length;if(this.remainderData&&(e=fi(this.remainderData,e),I=e.length,this.remainderData=null),I<vt&&!r)return this.remainderData=e,{audioTrack:u,videoTrack:c,id3Track:f,textTrack:h};const C=Math.max(0,Os.syncOffset(e));I-=(I-C)%vt,I<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,I,e.buffer.byteLength-I));let N=0;for(let O=C;O<I;O+=vt)if(e[O]===71){const j=!!(e[O+1]&64),B=Fd(e,O),U=(e[O+3]&48)>>4;let W;if(U>1){if(W=O+5+e[O+4],W===O+vt)continue}else W=O+4;switch(B){case m:j&&(p&&(a=tr(p,this.logger))&&(this.readyVideoParser(c.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(c,h,a,!1)),p={data:[],size:0}),p&&(p.data.push(e.subarray(W,O+vt)),p.size+=O+vt-W);break;case y:if(j){if(E&&(a=tr(E,this.logger)))switch(u.segmentCodec){case"aac":this.parseAACPES(u,a);break;case"mp3":this.parseMPEGPES(u,a);break;case"ac3":this.parseAC3PES(u,a);break}E={data:[],size:0}}E&&(E.data.push(e.subarray(W,O+vt)),E.size+=O+vt-W);break;case S:j&&(T&&(a=tr(T,this.logger))&&this.parseID3PES(f,a),T={data:[],size:0}),T&&(T.data.push(e.subarray(W,O+vt)),T.size+=O+vt-W);break;case 0:j&&(W+=e[W]+1),_=this._pmtId=ER(e,W);break;case _:{j&&(W+=e[W]+1);const re=SR(e,W,this.typeSupported,i,this.observer,this.logger);m=re.videoPid,m>0&&(c.pid=m,c.segmentCodec=re.segmentVideoCodec),y=re.audioPid,y>0&&(u.pid=y,u.segmentCodec=re.segmentAudioCodec),S=re.id3Pid,S>0&&(f.pid=S),b!==null&&!L&&(this.logger.warn(`MPEG-TS PMT found at ${O} after unknown PID '${b}'. Backtracking to sync byte @${C} to parse all TS packets.`),b=null,O=C-188),L=this.pmtParsed=!0;break}case 17:case 8191:break;default:b=B;break}}else N++;N>0&&jd(this.observer,new Error(`Found ${N} TS packet/s that do not start with 0x47`),void 0,this.logger),c.pesData=p,u.pesData=E,f.pesData=T;const K={audioTrack:u,videoTrack:c,id3Track:f,textTrack:h};return r&&this.extractRemainingSamples(K),K}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:i,id3Track:r,textTrack:a}=e,c=i.pesData,u=t.pesData,f=r.pesData;let h;if(c&&(h=tr(c,this.logger))?(this.readyVideoParser(i.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(i,a,h,!0),i.pesData=null)):i.pesData=c,u&&(h=tr(u,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,h);break;case"mp3":this.parseMPEGPES(t,h);break;case"ac3":this.parseAC3PES(t,h);break}t.pesData=null}else u!=null&&u.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=u;f&&(h=tr(f,this.logger))?(this.parseID3PES(r,h),r.pesData=null):r.pesData=f}demuxSampleAes(e,t,i){const r=this.demux(e,i,!0,!this.config.progressive),a=this.sampleAes=new yR(this.observer,this.config,t);return this.decrypt(r,a)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new xR:e==="hevc"&&(this.videoParser=new vR))}decrypt(e,t){return new Promise(i=>{const{audioTrack:r,videoTrack:a}=e;r.samples&&r.segmentCodec==="aac"?t.decryptAacSamples(r.samples,0,()=>{a.samples?t.decryptAvcSamples(a.samples,0,0,()=>{i(e)}):i(e)}):a.samples&&t.decryptAvcSamples(a.samples,0,0,()=>{i(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let i=0;const r=this.aacOverFlow;let a=t.data;if(r){this.aacOverFlow=null;const p=r.missing,y=r.sample.unit.byteLength;if(p===-1)a=fi(r.sample.unit,a);else{const S=y-p;r.sample.unit.set(a.subarray(0,p),S),e.samples.push(r.sample),i=r.missing}}let c,u;for(c=i,u=a.length;c<u-1&&!wo(a,c);c++);if(c!==i){let p;const y=c<u-1;if(y?p=`AAC PES did not start with ADTS header,offset:${c}`:p="No ADTS header found in AAC PES",jd(this.observer,new Error(p),y,this.logger),!y)return}cx(e,this.observer,a,c,this.audioCodec);let f;if(t.pts!==void 0)f=t.pts;else if(r){const p=ux(e.samplerate);f=r.sample.pts+p}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let h=0,m;for(;c<u;)if(m=dx(e,a,c,f,h),c+=m.length,m.missing){this.aacOverFlow=m;break}else for(h++;c<u-1&&!wo(a,c);c++);}parseMPEGPES(e,t){const i=t.data,r=i.length;let a=0,c=0;const u=t.pts;if(u===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;c<r;)if(px(i,c)){const f=mx(e,i,c,u,a);if(f)c+=f.length,a++;else break}else c++}parseAC3PES(e,t){{const i=t.data,r=t.pts;if(r===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const a=i.length;let c=0,u=0,f;for(;u<a&&(f=vx(e,i,u,r,c++))>0;)u+=f}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const i=Ke({},t,{type:this._videoTrack?Jt.emsg:Jt.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(i)}}function Fd(l,e){return((l[e+1]&31)<<8)+l[e+2]}function ER(l,e){return(l[e+10]&31)<<8|l[e+11]}function SR(l,e,t,i,r,a){const c={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},u=(l[e+1]&15)<<8|l[e+2],f=e+3+u-4,h=(l[e+10]&15)<<8|l[e+11];for(e+=12+h;e<f;){const m=Fd(l,e),p=(l[e+3]&15)<<8|l[e+4];switch(l[e]){case 207:if(!i){fd("ADTS AAC",a);break}case 15:c.audioPid===-1&&(c.audioPid=m);break;case 21:c.id3Pid===-1&&(c.id3Pid=m);break;case 219:if(!i){fd("H.264",a);break}case 27:c.videoPid===-1&&(c.videoPid=m);break;case 3:case 4:!t.mpeg&&!t.mp3?a.log("MPEG audio found, not supported in this browser"):c.audioPid===-1&&(c.audioPid=m,c.segmentAudioCodec="mp3");break;case 193:if(!i){fd("AC-3",a);break}case 129:t.ac3?c.audioPid===-1&&(c.audioPid=m,c.segmentAudioCodec="ac3"):a.log("AC-3 audio found, not supported in this browser");break;case 6:if(c.audioPid===-1&&p>0){let y=e+5,S=p;for(;S>2;){switch(l[y]){case 106:t.ac3!==!0?a.log("AC-3 audio found, not supported in this browser for now"):(c.audioPid=m,c.segmentAudioCodec="ac3");break}const T=l[y+1]+2;y+=T,S-=T}}break;case 194:case 135:return jd(r,new Error("Unsupported EC-3 in M2TS found"),void 0,a),c;case 36:c.videoPid===-1&&(c.videoPid=m,c.segmentVideoCodec="hevc",a.log("HEVC in M2TS found"));break}e+=p+5}return c}function jd(l,e,t,i){i.warn(`parsing error: ${e.message}`),l.emit(A.ERROR,A.ERROR,{type:pe.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function fd(l,e){e.log(`${l} with AES-128-CBC encryption found in unencrypted stream`)}function tr(l,e){let t=0,i,r,a,c,u;const f=l.data;if(!l||l.size===0)return null;for(;f[0].length<19&&f.length>1;)f[0]=fi(f[0],f[1]),f.splice(1,1);if(i=f[0],(i[0]<<16)+(i[1]<<8)+i[2]===1){if(r=(i[4]<<8)+i[5],r&&r>l.size-6)return null;const m=i[7];m&192&&(c=(i[9]&14)*536870912+(i[10]&255)*4194304+(i[11]&254)*16384+(i[12]&255)*128+(i[13]&254)/2,m&64?(u=(i[14]&14)*536870912+(i[15]&255)*4194304+(i[16]&254)*16384+(i[17]&255)*128+(i[18]&254)/2,c-u>60*9e4&&(e.warn(`${Math.round((c-u)/9e4)}s delta between PTS and DTS, align them`),c=u)):u=c),a=i[8];let p=a+9;if(l.size<=p)return null;l.size-=p;const y=new Uint8Array(l.size);for(let S=0,E=f.length;S<E;S++){i=f[S];let T=i.byteLength;if(p)if(p>T){p-=T;continue}else i=i.subarray(p),T-=p,p=0;y.set(i,t),t+=T}return r&&(r-=a+3),{data:y,pts:c,dts:u,len:r}}return null}class TR{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const ws=Math.pow(2,32)-1;class G{static init(){G.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in G.types)G.types.hasOwnProperty(e)&&(G.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);G.HDLR_TYPES={video:t,audio:i};const r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);G.STTS=G.STSC=G.STCO=a,G.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),G.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),G.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),G.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const c=new Uint8Array([105,115,111,109]),u=new Uint8Array([97,118,99,49]),f=new Uint8Array([0,0,0,1]);G.FTYP=G.box(G.types.ftyp,c,f,c,u),G.DINF=G.box(G.types.dinf,G.box(G.types.dref,r))}static box(e,...t){let i=8,r=t.length;const a=r;for(;r--;)i+=t[r].byteLength;const c=new Uint8Array(i);for(c[0]=i>>24&255,c[1]=i>>16&255,c[2]=i>>8&255,c[3]=i&255,c.set(e,4),r=0,i=8;r<a;r++)c.set(t[r],i),i+=t[r].byteLength;return c}static hdlr(e){return G.box(G.types.hdlr,G.HDLR_TYPES[e])}static mdat(e){return G.box(G.types.mdat,e)}static mdhd(e,t){t*=e;const i=Math.floor(t/(ws+1)),r=Math.floor(t%(ws+1));return G.box(G.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24,i>>16&255,i>>8&255,i&255,r>>24,r>>16&255,r>>8&255,r&255,85,196,0,0]))}static mdia(e){return G.box(G.types.mdia,G.mdhd(e.timescale||0,e.duration||0),G.hdlr(e.type),G.minf(e))}static mfhd(e){return G.box(G.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?G.box(G.types.minf,G.box(G.types.smhd,G.SMHD),G.DINF,G.stbl(e)):G.box(G.types.minf,G.box(G.types.vmhd,G.VMHD),G.DINF,G.stbl(e))}static moof(e,t,i){return G.box(G.types.moof,G.mfhd(e),G.traf(i,t))}static moov(e){let t=e.length;const i=[];for(;t--;)i[t]=G.trak(e[t]);return G.box.apply(null,[G.types.moov,G.mvhd(e[0].timescale||0,e[0].duration||0)].concat(i).concat(G.mvex(e)))}static mvex(e){let t=e.length;const i=[];for(;t--;)i[t]=G.trex(e[t]);return G.box.apply(null,[G.types.mvex,...i])}static mvhd(e,t){t*=e;const i=Math.floor(t/(ws+1)),r=Math.floor(t%(ws+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24,i>>16&255,i>>8&255,i&255,r>>24,r>>16&255,r>>8&255,r&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return G.box(G.types.mvhd,a)}static sdtp(e){const t=e.samples||[],i=new Uint8Array(4+t.length);let r,a;for(r=0;r<t.length;r++)a=t[r].flags,i[r+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy;return G.box(G.types.sdtp,i)}static stbl(e){return G.box(G.types.stbl,G.stsd(e),G.box(G.types.stts,G.STTS),G.box(G.types.stsc,G.STSC),G.box(G.types.stsz,G.STSZ),G.box(G.types.stco,G.STCO))}static avc1(e){let t=[],i=[],r,a,c;for(r=0;r<e.sps.length;r++)a=e.sps[r],c=a.byteLength,t.push(c>>>8&255),t.push(c&255),t=t.concat(Array.prototype.slice.call(a));for(r=0;r<e.pps.length;r++)a=e.pps[r],c=a.byteLength,i.push(c>>>8&255),i.push(c&255),i=i.concat(Array.prototype.slice.call(a));const u=G.box(G.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(i))),f=e.width,h=e.height,m=e.pixelRatio[0],p=e.pixelRatio[1];return G.box(G.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,f>>8&255,f&255,h>>8&255,h&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,G.box(G.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),G.box(G.types.pasp,new Uint8Array([m>>24,m>>16&255,m>>8&255,m&255,p>>24,p>>16&255,p>>8&255,p&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return G.box(G.types.mp4a,G.audioStsd(e),G.box(G.types.esds,G.esds(e)))}static mp3(e){return G.box(G.types[".mp3"],G.audioStsd(e))}static ac3(e){return G.box(G.types["ac-3"],G.audioStsd(e),G.box(G.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return G.box(G.types.stsd,G.STSD,G.mp4a(e));if(t==="ac3"&&e.config)return G.box(G.types.stsd,G.STSD,G.ac3(e));if(t==="mp3"&&e.codec==="mp3")return G.box(G.types.stsd,G.STSD,G.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return G.box(G.types.stsd,G.STSD,G.avc1(e));if(t==="hevc"&&e.vps)return G.box(G.types.stsd,G.STSD,G.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,i=(e.duration||0)*(e.timescale||0),r=e.width||0,a=e.height||0,c=Math.floor(i/(ws+1)),u=Math.floor(i%(ws+1));return G.box(G.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,c>>24,c>>16&255,c>>8&255,c&255,u>>24,u>>16&255,u>>8&255,u&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,r&255,0,0,a>>8&255,a&255,0,0]))}static traf(e,t){const i=G.sdtp(e),r=e.id,a=Math.floor(t/(ws+1)),c=Math.floor(t%(ws+1));return G.box(G.types.traf,G.box(G.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255])),G.box(G.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,c>>24,c>>16&255,c>>8&255,c&255])),G.trun(e,i.length+16+20+8+16+8+8),i)}static trak(e){return e.duration=e.duration||4294967295,G.box(G.types.trak,G.tkhd(e),G.mdia(e))}static trex(e){const t=e.id;return G.box(G.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const i=e.samples||[],r=i.length,a=12+16*r,c=new Uint8Array(a);let u,f,h,m,p,y;for(t+=8+a,c.set([e.type==="video"?1:0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,r&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),u=0;u<r;u++)f=i[u],h=f.duration,m=f.size,p=f.flags,y=f.cts,c.set([h>>>24&255,h>>>16&255,h>>>8&255,h&255,m>>>24&255,m>>>16&255,m>>>8&255,m&255,p.isLeading<<2|p.dependsOn,p.isDependedOn<<6|p.hasRedundancy<<4|p.paddingValue<<1|p.isNonSync,p.degradPrio&61440,p.degradPrio&15,y>>>24&255,y>>>16&255,y>>>8&255,y&255],12+16*u);return G.box(G.types.trun,c)}static initSegment(e){G.types||G.init();const t=G.moov(e);return fi(G.FTYP,t)}static hvc1(e){const t=e.params,i=[e.vps,e.sps,e.pps],r=4,a=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),r-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),i.length]);let c=a.length;for(let E=0;E<i.length;E+=1){c+=3;for(let T=0;T<i[E].length;T+=1)c+=2+i[E][T].length}const u=new Uint8Array(c);u.set(a,0),c=a.length;const f=i.length-1;for(let E=0;E<i.length;E+=1){u.set(new Uint8Array([32+E|(E===f?128:0),0,i[E].length]),c),c+=3;for(let T=0;T<i[E].length;T+=1)u.set(new Uint8Array([i[E][T].length>>8,i[E][T].length&255]),c),c+=2,u.set(i[E][T],c),c+=i[E][T].length}const h=G.box(G.types.hvcC,u),m=e.width,p=e.height,y=e.pixelRatio[0],S=e.pixelRatio[1];return G.box(G.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,m>>8&255,m&255,p>>8&255,p&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),h,G.box(G.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),G.box(G.types.pasp,new Uint8Array([y>>24,y>>16&255,y>>8&255,y&255,S>>24,S>>16&255,S>>8&255,S&255])))}}G.types=void 0;G.HDLR_TYPES=void 0;G.STTS=void 0;G.STSC=void 0;G.STCO=void 0;G.STSZ=void 0;G.VMHD=void 0;G.SMHD=void 0;G.STSD=void 0;G.FTYP=void 0;G.DINF=void 0;const Sx=9e4;function vh(l,e,t=1,i=!1){const r=l*e*t;return i?Math.round(r):r}function bR(l,e,t=1,i=!1){return vh(l,e,1/t,i)}function pa(l,e=!1){return vh(l,1e3,1/Sx,e)}function AR(l,e=1){return vh(l,Sx,1/e)}function bp(l){const{baseTime:e,timescale:t,trackId:i}=l;return`${e/t} (${e}/${t}) trackId: ${i}`}const RR=10*1e3,LR=1024,_R=1152,DR=1536;let ir=null,md=null;function Ap(l,e,t,i){return{duration:e,size:t,cts:i,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:l?2:1,isNonSync:l?0:1}}}class po extends mi{constructor(e,t,i,r){if(super("mp4-remuxer",r),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=i,this.ISGenerated=!1,ir===null){const c=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);ir=c?parseInt(c[1]):0}if(md===null){const a=navigator.userAgent.match(/Safari\/(\d+)/i);md=a?parseInt(a[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){const t=this._initPTS;(!t||!e||e.trackId!==t.trackId||e.baseTime!==t.baseTime||e.timescale!==t.timescale)&&this.log(`Reset initPTS: ${t&&bp(t)} > ${e&&bp(e)}`),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const i=e[0].pts,r=e.reduce((a,c)=>{let u=c.pts,f=u-a;return f<-4294967296&&(t=!0,u=Zt(u,i),f=u-a),f>0?a:u},i);return t&&this.debug("PTS rollover detected"),r}remux(e,t,i,r,a,c,u,f){let h,m,p,y,S,E,T=a,b=a;const L=e.pid>-1,_=t.pid>-1,I=t.samples.length,C=e.samples.length>0,N=u&&I>0||I>1;if((!L||C)&&(!_||N)||this.ISGenerated||u){if(this.ISGenerated){var O,j,B,U;const fe=this.videoTrackConfig;(fe&&(t.width!==fe.width||t.height!==fe.height||((O=t.pixelRatio)==null?void 0:O[0])!==((j=fe.pixelRatio)==null?void 0:j[0])||((B=t.pixelRatio)==null?void 0:B[1])!==((U=fe.pixelRatio)==null?void 0:U[1]))||!fe&&N||this.nextAudioTs===null&&C)&&this.resetInitSegment()}this.ISGenerated||(p=this.generateIS(e,t,a,c));const W=this.isVideoContiguous;let re=-1,ue;if(N&&(re=IR(t.samples),!W&&this.config.forceKeyFrameOnDiscontinuity))if(E=!0,re>0){this.warn(`Dropped ${re} out of ${I} video samples due to a missing keyframe`);const fe=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(re),t.dropped+=re,b+=(t.samples[0].pts-fe)/t.inputTimeScale,ue=b}else re===-1&&(this.warn(`No keyframe found out of ${I} video samples`),E=!1);if(this.ISGenerated){if(C&&N){const fe=this.getVideoStartPts(t.samples),M=(Zt(e.samples[0].pts,fe)-fe)/t.inputTimeScale;T+=Math.max(0,M),b+=Math.max(0,-M)}if(C){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),p=this.generateIS(e,t,a,c)),m=this.remuxAudio(e,T,this.isAudioContiguous,c,_||N||f===me.AUDIO?b:void 0),N){const fe=m?m.endPTS-m.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),p=this.generateIS(e,t,a,c)),h=this.remuxVideo(t,b,W,fe)}}else N&&(h=this.remuxVideo(t,b,W,0));h&&(h.firstKeyFrame=re,h.independent=re!==-1,h.firstKeyFramePTS=ue)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(S=Tx(i,a,this._initPTS,this._initDTS)),r.samples.length&&(y=bx(r,a,this._initPTS))),{audio:m,video:h,initSegment:p,independent:E,text:y,id3:S}}computeInitPts(e,t,i,r){const a=Math.round(i*t);let c=Zt(e,a);if(c<a+t)for(this.log(`Adjusting PTS for rollover in timeline near ${(a-c)/t} ${r}`);c<a+t;)c+=8589934592;return c-a}generateIS(e,t,i,r){const a=e.samples,c=t.samples,u=this.typeSupported,f={},h=this._initPTS;let m=!h||r,p="audio/mp4",y,S,E,T=-1;if(m&&(y=S=1/0),e.config&&a.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":u.mpeg?(p="audio/mpeg",e.codec=""):u.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}f.audio={id:"audio",container:p,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&u.mpeg?new Uint8Array(0):G.initSegment([e]),metadata:{channelCount:e.channelCount}},m&&(T=e.id,E=e.inputTimeScale,!h||E!==h.timescale?y=S=this.computeInitPts(a[0].pts,E,i,"audio"):m=!1)}if(t.sps&&t.pps&&c.length){if(t.timescale=t.inputTimeScale,f.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:G.initSegment([t]),metadata:{width:t.width,height:t.height}},m)if(T=t.id,E=t.inputTimeScale,!h||E!==h.timescale){const b=this.getVideoStartPts(c),L=Zt(c[0].dts,b),_=this.computeInitPts(L,E,i,"video"),I=this.computeInitPts(b,E,i,"video");S=Math.min(S,_),y=Math.min(y,I)}else m=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(f).length)return this.ISGenerated=!0,m?(h&&this.warn(`Timestamps at playlist time: ${r?"":"~"}${i} ${y/E} != initPTS: ${h.baseTime/h.timescale} (${h.baseTime}/${h.timescale}) trackId: ${h.trackId}`),this.log(`Found initPTS at playlist time: ${i} offset: ${y/E} (${y}/${E}) trackId: ${T}`),this._initPTS={baseTime:y,timescale:E,trackId:T},this._initDTS={baseTime:S,timescale:E,trackId:T}):y=E=void 0,{tracks:f,initPTS:y,timescale:E,trackId:T}}remuxVideo(e,t,i,r){const a=e.inputTimeScale,c=e.samples,u=[],f=c.length,h=this._initPTS,m=h.baseTime*a/h.timescale;let p=this.nextVideoTs,y=8,S=this.videoSampleDuration,E,T,b=Number.POSITIVE_INFINITY,L=Number.NEGATIVE_INFINITY,_=!1;if(!i||p===null){const F=m+t*a,q=c[0].pts-Zt(c[0].dts,c[0].pts);ir&&p!==null&&Math.abs(F-q-(p+m))<15e3?i=!0:p=F-q-m}const I=p+m;for(let F=0;F<f;F++){const q=c[F];q.pts=Zt(q.pts,I),q.dts=Zt(q.dts,I),q.dts<c[F>0?F-1:F].dts&&(_=!0)}_&&c.sort(function(F,q){const se=F.dts-q.dts,oe=F.pts-q.pts;return se||oe}),E=c[0].dts,T=c[c.length-1].dts;const C=T-E,N=C?Math.round(C/(f-1)):S||e.inputTimeScale/30;if(i){const F=E-I,q=F>N,se=F<-1;if((q||se)&&(q?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${pa(F,!0)} ms (${F}dts) hole between fragments detected at ${t.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${pa(-F,!0)} ms (${F}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!se||I>=c[0].pts||ir)){E=I;const oe=c[0].pts-F;if(q)c[0].dts=E,c[0].pts=oe;else{let he=!0;for(let ce=0;ce<c.length&&!(c[ce].dts>oe&&he);ce++){const Ue=c[ce].pts;if(c[ce].dts-=F,c[ce].pts-=F,ce<c.length-1){const Ae=c[ce+1].pts,rt=c[ce].pts,kt=Ae<=rt,ii=Ae<=Ue;he=kt==ii}}}this.log(`Video: Initial PTS/DTS adjusted: ${pa(oe,!0)}/${pa(E,!0)}, delta: ${pa(F,!0)} ms`)}}E=Math.max(0,E);let K=0,O=0,j=E;for(let F=0;F<f;F++){const q=c[F],se=q.units,oe=se.length;let he=0;for(let ce=0;ce<oe;ce++)he+=se[ce].data.length;O+=he,K+=oe,q.length=he,q.dts<j?(q.dts=j,j+=N/4|0||1):j=q.dts,b=Math.min(q.pts,b),L=Math.max(q.pts,L)}T=c[f-1].dts;const B=O+4*K+8;let U;try{U=new Uint8Array(B)}catch(F){this.observer.emit(A.ERROR,A.ERROR,{type:pe.MUX_ERROR,details:H.REMUX_ALLOC_ERROR,fatal:!1,error:F,bytes:B,reason:`fail allocating video mdat ${B}`});return}const W=new DataView(U.buffer);W.setUint32(0,B),U.set(G.types.mdat,4);let re=!1,ue=Number.POSITIVE_INFINITY,fe=Number.POSITIVE_INFINITY,le=Number.NEGATIVE_INFINITY,M=Number.NEGATIVE_INFINITY;for(let F=0;F<f;F++){const q=c[F],se=q.units;let oe=0;for(let Ue=0,Ae=se.length;Ue<Ae;Ue++){const rt=se[Ue],kt=rt.data,ii=rt.data.byteLength;W.setUint32(y,ii),y+=4,U.set(kt,y),y+=ii,oe+=4+ii}let he;if(F<f-1)S=c[F+1].dts-q.dts,he=c[F+1].pts-q.pts;else{const Ue=this.config,Ae=F>0?q.dts-c[F-1].dts:N;if(he=F>0?q.pts-c[F-1].pts:N,Ue.stretchShortVideoTrack&&this.nextAudioTs!==null){const rt=Math.floor(Ue.maxBufferHole*a),kt=(r?b+r*a:this.nextAudioTs+m)-q.pts;kt>rt?(S=kt-Ae,S<0?S=Ae:re=!0,this.log(`It is approximately ${kt/90} ms to the next segment; using duration ${S/90} ms for the last video frame.`)):S=Ae}else S=Ae}const ce=Math.round(q.pts-q.dts);ue=Math.min(ue,S),le=Math.max(le,S),fe=Math.min(fe,he),M=Math.max(M,he),u.push(Ap(q.key,S,oe,ce))}if(u.length){if(ir){if(ir<70){const F=u[0].flags;F.dependsOn=2,F.isNonSync=0}}else if(md&&M-fe<le-ue&&N/le<.025&&u[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let F=E;for(let q=0,se=u.length;q<se;q++){const oe=F+u[q].duration,he=F+u[q].cts;if(q<se-1){const ce=oe+u[q+1].cts;u[q].duration=ce-he}else u[q].duration=q?u[q-1].duration:N;u[q].cts=0,F=oe}}}S=re||!S?N:S;const Q=T+S;this.nextVideoTs=p=Q-m,this.videoSampleDuration=S,this.isVideoContiguous=!0;const w={data1:G.moof(e.sequenceNumber++,E,Ke(e,{samples:u})),data2:U,startPTS:(b-m)/a,endPTS:(L+S-m)/a,startDTS:(E-m)/a,endDTS:p/a,type:"video",hasAudio:!1,hasVideo:!0,nb:u.length,dropped:e.dropped};return e.samples=[],e.dropped=0,w}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return _R;case"ac3":return DR;default:return LR}}remuxAudio(e,t,i,r,a){const c=e.inputTimeScale,u=e.samplerate?e.samplerate:c,f=c/u,h=this.getSamplesPerFrame(e),m=h*f,p=this._initPTS,y=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,S=[],E=a!==void 0;let T=e.samples,b=y?0:8,L=this.nextAudioTs||-1;const _=p.baseTime*c/p.timescale,I=_+t*c;if(this.isAudioContiguous=i=i||T.length&&L>0&&(r&&Math.abs(I-(L+_))<9e3||Math.abs(Zt(T[0].pts,I)-(L+_))<20*m),T.forEach(function(M){M.pts=Zt(M.pts,I)}),!i||L<0){const M=T.length;if(T=T.filter(Q=>Q.pts>=0),M!==T.length&&this.warn(`Removed ${T.length-M} of ${M} samples (initPTS ${_} / ${c})`),!T.length)return;a===0?L=0:r&&!E?L=Math.max(0,I-_):L=T[0].pts-_}if(e.segmentCodec==="aac"){const M=this.config.maxAudioFramesDrift;for(let Q=0,Z=L+_;Q<T.length;Q++){const ae=T[Q],w=ae.pts,F=w-Z,q=Math.abs(1e3*F/c);if(F<=-M*m&&E)Q===0&&(this.warn(`Audio frame @ ${(w/c).toFixed(3)}s overlaps marker by ${Math.round(1e3*F/c)} ms.`),this.nextAudioTs=L=w-_,Z=w);else if(F>=M*m&&q<RR&&E){let se=Math.round(F/m);for(Z=w-se*m;Z<0&&se&&m;)se--,Z+=m;Q===0&&(this.nextAudioTs=L=Z-_),this.warn(`Injecting ${se} audio frames @ ${((Z-_)/c).toFixed(3)}s due to ${Math.round(1e3*F/c)} ms gap.`);for(let oe=0;oe<se;oe++){let he=TR.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);he||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),he=ae.unit.subarray()),T.splice(Q,0,{unit:he,pts:Z}),Z+=m,Q++}}ae.pts=Z,Z+=m}}let C=null,N=null,K,O=0,j=T.length;for(;j--;)O+=T[j].unit.byteLength;for(let M=0,Q=T.length;M<Q;M++){const Z=T[M],ae=Z.unit;let w=Z.pts;if(N!==null){const q=S[M-1];q.duration=Math.round((w-N)/f)}else if(i&&e.segmentCodec==="aac"&&(w=L+_),C=w,O>0){O+=b;try{K=new Uint8Array(O)}catch(q){this.observer.emit(A.ERROR,A.ERROR,{type:pe.MUX_ERROR,details:H.REMUX_ALLOC_ERROR,fatal:!1,error:q,bytes:O,reason:`fail allocating audio mdat ${O}`});return}y||(new DataView(K.buffer).setUint32(0,O),K.set(G.types.mdat,4))}else return;K.set(ae,b);const F=ae.byteLength;b+=F,S.push(Ap(!0,h,F,0)),N=w}const B=S.length;if(!B)return;const U=S[S.length-1];L=N-_,this.nextAudioTs=L+f*U.duration;const W=y?new Uint8Array(0):G.moof(e.sequenceNumber++,C/f,Ke({},e,{samples:S}));e.samples=[];const re=(C-_)/c,ue=L/c,le={data1:W,data2:K,startPTS:re,endPTS:ue,startDTS:re,endDTS:ue,type:"audio",hasAudio:!0,hasVideo:!1,nb:B};return this.isAudioContiguous=!0,le}}function Zt(l,e){let t;if(e===null)return l;for(e<l?t=-8589934592:t=8589934592;Math.abs(l-e)>4294967296;)l+=t;return l}function IR(l){for(let e=0;e<l.length;e++)if(l[e].key)return e;return-1}function Tx(l,e,t,i){const r=l.samples.length;if(!r)return;const a=l.inputTimeScale;for(let u=0;u<r;u++){const f=l.samples[u];f.pts=Zt(f.pts-t.baseTime*a/t.timescale,e*a)/a,f.dts=Zt(f.dts-i.baseTime*a/i.timescale,e*a)/a}const c=l.samples;return l.samples=[],{samples:c}}function bx(l,e,t){const i=l.samples.length;if(!i)return;const r=l.inputTimeScale;for(let c=0;c<i;c++){const u=l.samples[c];u.pts=Zt(u.pts-t.baseTime*r/t.timescale,e*r)/r}l.samples.sort((c,u)=>c.pts-u.pts);const a=l.samples;return l.samples=[],{samples:a}}class CR extends mi{constructor(e,t,i,r){super("passthrough-remuxer",r),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,i,r){this.audioCodec=t,this.videoCodec=i,this.generateInitSegment(e,r),this.emitInitSegment=!0}generateInitSegment(e,t){let{audioCodec:i,videoCodec:r}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:a,video:c}=this.initData=Iy(e);if(t)yA(e,t);else{const f=a||c;f!=null&&f.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${f.codec}")!`)}a&&(i=Rp(a,qe.AUDIO,this)),c&&(r=Rp(c,qe.VIDEO,this));const u={};a&&c?u.audiovideo={container:"video/mp4",codec:i+","+r,supplemental:c.supplemental,encrypted:c.encrypted,initSegment:e,id:"main"}:a?u.audio={container:"audio/mp4",codec:i,encrypted:a.encrypted,initSegment:e,id:"audio"}:c?u.video={container:"video/mp4",codec:r,supplemental:c.supplemental,encrypted:c.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=u}remux(e,t,i,r,a,c){var u,f;let{initPTS:h,lastEndTime:m}=this;const p={audio:void 0,video:void 0,text:r,id3:i,initSegment:void 0};de(m)||(m=this.lastEndTime=a||0);const y=t.samples;if(!y.length)return p;const S={initPTS:void 0,timescale:void 0,trackId:void 0};let E=this.initData;if((u=E)!=null&&u.length||(this.generateInitSegment(y),E=this.initData),!((f=E)!=null&&f.length))return this.warn("Failed to generate initSegment."),p;this.emitInitSegment&&(S.tracks=this.initTracks,this.emitInitSegment=!1);const T=vA(y,E,this),b=E.audio?T[E.audio.id]:null,L=E.video?T[E.video.id]:null,_=to(L,1/0),I=to(b,1/0),C=to(L,0,!0),N=to(b,0,!0);let K=a,O=0;const j=b&&(!L||!h&&I<_||h&&h.trackId===E.audio.id),B=j?b:L;if(B){const Z=B.timescale,ae=B.start-a*Z,w=j?E.audio.id:E.video.id;K=B.start/Z,O=j?N-I:C-_,(c||!h)&&(wR(h,K,a,O)||Z!==h.timescale)&&(h&&this.warn(`Timestamps at playlist time: ${c?"":"~"}${a} ${ae/Z} != initPTS: ${h.baseTime/h.timescale} (${h.baseTime}/${h.timescale}) trackId: ${h.trackId}`),this.log(`Found initPTS at playlist time: ${a} offset: ${K-a} (${ae}/${Z}) trackId: ${w}`),h=null,S.initPTS=ae,S.timescale=Z,S.trackId=w)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${a}`);h?(S.initPTS=h.baseTime,S.timescale=h.timescale,S.trackId=h.trackId):((!S.timescale||S.trackId===void 0||S.initPTS===void 0)&&(this.warn("Could not set initPTS"),S.initPTS=K,S.timescale=1,S.trackId=-1),this.initPTS=h={baseTime:S.initPTS,timescale:S.timescale,trackId:S.trackId});const U=K-h.baseTime/h.timescale,W=U+O;O>0?this.lastEndTime=W:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const re=!!E.audio,ue=!!E.video;let fe="";re&&(fe+="audio"),ue&&(fe+="video");const le=(E.audio?E.audio.encrypted:!1)||(E.video?E.video.encrypted:!1),M={data1:y,startPTS:U,startDTS:U,endPTS:W,endDTS:W,type:fe,hasAudio:re,hasVideo:ue,nb:1,dropped:0,encrypted:le};p.audio=re&&!ue?M:void 0,p.video=ue?M:void 0;const Q=L==null?void 0:L.sampleCount;if(Q){const Z=L.keyFrameIndex,ae=Z!==-1;M.nb=Q,M.dropped=Z===0||this.isVideoContiguous?0:ae?Z:Q,M.independent=ae,M.firstKeyFrame=Z,ae&&L.keyFrameStart&&(M.firstKeyFramePTS=(L.keyFrameStart-h.baseTime)/h.timescale),this.isVideoContiguous||(p.independent=ae),this.isVideoContiguous||(this.isVideoContiguous=ae),M.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${Z}/${Q} dropped: ${M.dropped} start: ${M.firstKeyFramePTS||"NA"}`)}return p.initSegment=S,p.id3=Tx(i,a,h,h),r.samples.length&&(p.text=bx(r,a,h)),p}}function to(l,e,t=!1){return(l==null?void 0:l.start)!==void 0?(l.start+(t?l.duration:0))/l.timescale:e}function wR(l,e,t,i){if(l===null)return!0;const r=Math.max(i,1),a=e-l.baseTime/l.timescale;return Math.abs(a-t)>r}function Rp(l,e,t){const i=l.codec;return i&&i.length>4?i:e===qe.AUDIO?i==="ec-3"||i==="ac-3"||i==="alac"?i:i==="fLaC"||i==="Opus"?bo(i,!1):(t.warn(`Unhandled audio codec "${i}" in mp4 MAP`),i||"mp4a"):(t.warn(`Unhandled video codec "${i}" in mp4 MAP`),i||"avc1")}let ns;try{ns=self.performance.now.bind(self.performance)}catch{ns=Date.now}const yo=[{demux:pR,remux:CR},{demux:Os,remux:po},{demux:hR,remux:po},{demux:mR,remux:po}];yo.splice(2,0,{demux:fR,remux:po});class Lp{constructor(e,t,i,r,a,c){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=i,this.id=a,this.logger=c}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,i,r){const a=i.transmuxing;a.executeStart=ns();let c=new Uint8Array(e);const{currentTransmuxState:u,transmuxConfig:f}=this;r&&(this.currentTransmuxState=r);const{contiguous:h,discontinuity:m,trackSwitch:p,accurateTimeOffset:y,timeOffset:S,initSegmentChange:E}=r||u,{audioCodec:T,videoCodec:b,defaultInitPts:L,duration:_,initSegmentData:I}=f,C=NR(c,t);if(C&&ar(C.method)){const j=this.getDecrypter(),B=uh(C.method);if(j.isSync()){let U=j.softwareDecrypt(c,C.key.buffer,C.iv.buffer,B);if(i.part>-1){const re=j.flush();U=re&&re.buffer}if(!U)return a.executeEnd=ns(),gd(i);c=new Uint8Array(U)}else return this.asyncResult=!0,this.decryptionPromise=j.webCryptoDecrypt(c,C.key.buffer,C.iv.buffer,B).then(U=>{const W=this.push(U,null,i);return this.decryptionPromise=null,W}),this.decryptionPromise}const N=this.needsProbing(m,p);if(N){const j=this.configureTransmuxer(c);if(j)return this.logger.warn(`[transmuxer] ${j.message}`),this.observer.emit(A.ERROR,A.ERROR,{type:pe.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,error:j,reason:j.message}),a.executeEnd=ns(),gd(i)}(m||p||E||N)&&this.resetInitSegment(I,T,b,_,t),(m||E||N)&&this.resetInitialTimestamp(L),h||this.resetContiguity();const K=this.transmux(c,C,S,y,i);this.asyncResult=_a(K);const O=this.currentTransmuxState;return O.contiguous=!0,O.discontinuity=!1,O.trackSwitch=!1,a.executeEnd=ns(),K}flush(e){const t=e.transmuxing;t.executeStart=ns();const{decrypter:i,currentTransmuxState:r,decryptionPromise:a}=this;if(a)return this.asyncResult=!0,a.then(()=>this.flush(e));const c=[],{timeOffset:u}=r;if(i){const p=i.flush();p&&c.push(this.push(p.buffer,null,e))}const{demuxer:f,remuxer:h}=this;if(!f||!h){t.executeEnd=ns();const p=[gd(e)];return this.asyncResult?Promise.resolve(p):p}const m=f.flush(u);return _a(m)?(this.asyncResult=!0,m.then(p=>(this.flushRemux(c,p,e),c))):(this.flushRemux(c,m,e),this.asyncResult?Promise.resolve(c):c)}flushRemux(e,t,i){const{audioTrack:r,videoTrack:a,id3Track:c,textTrack:u}=t,{accurateTimeOffset:f,timeOffset:h}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${i.sn}${i.part>-1?" part: "+i.part:""} of ${this.id===me.MAIN?"level":"track"} ${i.level}`);const m=this.remuxer.remux(r,a,c,u,h,f,!0,this.id);e.push({remuxResult:m,chunkMeta:i}),i.transmuxing.executeEnd=ns()}resetInitialTimestamp(e){const{demuxer:t,remuxer:i}=this;!t||!i||(t.resetTimeStamp(e),i.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,i,r,a){const{demuxer:c,remuxer:u}=this;!c||!u||(c.resetInitSegment(e,t,i,r),u.resetInitSegment(e,t,i,a))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,i,r,a){let c;return t&&t.method==="SAMPLE-AES"?c=this.transmuxSampleAes(e,t,i,r,a):c=this.transmuxUnencrypted(e,i,r,a),c}transmuxUnencrypted(e,t,i,r){const{audioTrack:a,videoTrack:c,id3Track:u,textTrack:f}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(a,c,u,f,t,i,!1,this.id),chunkMeta:r}}transmuxSampleAes(e,t,i,r,a){return this.demuxer.demuxSampleAes(e,t,i).then(c=>({remuxResult:this.remuxer.remux(c.audioTrack,c.videoTrack,c.id3Track,c.textTrack,i,r,!1,this.id),chunkMeta:a}))}configureTransmuxer(e){const{config:t,observer:i,typeSupported:r}=this;let a;for(let p=0,y=yo.length;p<y;p++){var c;if((c=yo[p].demux)!=null&&c.probe(e,this.logger)){a=yo[p];break}}if(!a)return new Error("Failed to find demuxer by probing fragment data");const u=this.demuxer,f=this.remuxer,h=a.remux,m=a.demux;(!f||!(f instanceof h))&&(this.remuxer=new h(i,t,r,this.logger)),(!u||!(u instanceof m))&&(this.demuxer=new m(i,t,r,this.logger),this.probe=m.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new oh(this.config)),e}}function NR(l,e){let t=null;return l.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const gd=l=>({remuxResult:{},chunkMeta:l});function _a(l){return"then"in l&&l.then instanceof Function}class kR{constructor(e,t,i,r,a){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=i,this.duration=r,this.defaultInitPts=a||null}}class OR{constructor(e,t,i,r,a,c){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=i,this.trackSwitch=r,this.timeOffset=a,this.initSegmentChange=c}}let _p=0;class Ax{constructor(e,t,i,r){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=_p++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=f=>{const h=f.data,m=this.hls;if(!(!m||!(h!=null&&h.event)||h.instanceNo!==this.instanceNo))switch(h.event){case"init":{var p;const y=(p=this.workerContext)==null?void 0:p.objectURL;y&&self.URL.revokeObjectURL(y);break}case"transmuxComplete":{this.handleTransmuxComplete(h.data);break}case"flush":{this.onFlush(h.data);break}case"workerLog":{m.logger[h.data.logType]&&m.logger[h.data.logType](h.data.message);break}default:{h.data=h.data||{},h.data.frag=this.frag,h.data.part=this.part,h.data.id=this.id,m.trigger(h.event,h.data);break}}},this.onWorkerError=f=>{if(!this.hls)return;const h=new Error(`${f.message}  (${f.filename}:${f.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(A.ERROR,{type:pe.OTHER_ERROR,details:H.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:h})};const a=e.config;this.hls=e,this.id=t,this.useWorker=!!a.enableWorker,this.onTransmuxComplete=i,this.onFlush=r;const c=(f,h)=>{h=h||{},h.frag=this.frag||void 0,f===A.ERROR&&(h=h,h.parent=this.id,h.part=this.part,this.error=h.error),this.hls.trigger(f,h)};this.observer=new fh,this.observer.on(A.FRAG_DECRYPTED,c),this.observer.on(A.ERROR,c);const u=G0(a.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const f=this.hls.logger;if(a.workerPath||B1()){try{a.workerPath?(f.log(`loading Web Worker ${a.workerPath} for "${t}"`),this.workerContext=j1(a.workerPath)):(f.log(`injecting Web Worker for "${t}"`),this.workerContext=F1());const{worker:m}=this.workerContext;m.addEventListener("message",this.onWorkerMessage),m.addEventListener("error",this.onWorkerError),m.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:u,id:t,config:Xe(a)})}catch(m){f.warn(`Error setting up "${t}" Web Worker, fallback to inline`,m),this.terminateWorker(),this.error=null,this.transmuxer=new Lp(this.observer,u,a,"",t,e.logger)}return}}this.transmuxer=new Lp(this.observer,u,a,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=_p++;const t=this.hls.config,i=G0(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:i,id:this.id,config:Xe(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),$1(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,i,r,a,c,u,f,h,m){var p,y;h.transmuxing.start=self.performance.now();const{instanceNo:S,transmuxer:E}=this,T=c?c.start:a.start,b=a.decryptdata,L=this.frag,_=!(L&&a.cc===L.cc),I=!(L&&h.level===L.level),C=L?h.sn-L.sn:-1,N=this.part?h.part-this.part.index:-1,K=C===0&&h.id>1&&h.id===(L==null?void 0:L.stats.chunkCount),O=!I&&(C===1||C===0&&(N===1||K&&N<=0)),j=self.performance.now();(I||C||a.stats.parsing.start===0)&&(a.stats.parsing.start=j),c&&(N||!O)&&(c.stats.parsing.start=j);const B=!(L&&((p=a.initSegment)==null?void 0:p.url)===((y=L.initSegment)==null?void 0:y.url)),U=new OR(_,O,f,I,T,B);if(!O||_||B){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${a.type} sn: ${h.sn}${h.part>-1?" part: "+h.part:""} ${this.id===me.MAIN?"level":"track"}: ${h.level} id: ${h.id}
        discontinuity: ${_}
        trackSwitch: ${I}
        contiguous: ${O}
        accurateTimeOffset: ${f}
        timeOffset: ${T}
        initSegmentChange: ${B}`);const W=new kR(i,r,t,u,m);this.configureTransmuxer(W)}if(this.frag=a,this.part=c,this.workerContext)this.workerContext.worker.postMessage({instanceNo:S,cmd:"demux",data:e,decryptdata:b,chunkMeta:h,state:U},e instanceof ArrayBuffer?[e]:[]);else if(E){const W=E.push(e,b,h,U);_a(W)?W.then(re=>{this.handleTransmuxComplete(re)}).catch(re=>{this.transmuxerError(re,h,"transmuxer-interface push error")}):this.handleTransmuxComplete(W)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:i}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(i){const r=i.flush(e);_a(r)?r.then(a=>{this.handleFlushResult(a,e)}).catch(a=>{this.transmuxerError(a,e,"transmuxer-interface flush error")}):this.handleFlushResult(r,e)}}transmuxerError(e,t,i){this.hls&&(this.error=e,this.hls.trigger(A.ERROR,{type:pe.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:i}))}handleFlushResult(e,t){e.forEach(i=>{this.handleTransmuxComplete(i)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:i}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):i&&i.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const Dp=100;class MR extends hh{constructor(e,t,i){super(e,t,i,"audio-stream-controller",me.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(A.LEVEL_LOADED,this.onLevelLoaded,this),e.on(A.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(A.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(A.BUFFER_RESET,this.onBufferReset,this),e.on(A.BUFFER_CREATED,this.onBufferCreated,this),e.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(A.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(A.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(A.FRAG_LOADING,this.onFragLoading,this),e.on(A.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(A.LEVEL_LOADED,this.onLevelLoaded,this),e.off(A.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(A.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(A.BUFFER_RESET,this.onBufferReset,this),e.off(A.BUFFER_CREATED,this.onBufferCreated,this),e.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(A.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(A.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(A.FRAG_LOADING,this.onFragLoading,this),e.off(A.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:i,initPTS:r,timescale:a,trackId:c}){if(i===me.MAIN){const u=t.cc,f=this.fragCurrent;if(this.initPTS[u]={baseTime:r,timescale:a,trackId:c},this.log(`InitPTS for cc: ${u} found from main: ${r/a} (${r}/${a}) trackId: ${c}`),this.mainAnchor=t,this.state===ee.WAITING_INIT_PTS){const h=this.waitingData;(!h&&!this.loadingParts||h&&h.frag.cc!==u)&&this.syncWithAnchor(t,h==null?void 0:h.frag)}else!this.hls.hasEnoughToStart&&f&&f.cc!==u?(f.abortRequests(),this.syncWithAnchor(t,f)):this.state===ee.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var i;const r=((i=this.mainFragLoading)==null?void 0:i.frag)||null;if(t&&(r==null?void 0:r.cc)===t.cc)return;const a=(r||e).cc,c=this.getLevelDetails(),u=this.getLoadPosition(),f=jy(c,a,u);f&&(this.log(`Syncing with main frag at ${f.start} cc ${f.cc}`),this.startFragRequested=!1,this.nextLoadPosition=f.start,this.resetLoadingState(),this.state===ee.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=ee.STOPPED;return}const i=this.lastCurrentTime;this.stopLoad(),this.setInterval(Dp),i>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),e=i,this.state=ee.IDLE):this.state=ee.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case ee.IDLE:this.doTickIdle();break;case ee.WAITING_TRACK:{const{levels:e,trackId:t}=this,i=e==null?void 0:e[t],r=i==null?void 0:i.details;if(r&&!this.waitForLive(i)){if(this.waitForCdnTuneIn(r))break;this.state=ee.WAITING_INIT_PTS}break}case ee.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case ee.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:t,part:i,cache:r,complete:a}=e,c=this.mainAnchor;if(this.initPTS[t.cc]!==void 0){this.waitingData=null,this.state=ee.FRAG_LOADING;const u=r.flush().buffer,f={frag:t,part:i,payload:u,networkDetails:null};this._handleFragmentLoadProgress(f),a&&super._handleFragmentLoadComplete(f)}else c&&c.cc!==e.frag.cc&&this.syncWithAnchor(c,e.frag)}else this.state=ee.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:i,media:r,trackId:a}=this,c=t.config;if(!this.buffering||!r&&!this.primaryPrefetch&&(this.startFragRequested||!c.startFragPrefetch)||!(i!=null&&i[a]))return;const u=i[a],f=u.details;if(!f||this.waitForLive(u)||this.waitForCdnTuneIn(f)){this.state=ee.WAITING_TRACK,this.startFragRequested=!1;return}const h=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&h&&(this.bufferFlushed=!1,this.afterBufferFlushed(h,qe.AUDIO,me.AUDIO));const m=this.getFwdBufferInfo(h,me.AUDIO);if(m===null)return;if(!this.switchingTrack&&this._streamEnded(m,f)){t.trigger(A.BUFFER_EOS,{type:"audio"}),this.state=ee.ENDED;return}const p=m.len,y=t.maxBufferLength,S=f.fragments,E=S[0].start,T=this.getLoadPosition(),b=this.flushing?T:m.end;if(this.switchingTrack&&r){const I=T;f.PTSKnown&&I<E&&(m.end>E||m.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=E+.05)}if(p>=y&&!this.switchingTrack&&b<S[S.length-1].start)return;let L=this.getNextFragment(b,f);if(L&&this.isLoopLoading(L,b)&&(L=this.getNextFragmentLoopLoading(L,f,m,me.MAIN,y)),!L){this.bufferFlushed=!0;return}let _=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&_&&ut(L)&&!L.endList&&(!f.live||!this.loadingParts&&b<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(_)===mt.OK&&(this.mainFragLoading=_=null),_&&ut(_))){if(L.start>_.end){const C=this.fragmentTracker.getFragAtPos(b,me.MAIN);C&&C.end>_.end&&(_=C,this.mainFragLoading={frag:C,targetBufferTime:null})}if(L.start>_.end)return}this.loadFragment(L,u,b)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(i=>new Aa(i))}onAudioTrackSwitching(e,t){const i=!!t.url;this.trackId=t.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),i?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==ee.STOPPED&&(this.setInterval(Dp),this.state=ee.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const i=this.cachedTrackLoadedData;i&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(A.AUDIO_TRACK_LOADED,i))}onAudioTrackLoaded(e,t){var i;const{levels:r}=this,{details:a,id:c,groupId:u,track:f}=t;if(!r){this.warn(`Audio tracks reset while loading track ${c} "${f.name}" of "${u}"`);return}const h=this.mainDetails;if(!h||a.endCC>h.endCC||h.expired){this.cachedTrackLoadedData=t,this.state!==ee.STOPPED&&(this.state=ee.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${c} "${f.name}" of "${u}" loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`);const m=r[c];let p=0;if(a.live||(i=m.details)!=null&&i.live){if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;if(m.details){var y;p=this.alignPlaylists(a,m.details,(y=this.levelLastLoaded)==null?void 0:y.details)}a.alignedSliding||(nx(a,h),a.alignedSliding||Co(a,h),p=a.fragmentStart)}m.details=a,this.levelLastLoaded=m,this.startFragRequested||this.setStartPosition(h,p),this.hls.trigger(A.AUDIO_TRACK_UPDATED,{details:a,id:c,groupId:t.groupId}),this.state===ee.WAITING_TRACK&&!this.waitForCdnTuneIn(a)&&(this.state=ee.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const i=e.frag,{part:r,payload:a}=e,{config:c,trackId:u,levels:f}=this;if(!f){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const h=f[u];if(!h){this.warn("Audio track is undefined on fragment load progress");return}const m=h.details;if(!m){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(i.start);return}const p=c.defaultAudioCodec||h.audioCodec||"mp4a.40.2";let y=this.transmuxer;y||(y=this.transmuxer=new Ax(this.hls,me.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const S=this.initPTS[i.cc],E=(t=i.initSegment)==null?void 0:t.data;if(S!==void 0){const b=r?r.index:-1,L=b!==-1,_=new ch(i.level,i.sn,i.stats.chunkCount,a.byteLength,b,L);y.push(a,E,p,"",i,r,m.totalduration,!1,_,S)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${m.startSN} ,${m.endSN}],track ${u}`);const{cache:T}=this.waitingData=this.waitingData||{frag:i,part:r,cache:new rx,complete:!1};T.push(new Uint8Array(a)),this.state!==ee.STOPPED&&(this.state=ee.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const i=t.tracks.audio;i&&(this.mediaBuffer=i.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===me.MAIN&&ut(t.frag)&&(this.mainFragLoading=t,this.state===ee.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:i,part:r}=t;if(i.type!==me.AUDIO){!this.audioOnly&&i.type===me.MAIN&&!i.elementaryStreams.video&&!i.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${r?" p: "+r.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(ut(i)){this.fragPrevious=i;const a=this.switchingTrack;a&&(this.bufferedTrack=a,this.switchingTrack=null,this.hls.trigger(A.AUDIO_TRACK_SWITCHED,je({},a)))}this.fragBufferedComplete(i,r),this.media&&this.tick()}onError(e,t){var i;if(t.fatal){this.state=ee.ERROR;return}switch(t.details){case H.FRAG_GAP:case H.FRAG_PARSING_ERROR:case H.FRAG_DECRYPT_ERROR:case H.FRAG_LOAD_ERROR:case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_ERROR:case H.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(me.AUDIO,t);break;case H.AUDIO_TRACK_LOAD_ERROR:case H.AUDIO_TRACK_LOAD_TIMEOUT:case H.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ee.WAITING_TRACK&&((i=t.context)==null?void 0:i.type)===Ie.AUDIO_TRACK&&(this.state=ee.IDLE);break;case H.BUFFER_ADD_CODEC_ERROR:case H.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case H.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case H.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==qe.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==qe.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===ee.ENDED&&(this.state=ee.IDLE);const i=this.mediaBuffer||this.media;i&&(this.afterBufferFlushed(i,t,me.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const i="audio",{hls:r}=this,{remuxResult:a,chunkMeta:c}=e,u=this.getCurrentContext(c);if(!u){this.resetWhenMissingContext(c);return}const{frag:f,part:h,level:m}=u,{details:p}=m,{audio:y,text:S,id3:E,initSegment:T}=a;if(this.fragContextChanged(f)||!p){this.fragmentTracker.removeFragment(f);return}if(this.state=ee.PARSING,this.switchingTrack&&y&&this.completeAudioSwitch(this.switchingTrack),T!=null&&T.tracks){const b=f.initSegment||f;if(this.unhandledEncryptionError(T,f))return;this._bufferInitSegment(m,T.tracks,b,c),r.trigger(A.FRAG_PARSING_INIT_SEGMENT,{frag:b,id:i,tracks:T.tracks})}if(y){const{startPTS:b,endPTS:L,startDTS:_,endDTS:I}=y;h&&(h.elementaryStreams[qe.AUDIO]={startPTS:b,endPTS:L,startDTS:_,endDTS:I}),f.setElementaryStreamInfo(qe.AUDIO,b,L,_,I),this.bufferFragmentData(y,f,h,c)}if(E!=null&&(t=E.samples)!=null&&t.length){const b=Ke({id:i,frag:f,details:p},E);r.trigger(A.FRAG_PARSING_METADATA,b)}if(S){const b=Ke({id:i,frag:f,details:p},S);r.trigger(A.FRAG_PARSING_USERDATA,b)}}_bufferInitSegment(e,t,i,r){if(this.state!==ee.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const a=t.audio;a.id=me.AUDIO;const c=e.audioCodec;this.log(`Init audio buffer, container:${a.container}, codecs[level/parsed]=[${c}/${a.codec}]`),c&&c.split(",").length===1&&(a.levelCodec=c),this.hls.trigger(A.BUFFER_CODECS,t);const u=a.initSegment;if(u!=null&&u.byteLength){const f={type:"audio",frag:i,part:null,chunkMeta:r,parent:i.type,data:u};this.hls.trigger(A.BUFFER_APPENDING,f)}this.tickImmediate()}loadFragment(e,t,i){const r=this.fragmentTracker.getState(e);if(this.switchingTrack||r===mt.NOT_LOADED||r===mt.PARTIAL){var a;if(!ut(e))this._loadInitSegment(e,t);else if((a=t.details)!=null&&a.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=ee.WAITING_INIT_PTS;const c=this.mainDetails;c&&c.fragmentStart!==t.details.fragmentStart&&Co(t.details,c)}else super.loadFragment(e,t,i)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:i,assocLang:r,characteristics:a,audioCodec:c,channels:u}=this.bufferedTrack;un({name:t,lang:i,assocLang:r,characteristics:a,audioCodec:c,channels:u},e,cn)||(Ro(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(A.AUDIO_TRACK_SWITCHED,je({},e))}}class Eh extends mi{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,i){const r=t==null?void 0:t.renditionReports;if(r){let a=-1;for(let c=0;c<r.length;c++){const u=r[c];let f;try{f=new self.URL(u.URI,t.url).href}catch(h){this.warn(`Could not construct new URL for Rendition Report: ${h}`),f=u.URI||""}if(f===e){a=c;break}else f===e.substring(0,f.length)&&(a=c)}if(a!==-1){const c=r[a],u=parseInt(c["LAST-MSN"])||t.lastPartSn;let f=parseInt(c["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){const m=Math.min(t.age-t.partTarget,t.targetduration);f>=0&&m>t.partTarget&&(f+=1)}const h=i&&H0(i);return new V0(u,f>=0?f:void 0,h)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(i){this.warn(`Could not construct new URL with HLS Delivery Directives: ${i}`)}return e}playlistLoaded(e,t,i){const{details:r,stats:a}=t,c=self.performance.now(),u=a.loading.first?Math.max(0,c-a.loading.first):0;r.advancedDateTime=Date.now()-u;const f=this.hls.config.timelineOffset;if(f!==r.appliedTimelineOffset){const m=Math.max(f||0,0);r.appliedTimelineOffset=m,r.fragments.forEach(p=>{p.setStart(p.playlistOffset+m)})}if(r.live||i!=null&&i.live){const m="levelInfo"in t?t.levelInfo:t.track;if(r.reloaded(i),i&&r.fragments.length>0){_1(i,r,this);const _=r.playlistParsingError;if(_){this.warn(_);const I=this.hls;if(!I.config.ignorePlaylistParsingErrors){var h;const{networkDetails:C}=t;I.trigger(A.ERROR,{type:pe.NETWORK_ERROR,details:H.LEVEL_PARSING_ERROR,fatal:!1,url:r.url,error:_,reason:_.message,level:t.level||void 0,parent:(h=r.fragments[0])==null?void 0:h.type,networkDetails:C,stats:a});return}r.playlistParsingError=null}}r.requestScheduled===-1&&(r.requestScheduled=a.loading.start);const p=this.hls.mainForwardBufferInfo,y=p?p.end-p.len:0,S=(r.edge-y)*1e3,E=Jy(r,S);if(r.requestScheduled+E<c?r.requestScheduled=c:r.requestScheduled+=E,this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),!this.canLoad||!r.live)return;let T,b,L;if(r.canBlockReload&&r.endSN&&r.advanced){const _=this.hls.config.lowLatencyMode,I=r.lastPartSn,C=r.endSN,N=r.lastPartIndex,K=N!==-1,O=I===C;K?O?(b=C+1,L=_?0:N):(b=I,L=_?N+1:r.maxPartIndex):b=C+1;const j=r.age,B=j+r.ageHeader;let U=Math.min(B-r.partTarget,r.targetduration*1.5);if(U>0){if(B>r.targetduration*3)this.log(`Playlist last advanced ${j.toFixed(2)}s ago. Omitting segment and part directives.`),b=void 0,L=void 0;else if(i!=null&&i.tuneInGoal&&B-r.partTarget>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${U} with playlist age: ${r.age}`),U=0;else{const W=Math.floor(U/r.targetduration);if(b+=W,L!==void 0){const re=Math.round(U%r.targetduration/r.partTarget);L+=re}this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${j.toFixed(2)}s goal: ${U} skip sn ${W} to part ${L}`)}r.tuneInGoal=U}if(T=this.getDeliveryDirectives(r,t.deliveryDirectives,b,L),_||!O){r.requestScheduled=c,this.loadingPlaylist(m,T);return}}else(r.canBlockReload||r.canSkipUntil)&&(T=this.getDeliveryDirectives(r,t.deliveryDirectives,b,L));T&&b!==void 0&&r.canBlockReload&&(r.requestScheduled=a.loading.first+Math.max(E-u*2,E/2)),this.scheduleLoading(m,T,r)}else this.clearTimer()}scheduleLoading(e,t,i){const r=i||e.details;if(!r){this.loadingPlaylist(e,t);return}const a=self.performance.now(),c=r.requestScheduled;if(a>=c){this.loadingPlaylist(e,t);return}const u=c-a;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(u)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),u)}getDeliveryDirectives(e,t,i,r){let a=H0(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(i=t.msn,r=t.part,a=mo.No),new V0(i,r,a)}checkRetry(e){const t=e.details,i=Lo(e),r=e.errorAction,{action:a,retryCount:c=0,retryConfig:u}=r||{},f=!!r&&!!u&&(a===bt.RetryRequest||!r.resolved&&a===bt.SendAlternateToPenaltyBox);if(f){var h;if(c>=u.maxNumRetry)return!1;if(i&&(h=e.context)!=null&&h.deliveryDirectives)this.warn(`Retrying playlist loading ${c+1}/${u.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const m=lh(u,c);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),m),this.warn(`Retrying playlist loading ${c+1}/${u.maxNumRetry} after "${t}" in ${m}ms`)}e.levelRetry=!0,r.resolved=!0}return f}}function Rx(l,e){if(l.length!==e.length)return!1;for(let t=0;t<l.length;t++)if(!Da(l[t].attrs,e[t].attrs))return!1;return!0}function Da(l,e,t){const i=l["STABLE-RENDITION-ID"];return i&&!t?i===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(r=>l[r]!==e[r])}function $d(l,e){return e.label.toLowerCase()===l.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(l.lang||"").toLowerCase())}class PR extends Eh{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.LEVEL_LOADING,this.onLevelLoading,this),e.on(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(A.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(A.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.LEVEL_LOADING,this.onLevelLoading,this),e.off(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(A.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(A.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:i,groupId:r,details:a}=t,c=this.tracksInGroup[i];if(!c||c.groupId!==r){this.warn(`Audio track with id:${i} and group:${r} not found in active group ${c==null?void 0:c.groupId}`);return}const u=c.details;c.details=t.details,this.log(`Audio track ${i} "${c.name}" lang:${c.lang} group:${r} loaded [${a.startSN}-${a.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,u)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const i=t.audioGroups||null,r=this.groupIds;let a=this.currentTrack;if(!i||(r==null?void 0:r.length)!==(i==null?void 0:i.length)||i!=null&&i.some(u=>(r==null?void 0:r.indexOf(u))===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const u=this.tracks.filter(y=>!i||i.indexOf(y.groupId)!==-1);if(u.length)this.selectDefaultTrack&&!u.some(y=>y.default)&&(this.selectDefaultTrack=!1),u.forEach((y,S)=>{y.id=S});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=u;const f=this.hls.config.audioPreference;if(!a&&f){const y=ki(f,u,cn);if(y>-1)a=u[y];else{const S=ki(f,this.tracks);a=this.tracks[S]}}let h=this.findTrackId(a);h===-1&&a&&(h=this.findTrackId(null));const m={audioTracks:u};this.log(`Updating audio tracks, ${u.length} track(s) found in group(s): ${i==null?void 0:i.join(",")}`),this.hls.trigger(A.AUDIO_TRACKS_UPDATED,m);const p=this.trackId;if(h!==-1&&p===-1)this.setAudioTrack(h);else if(u.length&&p===-1){var c;const y=new Error(`No audio track selected for current audio group-ID(s): ${(c=this.groupIds)==null?void 0:c.join(",")} track count: ${u.length}`);this.warn(y.message),this.hls.trigger(A.ERROR,{type:pe.MEDIA_ERROR,details:H.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:y})}}}onError(e,t){t.fatal||!t.context||t.context.type===Ie.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const i=this.allAudioTracks;if(this.selectDefaultTrack=!1,i.length){const r=this.currentTrack;if(r&&un(e,r,cn))return r;const a=ki(e,this.tracksInGroup,cn);if(a>-1){const c=this.tracksInGroup[a];return this.setAudioTrack(a),c}else if(r){let c=t.loadLevel;c===-1&&(c=t.firstAutoLevel);const u=qA(e,t.levels,i,c,cn);if(u===-1)return null;t.nextLoadLevel=u}if(e.channels||e.audioCodec){const c=ki(e,i);if(c>-1)return i[c]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const i=this.currentTrack,r=t[e],a=r.details&&!r.details.live;if(e===this.trackId&&r===i&&a||(this.log(`Switching to audio-track ${e} "${r.name}" lang:${r.lang} group:${r.groupId} channels:${r.channels}`),this.trackId=e,this.currentTrack=r,this.hls.trigger(A.AUDIO_TRACK_SWITCHING,je({},r)),a))return;const c=this.switchParams(r.url,i==null?void 0:i.details,r.details);this.loadPlaylist(c)}findTrackId(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const r=t[i];if(!(this.selectDefaultTrack&&!r.default)&&(!e||un(e,r,cn)))return i}if(e){const{name:i,lang:r,assocLang:a,characteristics:c,audioCodec:u,channels:f}=e;for(let h=0;h<t.length;h++){const m=t[h];if(un({name:i,lang:r,assocLang:a,characteristics:c,audioCodec:u,channels:f},m,cn))return h}for(let h=0;h<t.length;h++){const m=t[h];if(Da(e.attrs,m.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return h}for(let h=0;h<t.length;h++){const m=t[h];if(Da(e.attrs,m.attrs,["LANGUAGE"]))return h}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&Ro(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const i=e.id,r=e.groupId,a=this.getUrlWithDirectives(e.url,t),c=e.details,u=c==null?void 0:c.age;this.log(`Loading audio-track ${i} "${e.name}" lang:${e.lang} group:${r}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${u&&c.live?" age "+u.toFixed(1)+(c.type&&" "+c.type||""):""} ${a}`),this.hls.trigger(A.AUDIO_TRACK_LOADING,{url:a,id:i,groupId:r,deliveryDirectives:t||null,track:e})}}class UR{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,i){if(this.queues===null||this.tracks===null)return;const r=this.queues[t];r.push(e),r.length===1&&!i&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const i={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(i,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const i={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(i)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const i=(t=e[0])==null?void 0:t.label;(i==="async-blocker"||i==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const r=t[0];try{r.execute()}catch(a){var i;if(r.onError(a),this.queues===null||this.tracks===null)return;const c=(i=this.tracks[e])==null?void 0:i.buffer;c!=null&&c.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,i;return(t=this.queues)!=null&&t[e]||(i=this.tracks)!=null&&i[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const i=(t=this.tracks)==null?void 0:t[e],r=i==null?void 0:i.buffer;return r?`SourceBuffer${r.updating?" updating":""}${i.ended?" ended":""}${i.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(i=>i.label).join(", "))||""}}const Ip=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,Lx="HlsJsTrackRemovedError";class BR extends Error{constructor(e){super(e),this.name=Lx}}class FR extends mi{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=i=>{var r;this.hls&&((r=this.mediaSource)==null?void 0:r.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=i=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=i=>{const{media:r,mediaSource:a}=this;i&&this.log("Media source opened"),!(!r||!a)&&(a.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(A.MEDIA_ATTACHED,{media:r,mediaSource:a}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:i,_objectUrl:r}=this;i!==r&&this.error(`Media element src was set while attaching MediaSource (${r} > ${i})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=lA(Ps(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.BUFFER_RESET,this.onBufferReset,this),e.on(A.BUFFER_APPENDING,this.onBufferAppending,this),e.on(A.BUFFER_CODECS,this.onBufferCodecs,this),e.on(A.BUFFER_EOS,this.onBufferEos,this),e.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(A.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(A.FRAG_PARSED,this.onFragParsed,this),e.on(A.FRAG_CHANGED,this.onFragChanged,this),e.on(A.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.BUFFER_RESET,this.onBufferReset,this),e.off(A.BUFFER_APPENDING,this.onBufferAppending,this),e.off(A.BUFFER_CODECS,this.onBufferCodecs,this),e.off(A.BUFFER_EOS,this.onBufferEos,this),e.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(A.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(A.FRAG_PARSED,this.onFragParsed,this),e.off(A.FRAG_CHANGED,this.onFragChanged,this),e.off(A.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const i={};if(this.operationQueue){const a=this.isUpdating();a||this.operationQueue.removeBlockers();const c=this.isQueued();(a||c)&&this.warn(`Transfering MediaSource with${c?" operations in queue":""}${a?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const r=this.transferData;return!this.sourceBufferCount&&r&&r.mediaSource===t?Ke(i,r.tracks):this.sourceBuffers.forEach(a=>{const[c]=a;c&&(i[c]=Ke({},this.tracks[c]),this.removeBuffer(c)),a[0]=a[1]=null}),{media:e,mediaSource:t,tracks:i}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var i;let r=2;(t.audio&&!t.video||!t.altAudio)&&(r=1),this.bufferCodecEventsTotal=r,this.log(`${r} bufferCodec event(s) expected.`),(i=this.transferData)!=null&&i.mediaSource&&this.sourceBufferCount&&r&&this.bufferCreated()}onMediaAttaching(e,t){const i=this.media=t.media;this.transferData=this.overrides=void 0;const r=Ps(this.appendSource);if(r){const a=!!t.mediaSource;(a||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const c=this.mediaSource=t.mediaSource||new r;if(this.assignMediaSource(c),a)this._objectUrl=i.src,this.attachTransferred();else{const u=this._objectUrl=self.URL.createObjectURL(c);if(this.appendSource)try{i.removeAttribute("src");const f=self.ManagedMediaSource;i.disableRemotePlayback=i.disableRemotePlayback||f&&c instanceof f,Cp(i),jR(i,u),i.load()}catch{i.src=u}else i.src=u}i.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,i;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(i=e.constructor)==null?void 0:i.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const i=this.tracks,r=t.tracks,a=r?Object.keys(r):null,c=a?a.length:0,u=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(r&&a&&c){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${Xe(i,(f,h)=>f==="initSegment"?void 0:h)};
transfer tracks: ${Xe(r,(f,h)=>f==="initSegment"?void 0:h)}}`),!Ty(r,i)){t.mediaSource=null,t.tracks=void 0;const f=e.currentTime,h=this.details,m=Math.max(f,(h==null?void 0:h.fragments[0].start)||0);if(m-f>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${f} -> ${m}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(r)}"->"${Object.keys(i)}") start time: ${m} currentTime: ${f}`),this.onMediaDetaching(A.MEDIA_DETACHING,{}),this.onMediaAttaching(A.MEDIA_ATTACHING,t),e.currentTime=m;return}this.transferData=void 0,a.forEach(f=>{const h=f,m=r[h];if(m){const p=m.buffer;if(p){const y=this.fragmentTracker,S=m.id;if(y.hasFragments(S)||y.hasParts(S)){const b=be.getBuffered(p);y.detectEvictedFragments(h,b,S,null,!0)}const E=pd(h),T=[h,p];this.sourceBuffers[E]=T,p.updating&&this.operationQueue&&this.operationQueue.prependBlocker(h),this.trackSourceBuffer(h,m)}}}),u(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),u()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const i=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:r,mediaSource:a,_objectUrl:c}=this;if(a){if(this.log(`media source ${i?"transferring":"detaching"}`),i)this.sourceBuffers.forEach(([u])=>{u&&this.removeBuffer(u)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const u=a.readyState==="open";try{const f=a.sourceBuffers;for(let h=f.length;h--;)u&&f[h].abort(),a.removeSourceBuffer(f[h]);u&&a.endOfStream()}catch(f){this.warn(`onMediaDetaching: ${f.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}a.removeEventListener("sourceopen",this._onMediaSourceOpen),a.removeEventListener("sourceended",this._onMediaSourceEnded),a.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(a.removeEventListener("startstreaming",this._onStartStreaming),a.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}r&&(r.removeEventListener("emptied",this._onMediaEmptied),i||(c&&self.URL.revokeObjectURL(c),this.mediaSrc===c?(r.removeAttribute("src"),this.appendSource&&Cp(r),r.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(A.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const i=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),i)try{var r;(r=this.mediaSource)!=null&&r.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(i)}catch(a){this.warn(`onBufferReset ${e}`,a)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[pd(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new UR(this.tracks)}onBufferCodecs(e,t){var i;const r=this.tracks,a=Object.keys(t);this.log(`BUFFER_CODECS: "${a}" (current SB count ${this.sourceBufferCount})`);const c="audiovideo"in t&&(r.audio||r.video)||r.audiovideo&&("audio"in t||"video"in t),u=!c&&this.sourceBufferCount&&this.media&&a.some(f=>!r[f]);if(c||u){this.warn(`Unsupported transition between "${Object.keys(r)}" and "${a}" SourceBuffers`);return}a.forEach(f=>{var h,m;const p=t[f],{id:y,codec:S,levelCodec:E,container:T,metadata:b,supplemental:L}=p;let _=r[f];const I=(h=this.transferData)==null||(h=h.tracks)==null?void 0:h[f],C=I!=null&&I.buffer?I:_,N=(C==null?void 0:C.pendingCodec)||(C==null?void 0:C.codec),K=C==null?void 0:C.levelCodec;_||(_=r[f]={buffer:void 0,listeners:[],codec:S,supplemental:L,container:T,levelCodec:E,metadata:b,id:y});const O=fo(N,K),j=O==null?void 0:O.replace(Ip,"$1");let B=fo(S,E);const U=(m=B)==null?void 0:m.replace(Ip,"$1");B&&O&&j!==U&&(f.slice(0,5)==="audio"&&(B=bo(B,this.appendSource)),this.log(`switching codec ${N} to ${B}`),B!==(_.pendingCodec||_.codec)&&(_.pendingCodec=B),_.container=T,this.appendChangeType(f,T,B))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!t.video&&((i=t.audio)==null?void 0:i.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const i=this.tracks[t];return e[t]={id:i.id,container:i.container,codec:i.codec,levelCodec:i.levelCodec},e},{})}appendChangeType(e,t,i){const r=`${t};codecs=${i}`,a={label:`change-type=${r}`,execute:()=>{const c=this.tracks[e];if(c){const u=c.buffer;u!=null&&u.changeType&&(this.log(`changing ${e} sourceBuffer type to ${r}`),u.changeType(r),c.codec=i,c.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:c=>{this.warn(`Failed to change ${e} SourceBuffer type`,c)}};this.append(a,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const i=e.start,r=i+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(i,me.MAIN))==null?void 0:t.gap)===!0)return;const c={label:"block-audio",execute:()=>{var u;const f=this.tracks.video;(this.lastVideoAppendEnd>r||f!=null&&f.buffer&&be.isBuffered(f.buffer,r)||((u=this.fragmentTracker.getAppendedFrag(r,me.MAIN))==null?void 0:u.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:u=>{this.warn("Error executing block-audio operation",u)}};this.blockedAudioAppend={op:c,frag:e},this.append(c,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:i}=this,{data:r,type:a,parent:c,frag:u,part:f,chunkMeta:h,offset:m}=t,p=h.buffering[a],{sn:y,cc:S}=u,E=self.performance.now();p.start=E;const T=u.stats.buffering,b=f?f.stats.buffering:null;T.start===0&&(T.start=E),b&&b.start===0&&(b.start=E);const L=i.audio;let _=!1;a==="audio"&&(L==null?void 0:L.container)==="audio/mpeg"&&(_=!this.lastMpegAudioChunk||h.id===1||this.lastMpegAudioChunk.sn!==h.sn,this.lastMpegAudioChunk=h);const I=i.video,C=I==null?void 0:I.buffer;if(C&&y!=="initSegment"){const O=f||u,j=this.blockedAudioAppend;if(a==="audio"&&c!=="main"&&!this.blockedAudioAppend&&!(I.ending||I.ended)){const U=O.start+O.duration*.05,W=C.buffered,re=this.currentOp("video");!W.length&&!re?this.blockAudio(O):!re&&!be.isBuffered(C,U)&&this.lastVideoAppendEnd<U&&this.blockAudio(O)}else if(a==="video"){const B=O.end;if(j){const U=j.frag.start;(B>U||B<this.lastVideoAppendEnd||be.isBuffered(C,U))&&this.unblockAudio()}this.lastVideoAppendEnd=B}}const N=(f||u).start,K={label:`append-${a}`,execute:()=>{var O;p.executeStart=self.performance.now();const j=(O=this.tracks[a])==null?void 0:O.buffer;j&&(_?this.updateTimestampOffset(j,N,.1,a,y,S):m!==void 0&&de(m)&&this.updateTimestampOffset(j,m,1e-6,a,y,S)),this.appendExecutor(r,a)},onStart:()=>{},onComplete:()=>{const O=self.performance.now();p.executeEnd=p.end=O,T.first===0&&(T.first=O),b&&b.first===0&&(b.first=O);const j={};this.sourceBuffers.forEach(([B,U])=>{B&&(j[B]=be.getBuffered(U))}),this.appendErrors[a]=0,a==="audio"||a==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(A.BUFFER_APPENDED,{type:a,frag:u,part:f,chunkMeta:h,parent:u.type,timeRanges:j})},onError:O=>{var j;const B={type:pe.MEDIA_ERROR,parent:u.type,details:H.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:u,part:f,chunkMeta:h,error:O,err:O,fatal:!1},U=(j=this.media)==null?void 0:j.error;if(O.code===DOMException.QUOTA_EXCEEDED_ERR||O.name=="QuotaExceededError"||"quota"in O)B.details=H.BUFFER_FULL_ERROR;else if(O.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!U)B.errorAction=rr(!0);else if(O.name===Lx&&this.sourceBufferCount===0)B.errorAction=rr(!0);else{const W=++this.appendErrors[a];this.warn(`Failed ${W}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer (${U||"no media error"})`),(W>=this.hls.config.appendErrorMaxRetry||U)&&(B.fatal=!0)}this.hls.trigger(A.ERROR,B)}};this.log(`queuing "${a}" append sn: ${y}${f?" p: "+f.index:""} of ${u.type===me.MAIN?"level":"track"} ${u.level} cc: ${S}`),this.append(K,a,this.isPending(this.tracks[a]))}getFlushOp(e,t,i){return this.log(`queuing "${e}" remove ${t}-${i}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,i)},onStart:()=>{},onComplete:()=>{this.hls.trigger(A.BUFFER_FLUSHED,{type:e})},onError:r=>{this.warn(`Failed to remove ${t}-${i} from "${e}" SourceBuffer`,r)}}}onBufferFlushing(e,t){const{type:i,startOffset:r,endOffset:a}=t;i?this.append(this.getFlushOp(i,r,a),i):this.sourceBuffers.forEach(([c])=>{c&&this.append(this.getFlushOp(c,r,a),c)})}onFragParsed(e,t){const{frag:i,part:r}=t,a=[],c=r?r.elementaryStreams:i.elementaryStreams;c[qe.AUDIOVIDEO]?a.push("audiovideo"):(c[qe.AUDIO]&&a.push("audio"),c[qe.VIDEO]&&a.push("video"));const u=()=>{const f=self.performance.now();i.stats.buffering.end=f,r&&(r.stats.buffering.end=f);const h=r?r.stats:i.stats;this.hls.trigger(A.FRAG_BUFFERED,{frag:i,part:r,stats:h,id:i.type})};a.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers(u,a).catch(f=>{this.warn(`Fragment buffered callback ${f}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const t=this.tracks[e];if(t)return!t.ended||t.ending}return!1})}onBufferEos(e,t){var i;this.sourceBuffers.forEach(([c])=>{if(c){const u=this.tracks[c];(!t.type||t.type===c)&&(u.ending=!0,u.ended||(u.ended=!0,this.log(`${c} buffer reached EOS`)))}});const r=((i=this.overrides)==null?void 0:i.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([c])=>{var u;return c&&!((u=this.tracks[c])!=null&&u.ended)})?r?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:c}=this;if(!c||c.readyState!=="open"){c&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${c.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),c.endOfStream(),this.hls.trigger(A.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(A.BUFFERED_TO_END,void 0)):t.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===H.BUFFER_APPEND_ERROR&&t.frag){var i;const r=(i=t.errorAction)==null?void 0:i.nextAutoLevel;de(r)&&r!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:i}=this;if(!i||t===null||!this.sourceBufferCount)return;const r=e.config,a=i.currentTime,c=t.levelTargetDuration,u=t.live&&r.liveBackBufferLength!==null?r.liveBackBufferLength:r.backBufferLength;if(de(u)&&u>=0){const h=Math.max(u,c),m=Math.floor(a/c)*c-h;this.flushBackBuffer(a,c,m)}const f=r.frontBufferFlushThreshold;if(de(f)&&f>0){const h=Math.max(r.maxBufferLength,f),m=Math.max(h,c),p=Math.floor(a/c)*c+m;this.flushFrontBuffer(a,c,p)}}flushBackBuffer(e,t,i){this.sourceBuffers.forEach(([r,a])=>{if(a){const u=be.getBuffered(a);if(u.length>0&&i>u.start(0)){var c;this.hls.trigger(A.BACK_BUFFER_REACHED,{bufferEnd:i});const f=this.tracks[r];if((c=this.details)!=null&&c.live)this.hls.trigger(A.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i});else if(f!=null&&f.ended){this.log(`Cannot flush ${r} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(A.BUFFER_FLUSHING,{startOffset:0,endOffset:i,type:r})}}})}flushFrontBuffer(e,t,i){this.sourceBuffers.forEach(([r,a])=>{if(a){const c=be.getBuffered(a),u=c.length;if(u<2)return;const f=c.start(u-1),h=c.end(u-1);if(i>f||e>=f&&e<=h)return;this.hls.trigger(A.BUFFER_FLUSHING,{startOffset:f,endOffset:1/0,type:r})}})}getDurationAndRange(){var e;const{details:t,mediaSource:i}=this;if(!t||!this.media||(i==null?void 0:i.readyState)!=="open")return null;const r=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&i.setLiveSeekableRange){const h=Math.max(0,t.fragmentStart),m=Math.max(h,r);return{duration:1/0,start:h,end:m}}return{duration:1/0}}const a=(e=this.overrides)==null?void 0:e.duration;if(a)return de(a)?{duration:a}:null;const c=this.media.duration,u=de(i.duration)?i.duration:0;return r>u&&r>c||!de(c)?{duration:r}:null}updateMediaSource({duration:e,start:t,end:i}){const r=this.mediaSource;!this.media||!r||r.readyState!=="open"||(r.duration!==e&&(de(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),r.duration=e),t!==void 0&&i!==void 0&&(this.log(`MediaSource duration is set to ${r.duration}. Setting seekable range to ${t}-${i}.`),r.setLiveSeekableRange(t,i)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:i}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${Xe(i)}`),this.tracksReady){var r;const a=(r=this.transferData)==null?void 0:r.tracks;a&&Object.keys(a).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,i])=>{if(t){const r=this.tracks[t];e[t]={buffer:i,container:r.container,codec:r.codec,supplemental:r.supplemental,levelCodec:r.levelCodec,id:r.id,metadata:r.metadata}}}),this.hls.trigger(A.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(A.ERROR,{type:pe.MEDIA_ERROR,details:H.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:i}=this;if(!i)throw new Error("createSourceBuffers called when mediaSource was null");for(const a in e){const c=a,u=e[c];if(this.isPending(u)){const f=this.getTrackCodec(u,c),h=`${u.container};codecs=${f}`;u.codec=f,this.log(`creating sourceBuffer(${h})${this.currentOp(c)?" Queued":""} ${Xe(u)}`);try{const m=i.addSourceBuffer(h),p=pd(c),y=[c,m];t[p]=y,u.buffer=m}catch(m){var r;this.error(`error while trying to add sourceBuffer: ${m.message}`),this.shiftAndExecuteNext(c),(r=this.operationQueue)==null||r.removeBlockers(),delete this.tracks[c],this.hls.trigger(A.ERROR,{type:pe.MEDIA_ERROR,details:H.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:m,sourceBufferName:c,mimeType:h,parent:u.id});return}this.trackSourceBuffer(c,u)}}this.bufferCreated()}getTrackCodec(e,t){const i=e.supplemental;let r=e.codec;i&&(t==="video"||t==="audiovideo")&&Ta(i,"video")&&(r=IA(r,i));const a=fo(r,e.levelCodec);return a?t.slice(0,5)==="audio"?bo(a,this.appendSource):a:""}trackSourceBuffer(e,t){const i=t.buffer;if(!i)return;const r=this.getTrackCodec(t,e);this.tracks[e]={buffer:i,codec:r,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(a,c)=>{const u=c.removedRanges;u!=null&&u.length&&this.hls.trigger(A.BUFFER_FLUSHED,{type:a})})}get mediaSrc(){var e,t;const i=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return i==null?void 0:i.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const i=this.currentOp(e);i&&(i.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var i;const r=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(i=this.mediaSource)==null?void 0:i.readyState}`);this.error(`${r}`,t),this.hls.trigger(A.ERROR,{type:pe.MEDIA_ERROR,details:H.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:r,fatal:!1});const a=this.currentOp(e);a&&a.onError(r)}updateTimestampOffset(e,t,i,r,a,c){const u=t-e.timestampOffset;Math.abs(u)>=i&&(this.log(`Updating ${r} SourceBuffer timestampOffset to ${t} (sn: ${a} cc: ${c})`),e.timestampOffset=t)}removeExecutor(e,t,i){const{media:r,mediaSource:a}=this,c=this.tracks[e],u=c==null?void 0:c.buffer;if(!r||!a||!u){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const f=de(r.duration)?r.duration:1/0,h=de(a.duration)?a.duration:1/0,m=Math.max(0,t),p=Math.min(i,f,h);p>m&&(!c.ending||c.ended)?(c.ended=!1,this.log(`Removing [${m},${p}] from the ${e} SourceBuffer`),u.remove(m,p)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const i=this.tracks[t],r=i==null?void 0:i.buffer;if(!r)throw new BR(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);i.ending=!1,i.ended=!1,r.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:i}=this,r=t.map(c=>this.appendBlocker(c));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(r).then(c=>{i===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var i;const r=(i=this.tracks[t])==null?void 0:i.buffer;!r||r.updating||this.shiftAndExecuteNext(t)})}append(e,t,i){this.operationQueue&&this.operationQueue.append(e,t,i)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,i){const r=this.tracks[e];if(!r)return;const a=r.buffer;if(!a)return;const c=i.bind(this,e);r.listeners.push({event:t,listener:c}),a.addEventListener(t,c)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const i=t.buffer;i&&(t.listeners.forEach(r=>{i.removeEventListener(r.event,r.listener)}),t.listeners.length=0)}}function Cp(l){const e=l.querySelectorAll("source");[].slice.call(e).forEach(t=>{l.removeChild(t)})}function jR(l,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,l.appendChild(t)}function pd(l){return l==="audio"?1:0}class Sh{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(A.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(A.BUFFER_CODECS,this.onBufferCodecs,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(A.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(A.BUFFER_CODECS,this.onBufferCodecs,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const i=this.hls.levels[t.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const i=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,i.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&de(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,i=this.getMaxLevel(e.length-1);i!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${i}: ${e[i].height}p@${e[i].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=i,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const i=t.filter((r,a)=>this.isLevelAllowed(r)&&a<=e);return this.clientRect=null,Sh.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const i=e.getBoundingClientRect();t.width=i.width,t.height=i.height,!t.width&&!t.height&&(t.width=i.right-i.left||e.width||0,t.height=i.bottom-i.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(i=>e.bitrate===i.bitrate&&e.width===i.width&&e.height===i.height)}static getMaxLevelByMediaSize(e,t,i){if(!(e!=null&&e.length))return-1;const r=(u,f)=>f?u.width!==f.width||u.height!==f.height:!0;let a=e.length-1;const c=Math.max(t,i);for(let u=0;u<e.length;u+=1){const f=e[u];if((f.width>=c||f.height>=c)&&r(f,e[u+1])){a=u;break}}return a}}const $R={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},$t=$R,GR={HLS:"h"},HR=GR;class Pi{constructor(e,t){Array.isArray(e)&&(e=e.map(i=>i instanceof Pi?i:new Pi(i))),this.value=e,this.params=t}}const VR="Dict";function KR(l){return Array.isArray(l)?JSON.stringify(l):l instanceof Map?"Map{}":l instanceof Set?"Set{}":typeof l=="object"?JSON.stringify(l):String(l)}function zR(l,e,t,i){return new Error(`failed to ${l} "${KR(e)}" as ${t}`,{cause:i})}function Ui(l,e,t){return zR("serialize",l,e,t)}class _x{constructor(e){this.description=e}}const wp="Bare Item",YR="Boolean";function qR(l){if(typeof l!="boolean")throw Ui(l,YR);return l?"?1":"?0"}function XR(l){return btoa(String.fromCharCode(...l))}const QR="Byte Sequence";function WR(l){if(ArrayBuffer.isView(l)===!1)throw Ui(l,QR);return`:${XR(l)}:`}const ZR="Integer";function JR(l){return l<-999999999999999||999999999999999<l}function Dx(l){if(JR(l))throw Ui(l,ZR);return l.toString()}function eL(l){return`@${Dx(l.getTime()/1e3)}`}function Ix(l,e){if(l<0)return-Ix(-l,e);const t=Math.pow(10,e);if(Math.abs(l*t%1-.5)<Number.EPSILON){const r=Math.floor(l*t);return(r%2===0?r:r+1)/t}else return Math.round(l*t)/t}const tL="Decimal";function iL(l){const e=Ix(l,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Ui(l,tL);const t=e.toString();return t.includes(".")?t:`${t}.0`}const sL="String",nL=/[\x00-\x1f\x7f]+/;function rL(l){if(nL.test(l))throw Ui(l,sL);return`"${l.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function aL(l){return l.description||l.toString().slice(7,-1)}const lL="Token";function Np(l){const e=aL(l);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Ui(e,lL);return e}function Gd(l){switch(typeof l){case"number":if(!de(l))throw Ui(l,wp);return Number.isInteger(l)?Dx(l):iL(l);case"string":return rL(l);case"symbol":return Np(l);case"boolean":return qR(l);case"object":if(l instanceof Date)return eL(l);if(l instanceof Uint8Array)return WR(l);if(l instanceof _x)return Np(l);default:throw Ui(l,wp)}}const oL="Key";function Hd(l){if(/^[a-z*][a-z0-9\-_.*]*$/.test(l)===!1)throw Ui(l,oL);return l}function Th(l){return l==null?"":Object.entries(l).map(([e,t])=>t===!0?`;${Hd(e)}`:`;${Hd(e)}=${Gd(t)}`).join("")}function Cx(l){return l instanceof Pi?`${Gd(l.value)}${Th(l.params)}`:Gd(l)}function cL(l){return`(${l.value.map(Cx).join(" ")})${Th(l.params)}`}function uL(l,e={whitespace:!0}){if(typeof l!="object"||l==null)throw Ui(l,VR);const t=l instanceof Map?l.entries():Object.entries(l),i=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([r,a])=>{a instanceof Pi||(a=new Pi(a));let c=Hd(r);return a.value===!0?c+=Th(a.params):(c+="=",Array.isArray(a.value)?c+=cL(a):c+=Cx(a)),c}).join(`,${i}`)}function wx(l,e){return uL(l,e)}const Ci="CMCD-Object",nt="CMCD-Request",ln="CMCD-Session",Ns="CMCD-Status",dL={br:Ci,ab:Ci,d:Ci,ot:Ci,tb:Ci,tpb:Ci,lb:Ci,tab:Ci,lab:Ci,url:Ci,pb:nt,bl:nt,tbl:nt,dl:nt,ltc:nt,mtp:nt,nor:nt,nrr:nt,rc:nt,sn:nt,sta:nt,su:nt,ttfb:nt,ttfbb:nt,ttlb:nt,cmsdd:nt,cmsds:nt,smrt:nt,df:nt,cs:nt,ts:nt,cid:ln,pr:ln,sf:ln,sid:ln,st:ln,v:ln,msd:ln,bs:Ns,bsd:Ns,cdn:Ns,rtp:Ns,bg:Ns,pt:Ns,ec:Ns,e:Ns},hL={REQUEST:nt};function fL(l){return Object.keys(l).reduce((e,t)=>{var i;return(i=l[t])===null||i===void 0||i.forEach(r=>e[r]=t),e},{})}function mL(l,e){const t={};if(!l)return t;const i=Object.keys(l),r=e?fL(e):{};return i.reduce((a,c)=>{var u;const f=dL[c]||r[c]||hL.REQUEST,h=(u=a[f])!==null&&u!==void 0?u:a[f]={};return h[c]=l[c],a},t)}function gL(l){return["ot","sf","st","e","sta"].includes(l)}function pL(l){return typeof l=="number"?de(l):l!=null&&l!==""&&l!==!1}const Nx="event";function yL(l,e){const t=new URL(l),i=new URL(e);if(t.origin!==i.origin)return l;const r=t.pathname.split("/").slice(1),a=i.pathname.split("/").slice(1,-1);for(;r[0]===a[0];)r.shift(),a.shift();for(;a.length;)a.shift(),r.unshift("..");return r.join("/")+t.search+t.hash}const xo=l=>Math.round(l),Vd=(l,e)=>Array.isArray(l)?l.map(t=>Vd(t,e)):l instanceof Pi&&typeof l.value=="string"?new Pi(Vd(l.value,e),l.params):(e.baseUrl&&(l=yL(l,e.baseUrl)),e.version===1?encodeURIComponent(l):l),io=l=>xo(l/100)*100,xL=(l,e)=>{let t=l;return e.version>=2&&(l instanceof Pi&&typeof l.value=="string"?t=new Pi([l]):typeof l=="string"&&(t=[l])),Vd(t,e)},vL={br:xo,d:xo,bl:io,dl:io,mtp:io,nor:xL,rtp:io,tb:xo},kx="request",Ox="response",bh=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],EL=["e"],SL=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Uo(l){return SL.test(l)}function TL(l){return bh.includes(l)||EL.includes(l)||Uo(l)}const Mx=["d","dl","nor","ot","rtp","su"];function bL(l){return bh.includes(l)||Mx.includes(l)||Uo(l)}const AL=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function RL(l){return bh.includes(l)||Mx.includes(l)||AL.includes(l)||Uo(l)}const LL=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function _L(l){return LL.includes(l)||Uo(l)}const DL={[Ox]:RL,[Nx]:TL,[kx]:bL};function Px(l,e={}){const t={};if(l==null||typeof l!="object")return t;const i=e.version||l.v||1,r=e.reportingMode||kx,a=i===1?_L:DL[r];let c=Object.keys(l).filter(a);const u=e.filter;typeof u=="function"&&(c=c.filter(u));const f=r===Ox||r===Nx;f&&!c.includes("ts")&&c.push("ts"),i>1&&!c.includes("v")&&c.push("v");const h=Ke({},vL,e.formatters),m={version:i,reportingMode:r,baseUrl:e.baseUrl};return c.sort().forEach(p=>{let y=l[p];const S=h[p];if(typeof S=="function"&&(y=S(y,m)),p==="v"){if(i===1)return;y=i}p=="pr"&&y===1||(f&&p==="ts"&&!de(y)&&(y=Date.now()),pL(y)&&(gL(p)&&typeof y=="string"&&(y=new _x(y)),t[p]=y))}),t}function IL(l,e={}){const t={};if(!l)return t;const i=Px(l,e),r=mL(i,e==null?void 0:e.customHeaderMap);return Object.entries(r).reduce((a,[c,u])=>{const f=wx(u,{whitespace:!1});return f&&(a[c]=f),a},t)}function CL(l,e,t){return Ke(l,IL(e,t))}const wL="CMCD";function NL(l,e={}){return l?wx(Px(l,e),{whitespace:!1}):""}function kL(l,e={}){if(!l)return"";const t=NL(l,e);return encodeURIComponent(t)}function OL(l,e={}){if(!l)return"";const t=kL(l,e);return`${wL}=${t}`}const kp=/CMCD=[^&#]+/;function ML(l,e,t){const i=OL(e,t);if(!i)return l;if(kp.test(l))return l.replace(kp,i);const r=l.includes("?")?"&":"?";return`${l}${r}${i}`}class PL{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:$t.MANIFEST,su:!this.initialized})}catch(a){this.hls.logger.warn("Could not generate manifest CMCD data.",a)}},this.applyFragmentData=r=>{try{const{frag:a,part:c}=r,u=this.hls.levels[a.level],f=this.getObjectType(a),h={d:(c||a).duration*1e3,ot:f};(f===$t.VIDEO||f===$t.AUDIO||f==$t.MUXED)&&(h.br=u.bitrate/1e3,h.tb=this.getTopBandwidth(f)/1e3,h.bl=this.getBufferLength(f));const m=c?this.getNextPart(c):this.getNextFrag(a);m!=null&&m.url&&m.url!==a.url&&(h.nor=m.url),this.apply(r,h)}catch(a){this.hls.logger.warn("Could not generate segment CMCD data.",a)}},this.hls=e;const t=this.config=e.config,{cmcd:i}=t;i!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||e.sessionId,this.cid=i.contentId,this.useHeaders=i.useHeaders===!0,this.includeKeys=i.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHED,this.onMediaDetached,this),e.on(A.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHED,this.onMediaDetached,this),e.off(A.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var i,r;this.audioBuffer=(i=t.tracks.audio)==null?void 0:i.buffer,this.videoBuffer=(r=t.tracks.video)==null?void 0:r.buffer}createData(){var e;return{v:1,sf:HR.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Ke(t,this.createData());const i=t.ot===$t.INIT||t.ot===$t.VIDEO||t.ot===$t.MUXED;this.starved&&i&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:r}=this;r&&(t=Object.keys(t).reduce((c,u)=>(r.includes(u)&&(c[u]=t[u]),c),{}));const a={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),CL(e.headers,t,a)):e.url=ML(e.url,t,a)}getNextFrag(e){var t;const i=(t=this.hls.levels[e.level])==null?void 0:t.details;if(i){const r=e.sn-i.startSN;return i.fragments[r+1]}}getNextPart(e){var t;const{index:i,fragment:r}=e,a=(t=this.hls.levels[r.level])==null||(t=t.details)==null?void 0:t.partList;if(a){const{sn:c}=r;for(let u=a.length-1;u>=0;u--){const f=a[u];if(f.index===i&&f.fragment.sn===c)return a[u+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return $t.TIMED_TEXT;if(e.sn==="initSegment")return $t.INIT;if(t==="audio")return $t.AUDIO;if(t==="main")return this.hls.audioTracks.length?$t.VIDEO:$t.MUXED}getTopBandwidth(e){let t=0,i;const r=this.hls;if(e===$t.AUDIO)i=r.audioTracks;else{const a=r.maxAutoLevel,c=a>-1?a+1:r.levels.length;i=r.levels.slice(0,c)}return i.forEach(a=>{a.bitrate>t&&(t=a.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,i=e===$t.AUDIO?this.audioBuffer:this.videoBuffer;return!i||!t?NaN:be.bufferInfo(i,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,i=e||this.config.loader;return class{constructor(a){this.loader=void 0,this.loader=new i(a)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(a,c,u){t(a),this.loader.load(a,c,u)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,i=e||this.config.loader;return class{constructor(a){this.loader=void 0,this.loader=new i(a)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(a,c,u){t(a),this.loader.load(a,c,u)}}}}const UL=3e5;class BL extends mi{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(i=>i!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:i}=t;i!==null&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:i}=t;if((i==null?void 0:i.action)===bt.SendAlternateToPenaltyBox&&i.flags===Wt.MoveAllAlternatesMatchingHost){const r=this.levels;let a=this._pathwayPriority,c=this.pathwayId;if(t.context){const{groupId:u,pathwayId:f,type:h}=t.context;u&&r?c=this.getPathwayForGroupId(u,h,c):f&&(c=f)}c in this.penalizedPathways||(this.penalizedPathways[c]=performance.now()),!a&&r&&(a=this.pathways()),a&&a.length>1&&(this.updatePathwayPriority(a),i.resolved=this.pathwayId!==c),t.details===H.BUFFER_APPEND_ERROR&&!t.fatal?i.resolved=!0:i.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${c} levels: ${r&&r.length} priorities: ${Xe(a)} penalized: ${Xe(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const i=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),t=this.getLevelsForPathway(i),this.pathwayId=i}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const i=this.penalizedPathways,r=performance.now();Object.keys(i).forEach(a=>{r-i[a]>UL&&delete i[a]});for(let a=0;a<e.length;a++){const c=e[a];if(c in i)continue;if(c===this.pathwayId)return;const u=this.hls.nextLoadLevel,f=this.hls.levels[u];if(t=this.getLevelsForPathway(c),t.length>0){this.log(`Setting Pathway to "${c}"`),this.pathwayId=c,ix(t),this.hls.trigger(A.LEVELS_UPDATED,{levels:t});const h=this.hls.levels[u];f&&h&&this.levels&&(h.attrs["STABLE-VARIANT-ID"]!==f.attrs["STABLE-VARIANT-ID"]&&h.bitrate!==f.bitrate&&this.log(`Unstable Pathways change from bitrate ${f.bitrate} to ${h.bitrate}`),this.hls.nextLoadLevel=u);break}}}getPathwayForGroupId(e,t,i){const r=this.getLevelsForPathway(i).concat(this.levels||[]);for(let a=0;a<r.length;a++)if(t===Ie.AUDIO_TRACK&&r[a].hasAudioGroup(e)||t===Ie.SUBTITLE_TRACK&&r[a].hasSubtitleGroup(e))return r[a].pathwayId;return i}clonePathways(e){const t=this.levels;if(!t)return;const i={},r={};e.forEach(a=>{const{ID:c,"BASE-ID":u,"URI-REPLACEMENT":f}=a;if(t.some(m=>m.pathwayId===c))return;const h=this.getLevelsForPathway(u).map(m=>{const p=new Je(m.attrs);p["PATHWAY-ID"]=c;const y=p.AUDIO&&`${p.AUDIO}_clone_${c}`,S=p.SUBTITLES&&`${p.SUBTITLES}_clone_${c}`;y&&(i[p.AUDIO]=y,p.AUDIO=y),S&&(r[p.SUBTITLES]=S,p.SUBTITLES=S);const E=Ux(m.uri,p["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",f),T=new Aa({attrs:p,audioCodec:m.audioCodec,bitrate:m.bitrate,height:m.height,name:m.name,url:E,videoCodec:m.videoCodec,width:m.width});if(m.audioGroups)for(let b=1;b<m.audioGroups.length;b++)T.addGroupId("audio",`${m.audioGroups[b]}_clone_${c}`);if(m.subtitleGroups)for(let b=1;b<m.subtitleGroups.length;b++)T.addGroupId("text",`${m.subtitleGroups[b]}_clone_${c}`);return T});t.push(...h),Op(this.audioTracks,i,f,c),Op(this.subtitleTracks,r,f,c)})}loadSteeringManifest(e){const t=this.hls.config,i=t.loader;this.loader&&this.loader.destroy(),this.loader=new i(t);let r;try{r=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(r.protocol!=="data:"){const m=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+m)}const a={responseType:"json",url:r.href},c=t.steeringManifestLoadPolicy.default,u=c.errorRetry||c.timeoutRetry||{},f={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:u.maxNumRetry||0,retryDelay:u.retryDelayMs||0,maxRetryDelay:u.maxRetryDelayMs||0},h={onSuccess:(m,p,y,S)=>{this.log(`Loaded steering manifest: "${r}"`);const E=m.data;if((E==null?void 0:E.VERSION)!==1){this.log(`Steering VERSION ${E.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=E.TTL;const{"RELOAD-URI":T,"PATHWAY-CLONES":b,"PATHWAY-PRIORITY":L}=E;if(T)try{this.uri=new self.URL(T,r).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${T}`);return}this.scheduleRefresh(this.uri||y.url),b&&this.clonePathways(b);const _={steeringManifest:E,url:r.toString()};this.hls.trigger(A.STEERING_MANIFEST_LOADED,_),L&&this.updatePathwayPriority(L)},onError:(m,p,y,S)=>{if(this.log(`Error loading steering manifest: ${m.code} ${m.text} (${p.url})`),this.stopLoad(),m.code===410){this.enabled=!1,this.log(`Steering manifest ${p.url} no longer available`);return}let E=this.timeToLoad*1e3;if(m.code===429){const T=this.loader;if(typeof(T==null?void 0:T.getResponseHeader)=="function"){const b=T.getResponseHeader("Retry-After");b&&(E=parseFloat(b)*1e3)}this.log(`Steering manifest ${p.url} rate limited`);return}this.scheduleRefresh(this.uri||p.url,E)},onTimeout:(m,p,y)=>{this.log(`Timeout loading steering manifest (${p.url})`),this.scheduleRefresh(this.uri||p.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(a,f,h)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var i;const r=(i=this.hls)==null?void 0:i.media;if(r&&!r.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function Op(l,e,t,i){l&&Object.keys(e).forEach(r=>{const a=l.filter(c=>c.groupId===r).map(c=>{const u=Ke({},c);return u.details=void 0,u.attrs=new Je(u.attrs),u.url=u.attrs.URI=Ux(c.url,c.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),u.groupId=u.attrs["GROUP-ID"]=e[r],u.attrs["PATHWAY-ID"]=i,u});l.push(...a)})}function Ux(l,e,t,i){const{HOST:r,PARAMS:a,[t]:c}=i;let u;e&&(u=c==null?void 0:c[e],u&&(l=u));const f=new self.URL(l);return r&&!u&&(f.host=r),a&&Object.keys(a).sort().forEach(h=>{h&&f.searchParams.set(h,a[h])}),f.href}class lr extends mi{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=lr.CDMCleanupPromise?[lr.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=t=>{const{initDataType:i,initData:r}=t,a=`"${t.type}" event: init data type: "${i}"`;if(this.debug(a),r!==null){if(!this.keyFormatPromise){let c=Object.keys(this.keySystemAccessPromises);c.length||(c=ya(this.config));const u=c.map(od).filter(f=>!!f);this.keyFormatPromise=this.getKeyFormatPromise(u)}this.keyFormatPromise.then(c=>{const u=go(c);if(i!=="sinf"||u!==et.FAIRPLAY){this.log(`Ignoring "${t.type}" event with init data type: "${i}" for selected key-system ${u}`);return}let f;try{const S=ft(new Uint8Array(r)),E=dh(JSON.parse(S).sinf),T=wy(E);if(!T)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");f=new Uint8Array(T.subarray(8,24))}catch(S){this.warn(`${a} Failed to parse sinf: ${S}`);return}const h=wt(f),{keyIdToKeySessionPromise:m,mediaKeySessions:p}=this;let y=m[h];for(let S=0;S<p.length;S++){const E=p[S],T=E.decryptdata;if(!T.keyId)continue;const b=wt(T.keyId);if(Do(f,T.keyId)||T.uri.replace(/-/g,"").indexOf(h)!==-1){if(y=m[b],!y)continue;if(T.pssh)break;delete m[b],T.pssh=new Uint8Array(r),T.keyId=f,y=m[h]=y.then(()=>this.generateRequestWithPreferredKeySession(E,i,r,"encrypted-event-key-match")),y.catch(L=>this.handleError(L));break}}y||this.handleError(new Error(`Key ID ${h} not encountered in playlist. Key-system sessions ${p.length}.`))}).catch(c=>this.handleError(c))}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(A.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(A.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(A.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(A.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(A.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(A.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(A.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(A.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:i}=this.config,r=t==null?void 0:t[e];if(r)return r.licenseUrl;if(e===et.WIDEVINE&&i)return i}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,i=t==null?void 0:t[e];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,i=(c,u,f)=>!!c&&f.indexOf(c)===u,r=t.map(c=>c.audioCodec).filter(i),a=t.map(c=>c.videoCodec).filter(i);return r.length+a.length===0&&a.push("avc1.42e01e"),new Promise((c,u)=>{const f=h=>{const m=h.shift();this.getMediaKeysPromise(m,r,a).then(p=>c({keySystem:m,mediaKeys:p})).catch(p=>{h.length?f(h):p instanceof Qt?u(p):u(new Qt({type:pe.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_ACCESS,error:p,fatal:!0},p.message))})};f(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:i}=this.config;if(typeof i!="function"){let r=`Configured requestMediaKeySystemAccess is not a function ${i}`;return qy===null&&self.location.protocol==="http:"&&(r=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(r))}return i(e,t)}getMediaKeysPromise(e,t,i){var r;const a=x1(e,t,i,this.config.drmSystemOptions||{});let c=this.keySystemAccessPromises[e],u=(r=c)==null?void 0:r.keySystemAccess;if(!u){this.log(`Requesting encrypted media "${e}" key-system access with config: ${Xe(a)}`),u=this.requestMediaKeySystemAccess(e,a);const f=c=this.keySystemAccessPromises[e]={keySystemAccess:u};return u.catch(h=>{this.log(`Failed to obtain access to key-system "${e}": ${h}`)}),u.then(h=>{this.log(`Access for key-system "${h.keySystem}" obtained`);const m=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const p=f.mediaKeys=h.createMediaKeys().then(y=>(this.log(`Media-keys created for "${e}"`),f.hasMediaKeys=!0,m.then(S=>S?this.setMediaKeysServerCertificate(y,e,S):y)));return p.catch(y=>{this.error(`Failed to create media-keys for "${e}"}: ${y}`)}),p})}return u.then(()=>c.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:i}){this.log(`Creating key-system session "${t}" keyId: ${wt(e.keyId||[])} keyUri: ${e.uri}`);const r=i.createSession(),a={decryptdata:e,keySystem:t,mediaKeys:i,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(a),a}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const i=this.createMediaKeySessionContext(e),r=so(t),a="cenc";this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(i,a,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,t){const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyId ${wt(e.decryptdata.keyId||[])}
      } (data length: ${t.byteLength})`),i.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>od(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:i})=>this.attemptSetMediaKeys(t,i))}selectKeySystem(e){return new Promise((t,i)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:r})=>{const a=od(r);a?t(a):i(new Error(`Unable to find format for key-system "${r}"`))}).catch(i)})}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=ya(this.config),i=e.map(go).filter(r=>!!r&&t.indexOf(r)!==-1);return this.selectKeySystem(i)}getKeyStatus(e){const{mediaKeySessions:t}=this;for(let i=0;i<t.length;i++){const r=FL(e,t[i]);if(r)return r}}loadKey(e){const t=e.keyInfo.decryptdata,i=so(t),r=this.bannedKeyIds[i];if(r||this.getKeyStatus(t)==="internal-error"){const u=Mp(r||"internal-error",t);return this.handleError(u,e.frag),Promise.reject(u)}const a=`(keyId: ${i} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${a}`);const c=this.keyIdToKeySessionPromise[i];if(!c){const u=this.getKeySystemForKeyPromise(t).then(({keySystem:f,mediaKeys:h})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${a}`),this.attemptSetMediaKeys(f,h).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:f,mediaKeys:h,decryptdata:t}))))).then(f=>{const h="cenc",m=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(f,h,m,"playlist-key")});return u.catch(f=>this.handleError(f,e.frag)),this.keyIdToKeySessionPromise[i]=u,u}return c.catch(u=>{if(u instanceof Qt){const f=je({},u.data);this.getKeyStatus(t)==="internal-error"&&(f.decryptdata=t);const h=new Qt(f,u.message);this.handleError(h,e.frag)}}),c}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,t){if(this.hls)if(e instanceof Qt){t&&(e.data.frag=t);const i=e.data.decryptdata;this.error(`${e.message}${i?` (${wt(i.keyId||[])})`:""}`),this.hls.trigger(A.ERROR,e.data)}else this.error(e.message),this.hls.trigger(A.ERROR,{type:pe.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const t=so(e),i=this.keyIdToKeySessionPromise[t];if(!i){const r=go(e.keyFormat),a=r?[r]:ya(this.config);return this.attemptKeySystemAccess(a)}return i}getKeySystemSelectionPromise(e){if(e.length||(e=ya(this.config)),e.length===0)throw new Qt({type:pe.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${Xe({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaKeys===t)return Promise.resolve();const i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const r=Promise.all(i).then(()=>{if(!this.media)throw this.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.mediaKeys=t,this.setMediaKeysQueue.push(r),r.then(()=>{this.log(`Media-keys set for "${e}"`),i.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(a=>i.indexOf(a)===-1)})}generateRequestWithPreferredKeySession(e,t,i,r){var a;const c=(a=this.config.drmSystems)==null||(a=a[e.keySystem])==null?void 0:a.generateRequest;if(c)try{const E=c.call(this.hls,t,i,e);if(!E)throw new Error("Invalid response from configured generateRequest filter");t=E.initDataType,i=E.initData?E.initData:null,e.decryptdata.pssh=i?new Uint8Array(i):null}catch(E){if(this.warn(E.message),this.hls&&this.hls.config.debug)throw E}if(i===null)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(e);const u=so(e.decryptdata),f=e.decryptdata.uri;this.log(`Generating key-session request for "${r}" keyId: ${u} URI: ${f} (init data type: ${t} length: ${i.byteLength})`);const h=new fh,m=e._onmessage=E=>{const T=e.mediaKeysSession;if(!T){h.emit("error",new Error("invalid state"));return}const{messageType:b,message:L}=E;this.log(`"${b}" message event for session "${T.sessionId}" message size: ${L.byteLength}`),b==="license-request"||b==="license-renewal"?this.renewLicense(e,L).catch(_=>{h.eventNames().length?h.emit("error",_):this.handleError(_)}):b==="license-release"?e.keySystem===et.FAIRPLAY&&this.updateKeySession(e,Pd("acknowledged")).then(()=>this.removeSession(e)).catch(_=>this.handleError(_)):this.warn(`unhandled media key message type "${b}"`)},p=(E,T)=>{T.keyStatus=E;let b;E.startsWith("usable")?h.emit("resolved"):E==="internal-error"||E==="output-restricted"||E==="output-downscaled"?b=Mp(E,T.decryptdata):E==="expired"?b=new Error(`key expired (keyId: ${u})`):E==="released"?b=new Error("key released"):E==="status-pending"||this.warn(`unhandled key status change "${E}" (keyId: ${u})`),b&&(h.eventNames().length?h.emit("error",b):this.handleError(b))},y=e._onkeystatuseschange=E=>{if(!e.mediaKeysSession){h.emit("error",new Error("invalid state"));return}const b=this.getKeyStatuses(e);if(!Object.keys(b).some(C=>b[C]!=="status-pending"))return;if(b[u]==="expired"){this.log(`Expired key ${Xe(b)} in key-session "${e.mediaKeysSession.sessionId}"`),this.renewKeySession(e);return}let _=b[u];if(_)p(_,e);else{var I;e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(I=e.keyStatusTimeouts)[u]||(I[u]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const N=this.getKeyStatus(e.decryptdata);if(N&&N!=="status-pending")return this.log(`No status for keyId ${u} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${N} from other session.`),p(N,e);this.log(`key status for ${u} in key-session "${e.mediaKeysSession.sessionId}" timed out after 1000ms`),_="internal-error",p(_,e)},1e3)),this.log(`No status for keyId ${u} (${Xe(b)}).`)}};Nt(e.mediaKeysSession,"message",m),Nt(e.mediaKeysSession,"keystatuseschange",y);const S=new Promise((E,T)=>{h.on("error",T),h.on("resolved",E)});return e.mediaKeysSession.generateRequest(t,i).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${u} URI: ${f}`)}).catch(E=>{throw new Qt({type:pe.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_SESSION,error:E,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${E}`)}).then(()=>S).catch(E=>(h.removeAllListeners(),this.removeSession(e).then(()=>{throw E}))).then(()=>(h.removeAllListeners(),e))}getKeyStatuses(e){const t={};return e.mediaKeysSession.keyStatuses.forEach((i,r)=>{if(typeof r=="string"&&typeof i=="object"){const u=r;r=i,i=u}const a="buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r);e.keySystem===et.PLAYREADY&&a.length===16&&zy(a);const c=wt(a);i==="internal-error"&&(this.bannedKeyIds[c]=i),this.log(`key status change "${i}" for keyStatuses keyId: ${c} key-session "${e.mediaKeysSession.sessionId}"`),t[c]=i}),t}fetchServerCertificate(e){const t=this.config,i=t.loader,r=new i(t),a=this.getServerCertificateUrl(e);return a?(this.log(`Fetching server certificate for "${e}"`),new Promise((c,u)=>{const f={responseType:"arraybuffer",url:a},h=t.certLoadPolicy.default,m={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(y,S,E,T)=>{c(y.data)},onError:(y,S,E,T)=>{u(new Qt({type:pe.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:E,response:je({url:f.url,data:void 0},y)},`"${e}" certificate request failed (${a}). Status: ${y.code} (${y.text})`))},onTimeout:(y,S,E)=>{u(new Qt({type:pe.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:E,response:{url:f.url,data:void 0}},`"${e}" certificate request timed out (${a})`))},onAbort:(y,S,E)=>{u(new Error("aborted"))}};r.load(f,m,p)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,i){return new Promise((r,a)=>{e.setServerCertificate(i).then(c=>{this.log(`setServerCertificate ${c?"success":"not supported by CDM"} (${i.byteLength}) on "${t}"`),r(e)}).catch(c=>{a(new Qt({type:pe.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:c,fatal:!0},c.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(i=>this.updateKeySession(e,new Uint8Array(i)).catch(r=>{throw new Qt({type:pe.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:r,fatal:!1},r.message)}))}unpackPlayReadyKeyMessage(e,t){const i=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!i.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const r=new DOMParser().parseFromString(i,"application/xml"),a=r.querySelectorAll("HttpHeader");if(a.length>0){let m;for(let p=0,y=a.length;p<y;p++){var c,u;m=a[p];const S=(c=m.querySelector("name"))==null?void 0:c.textContent,E=(u=m.querySelector("value"))==null?void 0:u.textContent;S&&E&&e.setRequestHeader(S,E)}}const f=r.querySelector("Challenge"),h=f==null?void 0:f.textContent;if(!h)throw new Error("Cannot find <Challenge> in key message");return Pd(atob(h))}setupLicenseXHR(e,t,i,r){const a=this.config.licenseXhrSetup;return a?Promise.resolve().then(()=>{if(!i.decryptdata)throw new Error("Key removed");return a.call(this.hls,e,t,i,r)}).catch(c=>{if(!i.decryptdata)throw c;return e.open("POST",t,!0),a.call(this.hls,e,t,i,r)}).then(c=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:c||r})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:r}))}requestLicense(e,t){const i=this.config.keyLoadPolicy.default;return new Promise((r,a)=>{const c=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${c}`);const u=new XMLHttpRequest;u.responseType="arraybuffer",u.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return a(new Error("invalid state"));if(u.readyState===4)if(u.status===200){this._requestLicenseFailureCount=0;let f=u.response;this.log(`License received ${f instanceof ArrayBuffer?f.byteLength:f}`);const h=this.config.licenseResponseCallback;if(h)try{f=h.call(this.hls,u,c,e)}catch(m){this.error(m)}r(f)}else{const f=i.errorRetry,h=f?f.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>h||u.status>=400&&u.status<500)a(new Qt({type:pe.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:u,response:{url:c,data:void 0,code:u.status,text:u.statusText}},`License Request XHR failed (${c}). Status: ${u.status} (${u.statusText})`));else{const m=h-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${m} attempts left`),this.requestLicense(e,t).then(r,a)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=u,this.setupLicenseXHR(u,c,e,t).then(({xhr:f,licenseChallenge:h})=>{e.keySystem==et.PLAYREADY&&(h=this.unpackPlayReadyKeyMessage(f,h)),f.send(h)}).catch(a)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const i=t.media;this.media=i,Nt(i,"encrypted",this.onMediaEncrypted),Nt(i,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(Gt(e,"encrypted",this.onMediaEncrypted),Gt(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={},!this.mediaKeys&&!this.mediaKeySessions.length)return;const t=this.media,i=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,dn.clearKeyUriToKeyIdMap();const r=i.length;lr.CDMCleanupPromise=Promise.all(i.map(a=>this.removeSession(a)).concat((t==null||(e=t.setMediaKeys(null))==null?void 0:e.catch(a=>{this.log(`Could not clear media keys: ${a}`),this.hls&&this.hls.trigger(A.ERROR,{type:pe.OTHER_ERROR,details:H.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${a}`)})}))||Promise.resolve())).catch(a=>{this.log(`Could not close sessions and clear media keys: ${a}`),this.hls&&this.hls.trigger(A.ERROR,{type:pe.OTHER_ERROR,details:H.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${a}`)})}).then(()=>{r&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this.keyFormatPromise=null,this.bannedKeyIds={}}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const i=t.reduce((r,a)=>(r.indexOf(a.keyFormat)===-1&&r.push(a.keyFormat),r),[]);this.log(`Selecting key-system from session-keys ${i.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(i)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:i,decryptdata:r}=e;if(t){this.log(`Remove licenses and keys and close session "${t.sessionId}" keyId: ${wt((r==null?void 0:r.keyId)||[])}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const a=this.mediaKeySessions.indexOf(e);a>-1&&this.mediaKeySessions.splice(a,1);const{keyStatusTimeouts:c}=e;c&&Object.keys(c).forEach(h=>self.clearTimeout(c[h]));const{drmSystemOptions:u}=this.config;return(E1(u)?new Promise((h,m)=>{self.setTimeout(()=>m(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(h).catch(m)}):Promise.resolve()).catch(h=>{this.log(`Could not remove session: ${h}`),this.hls&&this.hls.trigger(A.ERROR,{type:pe.OTHER_ERROR,details:H.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${h}`)})}).then(()=>t.close()).catch(h=>{this.log(`Could not close session: ${h}`),this.hls&&this.hls.trigger(A.ERROR,{type:pe.OTHER_ERROR,details:H.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${h}`)})})}return Promise.resolve()}}lr.CDMCleanupPromise=void 0;function so(l){if(!l)throw new Error("Could not read keyId of undefined decryptdata");if(l.keyId===null)throw new Error("keyId is null");return wt(l.keyId)}function FL(l,e){if(l.keyId&&e.mediaKeysSession.keyStatuses.has(l.keyId))return e.mediaKeysSession.keyStatuses.get(l.keyId);if(l.matches(e.decryptdata))return e.keyStatus}class Qt extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}function Mp(l,e){const t=l==="output-restricted",i=t?H.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:H.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new Qt({type:pe.KEY_SYSTEM_ERROR,details:i,fatal:!1,decryptdata:e},t?"HDCP level output restricted":`key status changed to "${l}"`)}class jL{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(A.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(A.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const i=this.hls.config;if(i.capLevelOnFPSDrop){const r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&typeof r.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,i){const r=performance.now();if(t){if(this.lastTime){const a=r-this.lastTime,c=i-this.lastDroppedFrames,u=t-this.lastDecodedFrames,f=1e3*c/a,h=this.hls;if(h.trigger(A.FPS_DROP,{currentDropped:c,currentDecoded:u,totalDroppedFrames:i}),f>0&&c>h.config.fpsDroppedMonitoringThreshold*u){let m=h.currentLevel;h.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+m),m>0&&(h.autoLevelCapping===-1||h.autoLevelCapping>=m)&&(m=m-1,h.trigger(A.FPS_DROP_LEVEL_CAPPING,{level:m,droppedLevel:h.currentLevel}),h.autoLevelCapping=m,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=i,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function Bx(l,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=l,e.dispatchEvent(t)}function Fx(l,e){const t=l.mode;if(t==="disabled"&&(l.mode="hidden"),l.cues&&!l.cues.getCueById(e.id))try{if(l.addCue(e),!l.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(i){$e.debug(`[texttrack-utils]: ${i}`);try{const r=new self.TextTrackCue(e.startTime,e.endTime,e.text);r.id=e.id,l.addCue(r)}catch(r){$e.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}t==="disabled"&&(l.mode=t)}function nr(l,e){const t=l.mode;if(t==="disabled"&&(l.mode="hidden"),l.cues)for(let i=l.cues.length;i--;)e&&l.cues[i].removeEventListener("enter",e),l.removeCue(l.cues[i]);t==="disabled"&&(l.mode=t)}function Kd(l,e,t,i){const r=l.mode;if(r==="disabled"&&(l.mode="hidden"),l.cues&&l.cues.length>0){const a=GL(l.cues,e,t);for(let c=0;c<a.length;c++)(!i||i(a[c]))&&l.removeCue(a[c])}r==="disabled"&&(l.mode=r)}function $L(l,e){if(e<=l[0].startTime)return 0;const t=l.length-1;if(e>l[t].endTime)return-1;let i=0,r=t,a;for(;i<=r;)if(a=Math.floor((r+i)/2),e<l[a].startTime)r=a-1;else if(e>l[a].startTime&&i<t)i=a+1;else return a;return l[i].startTime-e<e-l[r].startTime?i:r}function GL(l,e,t){const i=[],r=$L(l,e);if(r>-1)for(let a=r,c=l.length;a<c;a++){const u=l[a];if(u.startTime>=e&&u.endTime<=t)i.push(u);else if(u.startTime>t)return i}return i}function vo(l){const e=[];for(let t=0;t<l.length;t++){const i=l[t];(i.kind==="subtitles"||i.kind==="captions")&&i.label&&e.push(l[t])}return e}class HL extends Eh{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const i=vo(this.media.textTracks);for(let a=0;a<i.length;a++)if(i[a].mode==="hidden")t=i[a];else if(i[a].mode==="showing"){t=i[a];break}const r=this.findTrackForTextTrack(t);this.subtitleTrack!==r&&this.setSubtitleTrack(r)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.LEVEL_LOADING,this.onLevelLoading,this),e.on(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(A.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(A.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.LEVEL_LOADING,this.onLevelLoading,this),e.off(A.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(A.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(A.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const i=this.media;if(!i)return;const r=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||i.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,r)return;vo(i.textTracks).forEach(c=>{nr(c)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:i,groupId:r,details:a}=t,c=this.tracksInGroup[i];if(!c||c.groupId!==r){this.warn(`Subtitle track with id:${i} and group:${r} not found in active group ${c==null?void 0:c.groupId}`);return}const u=c.details;c.details=t.details,this.log(`Subtitle track ${i} "${c.name}" lang:${c.lang} group:${r} loaded [${a.startSN}-${a.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,u)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const i=t.subtitleGroups||null,r=this.groupIds;let a=this.currentTrack;if(!i||(r==null?void 0:r.length)!==(i==null?void 0:i.length)||i!=null&&i.some(c=>(r==null?void 0:r.indexOf(c))===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const c=this.tracks.filter(m=>!i||i.indexOf(m.groupId)!==-1);if(c.length)this.selectDefaultTrack&&!c.some(m=>m.default)&&(this.selectDefaultTrack=!1),c.forEach((m,p)=>{m.id=p});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=c;const u=this.hls.config.subtitlePreference;if(!a&&u){this.selectDefaultTrack=!1;const m=ki(u,c);if(m>-1)a=c[m];else{const p=ki(u,this.tracks);a=this.tracks[p]}}let f=this.findTrackId(a);f===-1&&a&&(f=this.findTrackId(null));const h={subtitleTracks:c};this.log(`Updating subtitle tracks, ${c.length} track(s) found in "${i==null?void 0:i.join(",")}" group-id`),this.hls.trigger(A.SUBTITLE_TRACKS_UPDATED,h),f!==-1&&this.trackId===-1&&this.setSubtitleTrack(f)}}findTrackId(e){const t=this.tracksInGroup,i=this.selectDefaultTrack;for(let r=0;r<t.length;r++){const a=t[r];if(!(i&&!a.default||!i&&!e)&&(!e||un(a,e)))return r}if(e){for(let r=0;r<t.length;r++){const a=t[r];if(Da(e.attrs,a.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r}for(let r=0;r<t.length;r++){const a=t[r];if(Da(e.attrs,a.attrs,["LANGUAGE"]))return r}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const r=t[i];if($d(r,e))return i}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Ie.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const i=this.currentTrack;if(i&&un(e,i))return i;const r=ki(e,this.tracksInGroup);if(r>-1){const a=this.tracksInGroup[r];return this.setSubtitleTrack(r),a}else{if(i)return null;{const a=ki(e,t);if(a>-1)return t[a]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const i=e.id,r=e.groupId,a=this.getUrlWithDirectives(e.url,t),c=e.details,u=c==null?void 0:c.age;this.log(`Loading subtitle ${i} "${e.name}" lang:${e.lang} group:${r}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${u&&c.live?" age "+u.toFixed(1)+(c.type&&" "+c.type||""):""} ${a}`),this.hls.trigger(A.SUBTITLE_TRACK_LOADING,{url:a,id:i,groupId:r,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=vo(e.textTracks),i=this.currentTrack;let r;if(i&&(r=t.filter(a=>$d(i,a))[0],r||this.warn(`Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`)),[].slice.call(t).forEach(a=>{a.mode!=="disabled"&&a!==r&&(a.mode="disabled")}),r){const a=this.subtitleDisplay?"showing":"hidden";r.mode!==a&&(r.mode=a)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!de(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const i=this.currentTrack,r=t[e]||null;if(this.trackId=e,this.currentTrack=r,this.toggleTrackModes(),!r){this.hls.trigger(A.SUBTITLE_TRACK_SWITCH,{id:e});return}const a=!!r.details&&!r.details.live;if(e===this.trackId&&r===i&&a)return;this.log(`Switching to subtitle-track ${e}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));const{id:c,groupId:u="",name:f,type:h,url:m}=r;this.hls.trigger(A.SUBTITLE_TRACK_SWITCH,{id:c,groupId:u,name:f,type:h,url:m});const p=this.switchParams(r.url,i==null?void 0:i.details,r.details);this.loadPlaylist(p)}}function VL(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const a=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(r=="x"?a:a&3|8).toString(16)})}}}function Ea(l){let e=5381,t=l.length;for(;t;)e=e*33^l.charCodeAt(--t);return(e>>>0).toString()}const or=.025;let No=function(l){return l[l.Point=0]="Point",l[l.Range=1]="Range",l}({});function KL(l,e,t){return`${l.identifier}-${t+1}-${Ea(e)}`}class zL{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const i=this.playoutLimit;return e<=0||isNaN(i)?!1:i===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>i}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return yd(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,i=yd(t,e);return t-i<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=de(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return yd(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<or))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?No.Range:No.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return YL(this)}}function yd(l,e){return l-e.start<e.duration/2&&!(Math.abs(l-(e.start+e.duration))<or)?e.start:e.start+e.duration}function jx(l,e,t){const i=new self.URL(l,t);return i.protocol!=="data:"&&i.searchParams.set("_HLS_primary_id",e),i}function xd(l,e){for(;(t=l.assetList[++e])!=null&&t.error;)var t;return e}function YL(l){return`["${l.identifier}" ${l.cue.pre?"<pre>":l.cue.post?"<post>":""}${l.timelineStart.toFixed(2)}-${l.resumeTime.toFixed(2)}]`}function sr(l){const e=l.timelineStart,t=l.duration||0;return`["${l.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class qL{constructor(e,t,i,r){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(A.PLAYOUT_LIMIT_REACHED,{})};const a=this.hls=new e(t);this.interstitial=i,this.assetItem=r;const c=()=>{this.hasDetails=!0};a.once(A.LEVEL_LOADED,c),a.once(A.AUDIO_TRACK_LOADED,c),a.once(A.SUBTITLE_TRACK_LOADED,c),a.on(A.MEDIA_ATTACHING,(u,{media:f})=>{this.removeMediaListeners(),this.mediaAttached=f,this.interstitial.playoutLimit&&(f.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&a.on(A.BUFFER_APPENDED,()=>{const m=this.bufferedEnd;this.reachedPlayout(m)&&(this._bufferedEosTime=m,a.trigger(A.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let t=this.assetItem.uri;try{t=jx(t,e.config.primarySessionId||"").href}catch{}e.loadSource(t)}}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e)return!1;const i=Math.min(this._bufferedEosTime||1/0,this.duration),r=this.timelineOffset,a=be.bufferInfo(e,r,0);return this.getAssetTime(a.end)>=i-.02}reachedPlayout(e){const i=this.interstitial.playoutLimit;return this.startOffset+e>=i}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=be.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const t=this.interstitial.playoutLimit;if(t){const i=t-this.startOffset;if(i>0&&i<e)return i}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const i=e-t;if(Math.abs(i)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,i=this.duration;return Math.min(Math.max(0,e-t),i)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var t;this.loadSource(),(t=this.hls)==null||t.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const t=i=>delete i.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,i){var r;(r=this.hls)==null||r.on(e,t)}once(e,t,i){var r;(r=this.hls)==null||r.once(e,t)}off(e,t,i){var r;(r=this.hls)==null||r.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${sr(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const Pp=.033;class XL extends mi{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((i,r)=>e<=r.startOffset&&t>r.startOffset?(delete r.error,i+1):i,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let i=-1;e.nextEvent?i=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(i=this.findEventIndex(e.previousEvent.identifier)+1);const r=this.items;if(r)for(r[i]||(t===void 0&&(t=e.start),i=this.findItemIndexAtTime(t));i>=0&&(a=r[i])!=null&&a.event;){var a;i--}return i}findItemIndexAtTime(e,t){const i=this.items;if(i)for(let r=0;r<i.length;r++){let a=i[r];if(t&&t!=="primary"&&(a=a[t]),e===a.start||e>a.start&&e<a.end)return r}return-1}findJumpRestrictedIndex(e,t){const i=this.items;if(i)for(let r=e;r<=t&&i[r];r++){const a=i[r].event;if(a!=null&&a.restrictions.jump&&!a.appendInPlace)return r}return-1}findEventIndex(e){const t=this.items;if(t)for(let r=t.length;r--;){var i;if(((i=t[r].event)==null?void 0:i.identifier)===e)return r}return-1}findAssetIndex(e,t){const i=e.assetList,r=i.length;if(r>1)for(let a=0;a<r;a++){const c=i[a];if(!c.error){const u=c.timelineStart;if(t===u||t>u&&(t<u+(c.duration||0)||a===r-1))return a}}return 0}get assetIdAtEnd(){var e;const t=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(t){const i=t.assetList,r=i[i.length-1];if(r)return r.identifier}return null}parseInterstitialDateRanges(e,t){const i=e.main.details,{dateRanges:r}=i,a=this.events,c=this.parseDateRanges(r,{url:i.url},t),u=Object.keys(r),f=a?a.filter(h=>!u.includes(h.identifier)):[];c.length&&c.sort((h,m)=>{const p=h.cue.pre,y=h.cue.post,S=m.cue.pre,E=m.cue.post;if(p&&!S)return-1;if(S&&!p||y&&!E)return 1;if(E&&!y)return-1;if(!p&&!S&&!y&&!E){const T=h.startTime,b=m.startTime;if(T!==b)return T-b}return h.dateRange.tagOrder-m.dateRange.tagOrder}),this.events=c,f.forEach(h=>{this.removeEvent(h)}),this.updateSchedule(e,f)}updateSchedule(e,t=[],i=!1){const r=this.events||[];if(r.length||t.length||this.length<2){const a=this.items,c=this.parseSchedule(r,e);(i||t.length||(a==null?void 0:a.length)!==c.length||c.some((f,h)=>Math.abs(f.playout.start-a[h].playout.start)>.005||Math.abs(f.playout.end-a[h].playout.end)>.005))&&(this.items=c,this.onScheduleUpdate(t,a))}}parseDateRanges(e,t,i){const r=[],a=Object.keys(e);for(let c=0;c<a.length;c++){const u=a[c],f=e[u];if(f.isInterstitial){let h=this.eventMap[u];h?h.setDateRange(f):(h=new zL(f,t),this.eventMap[u]=h,i===!1&&(h.appendInPlace=i)),r.push(h)}}return r}parseSchedule(e,t){const i=[],r=t.main.details,a=r.live?1/0:r.edge;let c=0;if(e=e.filter(f=>!f.error&&!(f.cue.once&&f.hasPlayed)),e.length){this.resolveOffsets(e,t);let f=0,h=0;if(e.forEach((m,p)=>{const y=m.cue.pre,S=m.cue.post,E=e[p-1]||null,T=m.appendInPlace,b=S?a:m.startOffset,L=m.duration,_=m.timelineOccupancy===No.Range?L:0,I=m.resumptionOffset,C=(E==null?void 0:E.startTime)===b,N=b+m.cumulativeDuration;let K=T?N+L:b+I;if(y||!S&&b<=0){const j=h;h+=_,m.timelineStart=N;const B=c;c+=L,i.push({event:m,start:N,end:K,playout:{start:B,end:c},integrated:{start:j,end:h}})}else if(b<=a){if(!C){const U=b-f;if(U>Pp){const W=f,re=h;h+=U;const ue=c;c+=U;const fe={previousEvent:e[p-1]||null,nextEvent:m,start:W,end:W+U,playout:{start:ue,end:c},integrated:{start:re,end:h}};i.push(fe)}else U>0&&E&&(E.cumulativeDuration+=U,i[i.length-1].end=b)}S&&(K=N),m.timelineStart=N;const j=h;h+=_;const B=c;c+=L,i.push({event:m,start:N,end:K,playout:{start:B,end:c},integrated:{start:j,end:h}})}else return;const O=m.resumeTime;S||O>a?f=a:f=O}),f<a){var u;const m=f,p=h,y=a-f;h+=y;const S=c;c+=y,i.push({previousEvent:((u=i[i.length-1])==null?void 0:u.event)||null,nextEvent:null,start:f,end:m+y,playout:{start:S,end:c},integrated:{start:p,end:h}})}this.setDurations(a,c,h)}else i.push({previousEvent:null,nextEvent:null,start:0,end:a,playout:{start:0,end:a},integrated:{start:0,end:a}}),this.setDurations(a,a,a);return i}setDurations(e,t,i){this.durations={primary:e,playout:t,integrated:i}}resolveOffsets(e,t){const i=t.main.details,r=i.live?1/0:i.edge;let a=0,c=-1;e.forEach((u,f)=>{const h=u.cue.pre,m=u.cue.post,p=h?0:m?r:u.startTime;this.updateAssetDurations(u),c===p?u.cumulativeDuration=a:(a=0,c=p),!m&&u.snapOptions.in&&(u.resumeAnchor=hn(null,i.fragments,u.startOffset+u.resumptionOffset,0,0)||void 0),u.appendInPlace&&!u.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(u,t)||(u.appendInPlace=!1)),!u.appendInPlace&&f+1<e.length&&e[f+1].startTime-e[f].resumeTime<Pp&&(e[f+1].appendInPlace=!1,e[f+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${u}`));const S=de(u.resumeOffset)?u.resumeOffset:u.duration;a+=S})}primaryCanResumeInPlaceAt(e,t){const i=e.resumeTime,r=e.startTime+e.resumptionOffset;return Math.abs(i-r)>or?(this.log(`"${e.identifier}" resumption ${i} not aligned with estimated timeline end ${r}`),!1):!Object.keys(t).some(c=>{const u=t[c].details,f=u.edge;if(i>=f)return this.log(`"${e.identifier}" resumption ${i} past ${c} playlist end ${f}`),!1;const h=hn(null,u.fragments,i);if(!h)return this.log(`"${e.identifier}" resumption ${i} does not align with any fragments in ${c} playlist (${u.fragStart}-${u.fragmentEnd})`),!0;const m=c==="audio"?.175:0;return Math.abs(h.start-i)<or+m||Math.abs(h.end-i)<or+m?!1:(this.log(`"${e.identifier}" resumption ${i} not aligned with ${c} fragment bounds (${h.start}-${h.end} sn: ${h.sn} cc: ${h.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let i=0,r=!1,a=!1;for(let c=0;c<e.assetList.length;c++){const u=e.assetList[c],f=t+i;u.startOffset=i,u.timelineStart=f,r||(r=u.duration===null),a||(a=!!u.error);const h=u.error?0:u.duration||0;i+=h}r&&!a?e.duration=Math.max(i,e.duration):e.duration=i}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function Ei(l){return`[${l.event?'"'+l.event.identifier+'"':"primary"}: ${l.start.toFixed(2)}-${l.end.toFixed(2)}]`}class QL{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const i=e.assetListUrl;let r;try{r=jx(i,this.hls.sessionId,e.baseUrl)}catch(y){const S=this.assignAssetListError(e,H.ASSET_LIST_LOAD_ERROR,y,i);this.hls.trigger(A.ERROR,S);return}t&&r.protocol!=="data:"&&r.searchParams.set("_HLS_start_offset",""+t);const a=this.hls.config,c=a.loader,u=new c(a),f={responseType:"json",url:r.href},h=a.interstitialAssetListLoadPolicy.default,m={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(y,S,E,T)=>{const b=y.data,L=b==null?void 0:b.ASSETS;if(!Array.isArray(L)){const _=this.assignAssetListError(e,H.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),E.url,S,T);this.hls.trigger(A.ERROR,_);return}e.assetListResponse=b,this.hls.trigger(A.ASSET_LIST_LOADED,{event:e,assetListResponse:b,networkDetails:T})},onError:(y,S,E,T)=>{const b=this.assignAssetListError(e,H.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${y.code} ${y.text} (${S.url})`),S.url,T,E);this.hls.trigger(A.ERROR,b)},onTimeout:(y,S,E)=>{const T=this.assignAssetListError(e,H.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${S.url})`),S.url,y,E);this.hls.trigger(A.ERROR,T)}};return u.load(f,m,p),this.hls.trigger(A.ASSET_LIST_LOADING,{event:e}),u}assignAssetListError(e,t,i,r,a,c){return e.error=i,{type:pe.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:r,error:i,networkDetails:c,stats:a}}}function Up(l){l==null||l.play().catch(()=>{})}function no(l,e){return`[${l}] Advancing timeline position to ${e}`}class WL extends mi{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const i=this.currentTime;if(i===void 0||this.playbackDisabled||!this.schedule)return;const r=i-this.timelinePos;if(Math.abs(r)<1/7056e5)return;const c=r<=-.01;this.timelinePos=i,this.bufferedPos=i;const u=this.playingItem;if(!u){this.checkBuffer();return}if(c&&this.schedule.resetErrorsInRange(i,i-r)&&this.updateSchedule(!0),this.checkBuffer(),c&&i<u.start||i>=u.end){var f;const S=this.findItemIndex(u);let E=this.schedule.findItemIndexAtTime(i);if(E===-1&&(E=S+(c?-1:1),this.log(`seeked ${c?"back ":""}to position not covered by schedule ${i} (resolving from ${S} to ${E})`)),!this.isInterstitial(u)&&(f=this.media)!=null&&f.paused&&(this.shouldPlay=!1),!c&&E>S){const T=this.schedule.findJumpRestrictedIndex(S+1,E);if(T>S){this.setSchedulePosition(T);return}}this.setSchedulePosition(E);return}const h=this.playingAsset;if(!h){if(this.playingLastItem&&this.isInterstitial(u)){const S=u.event.assetList[0];S&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(i,S))}return}const m=h.timelineStart,p=h.duration||0;if(c&&i<m||i>=m+p){var y;(y=u.event)!=null&&y.appendInPlace&&(this.clearInterstitial(u.event,u),this.flushFrontBuffer(i)),this.setScheduleToAssetAtTime(i,h)}},this.onTimeupdate=()=>{const i=this.currentTime;if(i===void 0||this.playbackDisabled)return;if(i>this.timelinePos)this.timelinePos=i,i>this.bufferedPos&&this.checkBuffer();else return;const r=this.playingItem;if(!r||this.playingLastItem)return;if(i>=r.end){this.timelinePos=r.end;const u=this.findItemIndex(r);this.setSchedulePosition(u+1)}const a=this.playingAsset;if(!a)return;const c=a.timelineStart+(a.duration||0);i>=c&&this.setScheduleToAssetAtTime(i,a)},this.onScheduleUpdate=(i,r)=>{const a=this.schedule;if(!a)return;const c=this.playingItem,u=a.events||[],f=a.items||[],h=a.durations,m=i.map(T=>T.identifier),p=!!(u.length||m.length);(p||r)&&this.log(`INTERSTITIALS_UPDATED (${u.length}): ${u}
Schedule: ${f.map(T=>Ei(T))} pos: ${this.timelinePos}`),m.length&&this.log(`Removed events ${m}`);let y=null,S=null;c&&(y=this.updateItem(c,this.timelinePos),this.itemsMatch(c,y)?this.playingItem=y:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const E=this.bufferingItem;if(E&&(S=this.updateItem(E,this.bufferedPos),this.itemsMatch(E,S)?this.bufferingItem=S:E.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(E.event,null))),i.forEach(T=>{T.assetList.forEach(b=>{this.clearAssetPlayer(b.identifier,null)})}),this.playerQueue.forEach(T=>{if(T.interstitial.appendInPlace){const b=T.assetItem.timelineStart,L=T.timelineOffset-b;if(L)try{T.timelineOffset=b}catch(_){Math.abs(L)>or&&this.warn(`${_} ("${T.assetId}" ${T.timelineOffset}->${b})`)}}}),p||r){if(this.hls.trigger(A.INTERSTITIALS_UPDATED,{events:u.slice(0),schedule:f.slice(0),durations:h,removedIds:m}),this.isInterstitial(c)&&m.includes(c.event.identifier)){this.warn(`Interstitial "${c.event.identifier}" removed while playing`),this.primaryFallback(c.event);return}c&&this.trimInPlace(y,c),E&&S!==y&&this.trimInPlace(S,E),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new QL(e),this.schedule=new XL(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(A.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(A.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(A.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(A.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(A.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(A.BUFFER_APPENDED,this.onBufferAppended,this),e.on(A.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(A.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(A.MEDIA_ENDED,this.onMediaEnded,this),e.on(A.ERROR,this.onError,this),e.on(A.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(A.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(A.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(A.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(A.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(A.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(A.BUFFER_CODECS,this.onBufferCodecs,this),e.off(A.BUFFER_APPENDED,this.onBufferAppended,this),e.off(A.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(A.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(A.MEDIA_ENDED,this.onMediaEnded,this),e.off(A.ERROR,this.onError,this),e.off(A.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){Gt(e,"play",this.onPlay),Gt(e,"pause",this.onPause),Gt(e,"seeking",this.onSeeking),Gt(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const i=this.media=t.media;Nt(i,"seeking",this.onSeeking),Nt(i,"timeupdate",this.onTimeupdate),Nt(i,"play",this.onPlay),Nt(i,"pause",this.onPause)}onMediaAttached(e,t){const i=this.effectivePlayingItem,r=this.detachedData;if(this.detachedData=null,i===null)this.checkStart();else if(!r){this.clearScheduleState();const a=this.findItemIndex(i);this.setSchedulePosition(a)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const i=!!t.transferMedia,r=this.media;if(this.media=null,!i&&(r&&this.removeMediaListeners(r),this.detachedData)){const a=this.getBufferingPlayer();a&&(this.log(`Removing schedule state for detachedData and ${a}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,a.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,t=()=>e.bufferingItem||e.waitingItem,i=p=>p&&e.getAssetPlayer(p.identifier),r=(p,y,S,E,T)=>{if(p){let b=p[y].start;const L=p.event;if(L){if(y==="playout"||L.timelineOccupancy!==No.Point){const _=i(S);(_==null?void 0:_.interstitial)===L&&(b+=_.assetItem.startOffset+_[T])}}else{const _=E==="bufferedPos"?c():e[E];b+=_-p.start}return b}return 0},a=(p,y)=>{var S;if(p!==0&&y!=="primary"&&(S=e.schedule)!=null&&S.length){var E;const T=e.schedule.findItemIndexAtTime(p),b=(E=e.schedule.items)==null?void 0:E[T];if(b){const L=b[y].start-b.start;return p+L}}return p},c=()=>{const p=e.bufferedPos;return p===Number.MAX_VALUE?u("primary"):Math.max(p,0)},u=p=>{var y,S;return(y=e.primaryDetails)!=null&&y.live?e.primaryDetails.edge:((S=e.schedule)==null?void 0:S.durations[p])||0},f=(p,y)=>{var S,E;const T=e.effectivePlayingItem;if(T!=null&&(S=T.event)!=null&&S.restrictions.skip||!e.schedule)return;e.log(`seek to ${p} "${y}"`);const b=e.effectivePlayingItem,L=e.schedule.findItemIndexAtTime(p,y),_=(E=e.schedule.items)==null?void 0:E[L],I=e.getBufferingPlayer(),C=I==null?void 0:I.interstitial,N=C==null?void 0:C.appendInPlace,K=b&&e.itemsMatch(b,_);if(b&&(N||K)){const O=i(e.playingAsset),j=(O==null?void 0:O.media)||e.primaryMedia;if(j){const B=y==="primary"?j.currentTime:r(b,y,e.playingAsset,"timelinePos","currentTime"),U=p-B,W=(N?B:j.currentTime)+U;if(W>=0&&(!O||N||W<=O.duration)){j.currentTime=W;return}}}if(_){let O=p;if(y!=="primary"){const B=_[y].start,U=p-B;O=_.start+U}const j=!e.isInterstitial(_);if((!e.isInterstitial(b)||b.event.appendInPlace)&&(j||_.event.appendInPlace)){const B=e.media||(N?I==null?void 0:I.media:null);B&&(B.currentTime=O)}else if(b){const B=e.findItemIndex(b);if(L>B){const W=e.schedule.findJumpRestrictedIndex(B+1,L);if(W>B){e.setSchedulePosition(W);return}}let U=0;if(j)e.timelinePos=O,e.checkBuffer();else{const W=_.event.assetList,re=p-(_[y]||_).start;for(let ue=W.length;ue--;){const fe=W[ue];if(fe.duration&&re>=fe.startOffset&&re<fe.startOffset+fe.duration){U=ue;break}}}e.setSchedulePosition(L,U)}}},h=()=>{const p=e.effectivePlayingItem;if(e.isInterstitial(p))return p;const y=t();return e.isInterstitial(y)?y:null},m={get bufferedEnd(){const p=t(),y=e.bufferingItem;if(y&&y===p){var S;return r(y,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-y.playout.start||((S=e.bufferingAsset)==null?void 0:S.startOffset)||0}return 0},get currentTime(){const p=h(),y=e.effectivePlayingItem;return y&&y===p?r(y,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-y.playout.start:0},set currentTime(p){const y=h(),S=e.effectivePlayingItem;S&&S===y&&f(p+S.playout.start,"playout")},get duration(){const p=h();return p?p.playout.end-p.playout.start:0},get assetPlayers(){var p;const y=(p=h())==null?void 0:p.event.assetList;return y?y.map(S=>e.getAssetPlayer(S.identifier)):[]},get playingIndex(){var p;const y=(p=h())==null?void 0:p.event;return y&&e.effectivePlayingAsset?y.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return h()}};return this.manager={get events(){var p;return((p=e.schedule)==null||(p=p.events)==null?void 0:p.slice(0))||[]},get schedule(){var p;return((p=e.schedule)==null||(p=p.items)==null?void 0:p.slice(0))||[]},get interstitialPlayer(){return h()?m:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const p=t();return e.findItemIndex(p)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const p=e.effectivePlayingItem;return e.findItemIndex(p)},primary:{get bufferedEnd(){return c()},get currentTime(){const p=e.timelinePos;return p>0?p:0},set currentTime(p){f(p,"primary")},get duration(){return u("primary")},get seekableStart(){var p;return((p=e.primaryDetails)==null?void 0:p.fragmentStart)||0}},integrated:{get bufferedEnd(){return r(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return r(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(p){f(p,"integrated")},get duration(){return u("integrated")},get seekableStart(){var p;return a(((p=e.primaryDetails)==null?void 0:p.fragmentStart)||0,"integrated")}},skip:()=>{const p=e.effectivePlayingItem,y=p==null?void 0:p.event;if(y&&!y.restrictions.skip){const S=e.findItemIndex(p);if(y.appendInPlace){const E=p.playout.start+p.event.duration;f(E+.001,"playout")}else e.advanceAfterAssetEnded(y,S,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,i=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!i?!1:this.findItemIndex(t)===i.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t;if(this.mediaSelection===null)return;const i=this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&!i.event.appendInPlace)return;let r=this.media;!r&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(r=this.primaryMedia);const a=(t=r)==null?void 0:t.currentTime;if(!(a===void 0||!de(a)))return a}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const i=this.getAssetPlayer(e);i&&this.transferMediaFromPlayer(i,t)}transferMediaFromPlayer(e,t){const i=e.interstitial.appendInPlace,r=e.media;if(i&&r===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&r){this.detachedData={media:r};return}const a=e.transferMedia();this.log(`transfer MediaSource from ${e} ${Xe(a)}`),this.detachedData=a}else t&&r&&(this.shouldPlay||(this.shouldPlay=!r.paused))}transferMediaTo(e,t){var i,r;if(e.media===t)return;let a=null;const c=this.hls,u=e!==c,f=u&&e.interstitial.appendInPlace,h=(i=this.detachedData)==null?void 0:i.mediaSource;let m;if(c.media)f&&(a=c.transferMedia(),this.detachedData=a),m="Primary";else if(h){const E=this.getBufferingPlayer();E?(a=E.transferMedia(),m=`${E}`):m="detached MediaSource"}else m="detached media";if(!a){if(h)a=this.detachedData,this.log(`using detachedData: MediaSource ${Xe(a)}`);else if(!this.detachedData||c.media===t){const E=this.playerQueue;E.length>1&&E.forEach(T=>{if(u&&T.interstitial.appendInPlace!==f){const b=T.interstitial;this.clearInterstitial(T.interstitial,null),b.appendInPlace=!1,b.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${b}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const p=a&&"mediaSource"in a&&((r=a.mediaSource)==null?void 0:r.readyState)!=="closed",y=p&&a?a:t;this.log(`${p?"transfering MediaSource":"attaching media"} to ${u?e:"Primary"} from ${m} (media.currentTime: ${t.currentTime})`);const S=this.schedule;if(y===a&&S){const E=u&&e.assetId===S.assetIdAtEnd;y.overrides={duration:S.duration,endOfStream:!u||E,cueRemoval:!u}}e.attachMedia(y)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e==null?void 0:e.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const i=this.timelinePos,r=this.effectivePlayingItem;if(i===-1){const a=this.hls.startPosition;if(this.log(no("checkStart",a)),this.timelinePos=a,t.length&&t[0].cue.pre){const c=e.findEventIndex(t[0].identifier);this.setSchedulePosition(c)}else if(a>=0||!this.primaryLive){const c=this.timelinePos=a>0?a:0,u=e.findItemIndexAtTime(c);this.setSchedulePosition(u)}}else if(r&&!this.playingItem){const a=e.findItemIndex(r);this.setSchedulePosition(a)}}advanceAssetBuffering(e,t){const i=e.event,r=i.findAssetIndex(t),a=xd(i,r);if(!i.isAssetPastPlayoutLimit(a))this.bufferedToEvent(e,a);else if(this.schedule){var c;const u=(c=this.schedule.items)==null?void 0:c[this.findItemIndex(e)+1];u&&this.bufferedToItem(u)}}advanceAfterAssetEnded(e,t,i){const r=xd(e,i);if(e.isAssetPastPlayoutLimit(r)){if(this.schedule){const a=this.schedule.items;if(a){const c=t+1,u=a.length;if(c>=u){this.setSchedulePosition(-1);return}const f=e.resumeTime;this.timelinePos<f&&(this.log(no("advanceAfterAssetEnded",f)),this.timelinePos=f,e.appendInPlace&&this.advanceInPlace(f),this.checkBuffer(this.bufferedPos<f)),this.setSchedulePosition(c)}}}else{if(e.appendInPlace){const a=e.assetList[r];a&&this.advanceInPlace(a.timelineStart)}this.setSchedulePosition(t,r)}}setScheduleToAssetAtTime(e,t){const i=this.schedule;if(!i)return;const r=t.parentIdentifier,a=i.getEvent(r);if(a){const c=i.findEventIndex(r),u=i.findAssetIndex(a,e);this.advanceAfterAssetEnded(a,c,u-1)}}setSchedulePosition(e,t){var i;const r=(i=this.schedule)==null?void 0:i.items;if(!r||this.playbackDisabled)return;const a=e>=0?r[e]:null;this.log(`setSchedulePosition ${e}, ${t} (${a&&Ei(a)}) pos: ${this.timelinePos}`);const c=this.waitingItem||this.playingItem,u=this.playingLastItem;if(this.isInterstitial(c)){const m=c.event,p=this.playingAsset,y=p==null?void 0:p.identifier,S=y?this.getAssetPlayer(y):null;if(S&&y&&(!this.eventItemsMatch(c,a)||t!==void 0&&y!==m.assetList[t].identifier)){var f;const E=m.findAssetIndex(p);if(this.log(`INTERSTITIAL_ASSET_ENDED ${E+1}/${m.assetList.length} ${sr(p)}`),this.endedAsset=p,this.playingAsset=null,this.hls.trigger(A.INTERSTITIAL_ASSET_ENDED,{asset:p,assetListIndex:E,event:m,schedule:r.slice(0),scheduleIndex:e,player:S}),c!==this.playingItem){this.itemsMatch(c,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(m,this.findItemIndex(this.playingItem),E);return}this.retreiveMediaSource(y,a),S.media&&!((f=this.detachedData)!=null&&f.mediaSource)&&S.detachMedia()}if(!this.eventItemsMatch(c,a)&&(this.endedItem=c,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${m} ${Ei(c)}`),m.hasPlayed=!0,this.hls.trigger(A.INTERSTITIAL_ENDED,{event:m,schedule:r.slice(0),scheduleIndex:e}),m.cue.once)){var h;this.updateSchedule();const E=(h=this.schedule)==null?void 0:h.items;if(a&&E){const T=this.findItemIndex(a);this.advanceSchedule(T,E,t,c,u)}return}}this.advanceSchedule(e,r,t,c,u)}advanceSchedule(e,t,i,r,a){const c=this.schedule;if(!c)return;const u=t[e]||null,f=this.primaryMedia,h=this.playerQueue;if(h.length&&h.forEach(m=>{const p=m.interstitial,y=c.findEventIndex(p.identifier);(y<e||y>e+1)&&this.clearInterstitial(p,u)}),this.isInterstitial(u)){this.timelinePos=Math.min(Math.max(this.timelinePos,u.start),u.end);const m=u.event;if(i===void 0){i=c.findAssetIndex(m,this.timelinePos);const E=xd(m,i-1);if(m.isAssetPastPlayoutLimit(E)||m.appendInPlace&&this.timelinePos===u.end){this.advanceAfterAssetEnded(m,e,i);return}i=E}const p=this.waitingItem;this.assetsBuffered(u,f)||this.setBufferingItem(u);let y=this.preloadAssets(m,i);if(this.eventItemsMatch(u,p||r)||(this.waitingItem=u,this.log(`INTERSTITIAL_STARTED ${Ei(u)} ${m.appendInPlace?"append in place":""}`),this.hls.trigger(A.INTERSTITIAL_STARTED,{event:m,schedule:t.slice(0),scheduleIndex:e})),!m.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${m}`);return}if(m.assetListLoader&&(m.assetListLoader.destroy(),m.assetListLoader=void 0),!f){this.log(`Waiting for attachMedia to start Interstitial ${m}`);return}this.waitingItem=this.endedItem=null,this.playingItem=u;const S=m.assetList[i];if(!S){this.advanceAfterAssetEnded(m,e,i||0);return}if(y||(y=this.getAssetPlayer(S.identifier)),y===null||y.destroyed){const E=m.assetList.length;this.warn(`asset ${i+1}/${E} player destroyed ${m}`),y=this.createAssetPlayer(m,S,i),y.loadSource()}if(!this.eventItemsMatch(u,this.bufferingItem)&&m.appendInPlace&&this.isAssetBuffered(S))return;this.startAssetPlayer(y,i,t,e,f),this.shouldPlay&&Up(y.media)}else u?(this.resumePrimary(u,e,r),this.shouldPlay&&Up(this.hls.media)):a&&this.isInterstitial(r)&&(this.endedItem=null,this.playingItem=r,r.event.appendInPlace||this.attachPrimary(c.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,i){var r,a;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${Ei(e)}`),!((r=this.detachedData)!=null&&r.mediaSource)){let u=this.timelinePos;(u<e.start||u>=e.end)&&(u=this.getPrimaryResumption(e,t),this.log(no("resumePrimary",u)),this.timelinePos=u),this.attachPrimary(u,e)}if(!i)return;const c=(a=this.schedule)==null?void 0:a.items;c&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${Ei(e)}`),this.hls.trigger(A.INTERSTITIALS_PRIMARY_RESUMED,{schedule:c.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const i=e.start;if(this.primaryLive){const r=this.primaryDetails;if(t===0)return this.hls.startPosition;if(r&&(i<r.fragmentStart||i>r.edge))return this.hls.liveSyncPosition||-1}return i}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:be.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,i){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const r=this.primaryMedia;if(!r)return;const a=this.hls;a.media?this.checkBuffer():(this.transferMediaTo(a,r),i&&this.startLoadingPrimaryAt(e,i)),i||(this.log(no("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,i))}startLoadingPrimaryAt(e,t){var i;const r=this.hls;!r.loadingEnabled||!r.media||Math.abs((((i=r.mainForwardBufferInfo)==null?void 0:i.start)||r.media.currentTime)-e)>.5?r.startLoad(e,t):r.bufferingEnabled||r.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(A.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(A.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1||!this.schedule)return;const i=this.hls.levels[t.level];if(!i.details)return;const r=je(je({},this.mediaSelection||this.altSelection),{},{main:i});this.mediaSelection=r,this.schedule.parseInterstitialDateRanges(r,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const i=this.hls.audioTracks[t.id],r=this.mediaSelection;if(!r){this.altSelection=je(je({},this.altSelection),{},{audio:i});return}const a=je(je({},r),{},{audio:i});this.mediaSelection=a}onSubtitleTrackUpdated(e,t){const i=this.hls.subtitleTracks[t.id],r=this.mediaSelection;if(!r){this.altSelection=je(je({},this.altSelection),{},{subtitles:i});return}const a=je(je({},r),{},{subtitles:i});this.mediaSelection=a}onAudioTrackSwitching(e,t){const i=z0(t);this.playerQueue.forEach(({hls:r})=>r&&(r.setAudioOption(t)||r.setAudioOption(i)))}onSubtitleTrackSwitch(e,t){const i=z0(t);this.playerQueue.forEach(({hls:r})=>r&&(r.setSubtitleOption(t)||t.id!==-1&&r.setSubtitleOption(i)))}onBufferCodecs(e,t){const i=t.tracks;i&&(this.requiredTracks=i)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const i=this.playingItem;if(i&&!this.itemsMatch(i,this.bufferingItem)&&!this.isInterstitial(i)){const r=this.timelinePos;this.bufferedPos=r,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let r=0;r<t.length;r++){const a=t[r];if(a.cue.post){var i;const c=this.schedule.findEventIndex(a.identifier),u=(i=this.schedule.items)==null?void 0:i[c];this.isInterstitial(u)&&this.eventItemsMatch(u,this.bufferingItem)&&this.bufferedToItem(u,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const i=this.findItemIndex(t);this.setSchedulePosition(i+1)}else this.shouldPlay=!1}updateItem(e,t){var i;const r=(i=this.schedule)==null?void 0:i.items;if(e&&r){const a=this.findItemIndex(e,t);return r[a]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((a,c)=>{e.event.isAssetPastPlayoutLimit(c)&&this.clearAssetPlayer(a.identifier,null)});const i=e.end+.25,r=be.bufferInfo(this.primaryMedia,i,0);(r.end>i||(r.nextStart||0)>i)&&(this.log(`trim buffered interstitial ${Ei(e)} (was ${Ei(t)})`),this.attachPrimary(i,null,!0),this.flushFrontBuffer(i))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var i;return!!t&&(e===t||e.event.identifier===((i=t.event)==null?void 0:i.identifier))}findItemIndex(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1}updateSchedule(e=!1){var t;const i=this.mediaSelection;i&&((t=this.schedule)==null||t.updateSchedule(i,[],e))}checkBuffer(e){var t;const i=(t=this.schedule)==null?void 0:t.items;if(!i)return;const r=be.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=r.len<1),this.updateBufferedPos(r.end,i,e)}updateBufferedPos(e,t,i){const r=this.schedule,a=this.bufferingItem;if(this.bufferedPos>e||!r)return;if(t.length===1&&this.itemsMatch(t[0],a)){this.bufferedPos=e;return}const c=this.playingItem,u=this.findItemIndex(c);let f=r.findItemIndexAtTime(e);if(this.bufferedPos<e){var h;const m=this.findItemIndex(a),p=Math.min(m+1,t.length-1),y=t[p];if((f===-1&&a&&e>=a.end||(h=y.event)!=null&&h.appendInPlace&&e+.01>=y.start)&&(f=p),this.isInterstitial(a)){const S=a.event;if(p-u>1&&S.appendInPlace===!1||S.assetList.length===0&&S.assetListLoader)return}if(this.bufferedPos=e,f>m&&f>u)this.bufferedToItem(y);else{const S=this.primaryDetails;this.primaryLive&&S&&e>S.edge-S.targetduration&&y.start<S.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(y)&&this.preloadAssets(y.event,0)}}else i&&c&&!this.itemsMatch(c,a)&&(f===u?this.bufferedToItem(c):f===u+1&&this.bufferedToItem(t[f]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(r=>{const a=this.getAssetPlayer(r.identifier);return!(a!=null&&a.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,i=this.schedule;if(!this.itemsMatch(e,t)&&i){const{items:r,events:a}=i;if(!r||!a)return t;const c=this.isInterstitial(e),u=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const f=u?u.remaining:t?t.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${Ei(e)}`+(t?` (${f.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(c){const h=i.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((m,p)=>{const y=this.getAssetPlayer(m.identifier);y&&(p===h&&y.loadSource(),y.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(h=>h.pauseBuffering());this.hls.trigger(A.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:a.slice(0),schedule:r.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return t}bufferedToItem(e,t=0){const i=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(i!==null){this.bufferingAsset=null;const r=this.detachedData;r?r.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),i=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(i)}bufferedToEvent(e,t){const i=e.event,r=i.assetList.length===0&&!i.assetListLoader,a=i.cue.once;if(r||!a){const c=this.preloadAssets(i,t);if(c!=null&&c.interstitial.appendInPlace){const u=this.primaryMedia;u&&this.bufferAssetPlayer(c,u)}}}preloadAssets(e,t){const i=e.assetUrl,r=e.assetList.length,a=r===0&&!e.assetListLoader,c=e.cue.once;if(a){const f=e.timelineStart;if(e.appendInPlace){var u;const y=this.playingItem;!this.isInterstitial(y)&&(y==null||(u=y.nextEvent)==null?void 0:u.identifier)===e.identifier&&this.flushFrontBuffer(f+.25)}let h,m=0;if(!this.playingItem&&this.primaryLive&&(m=this.hls.startPosition,m===-1&&(m=this.hls.liveSyncPosition||0)),m&&!(e.cue.pre||e.cue.post)){const y=m-f;y>0&&(h=Math.round(y*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${i?1:r} ${e}${h?` live-start: ${m} start-offset: ${h}`:""}`),i)return this.createAsset(e,0,0,f,e.duration,i);const p=this.assetListLoader.loadAssetList(e,h);p&&(e.assetListLoader=p)}else if(!c&&r){for(let h=t;h<r;h++){const m=e.assetList[h],p=this.getAssetPlayerQueueIndex(m.identifier);(p===-1||this.playerQueue[p].destroyed)&&!m.error&&this.createAssetPlayer(e,m,h)}const f=e.assetList[t];if(f){const h=this.getAssetPlayer(f.identifier);return h&&h.loadSource(),h}}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(r=>{this.hls.trigger(A.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:r})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let i=0;i<t.length;i++)if(e===t[i].assetId)return i;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let i=0;i<e.length;i++)if(e[i].media===t)return e[i]}return null}createAsset(e,t,i,r,a,c){const u={parentIdentifier:e.identifier,identifier:KL(e,c,t),duration:a,startOffset:i,timelineStart:r,uri:c};return this.createAssetPlayer(e,u,t)}createAssetPlayer(e,t,i){const r=this.hls,a=r.userConfig;let c=a.videoPreference;const u=r.loadLevelObj||r.levels[r.currentLevel];(c||u)&&(c=Ke({},c),u.videoCodec&&(c.videoCodec=u.videoCodec),u.videoRange&&(c.allowedVideoRanges=[u.videoRange]));const f=r.audioTracks[r.audioTrack],h=r.subtitleTracks[r.subtitleTrack];let m=0;if(this.primaryLive||e.appendInPlace){const C=this.timelinePos-t.timelineStart;if(C>1){const N=t.duration;N&&C<N&&(m=C)}}const p=t.identifier,y=je(je({},a),{},{maxMaxBufferLength:Math.min(180,r.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:r.sessionId,assetPlayerId:p,abrEwmaDefaultEstimate:r.bandwidthEstimate,interstitialsController:void 0,startPosition:m,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:c,audioPreference:f||a.audioPreference,subtitlePreference:h||a.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(y.timelineOffset=t.timelineStart));const S=y.cmcd;S!=null&&S.sessionId&&S.contentId&&(y.cmcd=Ke({},S,{contentId:Ea(t.uri)})),this.getAssetPlayer(p)&&this.warn(`Duplicate date range identifier ${e} and asset ${p}`);const E=new qL(this.HlsPlayerClass,y,e,t);this.playerQueue.push(E),e.assetList[i]=t;let T=!0;const b=C=>{if(C.live){var N;const j=new Error(`Interstitials MUST be VOD assets ${e}`),B={fatal:!0,type:pe.OTHER_ERROR,details:H.INTERSTITIAL_ASSET_ITEM_ERROR,error:j},U=((N=this.schedule)==null?void 0:N.findEventIndex(e.identifier))||-1;this.handleAssetItemError(B,e,U,i,j.message);return}const K=C.edge-C.fragmentStart,O=t.duration;(T||O===null||K>O)&&(T=!1,this.log(`Interstitial asset "${p}" duration change ${O} > ${K}`),t.duration=K,this.updateSchedule())};E.on(A.LEVEL_UPDATED,(C,{details:N})=>b(N)),E.on(A.LEVEL_PTS_UPDATED,(C,{details:N})=>b(N)),E.on(A.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const L=(C,N)=>{const K=this.getAssetPlayer(p);if(K&&N.tracks){K.off(A.BUFFER_CODECS,L),K.tracks=N.tracks;const O=this.primaryMedia;this.bufferingAsset===K.assetItem&&O&&!K.media&&this.bufferAssetPlayer(K,O)}};E.on(A.BUFFER_CODECS,L);const _=()=>{var C;const N=this.getAssetPlayer(p);if(this.log(`buffered to end of asset ${N}`),!N||!this.schedule)return;const K=this.schedule.findEventIndex(e.identifier),O=(C=this.schedule.items)==null?void 0:C[K];this.isInterstitial(O)&&this.advanceAssetBuffering(O,t)};E.on(A.BUFFERED_TO_END,_);const I=C=>()=>{if(!this.getAssetPlayer(p)||!this.schedule)return;this.shouldPlay=!0;const K=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,K,C)};return E.once(A.MEDIA_ENDED,I(i)),E.once(A.PLAYOUT_LIMIT_REACHED,I(1/0)),E.on(A.ERROR,(C,N)=>{if(!this.schedule)return;const K=this.getAssetPlayer(p);if(N.details===H.BUFFER_STALLED_ERROR){if(K!=null&&K.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(N,e,this.schedule.findEventIndex(e.identifier),i,`Asset player error ${N.error} ${e}`)}),E.on(A.DESTROYING,()=>{if(!this.getAssetPlayer(p)||!this.schedule)return;const N=new Error(`Asset player destroyed unexpectedly ${p}`),K={fatal:!0,type:pe.OTHER_ERROR,details:H.INTERSTITIAL_ASSET_ITEM_ERROR,error:N};this.handleAssetItemError(K,e,this.schedule.findEventIndex(e.identifier),i,N.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${sr(t)}`),this.hls.trigger(A.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:i,event:e,player:E}),E}clearInterstitial(e,t){e.assetList.forEach(i=>{this.clearAssetPlayer(i.identifier,t)}),e.reset()}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const i=this.playerQueue[t];this.transferMediaFromPlayer(i,null),i.resetDetails()}}clearAssetPlayer(e,t){const i=this.getAssetPlayerQueueIndex(e);if(i!==-1){const r=this.playerQueue[i];this.log(`clear ${r} toSegment: ${t&&Ei(t)}`),this.transferMediaFromPlayer(r,t),this.playerQueue.splice(i,1),r.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,i,r,a){const{interstitial:c,assetItem:u,assetId:f}=e,h=c.assetList.length,m=this.playingAsset;this.endedAsset=null,this.playingAsset=u,(!m||m.identifier!==f)&&(m&&(this.clearAssetPlayer(m.identifier,i[r]),delete m.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${h} ${sr(u)}`),this.hls.trigger(A.INTERSTITIAL_ASSET_STARTED,{asset:u,assetListIndex:t,event:c,schedule:i.slice(0),scheduleIndex:r,player:e})),this.bufferAssetPlayer(e,a)}bufferAssetPlayer(e,t){var i,r;if(!this.schedule)return;const{interstitial:a,assetItem:c}=e,u=this.schedule.findEventIndex(a.identifier),f=(i=this.schedule.items)==null?void 0:i[u];if(!f)return;e.loadSource(),this.setBufferingItem(f),this.bufferingAsset=c;const h=this.getBufferingPlayer();if(h===e)return;const m=a.appendInPlace;if(m&&(h==null?void 0:h.interstitial.appendInPlace)===!1)return;const p=(h==null?void 0:h.tracks)||((r=this.detachedData)==null?void 0:r.tracks)||this.requiredTracks;if(m&&c!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if(p&&!Ty(p,e.tracks)){const y=new Error(`Asset ${sr(c)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(p)}')`),S={fatal:!0,type:pe.OTHER_ERROR,details:H.INTERSTITIAL_ASSET_ITEM_ERROR,error:y},E=a.findAssetIndex(c);this.handleAssetItemError(S,a,u,E,y.message);return}}this.transferMediaTo(e,t)}handleInPlaceStall(e){const t=this.schedule,i=this.primaryMedia;if(!t||!i)return;const r=i.currentTime,a=t.findAssetIndex(e,r),c=e.assetList[a];if(c){const u=this.getAssetPlayer(c.identifier);if(u){const f=u.currentTime||r-c.timelineStart,h=u.duration-f;if(this.warn(`Stalled at ${f} of ${f+h} in ${u} ${e} (media.currentTime: ${r})`),f&&(h/i.playbackRate<.5||u.bufferedInPlaceToEnd(i))&&u.hls){const m=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,m,a)}}}}advanceInPlace(e){const t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)}handleAssetItemError(e,t,i,r,a){if(e.details===H.BUFFER_STALLED_ERROR)return;const c=t.assetList[r]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${c&&sr(c)} ${e.error}`),!this.schedule)return;const u=(c==null?void 0:c.identifier)||"",f=this.getAssetPlayerQueueIndex(u),h=this.playerQueue[f]||null,m=this.schedule.items,p=Ke({},e,{fatal:!1,errorAction:rr(!0),asset:c,assetListIndex:r,event:t,schedule:m,scheduleIndex:i,player:h});if(this.hls.trigger(A.INTERSTITIAL_ASSET_ERROR,p),!e.fatal)return;const y=this.playingAsset,S=this.bufferingAsset,E=new Error(a);if(c&&(this.clearAssetPlayer(u,null),c.error=E),!t.assetList.some(T=>!T.error))t.error=E;else for(let T=r;T<t.assetList.length;T++)this.resetAssetPlayer(t.assetList[T].identifier);this.updateSchedule(!0),t.error?this.primaryFallback(t):y&&y.identifier===u?this.advanceAfterAssetEnded(t,i,r):S&&S.identifier===u&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,S)}primaryFallback(e){const t=e.timelineStart,i=this.effectivePlayingItem;if(i){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${Ei(i)} error: ${e.error}`);let r=this.timelinePos;r===-1&&(r=this.hls.startPosition);const a=this.updateItem(i,r);if(this.itemsMatch(i,a)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t)),!this.schedule)return;const c=this.schedule.findItemIndexAtTime(r);this.setSchedulePosition(c)}else this.checkStart()}onAssetListLoaded(e,t){var i,r;const a=t.event,c=a.identifier,u=t.assetListResponse.ASSETS;if(!((i=this.schedule)!=null&&i.hasEvent(c)))return;const f=a.timelineStart,h=a.duration;let m=0;u.forEach((T,b)=>{const L=parseFloat(T.DURATION);this.createAsset(a,b,m,f+m,L,T.URI),m+=L}),a.duration=m,this.log(`Loaded asset-list with duration: ${m} (was: ${h}) ${a}`);const p=this.waitingItem,y=(p==null?void 0:p.event.identifier)===c;this.updateSchedule();const S=(r=this.bufferingItem)==null?void 0:r.event;if(y){var E;const T=this.schedule.findEventIndex(c),b=(E=this.schedule.items)==null?void 0:E[T];if(b){if(!this.playingItem&&this.timelinePos>b.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==T){a.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${a}`),this.updateSchedule(!0),this.primaryFallback(a);return}this.setBufferingItem(b)}this.setSchedulePosition(T)}else if((S==null?void 0:S.identifier)===c){const T=a.assetList[0];if(T){const b=this.getAssetPlayer(T.identifier);if(S.appendInPlace){const L=this.primaryMedia;b&&L&&this.bufferAssetPlayer(b,L)}else b&&b.loadSource()}}}onError(e,t){if(this.schedule)switch(t.details){case H.ASSET_LIST_PARSING_ERROR:case H.ASSET_LIST_LOAD_ERROR:case H.ASSET_LIST_LOAD_TIMEOUT:{const i=t.interstitial;i&&(this.updateSchedule(!0),this.primaryFallback(i));break}case H.BUFFER_STALLED_ERROR:{const i=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&i.event.appendInPlace){this.handleInPlaceStall(i.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const Bp=500;class ZL extends hh{constructor(e,t,i){super(e,t,i,"subtitle-stream-controller",me.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(A.LEVEL_LOADED,this.onLevelLoaded,this),e.on(A.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(A.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(A.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(A.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(A.LEVEL_LOADED,this.onLevelLoaded,this),e.off(A.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(A.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(A.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(A.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=ee.IDLE,this.setInterval(Bp),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:i,success:r}=t;if(this.fragContextChanged(i)||(ut(i)&&(this.fragPrevious=i),this.state=ee.IDLE),!r)return;const a=this.tracksBuffered[this.currentTrackId];if(!a)return;let c;const u=i.start;for(let h=0;h<a.length;h++)if(u>=a[h].start&&u<=a[h].end){c=a[h];break}const f=i.start+i.duration;c?c.end=f:(c={start:u,end:f},a.push(c)),this.fragmentTracker.fragBuffered(i),this.fragBufferedComplete(i,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:i,endOffset:r}=t;if(i===0&&r!==Number.POSITIVE_INFINITY){const a=r-1;if(a<=0)return;t.endOffsetSubtitles=Math.max(0,a),this.tracksBuffered.forEach(c=>{for(let u=0;u<c.length;){if(c[u].end<=a){c.shift();continue}else if(c[u].start<a)c[u].start=a;else break;u++}}),this.fragmentTracker.removeFragmentsInRange(i,a,me.SUBTITLE)}}onError(e,t){const i=t.frag;(i==null?void 0:i.type)===me.SUBTITLE&&(t.details===H.FRAG_GAP&&this.fragmentTracker.fragBuffered(i,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==ee.STOPPED&&(this.state=ee.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&Rx(this.levels,t)){this.levels=t.map(i=>new Aa(i));return}this.tracksBuffered=[],this.levels=t.map(i=>{const r=new Aa(i);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,me.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var i;if(this.currentTrackId=t.id,!((i=this.levels)!=null&&i.length)||this.currentTrackId===-1){this.clearInterval();return}const r=this.levels[this.currentTrackId];r!=null&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.state!==ee.STOPPED&&this.setInterval(Bp)}onSubtitleTrackLoaded(e,t){var i;const{currentTrackId:r,levels:a}=this,{details:c,id:u}=t;if(!a){this.warn(`Subtitle tracks were reset while loading level ${u}`);return}const f=a[u];if(u>=a.length||!f)return;this.log(`Subtitle track ${u} loaded [${c.startSN},${c.endSN}]${c.lastPartSn?`[part-${c.lastPartSn}-${c.lastPartIndex}]`:""},duration:${c.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let h=0;if(c.live||(i=f.details)!=null&&i.live){if(c.deltaUpdateFailed)return;const p=this.mainDetails;if(!p){this.startFragRequested=!1;return}const y=p.fragments[0];if(!f.details)c.hasProgramDateTime&&p.hasProgramDateTime?(Co(c,p),h=c.fragmentStart):y&&(h=y.start,Bd(c,h));else{var m;h=this.alignPlaylists(c,f.details,(m=this.levelLastLoaded)==null?void 0:m.details),h===0&&y&&(h=y.start,Bd(c,h))}p&&!this.startFragRequested&&this.setStartPosition(p,h)}f.details=c,this.levelLastLoaded=f,u===r&&(this.hls.trigger(A.SUBTITLE_TRACK_UPDATED,{details:c,id:u,groupId:t.groupId}),this.tick(),c.live&&!this.fragCurrent&&this.media&&this.state===ee.IDLE&&(hn(null,c.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),f.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:i}=e,r=t.decryptdata,a=this.hls;if(!this.fragContextChanged(t)&&i&&i.byteLength>0&&r!=null&&r.key&&r.iv&&ar(r.method)){const c=performance.now();this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer,uh(r.method)).catch(u=>{throw a.trigger(A.ERROR,{type:pe.MEDIA_ERROR,details:H.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:t}),u}).then(u=>{const f=performance.now();a.trigger(A.FRAG_DECRYPTED,{frag:t,payload:u,stats:{tstart:c,tdecrypt:f}})}).catch(u=>{this.warn(`${u.name}: ${u.message}`),this.state=ee.IDLE})}}doTick(){if(!this.media){this.state=ee.IDLE;return}if(this.state===ee.IDLE){const{currentTrackId:e,levels:t}=this,i=t==null?void 0:t[e];if(!i||!t.length||!i.details||this.waitForLive(i))return;const{config:r}=this,a=this.getLoadPosition(),c=be.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],a,r.maxBufferHole),{end:u,len:f}=c,h=i.details,m=this.hls.maxBufferLength+h.levelTargetDuration;if(f>m)return;const p=h.fragments,y=p.length,S=h.edge;let E=null;const T=this.fragPrevious;if(u<S){const _=r.maxFragLookUpTolerance,I=u>S-_?0:_;E=hn(T,p,Math.max(p[0].start,u),I),!E&&T&&T.start<p[0].start&&(E=p[0])}else E=p[y-1];if(E=this.filterReplacedPrimary(E,i.details),!E)return;const b=E.sn-h.startSN,L=p[b-1];if(L&&L.cc===E.cc&&this.fragmentTracker.getState(L)===mt.NOT_LOADED&&(E=L),this.fragmentTracker.getState(E)===mt.NOT_LOADED){const _=this.mapToInitFragWhenRequired(E);_&&this.loadFragment(_,i,u)}}}loadFragment(e,t,i){ut(e)?super.loadFragment(e,t,i):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new JL(this.tracksBuffered[this.currentTrackId]||[])}}class JL{constructor(e){this.buffered=void 0;const t=(i,r,a)=>{if(r=r>>>0,r>a-1)throw new DOMException(`Failed to execute '${i}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${a})`);return e[r][i]};this.buffered={get length(){return e.length},end(i){return t("end",i,e.length)},start(i){return t("start",i,e.length)}}}}const e_={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},$x=l=>String.fromCharCode(e_[l]||l),Si=15,is=100,t_={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},i_={17:2,18:4,21:6,22:8,23:10,19:13,20:15},s_={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},n_={25:2,26:4,29:6,30:8,31:10,27:13,28:15},r_=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class a_{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const i=typeof t=="function"?t():t;$e.log(`${this.time} [${e}] ${i}`)}}}const on=function(e){const t=[];for(let i=0;i<e.length;i++)t.push(e[i].toString(16));return t};class Gx{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let i=0;i<t.length;i++){const r=t[i];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class l_{constructor(){this.uchar=" ",this.penState=new Gx}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class o_{constructor(e){this.chars=[],this.pos=0,this.currPenState=new Gx,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<is;t++)this.chars.push(new l_);this.logger=e}equals(e){for(let t=0;t<is;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<is;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<is;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>is&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=is)}moveCursor(e){const t=this.pos+e;if(e>1)for(let i=this.pos+1;i<t+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=$x(e);if(this.pos>=is){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<is;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let i=0;i<is;i++){const r=this.chars[i].uchar;r!==" "&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class vd{constructor(e){this.rows=[],this.currRow=Si-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Si;t++)this.rows.push(new o_(e));this.logger=e}reset(){for(let e=0;e<Si;e++)this.rows[e].clear();this.currRow=Si-1}equals(e){let t=!0;for(let i=0;i<Si;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t}copy(e){for(let t=0;t<Si;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Si;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+Xe(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let u=0;u<Si;u++)this.rows[u].clear();const a=this.currRow+1-this.nrRollUpRows,c=this.lastOutputScreen;if(c){const u=c.rows[a].cueStartTime,f=this.logger.time;if(u!==null&&f!==null&&u<f)for(let h=0;h<this.nrRollUpRows;h++)this.rows[t-this.nrRollUpRows+h+1].copy(c.rows[a+h])}}this.currRow=t;const i=this.rows[this.currRow];if(e.indent!==null){const a=e.indent,c=Math.max(a-1,0);i.setCursor(e.indent),e.color=i.chars[c].penState.foreground}const r={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+Xe(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let i="",r=-1;for(let a=0;a<Si;a++){const c=this.rows[a].getTextString();c&&(r=a+1,e?t.push("Row "+r+": '"+c+"'"):t.push(c.trim()))}return t.length>0&&(e?i="["+t.join(" | ")+"]":i=t.join(`
`)),i}getTextAndFormat(){return this.rows}}class Fp{constructor(e,t,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new vd(i),this.nonDisplayedMemory=new vd(i),this.lastOutputScreen=new vd(i),this.currRollUpRow=this.displayedMemory.rows[Si-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Si-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let i=0;i<e.length;i++)this.writeScreen.insertChar(e[i]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const i=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[i]}this.logger.log(2,"MIDROW: "+Xe(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class jp{constructor(e,t,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory=u_(),this.logger=void 0;const r=this.logger=new a_;this.channels=[null,new Fp(e,t,r),new Fp(e+1,i,r)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let i=0;i<t.length;i+=2){const r=t[i]&127,a=t[i+1]&127;let c=!1,u=null;if(r===0&&a===0)continue;this.logger.log(3,()=>"["+on([t[i],t[i+1]])+"] -> ("+on([r,a])+")");const f=this.cmdHistory;if(r>=16&&r<=31){if(c_(r,a,f)){ro(null,null,f),this.logger.log(3,()=>"Repeated command ("+on([r,a])+") is dropped");continue}ro(r,a,this.cmdHistory),c=this.parseCmd(r,a),c||(c=this.parseMidrow(r,a)),c||(c=this.parsePAC(r,a)),c||(c=this.parseBackgroundAttributes(r,a))}else ro(null,null,f);if(!c&&(u=this.parseChars(r,a),u)){const m=this.currentChannel;m&&m>0?this.channels[m].insertChars(u):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!c&&!u&&this.logger.log(2,()=>"Couldn't parse cleaned data "+on([r,a])+" orig: "+on([t[i],t[i+1]]))}}parseCmd(e,t){const i=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=33&&t<=35;if(!(i||r))return!1;const a=e===20||e===21||e===23?1:2,c=this.channels[a];return e===20||e===21||e===28||e===29?t===32?c.ccRCL():t===33?c.ccBS():t===34?c.ccAOF():t===35?c.ccAON():t===36?c.ccDER():t===37?c.ccRU(2):t===38?c.ccRU(3):t===39?c.ccRU(4):t===40?c.ccFON():t===41?c.ccRDC():t===42?c.ccTR():t===43?c.ccRTD():t===44?c.ccEDM():t===45?c.ccCR():t===46?c.ccENM():t===47&&c.ccEOC():c.ccTO(t-32),this.currentChannel=a,!0}parseMidrow(e,t){let i=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?i=1:i=2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[i];return r?(r.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+on([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let i;const r=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,a=(e===16||e===24)&&t>=64&&t<=95;if(!(r||a))return!1;const c=e<=23?1:2;t>=64&&t<=95?i=c===1?t_[e]:s_[e]:i=c===1?i_[e]:n_[e];const u=this.channels[c];return u?(u.setPAC(this.interpretPAC(i,t)),this.currentChannel=c,!0):!1}interpretPAC(e,t){let i;const r={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?i=t-96:i=t-64,r.underline=(i&1)===1,i<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(r.italics=!0,r.color="white"):r.indent=Math.floor((i-16)/2)*4,r}parseChars(e,t){let i,r=null,a=null;if(e>=25?(i=2,a=e-8):(i=1,a=e),a>=17&&a<=19){let c;a===17?c=t+80:a===18?c=t+112:c=t+144,this.logger.log(2,()=>"Special char '"+$x(c)+"' in channel "+i),r=[c]}else e>=32&&e<=127&&(r=t===0?[e]:[e,t]);return r&&this.logger.log(3,()=>"Char codes =  "+on(r).join(",")),r}parseBackgroundAttributes(e,t){const i=(e===16||e===24)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=45&&t<=47;if(!(i||r))return!1;let a;const c={};e===16||e===24?(a=Math.floor((t-32)/2),c.background=r_[a],t%2===1&&(c.background=c.background+"_semi")):t===45?c.background="transparent":(c.foreground="black",t===47&&(c.underline=!0));const u=e<=23?1:2;return this.channels[u].setBkgData(c),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}ro(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const i=this.channels[t];i&&i.cueSplitAtTime(e)}}}function ro(l,e,t){t.a=l,t.b=e}function c_(l,e,t){return t.a===l&&t.b===e}function u_(){return{a:null,b:null}}var Ah=function(){if(Io!=null&&Io.VTTCue)return self.VTTCue;const l=["","lr","rl"],e=["start","middle","end","left","right"];function t(u,f){if(typeof f!="string"||!Array.isArray(u))return!1;const h=f.toLowerCase();return~u.indexOf(h)?h:!1}function i(u){return t(l,u)}function r(u){return t(e,u)}function a(u,...f){let h=1;for(;h<arguments.length;h++){const m=arguments[h];for(const p in m)u[p]=m[p]}return u}function c(u,f,h){const m=this,p={enumerable:!0};m.hasBeenReset=!1;let y="",S=!1,E=u,T=f,b=h,L=null,_="",I=!0,C="auto",N="start",K=50,O="middle",j=50,B="middle";Object.defineProperty(m,"id",a({},p,{get:function(){return y},set:function(U){y=""+U}})),Object.defineProperty(m,"pauseOnExit",a({},p,{get:function(){return S},set:function(U){S=!!U}})),Object.defineProperty(m,"startTime",a({},p,{get:function(){return E},set:function(U){if(typeof U!="number")throw new TypeError("Start time must be set to a number.");E=U,this.hasBeenReset=!0}})),Object.defineProperty(m,"endTime",a({},p,{get:function(){return T},set:function(U){if(typeof U!="number")throw new TypeError("End time must be set to a number.");T=U,this.hasBeenReset=!0}})),Object.defineProperty(m,"text",a({},p,{get:function(){return b},set:function(U){b=""+U,this.hasBeenReset=!0}})),Object.defineProperty(m,"region",a({},p,{get:function(){return L},set:function(U){L=U,this.hasBeenReset=!0}})),Object.defineProperty(m,"vertical",a({},p,{get:function(){return _},set:function(U){const W=i(U);if(W===!1)throw new SyntaxError("An invalid or illegal string was specified.");_=W,this.hasBeenReset=!0}})),Object.defineProperty(m,"snapToLines",a({},p,{get:function(){return I},set:function(U){I=!!U,this.hasBeenReset=!0}})),Object.defineProperty(m,"line",a({},p,{get:function(){return C},set:function(U){if(typeof U!="number"&&U!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");C=U,this.hasBeenReset=!0}})),Object.defineProperty(m,"lineAlign",a({},p,{get:function(){return N},set:function(U){const W=r(U);if(!W)throw new SyntaxError("An invalid or illegal string was specified.");N=W,this.hasBeenReset=!0}})),Object.defineProperty(m,"position",a({},p,{get:function(){return K},set:function(U){if(U<0||U>100)throw new Error("Position must be between 0 and 100.");K=U,this.hasBeenReset=!0}})),Object.defineProperty(m,"positionAlign",a({},p,{get:function(){return O},set:function(U){const W=r(U);if(!W)throw new SyntaxError("An invalid or illegal string was specified.");O=W,this.hasBeenReset=!0}})),Object.defineProperty(m,"size",a({},p,{get:function(){return j},set:function(U){if(U<0||U>100)throw new Error("Size must be between 0 and 100.");j=U,this.hasBeenReset=!0}})),Object.defineProperty(m,"align",a({},p,{get:function(){return B},set:function(U){const W=r(U);if(!W)throw new SyntaxError("An invalid or illegal string was specified.");B=W,this.hasBeenReset=!0}})),m.displayState=void 0}return c.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},c}();class d_{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function Hx(l){function e(i,r,a,c){return(i|0)*3600+(r|0)*60+(a|0)+parseFloat(c||0)}const t=l.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class h_{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,i){for(let r=0;r<i.length;++r)if(t===i[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const i=parseFloat(t);if(i>=0&&i<=100)return this.set(e,i),!0}return!1}}function Vx(l,e,t,i){const r=i?l.split(i):[l];for(const a in r){if(typeof r[a]!="string")continue;const c=r[a].split(t);if(c.length!==2)continue;const u=c[0],f=c[1];e(u,f)}}const zd=new Ah(0,0,""),ao=zd.align==="middle"?"middle":"center";function f_(l,e,t){const i=l;function r(){const u=Hx(l);if(u===null)throw new Error("Malformed timestamp: "+i);return l=l.replace(/^[^\sa-zA-Z-]+/,""),u}function a(u,f){const h=new h_;Vx(u,function(y,S){let E;switch(y){case"region":for(let T=t.length-1;T>=0;T--)if(t[T].id===S){h.set(y,t[T].region);break}break;case"vertical":h.alt(y,S,["rl","lr"]);break;case"line":E=S.split(","),h.integer(y,E[0]),h.percent(y,E[0])&&h.set("snapToLines",!1),h.alt(y,E[0],["auto"]),E.length===2&&h.alt("lineAlign",E[1],["start",ao,"end"]);break;case"position":E=S.split(","),h.percent(y,E[0]),E.length===2&&h.alt("positionAlign",E[1],["start",ao,"end","line-left","line-right","auto"]);break;case"size":h.percent(y,S);break;case"align":h.alt(y,S,["start",ao,"end","left","right"]);break}},/:/,/\s/),f.region=h.get("region",null),f.vertical=h.get("vertical","");let m=h.get("line","auto");m==="auto"&&zd.line===-1&&(m=-1),f.line=m,f.lineAlign=h.get("lineAlign","start"),f.snapToLines=h.get("snapToLines",!0),f.size=h.get("size",100),f.align=h.get("align",ao);let p=h.get("position","auto");p==="auto"&&zd.position===50&&(p=f.align==="start"||f.align==="left"?0:f.align==="end"||f.align==="right"?100:50),f.position=p}function c(){l=l.replace(/^\s+/,"")}if(c(),e.startTime=r(),c(),l.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+i);l=l.slice(3),c(),e.endTime=r(),c(),a(l,e)}function Kx(l){return l.replace(/<br(?: \/)?>/gi,`
`)}class m_{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new d_,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function i(){let a=t.buffer,c=0;for(a=Kx(a);c<a.length&&a[c]!=="\r"&&a[c]!==`
`;)++c;const u=a.slice(0,c);return a[c]==="\r"&&++c,a[c]===`
`&&++c,t.buffer=a.slice(c),u}function r(a){Vx(a,function(c,u){},/:/)}try{let a="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;a=i();const u=a.match(/^()?WEBVTT([ \t].*)?$/);if(!(u!=null&&u[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let c=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(c?c=!1:a=i(),t.state){case"HEADER":/:/.test(a)?r(a):a||(t.state="ID");continue;case"NOTE":a||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){t.state="NOTE";break}if(!a)continue;if(t.cue=new Ah(0,0,""),t.state="CUE",a.indexOf("-->")===-1){t.cue.id=a;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{f_(a,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const u=a.indexOf("-->")!==-1;if(!a||u&&(c=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=a}continue;case"BADCUE":a||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const g_=/\r\n|\n\r|\n|\r/g,Ed=function(e,t,i=0){return e.slice(i,i+t.length)===t},p_=function(e){let t=parseInt(e.slice(-3));const i=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),a=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!de(t)||!de(i)||!de(r)||!de(a))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*i,t+=60*1e3*r,t+=60*60*1e3*a,t};function Rh(l,e,t){return Ea(l.toString())+Ea(e.toString())+Ea(t)}const y_=function(e,t,i){let r=e[t],a=e[r.prevCC];if(!a||!a.new&&r.new){e.ccOffset=e.presentationOffset=r.start,r.new=!1;return}for(;(c=a)!=null&&c.new;){var c;e.ccOffset+=r.start-a.start,r.new=!1,r=a,a=e[r.prevCC]}e.presentationOffset=i};function x_(l,e,t,i,r,a,c){const u=new m_,f=ti(new Uint8Array(l)).trim().replace(g_,`
`).split(`
`),h=[],m=e?AR(e.baseTime,e.timescale):0;let p="00:00.000",y=0,S=0,E,T=!0;u.oncue=function(b){const L=t[i];let _=t.ccOffset;const I=(y-m)/9e4;if(L!=null&&L.new&&(S!==void 0?_=t.ccOffset=L.start:y_(t,i,I)),I){if(!e){E=new Error("Missing initPTS for VTT MPEGTS");return}_=I-t.presentationOffset}const C=b.endTime-b.startTime,N=Zt((b.startTime+_-S)*9e4,r*9e4)/9e4;b.startTime=Math.max(N,0),b.endTime=Math.max(N+C,0);const K=b.text.trim();b.text=decodeURIComponent(encodeURIComponent(K)),b.id||(b.id=Rh(b.startTime,b.endTime,K)),b.endTime>0&&h.push(b)},u.onparsingerror=function(b){E=b},u.onflush=function(){if(E){c(E);return}a(h)},f.forEach(b=>{if(T)if(Ed(b,"X-TIMESTAMP-MAP=")){T=!1,b.slice(16).split(",").forEach(L=>{Ed(L,"LOCAL:")?p=L.slice(6):Ed(L,"MPEGTS:")&&(y=parseInt(L.slice(7)))});try{S=p_(p)/1e3}catch(L){E=L}return}else b===""&&(T=!1);u.parse(b+`
`)}),u.flush()}const Sd="stpp.ttml.im1t",zx=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Yx=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,v_={left:"start",center:"center",right:"end",start:"start",end:"end"};function $p(l,e,t,i){const r=_e(new Uint8Array(l),["mdat"]);if(r.length===0){i(new Error("Could not parse IMSC1 mdat"));return}const a=r.map(u=>ti(u)),c=bR(e.baseTime,1,e.timescale);try{a.forEach(u=>t(E_(u,c)))}catch(u){i(u)}}function E_(l,e){const r=new DOMParser().parseFromString(l,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const a={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},c=Object.keys(a).reduce((p,y)=>(p[y]=r.getAttribute(`ttp:${y}`)||a[y],p),{}),u=r.getAttribute("xml:space")!=="preserve",f=Gp(Td(r,"styling","style")),h=Gp(Td(r,"layout","region")),m=Td(r,"body","[begin]");return[].map.call(m,p=>{const y=qx(p,u);if(!y||!p.hasAttribute("begin"))return null;const S=Ad(p.getAttribute("begin"),c),E=Ad(p.getAttribute("dur"),c);let T=Ad(p.getAttribute("end"),c);if(S===null)throw Hp(p);if(T===null){if(E===null)throw Hp(p);T=S+E}const b=new Ah(S-e,T-e,y);b.id=Rh(b.startTime,b.endTime,b.text);const L=h[p.getAttribute("region")],_=f[p.getAttribute("style")],I=S_(L,_,f),{textAlign:C}=I;if(C){const N=v_[C];N&&(b.lineAlign=N),b.align=C}return Ke(b,I),b}).filter(p=>p!==null)}function Td(l,e,t){const i=l.getElementsByTagName(e)[0];return i?[].slice.call(i.querySelectorAll(t)):[]}function Gp(l){return l.reduce((e,t)=>{const i=t.getAttribute("xml:id");return i&&(e[i]=t),e},{})}function qx(l,e){return[].slice.call(l.childNodes).reduce((t,i,r)=>{var a;return i.nodeName==="br"&&r?t+`
`:(a=i.childNodes)!=null&&a.length?qx(i,e):e?t+i.textContent.trim().replace(/\s+/g," "):t+i.textContent},"")}function S_(l,e,t){const i="http://www.w3.org/ns/ttml#styling";let r=null;const a=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],c=l!=null&&l.hasAttribute("style")?l.getAttribute("style"):null;return c&&t.hasOwnProperty(c)&&(r=t[c]),a.reduce((u,f)=>{const h=bd(e,i,f)||bd(l,i,f)||bd(r,i,f);return h&&(u[f]=h),u},{})}function bd(l,e,t){return l&&l.hasAttributeNS(e,t)?l.getAttributeNS(e,t):null}function Hp(l){return new Error(`Could not parse ttml timestamp ${l}`)}function Ad(l,e){if(!l)return null;let t=Hx(l);return t===null&&(zx.test(l)?t=T_(l,e):Yx.test(l)&&(t=b_(l,e))),t}function T_(l,e){const t=zx.exec(l),i=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+i/e.frameRate}function b_(l,e){const t=Yx.exec(l),i=Number(t[1]);switch(t[2]){case"h":return i*3600;case"m":return i*60;case"ms":return i*1e3;case"f":return i/e.frameRate;case"t":return i/e.tickRate}return i}class lo{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,i){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class A_{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Kp(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(A.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(A.FRAG_LOADING,this.onFragLoading,this),e.on(A.FRAG_LOADED,this.onFragLoaded,this),e.on(A.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(A.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(A.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(A.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(A.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(A.FRAG_LOADING,this.onFragLoading,this),e.off(A.FRAG_LOADED,this.onFragLoaded,this),e.off(A.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(A.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(A.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(A.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new lo(this,"textTrack1"),t=new lo(this,"textTrack2"),i=new lo(this,"textTrack3"),r=new lo(this,"textTrack4");this.cea608Parser1=new jp(1,e,t),this.cea608Parser2=new jp(3,i,r)}addCues(e,t,i,r,a){let c=!1;for(let u=a.length;u--;){const f=a[u],h=R_(f[0],f[1],t,i);if(h>=0&&(f[0]=Math.min(f[0],t),f[1]=Math.max(f[1],i),c=!0,h/(i-t)>.5))return}if(c||a.push([t,i]),this.config.renderTextTracksNatively){const u=this.captionsTracks[e];this.Cues.newCue(u,t,i,r)}else{const u=this.Cues.newCue(null,t,i,r);this.hls.trigger(A.CUES_PARSED,{type:"captions",cues:u,track:e})}}onInitPtsFound(e,{frag:t,id:i,initPTS:r,timescale:a,trackId:c}){const{unparsedVttFrags:u}=this;i===me.MAIN&&(this.initPTS[t.cc]={baseTime:r,timescale:a,trackId:c}),u.length&&(this.unparsedVttFrags=[],u.forEach(f=>{this.initPTS[f.frag.cc]?this.onFragLoaded(A.FRAG_LOADED,f):this.hls.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:f.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){const{media:i}=this;if(i)for(let r=0;r<i.textTracks.length;r++){const a=i.textTracks[r];if(Vp(a,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return a}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:i,media:r}=this,{label:a,languageCode:c}=t[e],u=this.getExistingTrack(a,c);if(u)i[e]=u,nr(i[e]),Bx(i[e],r);else{const f=this.createTextTrack("captions",a,c);f&&(f[e]=!0,i[e]=f)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const i=t.label,r={_id:e,label:i,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(A.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,i){const r=this.media;if(r)return r.addTextTrack(e,t,i)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const i=!!t.transferMedia;if(this.media=null,i)return;const{captionsTracks:r}=this;Object.keys(r).forEach(a=>{nr(r[a]),delete r[a]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Kp(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let i=0;i<t.length;i++)nr(t[i])}onSubtitleTracksUpdated(e,t){const i=t.subtitleTracks||[],r=i.some(a=>a.textCodec===Sd);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(Rx(this.tracks,i)){this.tracks=i;return}if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const c=this.media,u=c?vo(c.textTracks):null;if(this.tracks.forEach((f,h)=>{let m;if(u){let p=null;for(let y=0;y<u.length;y++)if(u[y]&&Vp(u[y],f)){p=u[y],u[y]=null;break}p&&(m=p)}if(m)nr(m);else{const p=Xx(f);m=this.createTextTrack(p,f.name,f.lang),m&&(m.mode="disabled")}m&&this.textTracks.push(m)}),u!=null&&u.length){const f=u.filter(h=>h!==null).map(h=>h.label);f.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${f.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const c=this.tracks.map(u=>({label:u.name,kind:u.type.toLowerCase(),default:u.default,subtitleTrack:u}));this.hls.trigger(A.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:c})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(i=>{const r=/(?:CC|SERVICE)([1-4])/.exec(i.instreamId);if(!r)return;const a=`textTrack${r[1]}`,c=this.captionsProperties[a];c&&(c.label=i.name,i.lang&&(c.languageCode=i.lang),c.media=i)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===me.MAIN){var i,r;const{cea608Parser1:a,cea608Parser2:c,lastSn:u}=this,{cc:f,sn:h}=t.frag,m=(i=(r=t.part)==null?void 0:r.index)!=null?i:-1;a&&c&&(h!==u+1||h===u&&m!==this.lastPartIndex+1||f!==this.lastCc)&&(a.reset(),c.reset()),this.lastCc=f,this.lastSn=h,this.lastPartIndex=m}}onFragLoaded(e,t){const{frag:i,payload:r}=t;if(i.type===me.SUBTITLE)if(r.byteLength){const a=i.decryptdata,c="stats"in t;if(a==null||!a.encrypted||c){const u=this.tracks[i.level],f=this.vttCCs;f[i.cc]||(f[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),u&&u.textCodec===Sd?this._parseIMSC1(i,r):this._parseVTTs(t)}}else this.hls.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const i=this.hls;$p(t,this.initPTS[e.cc],r=>{this._appendCues(r,e.level),i.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},r=>{i.logger.log(`Failed to parse IMSC1: ${r}`),i.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:r})})}_parseVTTs(e){var t;const{frag:i,payload:r}=e,{initPTS:a,unparsedVttFrags:c}=this,u=a.length-1;if(!a[i.cc]&&u===-1){c.push(e);return}const f=this.hls,h=(t=i.initSegment)!=null&&t.data?fi(i.initSegment.data,new Uint8Array(r)).buffer:r;x_(h,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,m=>{this._appendCues(m,i.level),f.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},m=>{const p=m.message==="Missing initPTS for VTT MPEGTS";p?c.push(e):this._fallbackToIMSC1(i,r),f.logger.log(`Failed to parse VTT cue: ${m}`),!(p&&u>i.cc)&&f.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:m})})}_fallbackToIMSC1(e,t){const i=this.tracks[e.level];i.textCodec||$p(t,this.initPTS[e.cc],()=>{i.textCodec=Sd,this._parseIMSC1(e,t)},()=>{i.textCodec="wvtt"})}_appendCues(e,t){const i=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[t];if(!r||r.mode==="disabled")return;e.forEach(a=>Fx(r,a))}else{const r=this.tracks[t];if(!r)return;const a=r.default?"default":"subtitles"+t;i.trigger(A.CUES_PARSED,{type:"subtitles",cues:e,track:a})}}onFragDecrypted(e,t){const{frag:i}=t;i.type===me.SUBTITLE&&this.onFragLoaded(A.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:i,samples:r}=t;if(!(i.type===me.MAIN&&this.closedCaptionsForLevel(i)==="NONE"))for(let a=0;a<r.length;a++){const c=r[a].bytes;if(c){this.cea608Parser1||this.initCea608Parsers();const u=this.extractCea608Data(c);this.cea608Parser1.addData(r[a].pts,u[0]),this.cea608Parser2.addData(r[a].pts,u[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:i,endOffsetSubtitles:r,type:a}){const{media:c}=this;if(!(!c||c.currentTime<i)){if(!a||a==="video"){const{captionsTracks:u}=this;Object.keys(u).forEach(f=>Kd(u[f],t,i))}if(this.config.renderTextTracksNatively&&t===0&&r!==void 0){const{textTracks:u}=this;Object.keys(u).forEach(f=>Kd(u[f],t,r))}}}extractCea608Data(e){const t=[[],[]],i=e[0]&31;let r=2;for(let a=0;a<i;a++){const c=e[r++],u=127&e[r++],f=127&e[r++];if(u===0&&f===0)continue;if((4&c)!==0){const m=3&c;(m===0||m===1)&&(t[m].push(u),t[m].push(f))}}return t}}function Xx(l){return l.characteristics&&/transcribes-spoken-dialog/gi.test(l.characteristics)&&/describes-music-and-sound/gi.test(l.characteristics)?"captions":"subtitles"}function Vp(l,e){return!!l&&l.kind===Xx(e)&&$d(e,l)}function R_(l,e,t,i){return Math.min(e,i)-Math.max(l,t)}function Kp(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const L_=/\s/,__={newCue(l,e,t,i){const r=[];let a,c,u,f,h;const m=self.VTTCue||self.TextTrackCue;for(let y=0;y<i.rows.length;y++)if(a=i.rows[y],u=!0,f=0,h="",!a.isEmpty()){var p;for(let T=0;T<a.chars.length;T++)L_.test(a.chars[T].uchar)&&u?f++:(h+=a.chars[T].uchar,u=!1);a.cueStartTime=e,e===t&&(t+=1e-4),f>=16?f--:f++;const S=Kx(h.trim()),E=Rh(e,t,S);l!=null&&(p=l.cues)!=null&&p.getCueById(E)||(c=new m(e,t,S),c.id=E,c.line=y+1,c.align="left",c.position=10+Math.min(80,Math.floor(f*8/32)*10),r.push(c))}return l&&r.length&&(r.sort((y,S)=>y.line==="auto"||S.line==="auto"?0:y.line>8&&S.line>8?S.line-y.line:y.line-S.line),r.forEach(y=>Fx(l,y))),r}};function D_(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const I_=/(\d+)-(\d+)\/(\d+)/;class zp{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||k_,this.controller=new self.AbortController,this.stats=new sh}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,i){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const a=C_(e,this.controller.signal),c=e.responseType==="arraybuffer",u=c?"byteLength":"length",{maxTimeToFirstByteMs:f,maxLoadTimeMs:h}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=i,this.request=this.fetchSetup(e,a),self.clearTimeout(this.requestTimeout),t.timeout=f&&de(f)?f:h,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))},t.timeout),(_a(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(p=>{var y;this.response=this.loader=p;const S=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=h,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))},h-(S-r.loading.start)),!p.ok){const{status:T,statusText:b}=p;throw new O_(b||"fetch, bad network response",T,p)}r.loading.first=S,r.total=N_(p.headers)||r.total;const E=(y=this.callbacks)==null?void 0:y.onProgress;return E&&de(t.highWaterMark)?this.loadProgressively(p,r,e,t.highWaterMark,E):c?p.arrayBuffer():e.responseType==="json"?p.json():p.text()}).then(p=>{var y,S;const E=this.response;if(!E)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const T=p[u];T&&(r.loaded=r.total=T);const b={url:E.url,data:p,code:E.status},L=(y=this.callbacks)==null?void 0:y.onProgress;L&&!de(t.highWaterMark)&&L(r,e,p,E),(S=this.callbacks)==null||S.onSuccess(b,r,e,E)}).catch(p=>{var y;if(self.clearTimeout(this.requestTimeout),r.aborted)return;const S=p&&p.code||0,E=p?p.message:null;(y=this.callbacks)==null||y.onError({code:S,text:E},e,p?p.details:null,r)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,i,r=0,a){const c=new rx,u=e.body.getReader(),f=()=>u.read().then(h=>{if(h.done)return c.dataLength&&a(t,i,c.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const m=h.value,p=m.length;return t.loaded+=p,p<r||c.dataLength?(c.push(m),c.dataLength>=r&&a(t,i,c.flush().buffer,e)):a(t,i,m.buffer,e),f()}).catch(()=>Promise.reject());return f()}}function C_(l,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Ke({},l.headers))};return l.rangeEnd&&t.headers.set("Range","bytes="+l.rangeStart+"-"+String(l.rangeEnd-1)),t}function w_(l){const e=I_.exec(l);if(e)return parseInt(e[2])-parseInt(e[1])+1}function N_(l){const e=l.get("Content-Range");if(e){const i=w_(e);if(de(i))return i}const t=l.get("Content-Length");if(t)return parseInt(t)}function k_(l,e){return new self.Request(l.url,e)}class O_ extends Error{constructor(e,t,i){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=i}}const M_=/^age:\s*[\d.]+\s*$/im;class Qx{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new sh,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const i=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const a=this.xhrSetup;a?Promise.resolve().then(()=>{if(!(this.loader!==i||this.stats.aborted))return a(i,t.url)}).catch(c=>{if(!(this.loader!==i||this.stats.aborted))return i.open("GET",t.url,!0),a(i,t.url)}).then(()=>{this.loader!==i||this.stats.aborted||this.openAndSendXhr(i,t,e)}).catch(c=>{var u;(u=this.callbacks)==null||u.onError({code:i.status,text:c.message},t,i,r)}):this.openAndSendXhr(i,t,e)}openAndSendXhr(e,t,i){e.readyState||e.open("GET",t.url,!0);const r=t.headers,{maxTimeToFirstByteMs:a,maxLoadTimeMs:c}=i.loadPolicy;if(r)for(const u in r)e.setRequestHeader(u,r[u]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),i.timeout=a&&de(a)?a:c,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:i}=this;if(!e||!t)return;const r=t.readyState,a=this.config;if(!i.aborted&&r>=2&&(i.loading.first===0&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),a.timeout!==a.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),a.timeout=a.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),r===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const h=t.status,m=t.responseType==="text"?t.responseText:null;if(h>=200&&h<300){const E=m??t.response;if(E!=null){var c,u;i.loading.end=Math.max(self.performance.now(),i.loading.first);const T=t.responseType==="arraybuffer"?E.byteLength:E.length;i.loaded=i.total=T,i.bwEstimate=i.total*8e3/(i.loading.end-i.loading.first);const b=(c=this.callbacks)==null?void 0:c.onProgress;b&&b(i,e,E,t);const L={url:t.responseURL,data:E,code:h};(u=this.callbacks)==null||u.onSuccess(L,i,e,t);return}}const p=a.loadPolicy.errorRetry,y=i.retry,S={url:e.url,data:void 0,code:h};if(_o(p,y,!1,S))this.retry(p);else{var f;$e.error(`${h} while loading ${e.url}`),(f=this.callbacks)==null||f.onError({code:h,text:t.statusText},e,t,i)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(_o(e,t,!0))this.retry(e);else{var i;$e.warn(`timeout while loading ${(i=this.context)==null?void 0:i.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:i}=this;this.retryDelay=lh(e,i.retry),i.retry++,$e.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${i.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&M_.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const P_={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},U_=je(je({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:Qx,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:XA,bufferController:FR,capLevelController:Sh,errorController:e1,fpsController:jL,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:qy,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:P_},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},B_()),{},{subtitleStreamController:ZL,subtitleTrackController:HL,timelineController:A_,audioStreamController:MR,audioTrackController:PR,emeController:lr,cmcdController:PL,contentSteeringController:BL,interstitialsController:WL});function B_(){return{cueHandler:__,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function F_(l,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=Yd(l),r=["manifest","level","frag"],a=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return r.forEach(c=>{const u=`${c==="level"?"playlist":c}LoadPolicy`,f=e[u]===void 0,h=[];a.forEach(m=>{const p=`${c}Loading${m}`,y=e[p];if(y!==void 0&&f){h.push(p);const S=i[u].default;switch(e[u]={default:S},m){case"TimeOut":S.maxLoadTimeMs=y,S.maxTimeToFirstByteMs=y;break;case"MaxRetry":S.errorRetry.maxNumRetry=y,S.timeoutRetry.maxNumRetry=y;break;case"RetryDelay":S.errorRetry.retryDelayMs=y,S.timeoutRetry.retryDelayMs=y;break;case"MaxRetryTimeout":S.errorRetry.maxRetryDelayMs=y,S.timeoutRetry.maxRetryDelayMs=y;break}}}),h.length&&t.warn(`hls.js config: "${h.join('", "')}" setting(s) are deprecated, use "${u}": ${Xe(e[u])}`)}),je(je({},i),e)}function Yd(l){return l&&typeof l=="object"?Array.isArray(l)?l.map(Yd):Object.keys(l).reduce((e,t)=>(e[t]=Yd(l[t]),e),{}):l}function j_(l,e){const t=l.loader;t!==zp&&t!==Qx?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),l.progressive=!1):D_()&&(l.loader=zp,l.progressive=!0,l.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const Eo=2,$_=.1,G_=.05,H_=100;class V_ extends Hy{constructor(e,t){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var i;(i=this.media)!=null&&i.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var i;this.ended=((i=this.media)==null?void 0:i.currentTime)||1,this.hls.trigger(A.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(H_),this.mediaSource=t.mediaSource;const i=this.media=t.media;Nt(i,"playing",this.onMediaPlaying),Nt(i,"waiting",this.onMediaWaiting),Nt(i,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:i}=this;i&&(Gt(i,"playing",this.onMediaPlaying),Gt(i,"waiting",this.onMediaWaiting),Gt(i,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var i,r;const a=(i=this.hls)==null?void 0:i.config;if(!a)return;const c=this.media;if(!c)return;const{seeking:u}=c,f=this.seeking&&!u,h=!this.seeking&&u,m=c.paused&&!u||c.ended||c.playbackRate===0;if(this.seeking=u,e!==t){t&&(this.ended=0),this.moved=!0,u||(this.nudgeRetry=0,a.nudgeOnVideoHole&&!m&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(h||f){f&&this.stallResolved(e);return}if(m){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&c.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(A.MEDIA_ENDED,{stalled:!1}));return}if(!be.getBuffered(c).length){this.nudgeRetry=0;return}const p=be.bufferInfo(c,e,0),y=p.nextStart||0,S=this.fragmentTracker;if(u&&S&&this.hls){const K=Yp(this.hls.inFlightFragments,e),O=p.len>Eo,j=!y||K||y-e>Eo&&!S.getPartialFragment(e);if(O||j)return;this.moved=!1}const E=(r=this.hls)==null?void 0:r.latestLevelDetails;if(!this.moved&&this.stalled!==null&&S){if(!(p.len>0)&&!y)return;const O=Math.max(y,p.start||0)-e,B=!!(E!=null&&E.live)?E.targetduration*2:Eo,U=oo(e,S);if(O>0&&(O<=B||U)){c.paused||this._trySkipBufferHole(U);return}}const T=a.detectStallWithCurrentTimeMs,b=self.performance.now(),L=this.waiting;let _=this.stalled;if(_===null)if(L>0&&b-L<T)_=this.stalled=L;else{this.stalled=b;return}const I=b-_;if(!u&&(I>=T||L)&&this.hls){var C;if(((C=this.mediaSource)==null?void 0:C.readyState)==="ended"&&!(E!=null&&E.live)&&Math.abs(e-((E==null?void 0:E.edge)||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(A.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(p),!this.media||!this.hls)return}const N=be.bufferInfo(c,e,a.maxBufferHole);this._tryFixBufferStall(N,I,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const i=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(i)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(A.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var i;const r=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(i=this.buffered.audio)!=null&&i.length&&r&&r.length>1&&e>r.end(0)){const a=be.bufferedInfo(be.timeRangesToArray(this.buffered.audio),e,0);if(a.len>1&&t>=a.start){const c=be.timeRangesToArray(r),u=be.bufferedInfo(c,t,0).bufferedIndex;if(u>-1&&u<c.length-1){const f=be.bufferedInfo(c,e,0).bufferedIndex,h=c[u].end,m=c[u+1].start;if((f===-1||f>u)&&m-h<1&&e-h<2){const p=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${h} -> ${m} buffered index: ${f}`);this.warn(p.message),this.media.currentTime+=1e-6;let y=oo(e,this.fragmentTracker);y&&"fragment"in y?y=y.fragment:y||(y=void 0);const S=be.bufferInfo(this.media,e,0);this.hls.trigger(A.ERROR,{type:pe.MEDIA_ERROR,details:H.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:p,reason:p.message,frag:y,buffer:S.len,bufferInfo:S})}}}}}_tryFixBufferStall(e,t,i){var r,a;const{fragmentTracker:c,media:u}=this,f=(r=this.hls)==null?void 0:r.config;if(!u||!c||!f)return;const h=(a=this.hls)==null?void 0:a.latestLevelDetails,m=oo(i,c);if((m||h!=null&&h.live&&i<h.fragmentStart)&&(this._trySkipBufferHole(m)||!this.media))return;const p=e.buffered,y=this.adjacentTraversal(e,i);(p&&p.length>1&&e.len>f.maxBufferHole||e.nextStart&&(e.nextStart-i<f.maxBufferHole||y))&&(t>f.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const i=this.fragmentTracker,r=e.nextStart;if(i&&r){const a=i.getFragAtPos(t,me.MAIN),c=i.getFragAtPos(r,me.MAIN);if(a&&c)return c.sn-a.sn<2}return!1}_reportStall(e){const{hls:t,media:i,stallReported:r,stalled:a}=this;if(!r&&a!==null&&i&&t){this.stallReported=!0;const c=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${Xe(e)})`);this.warn(c.message),t.trigger(A.ERROR,{type:pe.MEDIA_ERROR,details:H.BUFFER_STALLED_ERROR,fatal:!1,error:c,buffer:e.len,bufferInfo:e,stalled:{start:a}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:i,media:r}=this,a=(t=this.hls)==null?void 0:t.config;if(!r||!i||!a)return 0;const c=r.currentTime,u=be.bufferInfo(r,c,0),f=c<u.start?u.start:u.nextStart;if(f&&this.hls){const m=u.len<=a.maxBufferHole,p=u.len>0&&u.len<1&&r.readyState<3,y=f-c;if(y>0&&(m||p)){if(y>a.maxBufferHole){let E=!1;if(c===0){const T=i.getAppendedFrag(0,me.MAIN);T&&f<T.end&&(E=!0)}if(!E&&e){var h;if(!((h=this.hls.loadLevelObj)!=null&&h.details)||Yp(this.hls.inFlightFragments,f))return 0;let b=!1,L=e.end;for(;L<f;){const _=oo(L,i);if(_)L+=_.duration;else{b=!0;break}}if(b)return 0}}const S=Math.max(f+G_,c+$_);if(this.warn(`skipping hole, adjusting currentTime from ${c} to ${S}`),this.moved=!0,r.currentTime=S,!(e!=null&&e.gap)){const E=new Error(`fragment loaded with buffer holes, seeking from ${c} to ${S}`),T={type:pe.MEDIA_ERROR,details:H.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:E,reason:E.message,buffer:u.len,bufferInfo:u};e&&("fragment"in e?T.part=e:T.frag=e),this.hls.trigger(A.ERROR,T)}return S}}return 0}_tryNudgeBuffer(e){const{hls:t,media:i,nudgeRetry:r}=this,a=t==null?void 0:t.config;if(!i||!a)return 0;const c=i.currentTime;if(this.nudgeRetry++,r<a.nudgeMaxRetry){const u=c+(r+1)*a.nudgeOffset,f=new Error(`Nudging 'currentTime' from ${c} to ${u}`);this.warn(f.message),i.currentTime=u,t.trigger(A.ERROR,{type:pe.MEDIA_ERROR,details:H.BUFFER_NUDGE_ON_STALL,error:f,fatal:!1,buffer:e.len,bufferInfo:e})}else{const u=new Error(`Playhead still not moving while enough data buffered @${c} after ${a.nudgeMaxRetry} nudges`);this.error(u.message),t.trigger(A.ERROR,{type:pe.MEDIA_ERROR,details:H.BUFFER_STALLED_ERROR,error:u,fatal:!0,buffer:e.len,bufferInfo:e})}}}function Yp(l,e){const t=qp(l.main);if(t&&t.start<=e)return t;const i=qp(l.audio);return i&&i.start<=e?i:null}function qp(l){if(!l)return null;switch(l.state){case ee.IDLE:case ee.STOPPED:case ee.ENDED:case ee.ERROR:return null}return l.frag}function oo(l,e){return e.getAppendedFrag(l,me.MAIN)||e.getPartialFragment(l)}const K_=.25;function qd(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function Rd(l,e,t,i,r){let a=new l(e,t,"");try{a.value=i,r&&(a.type=r)}catch{a=new l(e,t,Xe(r?je({type:r},i):i))}return a}const co=(()=>{const l=qd();try{l&&new l(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class z_{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(A.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(A.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(A.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(A.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(A.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,t){var i;this.media=t.media,((i=t.overrides)==null?void 0:i.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;const t=(e=this.hls)==null?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&nr(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const i=e[t];if(i.kind==="metadata"&&i.label==="id3")return Bx(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:i,enableID3MetadataCues:r}=this.hls.config;if(!i&&!r)return;const{samples:a}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const c=qd();if(c)for(let u=0;u<a.length;u++){const f=a[u].type;if(f===Jt.emsg&&!i||!r)continue;const h=hx(a[u].data),m=a[u].pts;let p=m+a[u].duration;p>co&&(p=co),p-m<=0&&(p=m+K_);for(let S=0;S<h.length;S++){const E=h[S];if(!fx(E)){this.updateId3CueEnds(m,f);const T=Rd(c,m,p,E,f);T&&this.id3Track.addCue(T)}}}}updateId3CueEnds(e,t){var i;const r=(i=this.id3Track)==null?void 0:i.cues;if(r)for(let a=r.length;a--;){const c=r[a];c.type===t&&c.startTime<e&&c.endTime===co&&(c.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:i,type:r}){const{id3Track:a,hls:c}=this;if(!c)return;const{config:{enableEmsgMetadataCues:u,enableID3MetadataCues:f}}=c;if(a&&(u||f)){let h;r==="audio"?h=m=>m.type===Jt.audioId3&&f:r==="video"?h=m=>m.type===Jt.emsg&&u:h=m=>m.type===Jt.audioId3&&f||m.type===Jt.emsg&&u,Kd(a,t,i,h)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.hls||!this.media)return;const{assetPlayerId:i,timelineOffset:r,enableDateRangeMetadataCues:a,interstitialsController:c}=this.hls.config;if(!a)return;const u=qd();if(i&&r&&!c){const{fragmentStart:T,fragmentEnd:b}=e;let L=this.assetCue;L?(L.startTime=T,L.endTime=b):u&&(L=this.assetCue=Rd(u,T,b,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),L&&(L.id=i,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(L),L.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:f}=this,{dateRanges:h}=e,m=Object.keys(h);let p=this.dateRangeCuesAppended;if(f&&t){var y;if((y=f.cues)!=null&&y.length){const T=Object.keys(p).filter(b=>!m.includes(b));for(let b=T.length;b--;){var S;const L=T[b],_=(S=p[L])==null?void 0:S.cues;delete p[L],_&&Object.keys(_).forEach(I=>{const C=_[I];if(C){C.removeEventListener("enter",this.onEventCueEnter);try{f.removeCue(C)}catch{}}})}}else p=this.dateRangeCuesAppended={}}const E=e.fragments[e.fragments.length-1];if(!(m.length===0||!de(E==null?void 0:E.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let T=0;T<m.length;T++){const b=m[T],L=h[b],_=L.startTime,I=p[b],C=(I==null?void 0:I.cues)||{};let N=(I==null?void 0:I.durationKnown)||!1,K=co;const{duration:O,endDate:j}=L;if(j&&O!==null)K=_+O,N=!0;else if(L.endOnNext&&!N){const U=m.reduce((W,re)=>{if(re!==L.id){const ue=h[re];if(ue.class===L.class&&ue.startDate>L.startDate&&(!W||L.startDate<W.startDate))return ue}return W},null);U&&(K=U.startTime,N=!0)}const B=Object.keys(L.attr);for(let U=0;U<B.length;U++){const W=B[U];if(!f1(W))continue;const re=C[W];if(re)N&&!(I!=null&&I.durationKnown)?re.endTime=K:Math.abs(re.startTime-_)>.01&&(re.startTime=_,re.endTime=K);else if(u){let ue=L.attr[W];m1(W)&&(ue=by(ue));const le=Rd(u,_,K,{key:W,data:ue},Jt.dateRange);le&&(le.id=b,this.id3Track.addCue(le),C[W]=le,c&&(W==="X-ASSET-LIST"||W==="X-ASSET-URL")&&le.addEventListener("enter",this.onEventCueEnter))}}p[b]={cues:C,dateRange:L,durationKnown:N}}}}}class Y_{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,i=this.levelDetails;if(!t||!i)return;this.currentTime=t.currentTime;const r=this.computeLatency();if(r===null)return;this._latency=r;const{lowLatencyMode:a,maxLiveSyncPlaybackRate:c}=this.config;if(!a||c===1||!i.live)return;const u=this.targetLatency;if(u===null)return;const f=r-u,h=Math.min(this.maxLatency,u+i.targetduration);if(f<h&&f>.05&&this.forwardBufferLength>1){const p=Math.min(2,Math.max(1,c)),y=Math.round(2/(1+Math.exp(-.75*f-this.edgeStalled))*20)/20,S=Math.min(p,Math.max(1,y));this.changeMediaPlaybackRate(t,S)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:i,targetduration:r}=e,{liveSyncDuration:a,liveSyncDurationCount:c,lowLatencyMode:u}=this.config,f=this.hls.userConfig;let h=u&&i||t;(this._targetLatencyUpdated||f.liveSyncDuration||f.liveSyncDurationCount||h===0)&&(h=a!==void 0?a:c*r);const m=r;return h+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,m)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const i=this.levelDetails;if(i===null)return null;const r=i.edge,a=e-t-this.edgeStalled,c=r-i.totalduration,u=r-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(c,a),u)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const i=e.buffered.length;return(i?e.buffered.end(i-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(A.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(A.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var i;t.details===H.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(i=this.levelDetails)!=null&&i.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var i,r;e.playbackRate!==t&&((i=this.hls)==null||i.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(r=this.targetLatency)==null?void 0:r.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class q_ extends Eh{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(A.LEVEL_LOADED,this.onLevelLoaded,this),e.on(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(A.FRAG_BUFFERED,this.onFragBuffered,this),e.on(A.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(A.LEVEL_LOADED,this.onLevelLoaded,this),e.off(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(A.FRAG_BUFFERED,this.onFragBuffered,this),e.off(A.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const i=this.hls.config.preferManagedMediaSource,r=[],a={},c={};let u=!1,f=!1,h=!1;t.levels.forEach(m=>{const p=m.attrs;let{audioCodec:y,videoCodec:S}=m;y&&(m.audioCodec=y=bo(y,i)||void 0),S&&(S=m.videoCodec=CA(S));const{width:E,height:T,unknownCodecs:b}=m,L=(b==null?void 0:b.length)||0;if(u||(u=!!(E&&T)),f||(f=!!S),h||(h=!!y),L||y&&!this.isAudioSupported(y)||S&&!this.isVideoSupported(S)){this.log(`Some or all CODECS not supported "${p.CODECS}"`);return}const{CODECS:_,"FRAME-RATE":I,"HDCP-LEVEL":C,"PATHWAY-ID":N,RESOLUTION:K,"VIDEO-RANGE":O}=p,B=`${`${N||"."}-`}${m.bitrate}-${K}-${I}-${_}-${O}-${C}`;if(a[B])if(a[B].uri!==m.url&&!m.attrs["PATHWAY-ID"]){const U=c[B]+=1;m.attrs["PATHWAY-ID"]=new Array(U+1).join(".");const W=this.createLevel(m);a[B]=W,r.push(W)}else a[B].addGroupId("audio",p.AUDIO),a[B].addGroupId("text",p.SUBTITLES);else{const U=this.createLevel(m);a[B]=U,c[B]=1,r.push(U)}}),this.filterAndSortMediaOptions(r,t,u,f,h)}createLevel(e){const t=new Aa(e),i=e.supplemental;if(i!=null&&i.videoCodec&&!this.isVideoSupported(i.videoCodec)){const r=new Error(`SUPPLEMENTAL-CODECS not supported "${i.videoCodec}"`);this.log(r.message),t.supportedResult=My(r,[])}return t}isAudioSupported(e){return Ta(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return Ta(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,i,r,a){var c;let u=[],f=[],h=e;const m=((c=t.stats)==null?void 0:c.parsing)||{};if((i||r)&&a&&(h=h.filter(({videoCodec:_,videoRange:I,width:C,height:N})=>(!!_||!!(C&&N))&&jA(I))),h.length===0){Promise.resolve().then(()=>{if(this.hls){let _="no level with compatible codecs found in manifest",I=_;t.levels.length&&(I=`one or more CODECS in variant not supported: ${Xe(t.levels.map(N=>N.attrs.CODECS).filter((N,K,O)=>O.indexOf(N)===K))}`,this.warn(I),_+=` (${I})`);const C=new Error(_);this.hls.trigger(A.ERROR,{type:pe.MEDIA_ERROR,details:H.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:C,reason:I})}}),m.end=performance.now();return}t.audioTracks&&(u=t.audioTracks.filter(_=>!_.audioCodec||this.isAudioSupported(_.audioCodec)),Xp(u)),t.subtitles&&(f=t.subtitles,Xp(f));const p=h.slice(0);h.sort((_,I)=>{if(_.attrs["HDCP-LEVEL"]!==I.attrs["HDCP-LEVEL"])return(_.attrs["HDCP-LEVEL"]||"")>(I.attrs["HDCP-LEVEL"]||"")?1:-1;if(i&&_.height!==I.height)return _.height-I.height;if(_.frameRate!==I.frameRate)return _.frameRate-I.frameRate;if(_.videoRange!==I.videoRange)return Ao.indexOf(_.videoRange)-Ao.indexOf(I.videoRange);if(_.videoCodec!==I.videoCodec){const C=j0(_.videoCodec),N=j0(I.videoCodec);if(C!==N)return N-C}if(_.uri===I.uri&&_.codecSet!==I.codecSet){const C=To(_.codecSet),N=To(I.codecSet);if(C!==N)return N-C}return _.averageBitrate!==I.averageBitrate?_.averageBitrate-I.averageBitrate:0});let y=p[0];if(this.steering&&(h=this.steering.filterParsedLevels(h),h.length!==p.length)){for(let _=0;_<p.length;_++)if(p[_].pathwayId===h[0].pathwayId){y=p[_];break}}this._levels=h;for(let _=0;_<h.length;_++)if(h[_]===y){var S;this._firstLevel=_;const I=y.bitrate,C=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${h.length} level(s) found, first bitrate: ${I}`),((S=this.hls.userConfig)==null?void 0:S.abrEwmaDefaultEstimate)===void 0){const N=Math.min(I,this.hls.config.abrEwmaDefaultEstimateMax);N>C&&C===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=N)}break}const E=a&&!r,T=this.hls.config,b=!!(T.audioStreamController&&T.audioTrackController),L={levels:h,audioTracks:u,subtitleTracks:f,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:a,video:r,altAudio:b&&!E&&u.some(_=>!!_.url)};m.end=performance.now(),this.hls.trigger(A.MANIFEST_PARSED,L)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const m=new Error("invalid level idx"),p=e<0;if(this.hls.trigger(A.ERROR,{type:pe.OTHER_ERROR,details:H.LEVEL_SWITCH_ERROR,level:e,fatal:p,error:m,reason:m.message}),p)return;e=Math.min(e,t.length-1)}const i=this.currentLevelIndex,r=this.currentLevel,a=r?r.attrs["PATHWAY-ID"]:void 0,c=t[e],u=c.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=c,i===e&&r&&a===u)return;this.log(`Switching to level ${e} (${c.height?c.height+"p ":""}${c.videoRange?c.videoRange+" ":""}${c.codecSet?c.codecSet+" ":""}@${c.bitrate})${u?" with Pathway "+u:""} from level ${i}${a?" with Pathway "+a:""}`);const f={level:e,attrs:c.attrs,details:c.details,bitrate:c.bitrate,averageBitrate:c.averageBitrate,maxBitrate:c.maxBitrate,realBitrate:c.realBitrate,width:c.width,height:c.height,codecSet:c.codecSet,audioCodec:c.audioCodec,videoCodec:c.videoCodec,audioGroups:c.audioGroups,subtitleGroups:c.subtitleGroups,loaded:c.loaded,loadError:c.loadError,fragmentError:c.fragmentError,name:c.name,id:c.id,uri:c.uri,url:c.url,urlId:0,audioGroupIds:c.audioGroupIds,textGroupIds:c.textGroupIds};this.hls.trigger(A.LEVEL_SWITCHING,f);const h=c.details;if(!h||h.live){const m=this.switchParams(c.uri,r==null?void 0:r.details,h);this.loadPlaylist(m)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),i=e.filter(r=>t.indexOf(r)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=i}}onError(e,t){t.fatal||!t.context||t.context.type===Ie.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===me.MAIN){const i=t.elementaryStreams;if(!Object.keys(i).some(a=>!!i[a]))return;const r=this._levels[t.level];r!=null&&r.loadError&&(this.log(`Resetting level error count of ${r.loadError} on frag buffered`),r.loadError=0)}}onLevelLoaded(e,t){var i;const{level:r,details:a}=t,c=t.levelInfo;if(!c){var u;this.warn(`Invalid level index ${r}`),(u=t.deliveryDirectives)!=null&&u.skip&&(a.deltaUpdateFailed=!0);return}if(c===this.currentLevel||t.withoutMultiVariant){c.fragmentError===0&&(c.loadError=0);let f=c.details;f===t.details&&f.advanced&&(f=void 0),this.playlistLoaded(r,t,f)}else(i=t.deliveryDirectives)!=null&&i.skip&&(a.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const i=this.getUrlWithDirectives(e.uri,t),r=this.currentLevelIndex,a=e.attrs["PATHWAY-ID"],c=e.details,u=c==null?void 0:c.age;this.log(`Loading level index ${r}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${a?" Pathway "+a:""}${u&&c.live?" age "+u.toFixed(1)+(c.type&&" "+c.type||""):""} ${i}`),this.hls.trigger(A.LEVEL_LOADING,{url:i,level:r,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const i=this._levels.filter((a,c)=>c!==e?!0:(this.steering&&this.steering.removeLevel(a),a===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,a.details&&a.details.fragments.forEach(u=>u.level=-1)),!1));ix(i),this._levels=i,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const r=i.length-1;this._firstLevel=Math.min(this._firstLevel,r),this._startLevel&&(this._startLevel=Math.min(this._startLevel,r)),this.hls.trigger(A.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:i}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(A.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}))}}function Xp(l){const e={};l.forEach(t=>{const i=t.groupId||"";t.id=e[i]=e[i]||0,e[i]++})}function Wx(){return self.SourceBuffer||self.WebKitSourceBuffer}function Zx(){if(!Ps())return!1;const e=Wx();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function X_(){if(!Zx())return!1;const l=Ps();return typeof(l==null?void 0:l.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>l.isTypeSupported(ba(e,"video")))||["mp4a.40.2","fLaC"].some(e=>l.isTypeSupported(ba(e,"audio"))))}function Q_(){var l;const e=Wx();return typeof(e==null||(l=e.prototype)==null?void 0:l.changeType)=="function"}const W_=100;class Z_ extends hh{constructor(e,t,i){super(e,t,i,"stream-controller",me.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const r=this.media,a=r?r.currentTime:null;if(a===null||!de(a)||(this.log(`Media seeked to ${a.toFixed(3)}`),!this.getBufferedFrag(a)))return;const c=this.getFwdBufferInfoAtPos(r,a,me.MAIN,0);if(c===null||c.len===0){this.warn(`Main forward buffer length at ${a} on "seeked" event ${c?c.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(A.MANIFEST_PARSED,this.onManifestParsed,this),e.on(A.LEVEL_LOADING,this.onLevelLoading,this),e.on(A.LEVEL_LOADED,this.onLevelLoaded,this),e.on(A.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(A.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(A.BUFFER_CREATED,this.onBufferCreated,this),e.on(A.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(A.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(A.MANIFEST_PARSED,this.onManifestParsed,this),e.off(A.LEVEL_LOADED,this.onLevelLoaded,this),e.off(A.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(A.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(A.BUFFER_CREATED,this.onBufferCreated,this),e.off(A.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(A.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(A.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:i,hls:r}=this;if(this.stopLoad(),this.setInterval(W_),this.level=-1,!this.startFragRequested){let a=r.startLevel;a===-1&&(r.config.testBandwidth&&this.levels.length>1?(a=0,this.bitrateTest=!0):a=r.firstAutoLevel),r.nextLoadLevel=a,this.level=r.loadLevel,this._hasEnoughToStart=!!t}i>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),e=i),this.state=ee.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=ee.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case ee.WAITING_LEVEL:{const{levels:e,level:t}=this,i=e==null?void 0:e[t],r=i==null?void 0:i.details;if(r&&(!r.live||this.levelLastLoaded===i&&!this.waitForLive(i))){if(this.waitForCdnTuneIn(r))break;this.state=ee.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=ee.IDLE;break}break}case ee.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===ee.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:i,media:r}=this;if(t===null||!r&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const a=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(i!=null&&i[a]))return;const c=i[a],u=this.getMainFwdBufferInfo();if(u===null)return;const f=this.getLevelDetails();if(f&&this._streamEnded(u,f)){const T={};this.altAudio===2&&(T.type="video"),this.hls.trigger(A.BUFFER_EOS,T),this.state=ee.ENDED;return}if(!this.buffering)return;e.loadLevel!==a&&e.manualLevel===-1&&this.log(`Adapting to level ${a} from level ${this.level}`),this.level=e.nextLoadLevel=a;const h=c.details;if(!h||this.state===ee.WAITING_LEVEL||this.waitForLive(c)){this.level=a,this.state=ee.WAITING_LEVEL,this.startFragRequested=!1;return}const m=u.len,p=this.getMaxBufferLength(c.maxBitrate);if(m>=p)return;this.backtrackFragment&&this.backtrackFragment.start>u.end&&(this.backtrackFragment=null);const y=this.backtrackFragment?this.backtrackFragment.start:u.end;let S=this.getNextFragment(y,h);if(this.couldBacktrack&&!this.fragPrevious&&S&&ut(S)&&this.fragmentTracker.getState(S)!==mt.OK){var E;const b=((E=this.backtrackFragment)!=null?E:S).sn-h.startSN,L=h.fragments[b-1];L&&S.cc===L.cc&&(S=L,this.fragmentTracker.removeFragment(L))}else this.backtrackFragment&&u.len&&(this.backtrackFragment=null);if(S&&this.isLoopLoading(S,y)){if(!S.gap){const b=this.audioOnly&&!this.altAudio?qe.AUDIO:qe.VIDEO,L=(b===qe.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;L&&this.afterBufferFlushed(L,b,me.MAIN)}S=this.getNextFragmentLoopLoading(S,h,u,me.MAIN,p)}S&&(S.initSegment&&!S.initSegment.data&&!this.bitrateTest&&(S=S.initSegment),this.loadFragment(S,c,y))}loadFragment(e,t,i){const r=this.fragmentTracker.getState(e);r===mt.NOT_LOADED||r===mt.PARTIAL?ut(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,i):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,me.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let i;const r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const a=this.getLevelDetails();if(a!=null&&a.live){const u=this.getMainFwdBufferInfo();if(!u||u.len<a.targetduration*2)return}if(!t.paused&&e){const u=this.hls.nextLoadLevel,f=e[u],h=this.fragLastKbps;h&&this.fragCurrent?i=this.fragCurrent.duration*f.maxBitrate/(1e3*h)+1:i=0}else i=0;const c=this.getBufferedFrag(t.currentTime+i);if(c){const u=this.followingBufferedFrag(c);if(u){this.abortCurrentFrag();const f=u.maxStartPTS?u.maxStartPTS:u.start,h=u.duration,m=Math.max(c.end,f+Math.min(Math.max(h-this.config.maxFragLookUpTolerance,h*(this.couldBacktrack?.5:.125)),h*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(m,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case ee.KEY_LOADING:case ee.FRAG_LOADING:case ee.FRAG_LOADING_WAITING_RETRY:case ee.PARSING:case ee.PARSED:this.state=ee.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const i=t.media;Nt(i,"playing",this.onMediaPlaying),Nt(i,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:i}=this;i&&(Gt(i,"playing",this.onMediaPlaying),Gt(i,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(A.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let i=!1,r=!1;for(let a=0;a<t.levels.length;a++){const c=t.levels[a].audioCodec;c&&(i=i||c.indexOf("mp4a.40.2")!==-1,r=r||c.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=i&&r&&!Q_(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:i}=this;if(!i||this.state!==ee.IDLE)return;const r=t.levelInfo;(!r.details||r.details.live&&(this.levelLastLoaded!==r||r.details.expired)||this.waitForCdnTuneIn(r.details))&&(this.state=ee.WAITING_LEVEL)}onLevelLoaded(e,t){var i;const{levels:r,startFragRequested:a}=this,c=t.level,u=t.details,f=u.totalduration;if(!r){this.warn(`Levels were reset while loading level ${c}`);return}this.log(`Level ${c} loaded [${u.startSN},${u.endSN}]${u.lastPartSn?`[part-${u.lastPartSn}-${u.lastPartIndex}]`:""}, cc [${u.startCC}, ${u.endCC}] duration:${f}`);const h=t.levelInfo,m=this.fragCurrent;m&&(this.state===ee.FRAG_LOADING||this.state===ee.FRAG_LOADING_WAITING_RETRY)&&m.level!==t.level&&m.loader&&this.abortCurrentFrag();let p=0;if(u.live||(i=h.details)!=null&&i.live){var y;if(this.checkLiveUpdate(u),u.deltaUpdateFailed)return;p=this.alignPlaylists(u,h.details,(y=this.levelLastLoaded)==null?void 0:y.details)}if(h.details=u,this.levelLastLoaded=h,a||this.setStartPosition(u,p),this.hls.trigger(A.LEVEL_UPDATED,{details:u,level:c}),this.state===ee.WAITING_LEVEL){if(this.waitForCdnTuneIn(u))return;this.state=ee.IDLE}a&&u.live&&this.synchronizeToLiveEdge(u),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:i}=this;if(!i)return;const r=this.hls.liveSyncPosition,a=this.getLoadPosition(),c=e.fragmentStart,u=e.edge,f=a>=c-t.maxFragLookUpTolerance&&a<=u;if(r!==null&&i.duration>r&&(a<r||!f)){const m=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!f&&i.readyState<4||a<u-m)&&(this._hasEnoughToStart||(this.nextLoadPosition=r),i.readyState))if(this.warn(`Playback: ${a.toFixed(3)} is located too far from the end of live sliding playlist: ${u}, reset currentTime to : ${r.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var h;const p=be.bufferInfo(i,r,0);if(!((h=p.buffered)!=null&&h.length)){i.currentTime=r;return}if(p.start<=a){i.currentTime=r;return}const{nextStart:S}=be.bufferedInfo(p.buffered,a,0);S&&(i.currentTime=S)}else i.currentTime=r}}_handleFragmentLoadProgress(e){var t;const i=e.frag,{part:r,payload:a}=e,{levels:c}=this;if(!c){this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const u=c[i.level];if(!u){this.warn(`Level ${i.level} not found on progress`);return}const f=u.details;if(!f){this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),this.fragmentTracker.removeFragment(i);return}const h=u.videoCodec,m=f.PTSKnown||!f.live,p=(t=i.initSegment)==null?void 0:t.data,y=this._getAudioCodec(u),S=this.transmuxer=this.transmuxer||new Ax(this.hls,me.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),E=r?r.index:-1,T=E!==-1,b=new ch(i.level,i.sn,i.stats.chunkCount,a.byteLength,E,T),L=this.initPTS[i.cc];S.push(a,p,y,h,i,r,f.totalduration,m,b,L)}onAudioTrackSwitching(e,t){const i=this.hls,r=this.altAudio===2;if(Ro(t.url,i))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const c=this.fragCurrent;c&&(this.log("Switching to main audio track, cancel main fragment load"),c.abortRequests(),this.fragmentTracker.removeFragment(c)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(r){this.fragmentTracker.removeAllFragments(),i.once(A.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(A.AUDIO_TRACK_SWITCHED,t)}),i.trigger(A.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}i.trigger(A.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const i=Ro(t.url,this.hls);if(i){const r=this.videoBuffer;r&&this.mediaBuffer!==r&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=i?2:0,this.tick()}onBufferCreated(e,t){const i=t.tracks;let r,a,c=!1;for(const u in i){const f=i[u];if(f.id==="main"){if(a=u,r=f,u==="video"){const h=i[u];h&&(this.videoBuffer=h.buffer)}}else c=!0}c&&r?(this.log(`Alternate track found, use ${a}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:i,part:r}=t,a=i.type===me.MAIN;if(a){if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${r?" p: "+r.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),this.state===ee.PARSED&&(this.state=ee.IDLE);return}const u=r?r.stats:i.stats;this.fragLastKbps=Math.round(8*u.total/(u.buffering.end-u.loading.first)),ut(i)&&(this.fragPrevious=i),this.fragBufferedComplete(i,r)}const c=this.media;c&&(!this._hasEnoughToStart&&be.getBuffered(c).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),a&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var i;if(t.fatal){this.state=ee.ERROR;return}switch(t.details){case H.FRAG_GAP:case H.FRAG_PARSING_ERROR:case H.FRAG_DECRYPT_ERROR:case H.FRAG_LOAD_ERROR:case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_ERROR:case H.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(me.MAIN,t);break;case H.LEVEL_LOAD_ERROR:case H.LEVEL_LOAD_TIMEOUT:case H.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ee.WAITING_LEVEL&&((i=t.context)==null?void 0:i.type)===Ie.LEVEL&&(this.state=ee.IDLE);break;case H.BUFFER_ADD_CODEC_ERROR:case H.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case H.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case H.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=ee.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==qe.AUDIO||!this.altAudio){const i=(t===qe.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;i&&(this.afterBufferFlushed(i,t,me.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let i=this.startPosition;if(i>=0&&t<i){if(e.seeking){this.log(`could not seek to ${i}, already seeking at ${t}`);return}const r=this.timelineOffset;r&&i&&(i+=r);const a=this.getLevelDetails(),c=be.getBuffered(e),u=c.length?c.start(0):0,f=u-i,h=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||f>0&&(f<h||this.loadingParts&&f<2*((a==null?void 0:a.partTarget)||0)))&&(this.log(`adjusting start position by ${f} to match buffer start`),i+=f,this.startPosition=i),t<i&&(this.log(`seek to target start position ${i} from current time ${t} buffer start ${u}`),e.currentTime=i)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(i=>{const{hls:r}=this,a=i==null?void 0:i.frag;if(!a||this.fragContextChanged(a))return;t.fragmentError=0,this.state=ee.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const c=a.stats;c.parsing.start=c.parsing.end=c.buffering.start=c.buffering.end=self.performance.now(),r.trigger(A.FRAG_LOADED,i),a.bitrateTest=!1}).catch(i=>{this.state===ee.STOPPED||this.state===ee.ERROR||(this.warn(i),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const t=this.playlistType,{hls:i}=this,{remuxResult:r,chunkMeta:a}=e,c=this.getCurrentContext(a);if(!c){this.resetWhenMissingContext(a);return}const{frag:u,part:f,level:h}=c,{video:m,text:p,id3:y,initSegment:S}=r,{details:E}=h,T=this.altAudio?void 0:r.audio;if(this.fragContextChanged(u)){this.fragmentTracker.removeFragment(u);return}if(this.state=ee.PARSING,S){const b=S.tracks;if(b){const C=u.initSegment||u;if(this.unhandledEncryptionError(S,u))return;this._bufferInitSegment(h,b,C,a),i.trigger(A.FRAG_PARSING_INIT_SEGMENT,{frag:C,id:t,tracks:b})}const L=S.initPTS,_=S.timescale,I=this.initPTS[u.cc];if(de(L)&&(!I||I.baseTime!==L||I.timescale!==_)){const C=S.trackId;this.initPTS[u.cc]={baseTime:L,timescale:_,trackId:C},i.trigger(A.INIT_PTS_FOUND,{frag:u,id:t,initPTS:L,timescale:_,trackId:C})}}if(m&&E){T&&m.type==="audiovideo"&&this.logMuxedErr(u);const b=E.fragments[u.sn-1-E.startSN],L=u.sn===E.startSN,_=!b||u.cc>b.cc;if(r.independent!==!1){const{startPTS:I,endPTS:C,startDTS:N,endDTS:K}=m;if(f)f.elementaryStreams[m.type]={startPTS:I,endPTS:C,startDTS:N,endDTS:K};else if(m.firstKeyFrame&&m.independent&&a.id===1&&!_&&(this.couldBacktrack=!0),m.dropped&&m.independent){const O=this.getMainFwdBufferInfo(),j=(O?O.end:this.getLoadPosition())+this.config.maxBufferHole,B=m.firstKeyFramePTS?m.firstKeyFramePTS:I;if(!L&&j<B-this.config.maxBufferHole&&!_){this.backtrack(u);return}else _&&(u.gap=!0);u.setElementaryStreamInfo(m.type,u.start,C,u.start,K,!0)}else L&&I-(E.appliedTimelineOffset||0)>Eo&&(u.gap=!0);u.setElementaryStreamInfo(m.type,I,C,N,K),this.backtrackFragment&&(this.backtrackFragment=u),this.bufferFragmentData(m,u,f,a,L||_)}else if(L||_)u.gap=!0;else{this.backtrack(u);return}}if(T){const{startPTS:b,endPTS:L,startDTS:_,endDTS:I}=T;f&&(f.elementaryStreams[qe.AUDIO]={startPTS:b,endPTS:L,startDTS:_,endDTS:I}),u.setElementaryStreamInfo(qe.AUDIO,b,L,_,I),this.bufferFragmentData(T,u,f,a)}if(E&&y!=null&&y.samples.length){const b={id:t,frag:u,details:E,samples:y.samples};i.trigger(A.FRAG_PARSING_METADATA,b)}if(E&&p){const b={id:t,frag:u,details:E,samples:p.samples};i.trigger(A.FRAG_PARSING_USERDATA,b)}}logMuxedErr(e){this.warn(`${ut(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,i,r){if(this.state!==ee.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(i));const{audio:a,video:c,audiovideo:u}=t;if(a){const h=e.audioCodec;let m=fo(a.codec,h);m==="mp4a"&&(m="mp4a.40.5");const p=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){m&&(m.indexOf("mp4a.40.5")!==-1?m="mp4a.40.2":m="mp4a.40.5");const y=a.metadata;y&&"channelCount"in y&&(y.channelCount||1)!==1&&p.indexOf("firefox")===-1&&(m="mp4a.40.5")}m&&m.indexOf("mp4a.40.5")!==-1&&p.indexOf("android")!==-1&&a.container!=="audio/mpeg"&&(m="mp4a.40.2",this.log(`Android: force audio codec to ${m}`)),h&&h!==m&&this.log(`Swapping manifest audio codec "${h}" for "${m}"`),a.levelCodec=m,a.id=me.MAIN,this.log(`Init audio buffer, container:${a.container}, codecs[selected/level/parsed]=[${m||""}/${h||""}/${a.codec}]`),delete t.audiovideo}if(c){c.levelCodec=e.videoCodec,c.id=me.MAIN;const h=c.codec;if((h==null?void 0:h.length)===4)switch(h){case"hvc1":case"hev1":c.codec="hvc1.1.6.L120.90";break;case"av01":c.codec="av01.0.04M.08";break;case"avc1":c.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${c.container}, codecs[level/parsed]=[${e.videoCodec||""}/${h}]${c.codec!==h?" parsed-corrected="+c.codec:""}${c.supplemental?" supplemental="+c.supplemental:""}`),delete t.audiovideo}u&&(this.log(`Init audiovideo buffer, container:${u.container}, codecs[level/parsed]=[${e.codecs}/${u.codec}]`),delete t.video,delete t.audio);const f=Object.keys(t);if(f.length){if(this.hls.trigger(A.BUFFER_CODECS,t),!this.hls)return;f.forEach(h=>{const p=t[h].initSegment;p!=null&&p.byteLength&&this.hls.trigger(A.BUFFER_APPENDING,{type:h,data:p,frag:i,part:null,chunkMeta:r,parent:i.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,me.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,i=e==null?void 0:e[t];return i?this.getMaxBufferLength(i.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=ee.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const i=e.currentTime;if(be.isBuffered(e,i)?t=this.getAppendedFrag(i):be.isBuffered(e,i+.1)&&(t=this.getAppendedFrag(i+.1)),t){this.backtrackFragment=null;const r=this.fragPlaying,a=t.level;(!r||t.sn!==r.sn||r.level!==a)&&(this.fragPlaying=t,this.hls.trigger(A.FRAG_CHANGED,{frag:t}),(!r||r.level!==a)&&this.hls.trigger(A.LEVEL_SWITCHED,{level:a}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return de(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(de(t)){const i=this.getLevelDetails(),r=this.currentFrag||(i?hn(null,i.fragments,t):null);if(r){const a=r.programDateTime;if(a!==null){const c=a+(t-r.start)*1e3;return new Date(c)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class J_ extends mi{constructor(e,t){super("key-loader",t),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const i in this.keyIdToKeyInfo){const r=this.keyIdToKeyInfo[i].loader;if(r){var t;if(e&&e!==((t=r.context)==null?void 0:t.frag.type))return;r.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,t=H.KEY_LOAD_ERROR,i,r,a){return new ss({type:pe.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:a,error:i,networkDetails:r})}loadClear(e,t,i){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let r=0,a=t.length;r<a;r++){const c=t[r];if(e.cc<=c.cc&&(!ut(e)||!ut(c)||e.sn<c.sn)||!i&&r==a-1)return this.emeController.selectKeySystemFormat(c).then(u=>{if(!this.emeController)return;c.setKeyFormat(u);const f=go(u);if(f)return this.emeController.getKeySystemAccess([f])})}if(this.config.requireKeySystemAccessOnStart){const r=ya(this.config);if(r.length)return this.emeController.getKeySystemAccess(r)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var i,r;t&&e.setKeyFormat(t);const a=e.decryptdata;if(!a){const h=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(e,H.KEY_LOAD_ERROR,h))}const c=a.uri;if(!c)return Promise.reject(this.createKeyLoadError(e,H.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${c}"`)));const u=Ld(a);let f=this.keyIdToKeyInfo[u];if((i=f)!=null&&i.decryptdata.key)return a.key=f.decryptdata.key,Promise.resolve({frag:e,keyInfo:f});if(this.emeController&&(r=f)!=null&&r.keyLoadPromise)switch(this.emeController.getKeyStatus(f.decryptdata)){case"usable":case"usable-in-future":return f.keyLoadPromise.then(m=>{const{keyInfo:p}=m;return a.key=p.decryptdata.key,{frag:e,keyInfo:p}})}switch(this.log(`${this.keyIdToKeyInfo[u]?"Rel":"L"}oading${a.keyId?" keyId: "+wt(a.keyId):""} URI: ${a.uri} from ${e.type} ${e.level}`),f=this.keyIdToKeyInfo[u]={decryptdata:a,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},a.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return a.keyFormat==="identity"?this.loadKeyHTTP(f,e):this.loadKeyEME(f,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(f,e);default:return Promise.reject(this.createKeyLoadError(e,H.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${a.method}"`)))}}loadKeyEME(e,t){const i={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var r;if(!e.decryptdata.keyId&&(r=t.initSegment)!=null&&r.data){const c=xA(t.initSegment.data);if(c.length){const u=c[0];u.some(f=>f!==0)&&(this.log(`Using keyId found in init segment ${wt(u)}`),e.decryptdata.keyId=u,dn.setKeyIdForUri(e.decryptdata.uri,u))}}const a=this.emeController.loadKey(i);return(e.keyLoadPromise=a.then(c=>(e.mediaKeySessionContext=c,i))).catch(c=>{throw e.keyLoadPromise=null,"data"in c&&(c.data.frag=t),c})}return Promise.resolve(i)}loadKeyHTTP(e,t){const i=this.config,r=i.loader,a=new r(i);return t.keyLoader=e.loader=a,e.keyLoadPromise=new Promise((c,u)=>{const f={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},h=i.keyLoadPolicy.default,m={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(y,S,E,T)=>{const{frag:b,keyInfo:L}=E,_=Ld(L.decryptdata);if(!b.decryptdata||L!==this.keyIdToKeyInfo[_])return u(this.createKeyLoadError(b,H.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),T));L.decryptdata.key=b.decryptdata.key=new Uint8Array(y.data),b.keyLoader=null,L.loader=null,c({frag:b,keyInfo:L})},onError:(y,S,E,T)=>{this.resetLoader(S),u(this.createKeyLoadError(t,H.KEY_LOAD_ERROR,new Error(`HTTP Error ${y.code} loading key ${y.text}`),E,je({url:f.url,data:void 0},y)))},onTimeout:(y,S,E)=>{this.resetLoader(S),u(this.createKeyLoadError(t,H.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),E))},onAbort:(y,S,E)=>{this.resetLoader(S),u(this.createKeyLoadError(t,H.INTERNAL_ABORTED,new Error("key loading aborted"),E))}};a.load(f,m,p)})}resetLoader(e){const{frag:t,keyInfo:i,url:r}=e,a=i.loader;t.keyLoader===a&&(t.keyLoader=null,i.loader=null);const c=Ld(i.decryptdata)||r;delete this.keyIdToKeyInfo[c],a&&a.destroy()}}function Ld(l){if(l.keyFormat!==At.FAIRPLAY){const e=l.keyId;if(e)return wt(e)}return l.uri}function Qp(l){const{type:e}=l;switch(e){case Ie.AUDIO_TRACK:return me.AUDIO;case Ie.SUBTITLE_TRACK:return me.SUBTITLE;default:return me.MAIN}}function _d(l,e){let t=l.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class eD{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(A.MANIFEST_LOADING,this.onManifestLoading,this),e.on(A.LEVEL_LOADING,this.onLevelLoading,this),e.on(A.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(A.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(A.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(A.MANIFEST_LOADING,this.onManifestLoading,this),e.off(A.LEVEL_LOADING,this.onLevelLoading,this),e.off(A.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(A.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(A.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,i=t.pLoader,r=t.loader,a=i||r,c=new a(t);return this.loaders[e.type]=c,c}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:i}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Ie.MANIFEST,url:i,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:i,level:r,pathwayId:a,url:c,deliveryDirectives:u,levelInfo:f}=t;this.load({id:i,level:r,pathwayId:a,responseType:"text",type:Ie.LEVEL,url:c,deliveryDirectives:u,levelOrTrack:f})}onAudioTrackLoading(e,t){const{id:i,groupId:r,url:a,deliveryDirectives:c,track:u}=t;this.load({id:i,groupId:r,level:null,responseType:"text",type:Ie.AUDIO_TRACK,url:a,deliveryDirectives:c,levelOrTrack:u})}onSubtitleTrackLoading(e,t){const{id:i,groupId:r,url:a,deliveryDirectives:c,track:u}=t;this.load({id:i,groupId:r,level:null,responseType:"text",type:Ie.SUBTITLE_TRACK,url:a,deliveryDirectives:c,levelOrTrack:u})}onLevelsUpdated(e,t){const i=this.loaders[Ie.LEVEL];if(i){const r=i.context;r&&!t.levels.some(a=>a===r.levelOrTrack)&&(i.abort(),delete this.loaders[Ie.LEVEL])}}load(e){var t;const i=this.hls.config;let r=this.getInternalLoader(e);if(r){const h=this.hls.logger,m=r.context;if(m&&m.levelOrTrack===e.levelOrTrack&&(m.url===e.url||m.deliveryDirectives&&!e.deliveryDirectives)){m.url===e.url?h.log(`[playlist-loader]: ignore ${e.url} ongoing request`):h.log(`[playlist-loader]: ignore ${e.url} in favor of ${m.url}`);return}h.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}let a;if(e.type===Ie.MANIFEST?a=i.manifestLoadPolicy.default:a=Ke({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),de((t=e.deliveryDirectives)==null?void 0:t.part)){let h;if(e.type===Ie.LEVEL&&e.level!==null?h=this.hls.levels[e.level].details:e.type===Ie.AUDIO_TRACK&&e.id!==null?h=this.hls.audioTracks[e.id].details:e.type===Ie.SUBTITLE_TRACK&&e.id!==null&&(h=this.hls.subtitleTracks[e.id].details),h){const m=h.partTarget,p=h.targetduration;if(m&&p){const y=Math.max(m*3,p*.8)*1e3;a=Ke({},a,{maxTimeToFirstByteMs:Math.min(y,a.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(y,a.maxTimeToFirstByteMs)})}}}const c=a.errorRetry||a.timeoutRetry||{},u={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0},f={onSuccess:(h,m,p,y)=>{const S=this.getInternalLoader(p);this.resetInternalLoader(p.type);const E=h.data;m.parsing.start=performance.now(),Oi.isMediaPlaylist(E)||p.type!==Ie.MANIFEST?this.handleTrackOrLevelPlaylist(h,m,p,y||null,S):this.handleMasterPlaylist(h,m,p,y)},onError:(h,m,p,y)=>{this.handleNetworkError(m,p,!1,h,y)},onTimeout:(h,m,p)=>{this.handleNetworkError(m,p,!0,void 0,h)}};r.load(e,u,f)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:i}=this.hls;(e||i)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,i,r){const a=this.hls,c=e.data,u=_d(e,i),f=Oi.parseMasterPlaylist(c,u);if(f.playlistParsingError){t.parsing.end=performance.now(),this.handleManifestParsingError(e,i,f.playlistParsingError,r,t);return}const{contentSteering:h,levels:m,sessionData:p,sessionKeys:y,startTimeOffset:S,variableList:E}=f;this.variableList=E,m.forEach(_=>{const{unknownCodecs:I}=_;if(I){const{preferManagedMediaSource:C}=this.hls.config;let{audioCodec:N,videoCodec:K}=_;for(let O=I.length;O--;){const j=I[O];Ta(j,"audio",C)?(_.audioCodec=N=N?`${N},${j}`:j,cr.audio[N.substring(0,4)]=2,I.splice(O,1)):Ta(j,"video",C)&&(_.videoCodec=K=K?`${K},${j}`:j,cr.video[K.substring(0,4)]=2,I.splice(O,1))}}});const{AUDIO:T=[],SUBTITLES:b,"CLOSED-CAPTIONS":L}=Oi.parseMasterPlaylistMedia(c,u,f);T.length&&!T.some(I=>!I.url)&&m[0].audioCodec&&!m[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),T.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Je({}),bitrate:0,url:""})),a.trigger(A.MANIFEST_LOADED,{levels:m,audioTracks:T,subtitles:b,captions:L,contentSteering:h,url:u,stats:t,networkDetails:r,sessionData:p,sessionKeys:y,startTimeOffset:S,variableList:E})}handleTrackOrLevelPlaylist(e,t,i,r,a){const c=this.hls,{id:u,level:f,type:h}=i,m=_d(e,i),p=de(f)?f:de(u)?u:0,y=Qp(i),S=Oi.parseLevelPlaylist(e.data,m,p,y,0,this.variableList);if(h===Ie.MANIFEST){const E={attrs:new Je({}),bitrate:0,details:S,name:"",url:m};S.requestScheduled=t.loading.start+Jy(S,0),c.trigger(A.MANIFEST_LOADED,{levels:[E],audioTracks:[],url:m,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),i.levelDetails=S,this.handlePlaylistLoaded(S,e,t,i,r,a)}handleManifestParsingError(e,t,i,r,a){this.hls.trigger(A.ERROR,{type:pe.NETWORK_ERROR,details:H.MANIFEST_PARSING_ERROR,fatal:t.type===Ie.MANIFEST,url:e.url,err:i,error:i,reason:i.message,response:e,context:t,networkDetails:r,stats:a})}handleNetworkError(e,t,i=!1,r,a){let c=`A network ${i?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===Ie.LEVEL?c+=`: ${e.level} id: ${e.id}`:(e.type===Ie.AUDIO_TRACK||e.type===Ie.SUBTITLE_TRACK)&&(c+=` id: ${e.id} group-id: "${e.groupId}"`);const u=new Error(c);this.hls.logger.warn(`[playlist-loader]: ${c}`);let f=H.UNKNOWN,h=!1;const m=this.getInternalLoader(e);switch(e.type){case Ie.MANIFEST:f=i?H.MANIFEST_LOAD_TIMEOUT:H.MANIFEST_LOAD_ERROR,h=!0;break;case Ie.LEVEL:f=i?H.LEVEL_LOAD_TIMEOUT:H.LEVEL_LOAD_ERROR,h=!1;break;case Ie.AUDIO_TRACK:f=i?H.AUDIO_TRACK_LOAD_TIMEOUT:H.AUDIO_TRACK_LOAD_ERROR,h=!1;break;case Ie.SUBTITLE_TRACK:f=i?H.SUBTITLE_TRACK_LOAD_TIMEOUT:H.SUBTITLE_LOAD_ERROR,h=!1;break}m&&this.resetInternalLoader(e.type);const p={type:pe.NETWORK_ERROR,details:f,fatal:h,url:e.url,loader:m,context:e,error:u,networkDetails:t,stats:a};if(r){const y=(t==null?void 0:t.url)||e.url;p.response=je({url:y,data:void 0},r)}this.hls.trigger(A.ERROR,p)}handlePlaylistLoaded(e,t,i,r,a,c){const u=this.hls,{type:f,level:h,levelOrTrack:m,id:p,groupId:y,deliveryDirectives:S}=r,E=_d(t,r),T=Qp(r);let b=typeof r.level=="number"&&T===me.MAIN?h:void 0;const L=e.playlistParsingError;if(L){if(this.hls.logger.warn(`${L} ${e.url}`),!u.config.ignorePlaylistParsingErrors){u.trigger(A.ERROR,{type:pe.NETWORK_ERROR,details:H.LEVEL_PARSING_ERROR,fatal:!1,url:E,error:L,reason:L.message,response:t,context:r,level:b,parent:T,networkDetails:a,stats:i});return}e.playlistParsingError=null}if(!e.fragments.length){const _=e.playlistParsingError=new Error("No Segments found in Playlist");u.trigger(A.ERROR,{type:pe.NETWORK_ERROR,details:H.LEVEL_EMPTY_ERROR,fatal:!1,url:E,error:_,reason:_.message,response:t,context:r,level:b,parent:T,networkDetails:a,stats:i});return}switch(e.live&&c&&(c.getCacheAge&&(e.ageHeader=c.getCacheAge()||0),(!c.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),f){case Ie.MANIFEST:case Ie.LEVEL:if(b){if(!m)b=0;else if(m!==u.levels[b]){const _=u.levels.indexOf(m);_>-1&&(b=_)}}u.trigger(A.LEVEL_LOADED,{details:e,levelInfo:m||u.levels[0],level:b||0,id:p||0,stats:i,networkDetails:a,deliveryDirectives:S,withoutMultiVariant:f===Ie.MANIFEST});break;case Ie.AUDIO_TRACK:u.trigger(A.AUDIO_TRACK_LOADED,{details:e,track:m,id:p||0,groupId:y||"",stats:i,networkDetails:a,deliveryDirectives:S});break;case Ie.SUBTITLE_TRACK:u.trigger(A.SUBTITLE_TRACK_LOADED,{details:e,track:m,id:p||0,groupId:y||"",stats:i,networkDetails:a,deliveryDirectives:S});break}}}class ei{static get version(){return Ra}static isMSESupported(){return Zx()}static isSupported(){return X_()}static getMediaSource(){return Ps()}static get Events(){return A}static get MetadataSchema(){return Jt}static get ErrorTypes(){return pe}static get ErrorDetails(){return H}static get DefaultConfig(){return ei.defaultConfig?ei.defaultConfig:U_}static set DefaultConfig(e){ei.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new fh,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=aA(e.debug||!1,"Hls instance",e.assetPlayerId),i=this.config=F_(ei.DefaultConfig,e,t);this.userConfig=e,i.progressive&&j_(i,t);const{abrController:r,bufferController:a,capLevelController:c,errorController:u,fpsController:f}=i,h=new u(this),m=this.abrController=new r(this),p=new t1(this),y=i.interstitialsController,S=y?this.interstitialsController=new y(this,ei):null,E=this.bufferController=new a(this,p),T=this.capLevelController=new c(this),b=new f(this),L=new eD(this),_=i.contentSteeringController,I=_?new _(this):null,C=this.levelController=new q_(this,I),N=new z_(this),K=new J_(this.config,this.logger),O=this.streamController=new Z_(this,p,K),j=this.gapController=new V_(this,p);T.setStreamController(O),b.setStreamController(O);const B=[L,C,O];S&&B.splice(1,0,S),I&&B.splice(1,0,I),this.networkControllers=B;const U=[m,E,j,T,b,N,p];this.audioTrackController=this.createController(i.audioTrackController,B);const W=i.audioStreamController;W&&B.push(this.audioStreamController=new W(this,p,K)),this.subtitleTrackController=this.createController(i.subtitleTrackController,B);const re=i.subtitleStreamController;re&&B.push(this.subtititleStreamController=new re(this,p,K)),this.createController(i.timelineController,U),K.emeController=this.emeController=this.createController(i.emeController,U),this.cmcdController=this.createController(i.cmcdController,U),this.latencyController=this.createController(Y_,U),this.coreComponents=U,B.push(h);const ue=h.onErrorOut;typeof ue=="function"&&this.on(A.ERROR,ue,h),this.on(A.MANIFEST_LOADED,L.onManifestLoaded,L)}createController(e,t){if(e){const i=new e(this);return t&&t.push(i),i}return null}on(e,t,i=this){this._emitter.on(e,t,i)}once(e,t,i=this){this._emitter.once(e,t,i)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,i=this,r){this._emitter.off(e,t,i,r)}listeners(e){return this._emitter.listeners(e)}emit(e,t,i){return this._emitter.emit(e,t,i)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(i){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+i.message+'". Here is a stacktrace:',i),!this.triggeringException){this.triggeringException=!0;const r=e===A.ERROR;this.trigger(A.ERROR,{type:pe.OTHER_ERROR,details:H.INTERNAL_EXCEPTION,fatal:r,event:e,error:i}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(A.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const a=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(A.ERROR,{type:pe.OTHER_ERROR,details:H.ATTACH_MEDIA_ERROR,fatal:!0,error:a});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,i=t?e.media:e,r=t?e:{media:i};this._media=i,this.trigger(A.MEDIA_ATTACHING,r)}detachMedia(){this.logger.log("detachMedia"),this.trigger(A.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(A.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,i=this._url,r=this._url=ih.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${r}`),t&&i&&(i!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(A.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let i=0;i<this.networkControllers.length&&(this.networkControllers[i].startLoad(e,t),!(!this.started||!this.networkControllers));i++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[me.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[me.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[me.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e==null?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=VL()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){FA(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const i=e.length;for(let r=0;r<i;r++)if(e[r].maxBitrate>=t)return r;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:i}=this;let r;if(t===-1&&e!=null&&e.length?r=e.length-1:r=t,i)for(let a=r;a--;){const c=e[a].attrs["HDCP-LEVEL"];if(c&&c<=i)return a}return r}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const i=By(t);return Py(e,i,navigator.mediaCapabilities)}}ei.defaultConfig=void 0;const Bo=({title:l,description:e,keywords:t,image:i,url:r,type:a="website"})=>(te.useEffect(()=>{l&&(document.title=l);const c=document.querySelector('meta[name="description"]');c&&e&&c.setAttribute("content",e);const u=document.querySelector('meta[name="keywords"]');u&&t&&u.setAttribute("content",t);const f=document.querySelector('meta[property="og:title"]');f&&l&&f.setAttribute("content",l);const h=document.querySelector('meta[property="og:description"]');h&&e&&h.setAttribute("content",e);const m=document.querySelector('meta[property="og:image"]');m&&i&&m.setAttribute("content",i);const p=document.querySelector('meta[property="og:url"]');p&&r&&p.setAttribute("content",r);const y=document.querySelector('meta[property="og:type"]');y&&a&&y.setAttribute("content",a);const S=document.querySelector('meta[property="twitter:title"]');S&&l&&S.setAttribute("content",l);const E=document.querySelector('meta[property="twitter:description"]');E&&e&&E.setAttribute("content",e);const T=document.querySelector('meta[property="twitter:image"]');T&&i&&T.setAttribute("content",i);const b=document.querySelector('meta[property="twitter:url"]');b&&r&&b.setAttribute("content",r);const L=document.querySelector('link[rel="canonical"]');L&&r&&L.setAttribute("href",r)},[l,e,t,i,r,a]),null),tD=()=>{const l=te.useRef(null);return te.useEffect(()=>{const e=l.current;if(!e)return;const t="https://m.media-amazon.com/images/S/vse-vms-transcoding-artifact-eu-west-1-prod/09bac38b-b5f7-4498-99f5-4ed0ea3d2d03/default.jobtemplate.hls.m3u8";if(ei.isSupported()){const i=new ei;return i.loadSource(t),i.attachMedia(e),i.on(ei.Events.MANIFEST_PARSED,()=>{e.play().catch(console.error)}),i.on(ei.Events.ERROR,(r,a)=>{if(console.error("HLS error:",a),a.fatal)switch(a.type){case ei.ErrorTypes.NETWORK_ERROR:console.error("Fatal network error encountered, try to recover"),i.startLoad();break;case ei.ErrorTypes.MEDIA_ERROR:console.error("Fatal media error encountered, try to recover"),i.recoverMediaError();break;default:console.error("Fatal error, cannot recover"),i.destroy();break}}),()=>{i.destroy()}}else e.canPlayType("application/vnd.apple.mpegurl")?(e.src=t,e.addEventListener("loadedmetadata",()=>{e.play().catch(console.error)})):console.error("HLS is not supported in this browser")},[]),v.jsxs(v.Fragment,{children:[v.jsx(Bo,{title:"ARGUS - Artificial Intelligence for Defense",description:"Software-defined defense. Protecting democracies with autonomous systems and real-time intelligence.",keywords:"defense AI, autonomous systems, software-defined defense, national security, artificial intelligence",image:"https://argus.global/images/argus-logo-updated.png",url:"https://argus.global/"}),v.jsxs("div",{className:"bg-black min-h-screen font-sans text-white selection:bg-white selection:text-black",children:[v.jsxs("section",{className:"hero-minimal relative min-h-screen flex items-center justify-center overflow-hidden pt-20",children:[v.jsx("div",{className:"absolute inset-0 z-0",children:v.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-gray-900/20 via-black to-black"})}),v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 text-center",children:[v.jsxs("h1",{className:"text-5xl md:text-7xl lg:text-9xl font-medium mb-8 tracking-tighter leading-tight",children:["Artificial Intelligence",v.jsx("br",{}),v.jsx("span",{className:"text-subtle",children:"to Protect Democracies"})]}),v.jsxs("p",{className:"text-xl md:text-2xl mb-12 max-w-2xl mx-auto leading-relaxed text-gray-400 font-light",children:["We build software-defined defense systems. ",v.jsx("br",{}),"Processing information at the edge to ensure information superiority."]}),v.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center items-center",children:[v.jsxs(Te,{to:"/products",className:"btn-primary group",children:[v.jsx("span",{children:"Our Capabilities"}),v.jsx(Ms,{className:"ml-2 h-4 w-4 group-hover:translate-x-1 transition-transform"})]}),v.jsx(Te,{to:"/company",className:"btn-secondary group",children:v.jsx("span",{children:"Mission & Values"})})]})]})]}),v.jsx("section",{className:"w-full bg-black relative",children:v.jsxs("div",{className:"w-full h-[80vh] relative overflow-hidden",children:[v.jsx("video",{ref:l,className:"w-full h-full object-cover opacity-60 grayscale",controls:!1,muted:!0,loop:!0,playsInline:!0,preload:"metadata",poster:"/images/smart-glasses-poster.png",children:"Your browser does not support the video tag."}),v.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-black pointer-events-none"}),v.jsx("div",{className:"absolute bottom-10 left-10 z-20",children:v.jsx("p",{className:"text-xs font-mono text-gray-500 tracking-widest uppercase",children:"Live System Feed // Anonymized"})})]})}),v.jsx("section",{className:"py-32 bg-black border-t border-white/10",children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"grid md:grid-cols-3 gap-16",children:[v.jsxs("div",{className:"card group",children:[v.jsxs("div",{className:"mb-8",children:[v.jsx(my,{className:"h-8 w-8 text-white mb-4",strokeWidth:1}),v.jsx("h3",{className:"text-2xl font-medium mb-4 text-white",children:"Software-Defined"})]}),v.jsx("p",{className:"leading-relaxed text-gray-400 text-lg font-light",children:"Hardware is a commodity. Intelligence is the differentiator. We retrofit existing platforms with state-of-the-art AI to extend their operational relevance."})]}),v.jsxs("div",{className:"card group",children:[v.jsxs("div",{className:"mb-8",children:[v.jsx(ub,{className:"h-8 w-8 text-white mb-4",strokeWidth:1}),v.jsx("h3",{className:"text-2xl font-medium mb-4 text-white",children:"Information Superiority"})]}),v.jsx("p",{className:"leading-relaxed text-gray-400 text-lg font-light",children:"In the modern battlespace, data is the weapon. Our systems process sensor data on-device, delivering real-time situational awareness without latency."})]}),v.jsxs("div",{className:"card group",children:[v.jsxs("div",{className:"mb-8",children:[v.jsx(py,{className:"h-8 w-8 text-white mb-4",strokeWidth:1}),v.jsx("h3",{className:"text-2xl font-medium mb-4 text-white",children:"Sovereign & Secure"})]}),v.jsx("p",{className:"leading-relaxed text-gray-400 text-lg font-light",children:"Built on open standards for complete transparency. We ensure that critical defense infrastructure remains under sovereign control, free from black boxes."})]})]})})}),v.jsx("section",{className:"py-32 bg-off-black",children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-12 border-t border-white/10 pt-12",children:[v.jsxs("div",{children:[v.jsx("div",{className:"text-5xl font-light mb-2 text-white",children:"100%"}),v.jsx("p",{className:"text-xs font-mono text-gray-500 uppercase tracking-widest",children:"Open Architecture"})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-5xl font-light mb-2 text-white",children:"5+"}),v.jsx("p",{className:"text-xs font-mono text-gray-500 uppercase tracking-widest",children:"Nations Supported"})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-5xl font-light mb-2 text-white",children:"24/7"}),v.jsx("p",{className:"text-xs font-mono text-gray-500 uppercase tracking-widest",children:"Autonomous Ops"})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-5xl font-light mb-2 text-white",children:""}),v.jsx("p",{className:"text-xs font-mono text-gray-500 uppercase tracking-widest",children:"Scalability"})]})]})})}),v.jsx("section",{className:"py-32 bg-black relative overflow-hidden",children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:[v.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end mb-20",children:[v.jsx("h2",{className:"text-4xl md:text-6xl font-medium tracking-tight max-w-xl",children:"Autonomous Systems for Multi-Domain Operations"}),v.jsx(Te,{to:"/drones",className:"btn-secondary mt-8 md:mt-0",children:"View Platforms"})]}),v.jsxs("div",{className:"grid md:grid-cols-2 gap-px bg-white/10 border border-white/10",children:[v.jsxs("div",{className:"bg-black p-12 hover:bg-white/5 transition-colors duration-500 group cursor-pointer",children:[v.jsxs("div",{className:"flex justify-between items-start mb-12",children:[v.jsx(yy,{className:"h-6 w-6 text-gray-500 group-hover:text-white transition-colors",strokeWidth:1}),v.jsx(Ms,{className:"h-5 w-5 text-gray-500 group-hover:text-white -rotate-45 group-hover:rotate-0 transition-all duration-300"})]}),v.jsx("h3",{className:"text-3xl font-medium mb-4",children:"Air Superiority"}),v.jsx("p",{className:"text-gray-400 font-light",children:"AI-enabled air dominance. Our software stack transforms legacy airframes and next-gen drones into cognitive assets capable of autonomous decision-making in GPS-denied environments."})]}),v.jsxs("div",{className:"bg-black p-12 hover:bg-white/5 transition-colors duration-500 group cursor-pointer",children:[v.jsxs("div",{className:"flex justify-between items-start mb-12",children:[v.jsx(Ey,{className:"h-6 w-6 text-gray-500 group-hover:text-white transition-colors",strokeWidth:1}),v.jsx(Ms,{className:"h-5 w-5 text-gray-500 group-hover:text-white -rotate-45 group-hover:rotate-0 transition-all duration-300"})]}),v.jsx("h3",{className:"text-3xl font-medium mb-4",children:"Maritime Intelligence"}),v.jsx("p",{className:"text-gray-400 font-light",children:"Deploying neural networks at the edge to secure sovereign waters. From autonomous surface vessels to deep-sea monitoring, ensuring continuous situational awareness."})]})]})]})}),v.jsx("section",{className:"py-32 bg-black text-white border-t border-white/10",children:v.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[v.jsx("h2",{className:"text-4xl md:text-5xl font-medium mb-8 tracking-tight",children:"Join the Mission"}),v.jsx("p",{className:"text-xl mb-12 leading-relaxed text-gray-400 font-light max-w-2xl mx-auto",children:"We are looking for engineers and operators who share our conviction that democratic values are worth protecting."}),v.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center",children:[v.jsx(Te,{to:"/company",className:"btn-primary",children:"View Open Roles"}),v.jsx(Te,{to:"/products",className:"btn-secondary",children:"Contact Sales"})]})]})})]})]})},iD=()=>v.jsxs("div",{style:{backgroundColor:"var(--concrete-light)"},children:[v.jsx("section",{className:"hero-gradient text-pure-white py-32",style:{background:"linear-gradient(135deg, var(--carbon-black) 0%, var(--graphite-gray) 100%)",color:"var(--pure-white)"},children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"text-center",children:[v.jsx("h1",{className:"text-6xl md:text-7xl lg:text-8xl font-bold mb-6 tracking-tight",children:"Industry Solutions"}),v.jsx("p",{className:"text-xl mb-12 max-w-3xl mx-auto leading-relaxed",style:{color:"var(--concrete-light)"},children:"Argus Systems empowers frontline workers across diverse industries with hands-free visual intelligence and open-source flexibility."}),v.jsx(Te,{to:"/company",className:"btn-primary",children:"Request a Demo"})]})})}),v.jsx("section",{className:"py-24 bg-light",children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[v.jsxs("div",{className:"text-center mb-16",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",style:{color:"var(--carbon-black)"},children:"Solutions for Every Challenge"}),v.jsx("p",{className:"text-xl max-w-3xl mx-auto leading-relaxed",style:{color:"var(--graphite-gray)"},children:"From enhancing safety in hazardous environments to streamlining complex manufacturing processes, Argus delivers tailored visual intelligence."})]}),v.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:[v.jsxs(Te,{to:"/solutions/automotive",className:"card group",children:[v.jsx("div",{className:"w-16 h-16 bg-signal-orange rounded-sm flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300",children:v.jsx(sb,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-3",children:"Automotive"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Connected vehicle assembly, quality control, and remote diagnostics."})]}),v.jsxs(Te,{to:"/solutions/oil-gas",className:"card group",children:[v.jsx("div",{className:"w-16 h-16 bg-signal-orange rounded-sm flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300",children:v.jsx(mb,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-3",children:"Oil & Gas"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Safety compliance, remote inspections, and maintenance in hazardous environments."})]}),v.jsxs(Te,{to:"/solutions/warehousing",className:"card group",children:[v.jsx("div",{className:"w-16 h-16 bg-signal-orange rounded-sm flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300",children:v.jsx(Gb,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-3",children:"Warehousing"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Visual picking guidance, inventory management, and logistics optimization."})]}),v.jsxs(Te,{to:"/solutions/manufacturing",className:"card group",children:[v.jsx("div",{className:"w-16 h-16 bg-signal-orange rounded-sm flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300",children:v.jsx(hb,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-3",children:"Manufacturing"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Assembly instructions, quality assurance, and remote expert collaboration."})]}),v.jsxs(Te,{to:"/solutions/healthcare",className:"card group",children:[v.jsx("div",{className:"w-16 h-16 bg-signal-orange rounded-sm flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300",children:v.jsx(xy,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-3",children:"Healthcare"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Remote consultations, hands-free data access, and surgical assistance."})]}),v.jsxs(Te,{to:"/products",className:"card group",children:[v.jsx("div",{className:"w-16 h-16 bg-signal-orange rounded-sm flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300",children:v.jsx(gy,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-3",children:"Explore All Products"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Discover how Argus Smart Glasses and the Visual Intelligence Platform can transform your operations."})]})]})]})}),v.jsx("section",{className:"py-24 bg-graphite text-pure-white",children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[v.jsxs("div",{className:"text-center mb-16",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",children:"Why Choose Argus for Your Industry?"}),v.jsx("p",{className:"text-xl max-w-3xl mx-auto leading-relaxed",style:{color:"var(--concrete-light)"},children:"Our open-source approach provides unparalleled flexibility, security, and community support, tailored to your specific industry needs."})]}),v.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-signal-orange rounded-sm flex items-center justify-center mb-6",children:v.jsx(Ms,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Customizable Workflows"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Adapt our platform to your unique operational requirements with open APIs and a flexible architecture."})]}),v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-signal-orange rounded-sm flex items-center justify-center mb-6",children:v.jsx(Ms,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Enhanced Safety & Compliance"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Improve worker safety and ensure regulatory compliance with real-time visual guidance and data capture."})]}),v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-signal-orange rounded-sm flex items-center justify-center mb-6",children:v.jsx(Ms,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Increased Efficiency"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Streamline operations, reduce errors, and boost productivity with hands-free access to critical information."})]})]})]})}),v.jsx("section",{className:"py-24 bg-dark text-pure-white",children:v.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",children:"Ready to Find Your Solution?"}),v.jsx("p",{className:"text-xl mb-10 leading-relaxed",style:{color:"var(--concrete-light)"},children:"Contact our sales team to discuss how Argus Systems can be tailored to your industry's specific needs."}),v.jsx(Te,{to:"/company",className:"btn-primary",children:"Get a Custom Solution"})]})})]}),sD=()=>v.jsxs(v.Fragment,{children:[v.jsx(Bo,{title:"ARGUS Capabilities - Software-Defined Defense",description:"Our software-defined defense capabilities. Edge intelligence, autonomous systems, and sovereign cloud infrastructure.",keywords:"defense AI, edge computing, autonomous systems, sovereign cloud, defense software",image:"https://argus.global/images/argus-logo-updated.png",url:"https://argus.global/products"}),v.jsxs("div",{className:"bg-black min-h-screen text-white font-sans selection:bg-white selection:text-black",children:[v.jsx("section",{className:"hero-minimal relative pt-32 pb-20 overflow-hidden border-b border-white/10",children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:v.jsxs("div",{className:"max-w-4xl",children:[v.jsxs("h1",{className:"text-6xl md:text-8xl font-medium mb-8 tracking-tighter leading-tight",children:["Software-Defined",v.jsx("br",{}),v.jsx("span",{className:"text-gray-500",children:"Defense."})]}),v.jsx("p",{className:"text-xl md:text-2xl mb-12 max-w-2xl leading-relaxed text-gray-400 font-light",children:"We build the operating system for the modern battlefield. Integrating sensors, effectors, and intelligence into a unified, autonomous network."})]})})}),v.jsx("section",{className:"py-32 border-b border-white/10",children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"grid md:grid-cols-2 gap-24 items-start",children:[v.jsxs("div",{children:[v.jsx("div",{className:"inline-block mb-6 px-3 py-1 border border-white text-white text-xs font-mono tracking-widest uppercase",children:"Core Capability"}),v.jsx("h2",{className:"text-4xl md:text-5xl font-medium mb-8 tracking-tight",children:"Edge Intelligence"}),v.jsx("p",{className:"text-xl text-gray-400 font-light leading-relaxed mb-12",children:"Processing critical data where it matters most: at the edge. Our AI models run locally on low-power devices, ensuring operational continuity in disconnected environments."}),v.jsxs("div",{className:"space-y-8",children:[v.jsxs("div",{className:"flex items-start",children:[v.jsx(my,{className:"h-6 w-6 text-white mt-1 mr-4",strokeWidth:1}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"On-Device Inference"}),v.jsx("p",{className:"text-gray-500 font-light",children:"Real-time object detection and threat analysis without cloud dependency."})]})]}),v.jsxs("div",{className:"flex items-start",children:[v.jsx(fr,{className:"h-6 w-6 text-white mt-1 mr-4",strokeWidth:1}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Anti-Jamming Navigation"}),v.jsx("p",{className:"text-gray-500 font-light",children:"Visual odometry and terrain matching for GPS-denied operations."})]})]}),v.jsxs("div",{className:"flex items-start",children:[v.jsx(Lb,{className:"h-6 w-6 text-white mt-1 mr-4",strokeWidth:1}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Swarm Coordination"}),v.jsx("p",{className:"text-gray-500 font-light",children:"Distributed decision-making across autonomous assets."})]})]})]})]}),v.jsxs("div",{className:"relative h-full min-h-[500px] bg-gray-900 border border-white/10 flex items-center justify-center overflow-hidden",children:[v.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-gray-800/50 via-black to-black"}),v.jsx("div",{className:"relative z-10 grid grid-cols-3 gap-4 opacity-50",children:[...Array(9)].map((l,e)=>v.jsx("div",{className:"w-16 h-16 border border-white/20"},e))}),v.jsx("div",{className:"absolute z-20 text-xs font-mono text-white tracking-widest",children:"NEURAL_ENGINE_V4 // ACTIVE"})]})]})})}),v.jsx("section",{className:"py-32 border-b border-white/10 bg-off-black",children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"grid md:grid-cols-2 gap-24 items-center",children:[v.jsx("div",{className:"order-2 md:order-1 relative h-full min-h-[500px] bg-black border border-white/10 flex items-center justify-center",children:v.jsx("div",{className:"w-32 h-32 border border-white/20 rounded-full flex items-center justify-center",children:v.jsx("div",{className:"w-24 h-24 border border-white/40 rounded-full flex items-center justify-center",children:v.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})})}),v.jsxs("div",{className:"order-1 md:order-2",children:[v.jsx("div",{className:"inline-block mb-6 px-3 py-1 border border-white text-white text-xs font-mono tracking-widest uppercase",children:"Infrastructure"}),v.jsx("h2",{className:"text-4xl md:text-5xl font-medium mb-8 tracking-tight",children:"Sovereign Cloud"}),v.jsx("p",{className:"text-xl text-gray-400 font-light leading-relaxed mb-12",children:"Data sovereignty is national security. We provide deployable cloud infrastructure that ensures your data remains under your control, air-gapped or connected."}),v.jsxs("div",{className:"space-y-8",children:[v.jsxs("div",{className:"flex items-start",children:[v.jsx(py,{className:"h-6 w-6 text-white mt-1 mr-4",strokeWidth:1}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Zero Trust Architecture"}),v.jsx("p",{className:"text-gray-500 font-light",children:"Identity-based access control and end-to-end encryption."})]})]}),v.jsxs("div",{className:"flex items-start",children:[v.jsx(Mb,{className:"h-6 w-6 text-white mt-1 mr-4",strokeWidth:1}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Deployable Nodes"}),v.jsx("p",{className:"text-gray-500 font-light",children:"Ruggedized server nodes for forward operating bases."})]})]})]})]})]})})}),v.jsx("section",{className:"py-32 bg-black text-white",children:v.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[v.jsx("h2",{className:"text-4xl md:text-5xl font-medium mb-8 tracking-tight",children:"Deploy the Future"}),v.jsx("p",{className:"text-xl mb-12 leading-relaxed text-gray-400 font-light max-w-2xl mx-auto",children:"Our systems are ready for integration. Contact our engineering team to discuss your specific requirements."}),v.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center",children:[v.jsx(Te,{to:"/company",className:"btn-primary",children:"Contact Engineering"}),v.jsx(Te,{to:"/drones",className:"btn-secondary",children:"View Autonomous Assets"})]})]})})]})]}),nD=()=>v.jsxs("div",{style:{backgroundColor:"var(--concrete-light)"},children:[v.jsx("section",{className:"hero-gradient text-pure-white py-32",style:{background:"linear-gradient(135deg, var(--carbon-black) 0%, var(--graphite-gray) 100%)",color:"var(--pure-white)"},children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"text-center",children:[v.jsx("h1",{className:"text-6xl md:text-7xl lg:text-8xl font-bold mb-6 tracking-tight",children:"Resources"}),v.jsx("p",{className:"text-xl mb-12 max-w-3xl mx-auto leading-relaxed",style:{color:"var(--concrete-light)"},children:"Access a wealth of knowledge, documentation, and community support to maximize your Argus experience."}),v.jsx(Te,{to:"/company",className:"btn-primary",children:"Contact Support"})]})})}),v.jsx("section",{className:"py-24 bg-light",children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[v.jsxs("div",{className:"text-center mb-16",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",style:{color:"var(--carbon-black)"},children:"Explore Our Knowledge Hub"}),v.jsx("p",{className:"text-xl max-w-3xl mx-auto leading-relaxed",style:{color:"var(--graphite-gray)"},children:"Find everything from technical documentation to insightful case studies and blog posts."})]}),v.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-8",children:[v.jsxs("div",{className:"card group",children:[v.jsx("div",{className:"w-16 h-16 bg-signal-orange rounded-sm flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300",children:v.jsx(tb,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-3",children:"Documentation"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Comprehensive guides and API references for developers and system integrators."})]}),v.jsxs("div",{className:"card group",children:[v.jsx("div",{className:"w-16 h-16 bg-signal-orange rounded-sm flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300",children:v.jsx(Db,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-3",children:"Case Studies"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Real-world examples of how Argus Systems is transforming industries."})]}),v.jsxs("div",{className:"card group",children:[v.jsx("div",{className:"w-16 h-16 bg-signal-orange rounded-sm flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300",children:v.jsx(Kb,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-3",children:"Tutorials & Videos"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Step-by-step video guides and tutorials for getting started and advanced usage."})]}),v.jsxs("div",{className:"card group",children:[v.jsx("div",{className:"w-16 h-16 bg-signal-orange rounded-sm flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300",children:v.jsx(vy,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-3",children:"Community Forum"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Engage with other users and developers, share insights, and get support."})]})]})]})}),v.jsx("section",{className:"py-24 bg-graphite text-pure-white",children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[v.jsxs("div",{className:"text-center mb-16",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",children:"Join Our Growing Community"}),v.jsx("p",{className:"text-xl max-w-3xl mx-auto leading-relaxed",style:{color:"var(--concrete-light)"},children:"Argus is more than just a product; it's a vibrant community of innovators and problem-solvers."})]}),v.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Contribute to Open Source"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Help us build the future of visual intelligence. Contribute code, documentation, or ideas to our open-source projects."}),v.jsxs(Te,{to:"#",className:"text-signal-orange flex items-center mt-4 hover:underline",children:["Learn How to Contribute ",v.jsx(Ms,{className:"ml-2 h-4 w-4"})]})]}),v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Attend Workshops & Events"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Participate in our online and in-person workshops, webinars, and community events to learn and connect."}),v.jsxs(Te,{to:"#",className:"text-signal-orange flex items-center mt-4 hover:underline",children:["View Upcoming Events ",v.jsx(Ms,{className:"ml-2 h-4 w-4"})]})]})]})]})}),v.jsx("section",{className:"py-24 bg-dark text-pure-white",children:v.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",children:"Need More Information?"}),v.jsx("p",{className:"text-xl mb-10 leading-relaxed",style:{color:"var(--concrete-light)"},children:"Our team is here to help. Reach out for personalized support or detailed inquiries."}),v.jsx(Te,{to:"/company",className:"btn-primary",children:"Contact Us"})]})})]}),rD=()=>v.jsxs(v.Fragment,{children:[v.jsx(Bo,{title:"ARGUS Mission - Protecting Democracies",description:"We are a defense technology company dedicated to protecting democratic values through superior artificial intelligence and autonomous systems.",keywords:"defense mission, protecting democracies, AI ethics, national security, defense technology company",image:"https://argus.global/images/argus-logo-updated.png",url:"https://argus.global/company"}),v.jsxs("div",{className:"bg-black min-h-screen text-white font-sans selection:bg-white selection:text-black",children:[v.jsx("section",{className:"hero-minimal relative pt-32 pb-20 overflow-hidden border-b border-white/10",children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:v.jsxs("div",{className:"max-w-4xl",children:[v.jsxs("h1",{className:"text-6xl md:text-8xl font-medium mb-8 tracking-tighter leading-tight",children:["Our Mission",v.jsx("br",{}),v.jsx("span",{className:"text-gray-500",children:"is to Protect."})]}),v.jsx("p",{className:"text-xl md:text-2xl mb-12 max-w-2xl leading-relaxed text-gray-400 font-light",children:"We believe that the defense of democratic values requires technological superiority. We build the systems that ensure this advantage."})]})})}),v.jsx("section",{className:"py-32 border-b border-white/10",children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"grid md:grid-cols-2 gap-24",children:[v.jsxs("div",{children:[v.jsx("h2",{className:"text-3xl font-medium mb-8",children:"The Challenge"}),v.jsx("p",{className:"text-lg text-gray-400 font-light leading-relaxed mb-8",children:"The global security landscape has shifted. Authoritarian regimes are leveraging technology to undermine democratic institutions. The speed of conflict has accelerated beyond human cognitive limits."}),v.jsx("p",{className:"text-lg text-gray-400 font-light leading-relaxed",children:"To preserve peace and stability, democracies must possess defense capabilities that are not just reactive, but predictive and autonomous."})]}),v.jsxs("div",{children:[v.jsx("h2",{className:"text-3xl font-medium mb-8",children:"Our Response"}),v.jsx("p",{className:"text-lg text-gray-400 font-light leading-relaxed mb-8",children:"Argus Systems is building the software infrastructure for the next generation of defense. We reject the notion that AI is inherently dangerous; rather, we believe that responsible, sovereign AI is the ultimate shield against aggression."}),v.jsx("p",{className:"text-lg text-gray-400 font-light leading-relaxed",children:"Our commitment is to open standards, transparency, and the unwavering support of those who defend our freedoms."})]})]})})}),v.jsx("section",{className:"py-32 bg-off-black border-b border-white/10",children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"grid md:grid-cols-3 gap-12",children:[v.jsxs("div",{className:"card group",children:[v.jsx(fr,{className:"h-8 w-8 text-white mb-6",strokeWidth:1}),v.jsx("h3",{className:"text-2xl font-medium mb-4",children:"Sovereignty First"}),v.jsx("p",{className:"text-gray-400 font-light leading-relaxed",children:"We build systems that guarantee national control. No backdoors, no black boxes. Complete data sovereignty for our partners."})]}),v.jsxs("div",{className:"card group",children:[v.jsx(pb,{className:"h-8 w-8 text-white mb-6",strokeWidth:1}),v.jsx("h3",{className:"text-2xl font-medium mb-4",children:"Global Alliance"}),v.jsx("p",{className:"text-gray-400 font-light leading-relaxed",children:"We collaborate exclusively with democratic nations, fostering a technology alliance that strengthens collective security."})]}),v.jsxs("div",{className:"card group",children:[v.jsx(vy,{className:"h-8 w-8 text-white mb-6",strokeWidth:1}),v.jsx("h3",{className:"text-2xl font-medium mb-4",children:"Human-Machine Teaming"}),v.jsx("p",{className:"text-gray-400 font-light leading-relaxed",children:"We design AI to augment human decision-making, not replace it. The human operator remains in the loop for lethal force decisions."})]})]})})}),v.jsx("section",{className:"py-32 bg-black text-white",children:v.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[v.jsx("h2",{className:"text-4xl md:text-5xl font-medium mb-8 tracking-tight",children:"Join the Mission"}),v.jsx("p",{className:"text-xl mb-12 leading-relaxed text-gray-400 font-light max-w-2xl mx-auto",children:"We are looking for exceptional talent to solve the hardest problems in national security."}),v.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center",children:[v.jsx("a",{href:"mailto:careers@argus.global",className:"btn-primary",children:"View Open Roles"}),v.jsx("a",{href:"mailto:info@argus.global",className:"btn-secondary",children:"Contact Us"})]})]})})]})]}),aD=()=>v.jsxs("div",{style:{backgroundColor:"var(--concrete-light)"},children:[v.jsxs("section",{className:"hero-gradient text-pure-white py-32 relative overflow-hidden",style:{background:"linear-gradient(135deg, var(--carbon-black) 0%, var(--graphite-gray) 100%)",color:"var(--pure-white)"},children:[v.jsx("img",{src:"/images/automotive-banner.jpg",alt:"Automotive Industry Banner",className:"absolute inset-0 w-full h-full object-cover opacity-30"}),v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"text-center",children:[v.jsx("h1",{className:"text-6xl md:text-7xl lg:text-8xl font-bold mb-6 tracking-tight",children:"Automotive Solutions"}),v.jsx("p",{className:"text-xl mb-12 max-w-3xl mx-auto leading-relaxed",style:{color:"var(--concrete-light)"},children:"Empowering automotive professionals with hands-free visual intelligence for assembly, quality control, and maintenance."}),v.jsx(Te,{to:"/company",className:"btn-primary",children:"Request a Demo"})]})})]}),v.jsx("section",{className:"py-24 bg-light",children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[v.jsxs("div",{className:"text-center mb-16",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",style:{color:"var(--carbon-black)"},children:"Addressing Automotive Challenges"}),v.jsx("p",{className:"text-xl max-w-3xl mx-auto leading-relaxed",style:{color:"var(--graphite-gray)"},children:"The automotive industry demands precision, efficiency, and safety. Argus Smart Glasses provide solutions to common pain points."})]}),v.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Complex Assembly"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Navigating intricate assembly lines requires constant attention and access to detailed instructions."})]}),v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Quality Control"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Ensuring every component meets rigorous standards is critical but often time-consuming."})]}),v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Remote Diagnostics"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Diagnosing issues in the field or remotely can be challenging without visual context."})]})]})]})}),v.jsx("section",{className:"py-24 bg-graphite text-pure-white",children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[v.jsxs("div",{className:"text-center mb-16",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",children:"Argus Solutions for Automotive"}),v.jsx("p",{className:"text-xl max-w-3xl mx-auto leading-relaxed",style:{color:"var(--concrete-light)"},children:"Our smart glasses integrate seamlessly into your workflows, providing hands-free access to vital information."})]}),v.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-steel-blue rounded-sm flex items-center justify-center mb-6",children:v.jsx(Sy,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Guided Assembly"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Overlay digital instructions onto physical components, reducing errors and training time."})]}),v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-steel-blue rounded-sm flex items-center justify-center mb-6",children:v.jsx(fr,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Visual Quality Checks"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Perform hands-free inspections with real-time data capture and AI-powered anomaly detection."})]}),v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-steel-blue rounded-sm flex items-center justify-center mb-6",children:v.jsx(th,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Remote Expert Support"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Connect technicians with off-site experts for immediate visual assistance and problem-solving."})]})]})]})}),v.jsx("section",{className:"py-24 bg-dark text-pure-white",children:v.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",children:"Drive Innovation in Automotive"}),v.jsx("p",{className:"text-xl mb-10 leading-relaxed",style:{color:"var(--concrete-light)"},children:"Discover how Argus Systems can revolutionize your automotive operations. Contact us for a tailored solution."}),v.jsx(Te,{to:"/company",className:"btn-primary",children:"Get a Custom Solution"})]})})]}),lD=()=>v.jsxs("div",{style:{backgroundColor:"var(--concrete-light)"},children:[v.jsxs("section",{className:"hero-gradient text-pure-white py-32 relative overflow-hidden",style:{background:"linear-gradient(135deg, var(--carbon-black) 0%, var(--graphite-gray) 100%)",color:"var(--pure-white)"},children:[v.jsx("img",{src:"/images/oilgas-banner.jpg",alt:"Oil & Gas Industry Banner",className:"absolute inset-0 w-full h-full object-cover opacity-30"}),v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"text-center",children:[v.jsx("h1",{className:"text-6xl md:text-7xl lg:text-8xl font-bold mb-6 tracking-tight",children:"Oil & Gas Solutions"}),v.jsx("p",{className:"text-xl mb-12 max-w-3xl mx-auto leading-relaxed",style:{color:"var(--concrete-light)"},children:"Enhancing safety, efficiency, and compliance in hazardous oil and gas environments with hands-free visual intelligence."}),v.jsx(Te,{to:"/company",className:"btn-primary",children:"Request a Demo"})]})})]}),v.jsx("section",{className:"py-24 bg-light",children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[v.jsxs("div",{className:"text-center mb-16",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",style:{color:"var(--carbon-black)"},children:"Navigating Oil & Gas Complexities"}),v.jsx("p",{className:"text-xl max-w-3xl mx-auto leading-relaxed",style:{color:"var(--graphite-gray)"},children:"The oil and gas sector faces unique challenges, from extreme conditions to stringent safety regulations."})]}),v.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Hazardous Environments"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Working in volatile and remote locations demands robust, reliable, and safe equipment."})]}),v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Regulatory Compliance"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Adhering to strict safety and environmental regulations is paramount and complex."})]}),v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Remote Operations"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Managing and maintaining assets across vast, often inaccessible, areas is a logistical challenge."})]})]})]})}),v.jsx("section",{className:"py-24 bg-graphite text-pure-white",children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[v.jsxs("div",{className:"text-center mb-16",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",children:"Argus Solutions for Oil & Gas"}),v.jsx("p",{className:"text-xl max-w-3xl mx-auto leading-relaxed",style:{color:"var(--concrete-light)"},children:"Our smart glasses provide critical visual intelligence, enhancing safety and operational efficiency."})]}),v.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-steel-blue rounded-sm flex items-center justify-center mb-6",children:v.jsx(xb,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Enhanced Worker Safety"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Provide hands-free access to safety protocols, real-time alerts, and remote expert assistance."})]}),v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-steel-blue rounded-sm flex items-center justify-center mb-6",children:v.jsx(fr,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Compliance & Inspections"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Streamline regulatory compliance with visual documentation, guided inspections, and audit trails."})]}),v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-steel-blue rounded-sm flex items-center justify-center mb-6",children:v.jsx(rb,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Remote Maintenance"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Facilitate remote diagnostics and repair with experts guiding field technicians through complex procedures."})]})]})]})}),v.jsx("section",{className:"py-24 bg-dark text-pure-white",children:v.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",children:"Optimize Your Oil & Gas Operations"}),v.jsx("p",{className:"text-xl mb-10 leading-relaxed",style:{color:"var(--concrete-light)"},children:"Explore how Argus Systems can enhance safety and efficiency in your oil and gas projects."}),v.jsx(Te,{to:"/company",className:"btn-primary",children:"Get a Custom Solution"})]})})]}),oD=()=>v.jsxs("div",{style:{backgroundColor:"var(--concrete-light)"},children:[v.jsxs("section",{className:"hero-gradient text-pure-white py-32 relative overflow-hidden",style:{background:"linear-gradient(135deg, var(--carbon-black) 0%, var(--graphite-gray) 100%)",color:"var(--pure-white)"},children:[v.jsx("img",{src:"/images/warehousing-banner.jpg",alt:"Warehousing Industry Banner",className:"absolute inset-0 w-full h-full object-cover opacity-30"}),v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"text-center",children:[v.jsx("h1",{className:"text-6xl md:text-7xl lg:text-8xl font-bold mb-6 tracking-tight",children:"Warehousing Solutions"}),v.jsx("p",{className:"text-xl mb-12 max-w-3xl mx-auto leading-relaxed",style:{color:"var(--concrete-light)"},children:"Optimizing logistics and inventory management with hands-free visual intelligence for enhanced efficiency and accuracy."}),v.jsx(Te,{to:"/company",className:"btn-primary",children:"Request a Demo"})]})})]}),v.jsx("section",{className:"py-24 bg-light",children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[v.jsxs("div",{className:"text-center mb-16",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",style:{color:"var(--carbon-black)"},children:"Streamlining Warehouse Operations"}),v.jsx("p",{className:"text-xl max-w-3xl mx-auto leading-relaxed",style:{color:"var(--graphite-gray)"},children:"Warehousing and logistics face constant pressure to increase speed, accuracy, and cost-efficiency."})]}),v.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Picking Errors"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Manual picking processes are prone to human error, leading to mis-shipments and returns."})]}),v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Inventory Discrepancies"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Inaccurate inventory counts can lead to stockouts, overstocking, and operational delays."})]}),v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Inefficient Workflows"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Workers often juggle handheld devices, paper lists, and physical tasks, reducing efficiency."})]})]})]})}),v.jsx("section",{className:"py-24 bg-graphite text-pure-white",children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[v.jsxs("div",{className:"text-center mb-16",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",children:"Argus Solutions for Warehousing"}),v.jsx("p",{className:"text-xl max-w-3xl mx-auto leading-relaxed",style:{color:"var(--concrete-light)"},children:"Our smart glasses provide hands-free visual guidance, transforming picking, packing, and inventory tasks."})]}),v.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-steel-blue rounded-sm flex items-center justify-center mb-6",children:v.jsx(Cb,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Visual Picking Guidance"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Overlay picking instructions directly in the worker's field of view, reducing errors and improving speed."})]}),v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-steel-blue rounded-sm flex items-center justify-center mb-6",children:v.jsx(kb,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Real-time Inventory Updates"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Automate inventory scanning and updates, ensuring accurate stock levels and reducing discrepancies."})]}),v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-steel-blue rounded-sm flex items-center justify-center mb-6",children:v.jsx(th,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Logistics Optimization"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Streamline routing, packing, and shipping processes with hands-free data access and navigation."})]})]})]})}),v.jsx("section",{className:"py-24 bg-dark text-pure-white",children:v.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",children:"Transform Your Warehouse Operations"}),v.jsx("p",{className:"text-xl mb-10 leading-relaxed",style:{color:"var(--concrete-light)"},children:"Discover how Argus Systems can enhance efficiency and accuracy in your warehousing and logistics."}),v.jsx(Te,{to:"/company",className:"btn-primary",children:"Get a Custom Solution"})]})})]}),cD=()=>v.jsxs("div",{style:{backgroundColor:"var(--concrete-light)"},children:[v.jsxs("section",{className:"hero-gradient text-pure-white py-32 relative overflow-hidden",style:{background:"linear-gradient(135deg, var(--carbon-black) 0%, var(--graphite-gray) 100%)",color:"var(--pure-white)"},children:[v.jsx("img",{src:"/images/manufacturing-banner.jpg",alt:"Manufacturing Industry Banner",className:"absolute inset-0 w-full h-full object-cover opacity-30"}),v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"text-center",children:[v.jsx("h1",{className:"text-6xl md:text-7xl lg:text-8xl font-bold mb-6 tracking-tight",children:"Manufacturing Solutions"}),v.jsx("p",{className:"text-xl mb-12 max-w-3xl mx-auto leading-relaxed",style:{color:"var(--concrete-light)"},children:"Driving efficiency and precision in manufacturing with hands-free visual intelligence for assembly, inspection, and training."}),v.jsx(Te,{to:"/company",className:"btn-primary",children:"Request a Demo"})]})})]}),v.jsx("section",{className:"py-24 bg-light",children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[v.jsxs("div",{className:"text-center mb-16",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",style:{color:"var(--carbon-black)"},children:"Optimizing Modern Manufacturing"}),v.jsx("p",{className:"text-xl max-w-3xl mx-auto leading-relaxed",style:{color:"var(--graphite-gray)"},children:"The manufacturing sector demands continuous innovation to maintain competitiveness and quality."})]}),v.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Complex Assembly"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"As products become more intricate, assembly processes require greater precision and guidance."})]}),v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Quality Assurance"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Ensuring every product meets stringent quality standards is crucial but can be resource-intensive."})]}),v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Worker Training"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Onboarding new employees and upskilling existing ones for complex tasks is a continuous challenge."})]})]})]})}),v.jsx("section",{className:"py-24 bg-graphite text-pure-white",children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[v.jsxs("div",{className:"text-center mb-16",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",children:"Argus Solutions for Manufacturing"}),v.jsx("p",{className:"text-xl max-w-3xl mx-auto leading-relaxed",style:{color:"var(--concrete-light)"},children:"Our smart glasses provide hands-free visual intelligence, transforming production lines and worker efficiency."})]}),v.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-steel-blue rounded-sm flex items-center justify-center mb-6",children:v.jsx(Sy,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Guided Assembly & Repair"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Provide step-by-step visual instructions directly in the worker's field of view, reducing errors and speeding up tasks."})]}),v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-steel-blue rounded-sm flex items-center justify-center mb-6",children:v.jsx(gy,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Quality Inspection"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Enable hands-free quality checks with AR overlays highlighting critical points and automated data capture."})]}),v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-steel-blue rounded-sm flex items-center justify-center mb-6",children:v.jsx(th,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Remote Expert Collaboration"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Connect factory workers with remote experts for real-time visual assistance, minimizing downtime and travel."})]})]})]})}),v.jsx("section",{className:"py-24 bg-dark text-pure-white",children:v.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",children:"Innovate Your Manufacturing Process"}),v.jsx("p",{className:"text-xl mb-10 leading-relaxed",style:{color:"var(--concrete-light)"},children:"Discover how Argus Systems can enhance efficiency and precision in your manufacturing operations."}),v.jsx(Te,{to:"/company",className:"btn-primary",children:"Get a Custom Solution"})]})})]}),uD=()=>v.jsxs("div",{style:{backgroundColor:"var(--concrete-light)"},children:[v.jsxs("section",{className:"hero-gradient text-pure-white py-32 relative overflow-hidden",style:{background:"linear-gradient(135deg, var(--carbon-black) 0%, var(--graphite-gray) 100%)",color:"var(--pure-white)"},children:[v.jsx("img",{src:"/images/healthcare-banner.jpg",alt:"Healthcare Industry Banner",className:"absolute inset-0 w-full h-full object-cover opacity-30"}),v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"text-center",children:[v.jsx("h1",{className:"text-6xl md:text-7xl lg:text-8xl font-bold mb-6 tracking-tight",children:"Healthcare Solutions"}),v.jsx("p",{className:"text-xl mb-12 max-w-3xl mx-auto leading-relaxed",style:{color:"var(--concrete-light)"},children:"Transforming patient care and medical operations with hands-free visual intelligence for healthcare professionals."}),v.jsx(Te,{to:"/company",className:"btn-primary",children:"Request a Demo"})]})})]}),v.jsx("section",{className:"py-24 bg-light",children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[v.jsxs("div",{className:"text-center mb-16",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",style:{color:"var(--carbon-black)"},children:"Innovating Healthcare Delivery"}),v.jsx("p",{className:"text-xl max-w-3xl mx-auto leading-relaxed",style:{color:"var(--graphite-gray)"},children:"The healthcare sector faces increasing demands for efficiency, accuracy, and patient safety."})]}),v.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Complex Procedures"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Performing intricate medical procedures requires precision and access to real-time patient data."})]}),v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Remote Consultations"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Providing effective remote care can be challenging without direct visual interaction and data."})]}),v.jsxs("div",{className:"card",children:[v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Data Access & Documentation"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Efficiently accessing and documenting patient information while maintaining sterile conditions is critical."})]})]})]})}),v.jsx("section",{className:"py-24 bg-graphite text-pure-white",children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[v.jsxs("div",{className:"text-center mb-16",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",children:"Argus Solutions for Healthcare"}),v.jsx("p",{className:"text-xl max-w-3xl mx-auto leading-relaxed",style:{color:"var(--concrete-light)"},children:"Our smart glasses provide hands-free visual intelligence, transforming patient care and medical operations."})]}),v.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-steel-blue rounded-sm flex items-center justify-center mb-6",children:v.jsx(xy,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Remote Consultations & Training"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Enable hands-free remote consultations, allowing specialists to guide local staff or conduct virtual rounds."})]}),v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-steel-blue rounded-sm flex items-center justify-center mb-6",children:v.jsx(Eb,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Surgical & Procedural Guidance"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Overlay critical patient data and procedural guides directly into the surgeon's field of view."})]}),v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"w-16 h-16 bg-steel-blue rounded-sm flex items-center justify-center mb-6",children:v.jsx(fr,{className:"h-8 w-8 text-pure-white"})}),v.jsx("h3",{className:"text-2xl font-bold text-pure-white mb-4",children:"Secure Data Access & Documentation"}),v.jsx("p",{className:"text-concrete-light leading-relaxed",children:"Access patient records and document procedures hands-free, ensuring sterile environments and data security."})]})]})]})}),v.jsx("section",{className:"py-24 bg-dark text-pure-white",children:v.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[v.jsx("h2",{className:"text-5xl font-bold mb-6",children:"Advance Healthcare with Argus"}),v.jsx("p",{className:"text-xl mb-10 leading-relaxed",style:{color:"var(--concrete-light)"},children:"Discover how Argus Systems can revolutionize patient care and medical operations."}),v.jsx(Te,{to:"/company",className:"btn-primary",children:"Get a Custom Solution"})]})})]}),dD=()=>v.jsxs(v.Fragment,{children:[v.jsx(Bo,{title:"ARGUS Autonomous Assets - Air & Sea",description:"Autonomous aerial and marine systems for defense and security. AI-enabled drones and USVs for persistent surveillance and kinetic operations.",keywords:"autonomous drones, defense drones, USV, unmanned surface vehicle, loitering munition, aerial surveillance",image:"https://argus.global/images/argus-logo-updated.png",url:"https://argus.global/drones"}),v.jsxs("div",{className:"bg-black min-h-screen text-white font-sans selection:bg-white selection:text-black",children:[v.jsx("section",{className:"hero-minimal relative pt-32 pb-20 overflow-hidden border-b border-white/10",children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:v.jsxs("div",{className:"max-w-4xl",children:[v.jsxs("h1",{className:"text-6xl md:text-8xl font-medium mb-8 tracking-tighter leading-tight",children:["Autonomous",v.jsx("br",{}),v.jsx("span",{className:"text-gray-500",children:"Assets."})]}),v.jsx("p",{className:"text-xl md:text-2xl mb-12 max-w-2xl leading-relaxed text-gray-400 font-light",children:"Unmanned systems for multi-domain operations. From high-altitude surveillance to maritime interdiction, our assets operate autonomously in contested environments."})]})})}),v.jsx("section",{className:"py-32 border-b border-white/10",children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"grid md:grid-cols-2 gap-24 items-center",children:[v.jsxs("div",{children:[v.jsx("div",{className:"inline-block mb-6 px-3 py-1 border border-white text-white text-xs font-mono tracking-widest uppercase",children:"Air Domain"}),v.jsx("h2",{className:"text-4xl md:text-5xl font-medium mb-8 tracking-tight",children:"Ghost-V4 UAS"}),v.jsx("p",{className:"text-xl text-gray-400 font-light leading-relaxed mb-12",children:"A low-observable, long-endurance unmanned aerial system designed for deep sensing and electronic warfare. Capable of autonomous swarming and collaborative engagement."}),v.jsxs("div",{className:"space-y-8 font-mono text-sm",children:[v.jsxs("div",{className:"flex justify-between border-b border-white/10 pb-4",children:[v.jsx("span",{className:"text-gray-500",children:"ENDURANCE"}),v.jsx("span",{children:"12+ HOURS"})]}),v.jsxs("div",{className:"flex justify-between border-b border-white/10 pb-4",children:[v.jsx("span",{className:"text-gray-500",children:"RANGE"}),v.jsx("span",{children:"150 KM"})]}),v.jsxs("div",{className:"flex justify-between border-b border-white/10 pb-4",children:[v.jsx("span",{className:"text-gray-500",children:"PAYLOAD"}),v.jsx("span",{children:"EO/IR + EW SUITE"})]}),v.jsxs("div",{className:"flex justify-between border-b border-white/10 pb-4",children:[v.jsx("span",{className:"text-gray-500",children:"COMMS"}),v.jsx("span",{children:"SATCOM / MESH / SILENT"})]})]})]}),v.jsxs("div",{className:"relative h-full min-h-[500px] bg-gray-900 border border-white/10 flex items-center justify-center overflow-hidden",children:[v.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-gray-800/50 via-black to-black"}),v.jsx("div",{className:"relative z-10",children:v.jsx(yy,{className:"h-32 w-32 text-white opacity-80",strokeWidth:.5})}),v.jsxs("div",{className:"absolute bottom-8 left-8 text-xs font-mono text-white tracking-widest",children:["SYSTEM_STATUS: ONLINE",v.jsx("br",{}),"ALT: 15000 FT",v.jsx("br",{}),"SPD: 120 KTS"]})]})]})})}),v.jsx("section",{className:"py-32 border-b border-white/10 bg-off-black",children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"grid md:grid-cols-2 gap-24 items-center",children:[v.jsxs("div",{className:"order-2 md:order-1 relative h-full min-h-[500px] bg-black border border-white/10 flex items-center justify-center",children:[v.jsx("div",{className:"relative z-10",children:v.jsx(Ey,{className:"h-32 w-32 text-white opacity-80",strokeWidth:.5})}),v.jsxs("div",{className:"absolute bottom-8 right-8 text-xs font-mono text-white tracking-widest text-right",children:["VESSEL_ID: USV-X1",v.jsx("br",{}),"DEPTH: SURFACE",v.jsx("br",{}),"MODE: AUTONOMOUS"]})]}),v.jsxs("div",{className:"order-1 md:order-2",children:[v.jsx("div",{className:"inline-block mb-6 px-3 py-1 border border-white text-white text-xs font-mono tracking-widest uppercase",children:"Maritime Domain"}),v.jsx("h2",{className:"text-4xl md:text-5xl font-medium mb-8 tracking-tight",children:"Triton USV"}),v.jsx("p",{className:"text-xl text-gray-400 font-light leading-relaxed mb-12",children:"Autonomous surface vessel for littoral surveillance and mine countermeasures. Modular payload bay allows for rapid reconfiguration between ISR and kinetic missions."}),v.jsxs("div",{className:"space-y-8 font-mono text-sm",children:[v.jsxs("div",{className:"flex justify-between border-b border-white/10 pb-4",children:[v.jsx("span",{className:"text-gray-500",children:"AUTONOMY"}),v.jsx("span",{children:"LEVEL 4"})]}),v.jsxs("div",{className:"flex justify-between border-b border-white/10 pb-4",children:[v.jsx("span",{className:"text-gray-500",children:"SPEED"}),v.jsx("span",{children:"45 KNOTS"})]}),v.jsxs("div",{className:"flex justify-between border-b border-white/10 pb-4",children:[v.jsx("span",{className:"text-gray-500",children:"SIGNATURE"}),v.jsx("span",{children:"LOW RCS / ACOUSTIC"})]}),v.jsxs("div",{className:"flex justify-between border-b border-white/10 pb-4",children:[v.jsx("span",{className:"text-gray-500",children:"OPERATIONS"}),v.jsx("span",{children:"SEA STATE 5"})]})]})]})]})})}),v.jsx("section",{className:"py-32 bg-black text-white",children:v.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[v.jsxs("div",{className:"text-center mb-24",children:[v.jsx("h2",{className:"text-3xl font-medium mb-6",children:"Operational Advantages"}),v.jsx("p",{className:"text-gray-400 font-light max-w-2xl mx-auto",children:"Our autonomous systems are designed to operate as a cohesive force multiplier."})]}),v.jsxs("div",{className:"grid md:grid-cols-3 gap-12",children:[v.jsxs("div",{className:"card group",children:[v.jsx(ob,{className:"h-8 w-8 text-white mb-6",strokeWidth:1}),v.jsx("h3",{className:"text-xl font-medium mb-4",children:"Precision Targeting"}),v.jsx("p",{className:"text-gray-400 font-light leading-relaxed text-sm",children:"AI-assisted target recognition reduces collateral damage and ensures mission success in cluttered environments."})]}),v.jsxs("div",{className:"card group",children:[v.jsx(Fb,{className:"h-8 w-8 text-white mb-6",strokeWidth:1}),v.jsx("h3",{className:"text-xl font-medium mb-4",children:"Swarm Intelligence"}),v.jsx("p",{className:"text-gray-400 font-light leading-relaxed text-sm",children:"Assets communicate and coordinate tactics in real-time, overwhelming adversary defenses through synchronized action."})]}),v.jsxs("div",{className:"card group",children:[v.jsx(fr,{className:"h-8 w-8 text-white mb-6",strokeWidth:1}),v.jsx("h3",{className:"text-xl font-medium mb-4",children:"Resilient Comms"}),v.jsx("p",{className:"text-gray-400 font-light leading-relaxed text-sm",children:"Advanced waveforms and optical links maintain connectivity in heavy electronic warfare environments."})]})]})]})}),v.jsx("section",{className:"py-32 bg-off-black text-white border-t border-white/10",children:v.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[v.jsx("h2",{className:"text-4xl md:text-5xl font-medium mb-8 tracking-tight",children:"Secure the Advantage"}),v.jsx("p",{className:"text-xl mb-12 leading-relaxed text-gray-400 font-light max-w-2xl mx-auto",children:"Contact our defense solutions team for detailed technical specifications and capability demonstrations."}),v.jsx("div",{className:"flex flex-col sm:flex-row gap-6 justify-center",children:v.jsx(Te,{to:"/company",className:"btn-primary",children:"Request Briefing"})})]})})]})]});function hD(){return v.jsx(BT,{children:v.jsxs("div",{className:"min-h-screen flex flex-col",children:[v.jsx(Qb,{}),v.jsx("main",{className:"flex-grow",children:v.jsxs(mT,{children:[v.jsx(hi,{path:"/",element:v.jsx(tD,{})}),v.jsx(hi,{path:"/solutions",element:v.jsx(iD,{})}),v.jsx(hi,{path:"/solutions/automotive",element:v.jsx(aD,{})}),v.jsx(hi,{path:"/solutions/oil-gas",element:v.jsx(lD,{})}),v.jsx(hi,{path:"/solutions/warehousing",element:v.jsx(oD,{})}),v.jsx(hi,{path:"/solutions/manufacturing",element:v.jsx(cD,{})}),v.jsx(hi,{path:"/solutions/healthcare",element:v.jsx(uD,{})}),v.jsx(hi,{path:"/products",element:v.jsx(sD,{})}),v.jsx(hi,{path:"/drones",element:v.jsx(dD,{})}),v.jsx(hi,{path:"/resources",element:v.jsx(nD,{})}),v.jsx(hi,{path:"/company",element:v.jsx(rD,{})})]})}),v.jsx(Wb,{})]})})}TS.createRoot(document.getElementById("root")).render(v.jsx(te.StrictMode,{children:v.jsx(hD,{})}));
